import{L as _,K as m,U as f}from"./index-fcdb4188.js";const g=_("salchimonster-cart-new-4555",{persist:{key:"salchimonster-cart-new-4555",storage:localStorage,paths:["cart","last_order","menu"]},state:()=>({currentProduct:{},currentSection:{},currentVideoIndex:0,currentVideoTime:0,visibles:{currentProduct:!1,addAdditionToCart:!1,last_order:""},cart:[],last_order:"",sending_order:!1,was_reserva:!1,menu:{}}),getters:{cartTotal(e){return e.cart.reduce((o,i)=>o+i.pedido_precio,0)},isProductInCart:e=>o=>e.cart.some(i=>i.pedido_productoid===o),totalAdditions:e=>{},isProductInCart:e=>o=>e.cart.products.some(i=>i.product.productogeneral_id===o),getProductTotal:()=>(e,o=[],i=1)=>{let t=0;const a=parseFloat(e.productogeneral_precio)||0;return t+=a*i,e.lista_productobase&&e.lista_productobase.length>0&&e.lista_productobase.forEach(r=>{const c=parseFloat(r.productocombo_precio)||0,s=parseInt(r.productocombo_cantidad)||0;t+=c*s}),o&&o.length>0&&o.forEach(r=>{const c=parseFloat(r.price)||0,s=parseInt(r.quantity)||1;t+=c*s}),t}},actions:{incrementAdditionQuantity(e){},setCurrentVideoIndex(e){this.currentVideoIndex=e},setCurrentVideoTime(e){this.currentVideoTime=e},removeAdditionCompletelyFromCart(e){},decrementAdditionQuantity(e){},setCurrentProduct(e){this.currentProduct=e},setVisible(e,o){this.visibles[e]=o},getProductId(e){return e.producto_id?e.producto_id:e.lista_presentacion&&e.lista_presentacion.length>0&&e.lista_presentacion[0].producto_id?e.lista_presentacion[0].producto_id:(console.error("No valid product ID found for product:",e),null)},addProductToCart(e,o=1,i=[]){const a=JSON.stringify({product:e,additionalItems:i}),r=this.cart.findIndex(c=>c.signature===a);if(r!==-1){const c=this.cart[r];c.pedido_cantidad+=o,i.forEach(n=>{const l=c.modificadorseleccionList.findIndex(d=>d.modificador_id===n.group_id&&d.modificadorseleccion_id===n.id&&d.pedido_productoid===n.parent_id);l!==-1?(c.modificadorseleccionList[l].modificadorseleccion_cantidad+=Number(n.quantity),c.modificadorseleccionList[l].pedido_precio+=Number(n.price)):c.modificadorseleccionList.push({modificadorseleccion_cantidad:Number(n.quantity),pedido_precio:Number(n.price),modificador_id:n.group_id,modificadorseleccion_id:n.id,modificador_nombre:n.name,pedido_productoid:n.parent_id})});const s=this.calculateTotalPrice(e,c.pedido_cantidad,c.modificadorseleccionList,c.lista_productocombo);c.pedido_precio=s,this.cart[r]=c,console.log("Producto actualizado en el carrito:",c)}else{let s=(parseFloat(this.getProductPrice(e))||0)*o;i.forEach(d=>{const u=parseFloat(d.price)||0,p=parseInt(d.quantity)||1;s+=u*p});const n=e.lista_productobase?e.lista_productobase.map(d=>({pedido_productoid:parseInt(d.producto_id),pedido_cantidad:parseInt(d.productocombo_cantidad),pedido_precio:parseFloat(d.productocombo_precio),pedido_nombre:d.producto_descripcion})):[];e.lista_productobase&&e.lista_productobase.forEach(d=>{const u=parseFloat(d.productocombo_precio)||0,p=parseInt(d.productocombo_cantidad)||1;s+=u*p});const l={signature:a,pedido_productoid:this.getProductId(e),pedido_cantidad:o,pedido_precio:s,pedido_base_price:parseInt(this.getProductPrice(e))||0,pedido_escombo:e.productogeneral_escombo,productogeneral_urlimagen:e.productogeneral_urlimagen,pedido_nombre_producto:e.productogeneral_descripcion,lista_productocombo:n,modificadorseleccionList:i.map(d=>({modificadorseleccion_cantidad:Number(d.quantity),pedido_precio:Number(d.price),modificador_id:d.group_id,modificadorseleccion_id:d.id,modificador_nombre:d.name,pedido_productoid:d.parent_id}))};this.cart.push(l),console.log("Producto agregado al carrito:",l)}},removeProductFromCart(e){const o=this.cart.findIndex(i=>i.signature===e);o!==-1?(this.cart.splice(o,1),console.log(`Producto con signature ${e} eliminado del carrito.`)):console.warn(`Producto con signature ${e} no encontrado en el carrito.`)},calculateTotalPrice(e,o,i=[],t=[]){let r=(parseFloat(this.getProductPrice(e))||0)*o;return i.forEach(c=>{const s=c.pedido_precio||0,n=c.modificadorseleccion_cantidad||1;r+=s*n}),t!=null&&t.length&&t.forEach(c=>{const s=parseFloat(c.pedido_precio)||0,n=parseInt(c.pedido_cantidad)||1;r+=s*n}),r},getProductPrice(e){var t,a;const o=e.productogeneral_precio,i=(a=(t=e.lista_presentacion)==null?void 0:t[0])==null?void 0:a.producto_precio;return o!==void 0?o:i||0},decrementProduct(e){const o=this.cart.findIndex(r=>r.signature===e);if(o===-1)return;const i=this.cart[o];if(i.pedido_cantidad<=1){this.cart.splice(o,1);return}const t=i.pedido_cantidad;i.pedido_cantidad-=1,i.modificadorseleccionList.forEach(r=>{const s=r.modificadorseleccion_cantidad/t*i.pedido_cantidad;r.modificadorseleccion_cantidad=Math.round(s)});const{product:a}=JSON.parse(i.signature);i.pedido_precio=this.calculateTotalPrice(a,i.pedido_cantidad,i.modificadorseleccionList,i.lista_productocombo),this.cart[o]=i},incrementAdditional(e,o){const i=this.cart.findIndex(c=>c.signature===e);if(i===-1)return;const t=this.cart[i],a=t.modificadorseleccionList.findIndex(c=>c===o);a!==-1?t.modificadorseleccionList[a].modificadorseleccion_cantidad+=t.pedido_cantidad:t.modificadorseleccionList.push({modificadorseleccion_cantidad:t.pedido_cantidad,pedido_precio:parseFloat(o.price)||0,modificador_id:o.group_id,modificadorseleccion_id:o.id,modificador_nombre:o.name,pedido_productoid:o.parent_id});const{product:r}=JSON.parse(t.signature);t.pedido_precio=this.calculateTotalPrice(r,t.pedido_cantidad,t.modificadorseleccionList,t.lista_productocombo),this.cart[i]=t},decrementAdditional(e,o){const i=this.cart.findIndex(c=>c.signature===e);if(i===-1)return;const t=this.cart[i],a=t.modificadorseleccionList.findIndex(c=>c===o);if(a!==-1){const c=t.modificadorseleccionList[a];c.modificadorseleccion_cantidad-=t.pedido_cantidad,c.modificadorseleccion_cantidad<=0&&t.modificadorseleccionList.splice(a,1)}const{product:r}=JSON.parse(t.signature);t.pedido_precio=this.calculateTotalPrice(r,t.pedido_cantidad,t.modificadorseleccionList,t.lista_productocombo),this.cart[i]=t},incrementProduct(e){const o=this.cart.findIndex(r=>r.signature===e);if(o===-1)return;const i=this.cart[o],t=i.pedido_cantidad;i.pedido_cantidad+=1,i.modificadorseleccionList.forEach(r=>{const c=r.modificadorseleccion_cantidad/t;r.modificadorseleccion_cantidad=Math.round(c*i.pedido_cantidad)});const{product:a}=JSON.parse(i.signature);i.pedido_precio=this.calculateTotalPrice(a,i.pedido_cantidad,i.modificadorseleccionList,i.lista_productocombo),this.cart[o]=i},addAdditionalItem(e,o){},removeAdditionalItem(e,o){},groupAdditionalItems(e){},calculateProductTotal(e,o,i){},removeProductInstance(e){},calculateCartTotal(){},addAdditionToCart(e){},removeAdditionFromCart(e){}}}),b=_("call-center-site",{persist:{key:"call-center-site",storage:localStorage,paths:["location","restaurant"]},state:()=>({location:{site:{},neigborhood:{}},visibles:{currentSite:!1},current_delivery:0,webSocket:null,status:"closed",restaurant:1,categories:[10,22,26,8,9,13,27,11,4,5]}),getters:{fucion:e=>0},actions:{async func(){return func},setLocation(e){this.connectWebSocket(e.site.site_id),this.location=e},setVisible(e,o){this.visibles[e]=o},async connectWebSocket(e){this.webSocket!==null&&this.webSocket.close,this.webSocket.onopen=()=>this.webSocket.onmessage=o=>{console.log("new mesagge")},this.webSocket.onclose=async()=>{console.log("WebSocket disconnected");const o=this.location.site.site_id;o&&this.connectWebSocket(o),this.webSocket=null},this.webSocket.onerror=o=>console.error("WebSocket error:",o)},async setNeighborhoodPrice(){try{const e=await m.get(`${f}/neighborhood/${this.location.neigborhood.neighborhood_id}/`);return e.status===200?(this.location.neigborhood=e.data,e.data):(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async setNeighborhoodPriceCero(){this.location.neigborhood.delivery_price=0}}});export{g as a,b as u};
