import{A as k}from"./auditService-504d4ab2.js";import{x as G,f as d,h as O,r as _,o as i,c as n,a as t,d as s,w as r,F as v,k as D,t as u,b as g,U as F}from"./index-11627319.js";const M={class:"m-0 p-0 md:p-4"},q={class:"flex flex-wrap align-items-center justify-content-between gap-2"},H=t("span",{class:"text-xl text-900 font-bold"},"Checklists",-1),J={style:{"text-transform":"uppercase"}},K={style:{"text-transform":"uppercase"},class:"py-0 my-0"},W=t("i",{class:"fa-solid fa-eye text-2xl"},null,-1),z={style:{"text-transform":"uppercase"}},Q={class:"py-0 mt-4",style:{"text-transform":"uppercase","font-weight":"bold"}},X={class:"my-0 py-0"},Y={class:"my-0 py-0"},Z={class:"",style:{}},ee={class:"my-0 py-0"},te={class:"field"},se=t("label",{for:"checklistName"},"Nombre del Checklist",-1),le={class:"field my-5"},oe={class:"input-group",style:{display:"flex","align-items":"center","justify-content":"space-between"}},ae={class:"input-group my-2 col-12 p-0",style:{display:"flex",gap:"1rem","align-items":"center","justify-content":"space-between"}},ie={class:"col-12 p-0",style:{display:"flex","justify-content":"end"}},ne={class:"grid gap-2 my-4"},re={class:"col-12 py-0"},ce={class:"col-12 py-0"},de={class:"col-12 py-0"},he={__name:"checklist",setup(ue){const b=G(),C=d(!1),N=d();d({}),d({});const w=d({}),x=d([{}]),A=l=>{C.value=!0,k.getChecklistWithItems(l).then(a=>w.value=a)};O(()=>{k.getAudits().then(l=>N.value=l),k.getChecklist().then(l=>{x.value=Array.isArray(l)?l:[]})});const y=d(!1),m=d({name:"",groups:[]}),U=()=>{y.value=!0},S=()=>{m.value.groups.push({name:"",items:[]})},j=l=>{l.items.push({description:"",group_id:0})},I=l=>{m.value.groups.splice(l,1)},R=(l,a)=>{l.items.splice(a,1)},$=async()=>{const l=`${F}/checklists-with-groups-and-items`,a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m.value)};try{b.setLoading(!0,"guardando");const o=await fetch(l,a);if(!o.ok)throw new Error(`HTTP error! Status: ${o.status}`);const h=await o.json();console.log("Checklist guardado con éxito:",h),y.value=!1,k.getChecklist().then(f=>{x.value=Array.isArray(f)?f:[],b.setLoading(!1,"guardando")})}catch(o){console.error("Error al guardar el checklist:",o),b.setLoading(!1,"guardando")}},B=()=>{y.value=!1};return(l,a)=>{const o=_("Button"),h=_("Column"),f=_("DataTable"),L=_("Dialog"),V=_("InputText"),E=_("Divider");return i(),n(v,null,[t("div",M,[s(f,{value:x.value,tableStyle:"min-width: 50rem",class:"p-0",dataKey:"id",paginator:!0,rows:10,filters:l.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} to {last} de {totalRecords} listas",responsiveLayout:"scroll",scrollable:""},{header:r(()=>[t("div",q,[H,s(o,{icon:"pi pi-plus",rounded:"",raised:"",onClick:U})])]),default:r(()=>[s(h,{header:"Id"},{body:r(e=>[D(u(e.data.checklist_id),1)]),_:1}),s(h,{header:"Nombre del checklist"},{body:r(e=>[t("p",J,u(e.data.checklist_name),1)]),_:1}),s(h,{header:"Grupos de Items",class:""},{body:r(e=>[(i(!0),n(v,null,g(e.data.groups,(c,p)=>(i(),n("p",K,u(c.group_name)+" "+u(""),1))),256))]),_:1}),s(h,{class:"p-0 m-0",field:"inventoryStatus",header:"Mas detalles",style:{"min-width":"7rem"}},{body:r(e=>[s(o,{onClick:c=>A(e.data.checklist_id),text:"",severity:"help"},{default:r(()=>[W]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value","filters"])]),s(L,{visible:C.value,"onUpdate:visible":a[0]||(a[0]=e=>C.value=e),modal:"",header:"DETALLES",style:{width:"30rem"}},{default:r(()=>[t("h5",null,[t("b",z,u(w.value.checklist_name),1)]),(i(!0),n(v,null,g(w.value.groups,e=>(i(),n("div",null,[t("h6",Q,u(e.group_name),1),(i(!0),n(v,null,g(e.items,c=>(i(),n("div",X,[t("ul",Y,[t("li",Z,[t("h6",ee,u(c.item_description),1)])])]))),256))]))),256))]),_:1},8,["visible"]),s(L,{visible:y.value,"onUpdate:visible":a[2]||(a[2]=e=>y.value=e),header:"Crear Checklist",modal:!0},{default:r(()=>[t("div",te,[se,s(V,{style:{"font-weight":"bold","text-transform":"uppercase"},class:"col-12",id:"checklistName",modelValue:m.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value.name=e)},null,8,["modelValue"])]),(i(!0),n(v,null,g(m.value.groups,(e,c)=>(i(),n("div",{class:"ml-5",key:c},[t("div",le,[t("div",oe,[s(V,{style:{"font-weight":"bold","text-transform":"uppercase"},placeholder:"nombre del grupo",class:"col-10",id:"groupName"+c,modelValue:e.name,"onUpdate:modelValue":p=>e.name=p},null,8,["id","modelValue","onUpdate:modelValue"]),s(o,{severity:"danger",style:{width:"3rem",height:"3rem","border-radius":"5rem","aspect-ratio":"1 / 1"},class:"input-group-button",icon:"pi pi-times",onClick:p=>I(c)},null,8,["onClick"])])]),s(E,null,{default:r(()=>[D(" Items de "+u(e.name),1)]),_:2},1024),(i(!0),n(v,null,g(e.items,(p,P)=>(i(),n("div",{key:P},[t("div",ae,[s(V,{style:{width:"100%"},placeholder:"descripcion",class:"",id:"groupName"+c,modelValue:p.description,"onUpdate:modelValue":T=>p.description=T},null,8,["id","modelValue","onUpdate:modelValue"]),s(o,{severity:"danger",style:{"min-width":"3rem",height:"3rem","border-radius":"50%","aspect-ratio":"1 / 1"},class:"input-group-button",icon:"pi pi-times",onClick:T=>R(e,P)},null,8,["onClick"])])]))),128)),t("div",ie,[s(o,{style:{height:"3rem",width:"3rem","border-radius":"50%"},icon:"pi pi-plus ",severity:"info",onClick:p=>j(e)},null,8,["onClick"])])]))),128)),t("div",ne,[t("div",re,[s(o,{severity:"help",class:"col-12",label:"Añadir Grupo",onClick:S})]),t("div",ce,[s(o,{severity:"success",class:"col-12",label:"Guardar",onClick:$})]),t("div",de,[s(o,{severity:"danger",class:"col-12",label:"Cancelar",onClick:B})])])]),_:1},8,["visible"])],64)}}};export{he as default};
