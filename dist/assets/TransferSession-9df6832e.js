import{_ as oe,g as r,Z as $,h as C,i as E,U as F,l as re,q as ne,D as j,C as ie,s as de,ae as f,e as n,o as g,c as H,b as s,f as o,a,m as u,n as X,P as G,t as y,u as m,E as D,x as R,j as Z,F as ue,r as ce,p as pe,k as me}from"./index-65618ae1.js";import{D as _e}from"./OrderItem.vue_vue_type_style_index_0_scoped_bbba8067_lang-235f4da5.js";import"./index-558f534d.js";import{e as ve}from"./formatDate-262296cf.js";import"./formatoPesos-8aa989a0.js";import"./_commonjsHelpers-23102255.js";const _=b=>(pe("data-v-4e1d2481"),b=b(),me(),b),fe={class:"container",style:{"margin-top":"7rem"}},ye=_(()=>a("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"6rem"}},[a("i",{class:"fa-solid fa-truck-arrow-right"}),u(" Transferencias ")],-1)),he=_(()=>a("h3",null,[a("b",null,"Rechazar orden")],-1)),ge=_(()=>a("h3",null,[a("b",null,"Aprobar esta orden")],-1)),be={style:{"max-width":"1280px"},class:"mx-auto"},we={style:{display:"flex","align-items":"center",gap:"1rem"}},xe=_(()=>a("h3",{style:{width:"min-content",padding:"0"}},[a("b",null,"Modos")],-1)),Te={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},Pe={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},Ve=_(()=>a("div",{class:"col-12 md:col-6 p-3"},[a("span",{class:"text-xl",style:{width:"100%"}},[u(" Transferencias pendientes "),a("span",{style:{"text-transform":"capitalize"}})])],-1)),ke={class:"md:mt-0 p-input-icon-right m-3"},Se=_(()=>a("i",{class:"pi pi-search"},null,-1)),Ce={style:{display:"flex",gap:"0.5rem"}},De={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"start",display:"flex",gap:"1rem"}},Re={class:"px-2 m-0"},ze=_(()=>a("i",{class:"fa-regular fa-bars-progress"},null,-1)),Le={style:{"text-transform":"uppercase"}},Me={class:"m-0"},Ue={__name:"TransferSession",setup(b){const z=r([]);r([{columnName:"SEDE",columnValue:"sede",columnType:"other",size:"1rem",vif:!0},{columnName:"ASESOR",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);const i=r({start_date:new Date,end_date:new Date,sites:[]}),L=r([]),V=$(),J=l=>{V.setVisible("currentOrder",!0),V.setOrder(l)},K=async l=>{const t=O.rawUserData.id;await f.authorizeOrder(l,t),h.value=!1,P()},M=async()=>{const l=await E.post(`${F}/transaction_report/`,{start_date:i.value.start_date,end_date:i.value.end_date,sites:i.value.sites.map(t=>t.site_id)});U.value=l,l!=null&&l[0]&&(L.value=Object.keys(l[0]))},U=r([]);C(async()=>{z.value=await E.get(`${F}/sites/`),await M()});const k=r(!1),w=r([]),h=r(!1),O=re(),c=r({}),Q=r([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]),x=r({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),$(),r(null);const q={revisar:f.getPendientsCancellationRequest,aprobadas:f.getaceptedCancellationAcepted,rechazadas:f.getPendientsCancellationRejected};ne(()=>{B()}),j(()=>V.numberTransferRequests,()=>{P()});const W=l=>{h.value=!0,c.value.order_id=l},Y=async(l,t,A)=>{const p={authorized:l,responsible_id:O.rawUserData.id,responsible_observation:c.value.reason||"sin observaciones"};await f.resolveCancellationRequest(t,p),h.value=!1,k.value=!1,w.value=await q.revisar()},T=ie(),v=r(),B=()=>{v.value={global:{value:null,matchMode:de.CONTAINS}}};B(),C(()=>{P()}),C(async()=>{P()});const P=async()=>{w.value=await f.getOrdersTransfer()};return j(()=>T.params.request_status,async()=>{w.value=await q.revisar()},{deep:!0}),(l,t)=>{const A=n("Textarea"),p=n("Button"),N=n("Dialog"),ee=n("Dropdown"),te=n("InputText"),d=n("Column"),I=n("DataTable"),ae=n("Calendar"),se=n("calendar"),le=n("MultiSelect");return g(),H("div",fe,[ye,s(N,{visible:k.value,"onUpdate:visible":t[2]||(t[2]=e=>k.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[he]),default:o(()=>[a("form",{onSubmit:t[1]||(t[1]=G(e=>Y(!1,c.value.id,c.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(A,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:c.value.reason,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),s(p,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),s(N,{visible:h.value,"onUpdate:visible":t[4]||(t[4]=e=>h.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[ge]),default:o(()=>[a("form",{onSubmit:t[3]||(t[3]=G(e=>K(c.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(p,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (Transferencia confirmada)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),a("div",be,[a("div",we,[xe,u(),s(ee,{modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=e=>x.value=e),options:Q.value,optionLabel:"name"},null,8,["modelValue","options"])]),a("div",Te,[a("div",{style:X(`transform:translateX(${x.value.slide}%)`),class:"slider-item"},[s(I,{paginator:!0,rows:15,filters:v.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":t[7]||(t[7]=e=>v.value=e),class:"col-12 m-auto",value:w.value,tableStyle:"min-width: 50rem;"},{header:o(()=>[a("div",Pe,[Ve,a("span",ke,[Se,s(te,{class:"",modelValue:v.value.global.value,"onUpdate:modelValue":t[6]||(t[6]=e=>v.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:o(()=>[s(d,{style:{},class:"py-1 pl-0",field:"order_id",header:"ID orden",frozen:""}),s(d,{style:{},class:"py-1 pl-0",field:"total_order_price",header:"Monto de la orden"},{body:o(e=>[u(y(m(D)(e.data.total_order_price)),1)]),_:1}),s(d,{style:{},class:"py-1 pl-0",field:"total_order_price",header:"Hora"},{body:o(e=>[u(y(m(ve)(e.data.latest_status_timestamp)),1)]),_:1}),s(d,{style:{},class:"py-1 pl-0",field:"delivery_price",header:"Domicilio"},{body:o(e=>[u(y(m(D)(e.data.delivery_price)),1)]),_:1}),s(d,{style:{},class:"py-1 pl-0",field:"Total",header:"Total"},{body:o(e=>[u(y(m(D)(e.data.delivery_price+e.data.total_order_price)),1)]),_:1}),s(d,{style:{},class:"py-1 pl-0",field:"user_name",header:"Cliente"}),s(d,{style:{},class:"py-1 pl-0",field:"user_phone",header:"Telefono cliente"}),s(d,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:o(e=>[a("div",Ce,[m(T).params.request_status!="aprobadas"?(g(),R(p,{key:0,size:"",onClick:S=>J(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):Z("",!0),m(T).params.request_status!="aprobadas"?(g(),R(p,{key:1,size:"",onClick:S=>W(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):Z("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),a("div",{style:X(`transform:translateX(${x.value.slide}%)`),class:"slider-item"},[s(I,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:U.value,tableStyle:"min-width: 50rem;",filters:v.value},{header:o(()=>[a("div",De,[a("h4",Re,[ze,u(),a("b",Le,[u("Transferencias "),a("b",null,y(m(T).params.section),1)])]),s(ae,{modelValue:i.value.start_date,"onUpdate:modelValue":t[8]||(t[8]=e=>i.value.start_date=e)},null,8,["modelValue"]),s(se,{modelValue:i.value.end_date,"onUpdate:modelValue":t[9]||(t[9]=e=>i.value.end_date=e)},null,8,["modelValue"]),s(le,{style:{"max-width":"30rem"},modelValue:i.value.sites,"onUpdate:modelValue":t[10]||(t[10]=e=>i.value.sites=e),optionLabel:"site_name",options:z.value.filter(e=>e.show_on_web)},null,8,["modelValue","options"]),s(p,{severity:"help",onClick:M,label:"Buscar",icon:"pi pi-search"})])]),default:o(()=>[(g(!0),H(ue,null,ce(L.value,e=>(g(),R(d,{class:"py-1",style:{"text-transform":"uppercase"},header:e},{body:o(S=>[a("h6",Me,y(S.data[e]),1)]),_:2},1032,["header"]))),256))]),_:1},8,["value","filters"])],4)])]),s(_e)])}}},$e=oe(Ue,[["__scopeId","data-v-4e1d2481"]]);export{$e as default};
