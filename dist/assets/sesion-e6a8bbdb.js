import{_ as ye,f as s,g as J,z as n,A as fe,u as Ve,B as Ce,j as ne,U as v,C as B,D as O,E as R,G as F,H as q,h as be,r as g,o as _,c as E,d as l,w as ee,a as o,n as I,l as c,m as x,I as Y,t as M,F as ve,b as $e,J as se,v as Se,p as we,e as xe,K as le,L as he,M as X,s as ge,k as Ee,q as ke,P as Ue,N as te}from"./index-de8de9e2.js";import"./dialogoEditarProducto.vue_vue_type_style_index_0_scoped_93a19fed_lang-84580219.js";import{f as Te}from"./formatoPesos-2a38d2e7.js";const z=$=>(we("data-v-93a19fed"),$=$(),xe(),$),je={key:0,style:{}},De=["src"],Pe=z(()=>o("h5",null,"Nombre",-1)),Ie={class:"p-input-icon-left mb-0"},ze=z(()=>o("i",{class:"pi pi-pencil"},null,-1)),Le=z(()=>o("h5",null,"Description",-1)),Ge=z(()=>o("h5",null,"Precio",-1)),Ne={class:"p-input-icon-left"},Be={style:{display:"flex","align-items":"center"}},Oe=z(()=>o("span",{class:"ml-5"},"Conjunto de salsas",-1)),Re={key:1,class:"p-input-icon-left"},Fe={style:{display:"flex","align-items":"center"}},qe=z(()=>o("span",{class:"ml-5"},"Conjunto de adiciones",-1)),He={class:"p-input-icon-left"},Je={style:{display:"flex","align-items":"center"}},Me=z(()=>o("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),Ke={class:"p-input-icon-left"},Qe={style:{display:"flex","align-items":"center"}},We=z(()=>o("span",{class:"ml-5"},"Conjunto de toppings",-1)),Xe={class:"p-input-icon-left"},Ye={style:{display:"flex","align-items":"center"}},Ze=z(()=>o("span",{class:"ml-5"},"Conjunto de cambios",-1)),eo={class:"p-input-icon-left"},oo=z(()=>o("h5",{style:{display:"flex","align-items":"center"}},[o("span",{class:""},"Estado")],-1)),ao={class:"p-input-icon-left"},to={style:{display:"flex","align-items":"center"}},so={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},lo={class:"mt-6"},no={style:{display:"flex","align-items":"center"}},io=z(()=>o("span",{class:"ml-5"},"Todas",-1)),ro={style:{display:"flex","align-items":"center"}},uo={class:"ml-5"},co=z(()=>o("span",{class:"text-center col-12 p-0"},"Guardar",-1)),po={__name:"dialogoEditarProducto",setup($){const U=a=>{const e=new Date().getTime();return`${v}/read-product-image/300/${a}?timestamp=${e}`},w=s({}),K=s({});J(n,async a=>{if(a&&a.name)try{(await re(a.name)).forEach(t=>{K.value[t.site_id]={seleccionada:!0,product_id:t.product_id}})}catch(e){console.error("Error al obtener sedes para el producto:",e)}},{immediate:!0}),J(n,async a=>{Object.keys(w.value).forEach(t=>{w.value[t]=!1}),(await re(n.value.name)).forEach(t=>{w.value[t.site_id]=!0})});const C=s(null),oe=s(null),ae=a=>{const e=a.target.files[0];e&&(C.value=URL.createObjectURL(e),oe.value=e)},f=fe(),Z=Ve(),N=Ce(()=>Z.query.category),i=s([]),p=s(!1);J(p,a=>{ne.value.forEach(e=>{i.value[e.site_id]=a})}),console.log(N.value),s("producto sin nombre"),s("producto sin descripcion"),s(0),s("inactive");const h=s(["active","inactive"]),S=s([]),A=s([]),V=s([]),m=s([]),y=s([]),L=s(),T=s(),j=s(),D=s(),P=s(),ie=async()=>{await _e(n.value.name);for(const[a,e]of Object.entries(i.value))if(e&&K.value[a]&&K.value[a].product_id){const t={product_id:K.value[a].product_id,name:n.value.name,price:n.value.price,description:n.value.description,category_id:N.value,porcion:"1",state:n.value.state,grupo_salsa_id:L.value?B.value.grupo_salsa_id:null,grupo_topping_id:j.value?F.value.grupo_topping_id:null,grupo_acompanante_id:P.value?q.value.grupo_acompanante_id:null,grupo_cambio_id:D.value?O.value.grupo_cambio_id:null,grupo_adicional_id:T.value?R.value.grupo_id:null,site_id:a};try{const b=await fetch(`${v}/products/${t.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!b.ok)throw new Error(`Error: ${b.status}`);f.add({severity:"success",summary:`Producto actualizado en la sede ${a}`,detail:"ActualizaciÃ³n completada",life:3e3})}catch(b){console.error("Error al actualizar el producto:",b)}}se.value=!1,location.reload()};J(n,async a=>{if(Object.keys(i.value).forEach(e=>{i.value[e]=!1}),a&&a.name)try{(await re(n.value.name)).forEach(t=>{i.value[t.site_id]=!0})}catch(e){console.error("Error al obtener sedes para el producto:",e)}},{immediate:!0});const re=async a=>{try{const e=await fetch(`${v}/products/name/${a}/sites`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){console.error("Error fetching sites:",e),f.add({severity:"error",summary:"Error",detail:"Error fetching sites data",life:3e3})}},_e=async a=>{const e=new FormData;e.append("file",oe.value);try{if(!(await fetch(`${v}/upload-product-image/${a}`,{method:"POST",body:e})).ok)throw new Error("Error al subir la imagen");C.value=U(n.value.name)}catch(t){console.error("Error al subir la imagen:",t)}},ue=async()=>{try{return await(await fetch(`${v}/grupo-salsas`)).json()}catch(a){console.error("Error fetching data: ",a)}},ce=async()=>{try{return await(await fetch(`${v}/grupo-cambios`)).json()}catch(a){console.error("Error fetching data: ",a)}},de=async()=>{try{return await(await fetch(`${v}/grupo-adicionales`)).json()}catch(a){console.error("Error fetching data: ",a)}},pe=async()=>{try{return await(await fetch(`${v}/grupo-toppings`)).json()}catch(a){console.error("Error fetching data: ",a)}},me=async()=>{try{return await(await fetch(`${v}/grupo-acompanantes`)).json()}catch(a){console.error("Error fetching data: ",a)}};return J(n,async()=>{C.value=U(n.value.name),n.value.grupo_salsa_id?L.value=!0:L.value=!1,n.value.grupo_adicional_id?T.value=!0:T.value=!1,n.value.grupo_acompanante_id?P.value=!0:P.value=!1,n.value.grupo_topping_id?j.value=!0:j.value=!1,n.value.grupo_cambio_id?D.value=!0:D.value=!1,ue().then(d=>{S.value=d}),de().then(d=>{A.value=d}),ce().then(d=>{V.value=d}),me().then(d=>{m.value=d}),pe().then(d=>{y.value=d});const a=await ue();S.value=a;const e=await ce();V.value=e;const t=await de();A.value=t;const b=await pe();y.value=b;const G=await me();m.value=G,B.value=a.find(d=>d.grupo_salsa_id===n.value.grupo_salsa_id),O.value=e.find(d=>d.grupo_cambio_id===n.value.grupo_cambio_id),R.value=t.find(d=>d.grupo_id===n.value.grupo_adicional_id),F.value=b.find(d=>d.grupo_topping_id===n.value.grupo_topping_id),q.value=G.find(d=>d.grupo_acompanante_id===n.value.grupo_acompanante_id)}),be(async()=>{var a,e;C.value=U(n.value.name),n.value.grupo_salsa_id?L.value=!0:L.value=!1,n.value.grupo_adicional_id?T.value=!0:T.value=!1,n.value.grupo_acompanante_id?P.value=!0:P.value=!1,n.value.grupo_topping_id?j.value=!0:j.value=!1,n.value.grupo_cambio_id?D.value=!0:D.value=!1,ue().then(t=>{S.value=t}),de().then(t=>{A.value=t}),ce().then(t=>{V.value=t}),me().then(t=>{m.value=t}),pe().then(t=>{y.value=t}),(e=(a=ne)==null?void 0:a.value)==null||e.forEach(t=>{i.value[t.site_id]=!1})}),(a,e)=>{const t=g("Input"),b=g("Button"),G=g("InputText"),d=g("Textarea"),Q=g("InputNumber"),H=g("InputSwitch"),W=g("Dropdown"),u=g("Dialog");return _(),E(ve,null,[l(u,{visible:c(se),"onUpdate:visible":e[16]||(e[16]=r=>x(se)?se.value=r:null),style:Se([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:`Editar ${c(n).name}`,modal:!0,class:"p-fluid p-2 m-3"},{default:ee(()=>[C.value?(_(),E("div",je,[o("img",{src:C.value,style:{width:"100%",height:"auto"}},null,8,De)])):I("",!0),l(t,{type:"file",onChange:ae,accept:"image/*"}),l(b,{text:"",style:{width:"auto"},class:"p-0",label:"Reset image",size:"small",onClick:e[0]||(e[0]=r=>C.value=`${c(v)}/read-product-image/300/${c(n).name}`)}),Pe,o("span",Ie,[ze,l(G,{disabled:"",modelValue:c(n).name,"onUpdate:modelValue":e[1]||(e[1]=r=>c(n).name=r),type:"text"},null,8,["modelValue"])]),Le,l(d,{modelValue:c(n).description,"onUpdate:modelValue":e[2]||(e[2]=r=>c(n).description=r),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),Ge,o("span",Ne,[l(Q,{class:"",modelValue:c(n).price,"onUpdate:modelValue":e[3]||(e[3]=r=>c(n).price=r),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),o("h5",Be,[l(H,{class:"p-0 m-0",modelValue:L.value,"onUpdate:modelValue":e[4]||(e[4]=r=>L.value=r)},null,8,["modelValue"]),Oe]),L.value?(_(),E("span",Re,[l(W,{style:{outline:"none"},class:"p-0",primary:"",modelValue:c(B),"onUpdate:modelValue":e[5]||(e[5]=r=>x(B)?B.value=r:null),options:S.value,optionLabel:"name"},null,8,["modelValue","options"])])):I("",!0),o("h5",Fe,[l(H,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":e[6]||(e[6]=r=>T.value=r)},null,8,["modelValue"]),qe]),o("span",He,[T.value?(_(),Y(W,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(R),"onUpdate:modelValue":e[7]||(e[7]=r=>x(R)?R.value=r:null),options:A.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),o("h5",Je,[l(H,{class:"p-0 m-0",modelValue:P.value,"onUpdate:modelValue":e[8]||(e[8]=r=>P.value=r)},null,8,["modelValue"]),Me]),o("span",Ke,[P.value?(_(),Y(W,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(q),"onUpdate:modelValue":e[9]||(e[9]=r=>x(q)?q.value=r:null),options:m.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),o("h5",Qe,[l(H,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":e[10]||(e[10]=r=>j.value=r)},null,8,["modelValue"]),We]),o("span",Xe,[j.value?(_(),Y(W,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(F),"onUpdate:modelValue":e[11]||(e[11]=r=>x(F)?F.value=r:null),options:y.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),o("h5",Ye,[l(H,{class:"p-0 m-0",modelValue:D.value,"onUpdate:modelValue":e[12]||(e[12]=r=>D.value=r)},null,8,["modelValue"]),Ze]),o("span",eo,[D.value?(_(),Y(W,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(O),"onUpdate:modelValue":e[13]||(e[13]=r=>x(O)?O.value=r:null),options:V.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),oo,o("span",ao,[l(W,{style:{outline:"none"},class:"p-0",primary:"",modelValue:c(n).state,"onUpdate:modelValue":e[14]||(e[14]=r=>c(n).state=r),options:h.value},null,8,["modelValue","options"])]),o("h5",to,[o("span",so,"En que sedes quiere modificar "+M(c(n).name),1)]),o("div",lo,[o("h5",no,[l(H,{class:"p-0 m-0",modelValue:p.value,"onUpdate:modelValue":e[15]||(e[15]=r=>p.value=r)},null,8,["modelValue"]),io]),(_(!0),E(ve,null,$e(c(ne),r=>(_(),E("div",{key:r.site_id},[o("h5",ro,[l(H,{class:"p-0 m-0",modelValue:i.value[r.site_id],"onUpdate:modelValue":Ae=>i.value[r.site_id]=Ae,disabled:!w.value[r.site_id]},null,8,["modelValue","onUpdate:modelValue","disabled"]),o("span",uo,M(r.site_name),1)])]))),128))]),l(b,{onClick:ie,class:"m-auto my-4 text-center"},{default:ee(()=>[co]),_:1})]),_:1},8,["visible","header"]),l(c(f))],64)}}},mo=ye(po,[["__scopeId","data-v-93a19fed"]]);const k=$=>(we("data-v-a8a20a02"),$=$(),xe(),$),vo={key:0},_o=["src"],go=k(()=>o("h5",null,"Nombre",-1)),ho={class:"p-input-icon-left mb-4"},yo=k(()=>o("i",{class:"pi pi-pencil"},null,-1)),fo=k(()=>o("h5",null,"Description",-1)),Vo=k(()=>o("h5",null,"Precio",-1)),bo={class:"p-input-icon-left"},$o=k(()=>o("i",{class:"pi pi-pencil"},null,-1)),wo={style:{display:"flex","align-items":"center"}},xo=k(()=>o("span",{class:"ml-5"},"Conjunto de salsas",-1)),Eo={key:1,class:"p-input-icon-left"},ko={style:{display:"flex","align-items":"center"}},Uo=k(()=>o("span",{class:"ml-5"},"Conjunto de adiciones",-1)),Co={class:"p-input-icon-left"},So={style:{display:"flex","align-items":"center"}},Ao=k(()=>o("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),To={class:"p-input-icon-left"},jo={style:{display:"flex","align-items":"center"}},Do=k(()=>o("span",{class:"ml-5"},"Conjunto de toppings",-1)),Po={class:"p-input-icon-left"},Io={style:{display:"flex","align-items":"center"}},zo=k(()=>o("span",{class:"ml-5"},"Conjunto de cambios",-1)),Lo={class:"p-input-icon-left"},Go=k(()=>o("h5",{style:{display:"flex","align-items":"center"}},[o("span",{class:""},"Estado")],-1)),No={class:"p-input-icon-left"},Bo={style:{display:"flex","align-items":"center"}},Oo={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},Ro={class:"mt-6"},Fo={style:{display:"flex","align-items":"center"}},qo=k(()=>o("span",{class:"ml-5"},"Todas",-1)),Ho={style:{display:"flex","align-items":"center"}},Jo={class:"ml-5"},Mo=k(()=>o("span",{class:"text-center col-12 p-0"},"Agregar",-1)),Ko={__name:"dialogoAgregarProducto",setup($){const U=s(null),w=s(null),K=a=>{const e=a.target.files[0];e&&(U.value=URL.createObjectURL(e),w.value=e)},C=fe(),oe=Ve(),ae=Ce(()=>oe.query.category),f=s([]),Z=s(!1);J(Z,a=>{ne.value.forEach(e=>{f.value[e.site_id]=a})}),console.log(ae.value);const N=s("producto sin nombre"),i=s("producto sin descripcion"),p=s(0),h=s("inactive"),S=s(["active","inactive"]),A=s([]),V=s([]),m=s([]),y=s([]),L=s([]),T=s(),j=s(),D=s(),P=s(),ie=s(),re=async()=>{const a=`${v}/products`;_e(N.value);for(const[e,t]of Object.entries(f.value))if(t){const b={name:N.value,price:p.value,description:i.value,category_id:ae.value,porcion:"1",state:h.value,grupo_salsa_id:B.value?B.value.grupo_salsa_id:null,grupo_topping_id:F.value?F.value.grupo_topping_id:null,grupo_acompanante_id:q.value?q.value.grupo_acompanante_id:null,grupo_cambio_id:O.value?O.value.grupo_cambio_id:null,grupo_adicional_id:R.value?R.value.grupo_adicional_id:null,site_id:e};try{const G=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!G.ok)throw new Error(`Error: ${G.status}`);C.add({severity:"success",summary:`agregado a la sede ${e}`,detail:"espaerando las otras sedes",life:3e3}),he.value=he.value+1}catch(G){console.error("Error al enviar producto:",G)}}le.value=!1},_e=async a=>{const e=new FormData;e.append("file",w.value);try{if(!(await fetch(`${v}/upload-product-image/${a}`,{method:"POST",body:e})).ok)throw new Error("Error al subir la imagen")}catch(t){console.error("Error al subir la imagen:",t)}},ue=async()=>{try{return await(await fetch(`${v}/grupo-salsas`)).json()}catch(a){console.error("Error fetching data: ",a)}},ce=async()=>{try{return await(await fetch(`${v}/grupo-cambios`)).json()}catch(a){console.error("Error fetching data: ",a)}},de=async()=>{try{return await(await fetch(`${v}/grupo-adicionales`)).json()}catch(a){console.error("Error fetching data: ",a)}},pe=async()=>{try{return await(await fetch(`${v}/grupo-toppings`)).json()}catch(a){console.error("Error fetching data: ",a)}},me=async()=>{try{return await(await fetch(`${v}/grupo-acompanantes`)).json()}catch(a){console.error("Error fetching data: ",a)}};return be(async()=>{var a,e;ue().then(t=>{A.value=t}),de().then(t=>{V.value=t}),ce().then(t=>{m.value=t}),me().then(t=>{y.value=t}),pe().then(t=>{L.value=t}),(e=(a=ne)==null?void 0:a.value)==null||e.forEach(t=>{f.value[t.site_id]=!1})}),(a,e)=>{const t=g("Input"),b=g("InputText"),G=g("Textarea"),d=g("InputSwitch"),Q=g("Dropdown"),H=g("Button"),W=g("Dialog");return _(),E(ve,null,[l(W,{visible:c(le),"onUpdate:visible":e[15]||(e[15]=u=>x(le)?le.value=u:null),style:Se([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:"Agregar producto",modal:!0,class:"p-fluid p-2 m-3"},{default:ee(()=>[U.value?(_(),E("div",vo,[o("img",{src:U.value,alt:"PrevisualizaciÃ³n del Producto",style:{"max-width":"100%",height:"auto"}},null,8,_o)])):I("",!0),l(t,{type:"file",onChange:K,accept:"image/*"}),go,o("span",ho,[yo,l(b,{modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=u=>N.value=u),type:"text"},null,8,["modelValue"])]),fo,l(G,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=u=>i.value=u),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),Vo,o("span",bo,[$o,l(b,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=u=>p.value=u),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),o("h5",wo,[l(d,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=u=>T.value=u)},null,8,["modelValue"]),xo]),T.value?(_(),E("span",Eo,[l(Q,{style:{outline:"none"},class:"p-0",primary:"",modelValue:c(B),"onUpdate:modelValue":e[4]||(e[4]=u=>x(B)?B.value=u:null),options:A.value,optionLabel:"name"},null,8,["modelValue","options"])])):I("",!0),o("h5",ko,[l(d,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":e[5]||(e[5]=u=>j.value=u)},null,8,["modelValue"]),Uo]),o("span",Co,[j.value?(_(),Y(Q,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(R),"onUpdate:modelValue":e[6]||(e[6]=u=>x(R)?R.value=u:null),options:V.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),o("h5",So,[l(d,{class:"p-0 m-0",modelValue:ie.value,"onUpdate:modelValue":e[7]||(e[7]=u=>ie.value=u)},null,8,["modelValue"]),Ao]),o("span",To,[ie.value?(_(),Y(Q,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(q),"onUpdate:modelValue":e[8]||(e[8]=u=>x(q)?q.value=u:null),options:y.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),o("h5",jo,[l(d,{class:"p-0 m-0",modelValue:D.value,"onUpdate:modelValue":e[9]||(e[9]=u=>D.value=u)},null,8,["modelValue"]),Do]),o("span",Po,[D.value?(_(),Y(Q,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(F),"onUpdate:modelValue":e[10]||(e[10]=u=>x(F)?F.value=u:null),options:L.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),o("h5",Io,[l(d,{class:"p-0 m-0",modelValue:P.value,"onUpdate:modelValue":e[11]||(e[11]=u=>P.value=u)},null,8,["modelValue"]),zo]),o("span",Lo,[P.value?(_(),Y(Q,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(O),"onUpdate:modelValue":e[12]||(e[12]=u=>x(O)?O.value=u:null),options:m.value,optionLabel:"name"},null,8,["modelValue","options"])):I("",!0)]),Go,o("span",No,[l(Q,{style:{outline:"none"},class:"p-0",primary:"",modelValue:h.value,"onUpdate:modelValue":e[13]||(e[13]=u=>h.value=u),options:S.value},null,8,["modelValue","options"])]),o("h5",Bo,[o("span",Oo,"Sedes en las que estara disponible el producto "+M(N.value),1)]),o("div",Ro,[o("h5",Fo,[l(d,{class:"p-0 m-0",modelValue:Z.value,"onUpdate:modelValue":e[14]||(e[14]=u=>Z.value=u)},null,8,["modelValue"]),qo]),(_(!0),E(ve,null,$e(c(ne),u=>(_(),E("div",null,[o("h5",Ho,[l(d,{class:"p-0 m-0",modelValue:f.value[u.site_id],"onUpdate:modelValue":r=>f.value[u.site_id]=r},null,8,["modelValue","onUpdate:modelValue"]),o("span",Jo,M(u.site_name),1)])]))),256))]),l(H,{onClick:re,class:"m-auto my-4 text-center"},{default:ee(()=>[Mo]),_:1})]),_:1},8,["visible"]),l(c(C))],64)}}},Qo=ye(Ko,[["__scopeId","data-v-a8a20a02"]]);const Wo=$=>(we("data-v-08dbf807"),$=$(),xe(),$),Xo={class:"col-12 px-6"},Yo={class:"text-2xl titulo my-6 px-2",style:{"text-transform":"capitalize","font-weight":"bold"}},Zo={class:"grid p-5 md:p-0 m-0 col-12 m-auto"},ea={class:"cont p-2",style:{"background-color":"white",height:"100%",position:"relative"}},oa=["onClick"],aa=["onClick"],ta={class:"imagen-cont",style:{position:""}},sa=["src"],la={style:{display:""}},na={class:"nombre-producto mt-4",style:{"font-weight":"bold"}},ia={class:"descripcion-producto mt-2 text-sm mb-4"},ra={class:"info"},ua={class:"text-l",style:{"font-weight":"bold","border-radius":"100px"}},ca={class:"flex align-items-center justify-content-center"},da=Wo(()=>o("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),pa={__name:"sesion",setup($){const U=s([]),w=Ve(),K=s([]),C=fe(),oe=i=>{console.log("hola"),se.value=!se.value,n.value=i},ae=i=>{X.value=!X.value,te.value=i},f=async i=>{var p,h,S,A;if(console.log(localStorage),!((h=(p=ge)==null?void 0:p.value)!=null&&h.site_id)){console.log("Site ID is not available. Exiting function.");return}try{let V=await fetch(`${v}/products/category/name/${i}/site/${(A=(S=ge)==null?void 0:S.value)==null?void 0:A.site_id}`);if(!V.ok)throw U.value=[],new Error(`HTTP error! status: ${V.status}`);let m=await V.json();U.value=m.map(y=>({...y,isActive:y.state=="active"}))}catch(V){U.value=[],console.error("Error fetching data: ",V)}},Z=i=>{const p={...i};p.state=i.isActive?"active":"inactive",fetch(`${v}/products/${i.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then(h=>{if(!h.ok)throw new Error("Network response was not ok");return C.add({severity:`${i.isActive?"success":"error"}`,summary:`${i.isActive?"Activado":"Desactivado"}`,detail:i.name,life:3e3}),K.value=i.state=="active",h.json()}).then(h=>{}).catch(h=>{console.error("Error al actualizar el producto:",h)})};J(ge,(i,p)=>{i!==p&&f(w.params.sesion)}),J(he,(i,p)=>{i!==p&&f(w.params.sesion)}),be(async()=>{f(w.params.sesion)}),J(()=>w.params.sesion,i=>{f(i)});const N=async()=>{if(!te.value||!te.value.product_id){console.error("No se ha seleccionado ningÃºn producto para eliminar");return}try{const i=await fetch(`${v}/products/${te.value.product_id}`,{method:"DELETE"});if(!i.ok)throw new Error(`Error al eliminar el producto: ${i.status}`);await f(w.params.sesion),X.value=!1,console.log(`Producto eliminado: ${te.value.name}`)}catch(i){console.error("Error al eliminar el producto:",i)}};return(i,p)=>{const h=g("Button"),S=g("Toast"),A=g("InputSwitch"),V=g("Dialog");return _(),E("div",Xo,[o("p",Yo,M(c(w).params.sesion),1),o("span",null,[l(h,{onClick:p[0]||(p[0]=m=>le.value=!c(le)),class:"ml-2 mb-4"},{default:ee(()=>[Ee(" Agregar ")]),_:1})]),o("div",Zo,[(_(!0),E(ve,null,$e(U.value,m=>(_(),E("div",{key:m.id,class:"xl:col-3 lg:col-4 md:p-3 p-2 col-12 md:col-6 mb-4"},[o("div",ea,[o("button",{style:{position:"absolute",top:"-1rem",right:"-1rem","background-color":"var(--primary-color)",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center",color:"white","z-index":"99"},onClick:y=>oe(m),class:"add-cart-btn text-xl"},[o("i",{class:ke(["icono text-2xl p-0 m-0",c(Ue).PENCIL])},null,2)],8,oa),o("button",{style:{position:"absolute",top:"-1rem",right:"2rem","background-color":"var(--red-500)",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center",color:"white","z-index":"99"},onClick:y=>ae(m),class:"add-cart-btn text-xl"},[o("i",{class:ke(["icono text-2xl p-0 m-0",c(Ue).TRASH])},null,2)],8,aa),o("div",ta,[o("img",{class:"imagen",onError:p[1]||(p[1]=(...y)=>i.imagenError&&i.imagenError(...y)),style:{height:"50"},src:`${c(v)}/read-product-image/300/${m.name}`,alt:""},null,40,sa)]),o("div",la,[o("p",na,M(m.name),1),o("p",ia,M(m.description),1)]),l(S,{style:{"box-shadow":"none"}}),o("div",ra,[o("div",ua,M(c(Te)(m.price)),1),l(A,{modelValue:m.isActive,"onUpdate:modelValue":y=>m.isActive=y,onChange:()=>Z(m)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]))),128))]),l(S),l(Qo),l(mo),l(V,{header:"Confirmation",visible:c(X),"onUpdate:visible":p[3]||(p[3]=m=>x(X)?X.value=m:null),style:{width:"350px"},modal:!0},{footer:ee(()=>[l(h,{label:"No",icon:"pi pi-times",onClick:p[2]||(p[2]=m=>X.value=!c(X)),class:"p-button-text"}),l(h,{label:"Si",icon:"pi pi-check",onClick:N,class:"p-button-text",autofocus:""})]),default:ee(()=>[o("div",ca,[da,o("span",null,[Ee("Seguro que desea eliminar "),o("b",null,M(c(te).name),1)])])]),_:1},8,["visible"])])}}},ga=ye(pa,[["__scopeId","data-v-08dbf807"]]);export{ga as default};
