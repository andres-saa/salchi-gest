import{a as l,u as L}from"./formatoPesos-149518d5.js";import{L as b,K as y,U as v,y as S,l as $}from"./index-d24c4870.js";import{u as O}from"./ventas-10a53477.js";const P=b("client",{persist:{key:"client",storage:localStorage,paths:["user"]},state:()=>({user:{name:"",neigborhood:"",address:"",phone_number:"",payment_method_option:""}}),getters:{fucion:e=>0},actions:{async func(){return func}}}),t=O(),o=l(),d=L(),n=P(),w=()=>{var g,h,m,f;n.user.was_reserva=!1,o.sending_order=!0;const e=o.cart,r=$(),s=d.location.site.site_id,_=d.location.site.pe_site_id,i=(g=n.user.payment_method_option)==null?void 0:g.id,p=i===7?0:d.location.neigborhood.delivery_price,u=o.cart.order_notes,c={user_name:n.user.name,user_phone:(h=n.user.phone_number)==null?void 0:h.split(" ").join(""),user_address:` ${n.user.address} ${(f=(m=d.location)==null?void 0:m.neigborhood)==null?void 0:f.name}`||""},a={order_products:[],site_id:s,pe_site_id:_,delivery_person_id:4,payment_method_id:i,delivery_price:p,order_notes:u||"SIN NOTAS",user_data:c,order_aditionals:[],pe_json:e,total:0,inserted_by:r.rawUserData.id};return console.log(a),a},N=()=>{var u,c;n.user.was_reserva=!0,o.sending_order=!0;const e=o.cart.products.map(a=>({product_instance_id:a.product.id,quantity:a.quantity})),r=d.location.siteReservas.site_id,s=(u=n.user.payment_method_option)==null?void 0:u.id,_=o.cart.order_notes,i={user_name:n.user.name,user_phone:(c=n.user.phone_number)==null?void 0:c.split(" ").join(""),user_address:"Debe ir a la sede"};return{order_products:e,site_id:r,delivery_person_id:4,payment_method_id:s,delivery_price:0,order_notes:_||"SIN NOTAS",user_data:i,order_aditionals:[]}},k={async sendOrder(){const e=w(),r=l();if(!A(e))return r.sending_order=!1,null;try{t.setLoading(!0,`enviando tu pedido ${n.user.name}`);const s=await y.post(`${v}/order`,e);if(s.status===200)r.sending_order=!1,r.last_order=s.data,t.setLoading(!0,"enviando tu pedido"),S.push("/call-center-vender/gracias");else return console.error("An error occurred while sending the order:",s.status),alert("An error occurred while sending the order. Please try again."),t.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,null}catch(s){return console.error("An error occurred while sending the order:",s),t.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),r.sending_order=!1,null}},preparar_orden(){w()},async sendOrderReserva(){const e=N(),r=l();if(n.user.was_reserva=!0,!A(e))return r.sending_order=!1,null;try{t.setLoading(!0,`enviando tu pedido ${n.user.name}`);const s=await y.post(`${v}/order`,e);if(s.status===200)r.sending_order=!1,r.last_order=s.data,t.setLoading(!1,"enviando tu pedido"),S.push("/gracias");else return console.error("An error occurred while sending the order:",s.status),alert("An error occurred while sending the order. Please try again."),t.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,null}catch(s){return console.error("An error occurred while sending the order:",s),t.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),r.sending_order=!1,null}}};function A(e){return!e.user_data.user_name||e.user_data.user_name.trim()==""||!e.user_data.user_phone||e.user_data.user_phone.trim()==""||!e.user_data.user_address||e.user_data.user_address.trim()==""?(alert("Sus datos estan incompletos por favor reviselos"),o.sending_order=!1,!1):!e.site_id||e.delivery_price==null?(alert("Site information is missing. Please select a valid site."),o.sending_order=!1,!1):!0}export{k as o,P as u};
