import{_ as pe,j as n,y as J,k as U,m as K,U as Q,l as me,z as _e,H as W,G as ve,A as ye,av as f,r as c,o as g,c as Y,e as s,f as o,a,h as _,n as Z,N as M,t as d,u as b,p as O,g as C,i as j,F as fe,b as be,q as he,x as ge}from"./index-3fffce46.js";/* empty css                                                                  */import{D as we}from"./DialogoPedido-8a25abcc.js";import"./index-558f534d.js";import"./formatoPesos-2293ab52.js";import"./_commonjsHelpers-23102255.js";const v=P=>(he("data-v-16e528f0"),P=P(),ge(),P),xe={class:"container",style:{"margin-top":"3rem"}},Te=v(()=>a("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"0rem"}}," Transferencias Por Confirmar ",-1)),Pe=v(()=>a("h3",null,[a("b",null,"Rechazar orden")],-1)),Ve=v(()=>a("h3",null,[a("b",null,"Aprobar esta orden")],-1)),ke=v(()=>a("h3",null,[a("b",null,"El cliente no realizo' la transferencia")],-1)),Se={style:{"max-width":"1280px"},class:"mx-auto"},Ce={style:{display:"flex","align-items":"center",gap:"1rem"}},De=v(()=>a("h3",{style:{width:"min-content",padding:"0"}},[a("b",null,"Modos")],-1)),Re={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},ze={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},Le=v(()=>a("span",null,null,-1)),Ue={class:"md:mt-0 p-input-icon-right m-3"},Me=v(()=>a("i",{class:"pi pi-search"},null,-1)),Oe={style:{display:"flex",gap:"0.5rem"}},je={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"start",display:"flex",gap:"1rem"}},qe={class:"px-2 m-0"},Ae=v(()=>a("i",{class:"fa-regular fa-bars-progress"},null,-1)),Be={style:{"text-transform":"uppercase"}},Ne={class:"m-0"},$e={__name:"TransferSession",setup(P){const q=n([]);n([{columnName:"SEDE",columnValue:"sede",columnType:"other",size:"1rem",vif:!0},{columnName:"ASESOR",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);const p=n({start_date:new Date,end_date:new Date,sites:[]}),A=n([]),D=J(),ee=l=>{D.setVisible("currentOrder",!0),D.setOrder(l)},te=async l=>{const t=z.rawUserData.id;await f.authorizeOrder(l,t),w.value=!1,T()},ae=async l=>{const t=z.rawUserData.id;await f.rejectOrder(l,t),k.value=!1,T()},B=async()=>{const l=await K.post(`${Q}/transaction_report/`,{start_date:p.value.start_date,end_date:p.value.end_date,sites:p.value.sites.map(t=>t.site_id)});N.value=l,l!=null&&l[0]&&(A.value=Object.keys(l[0]))},N=n([]);U(async()=>{q.value=await K.get(`${Q}/sites/`),await B()});const R=n(!1),V=n([]),w=n(!1),k=n(!1),z=me(),y=n({}),$=n({}),se=n([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]),S=n({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),J(),n(null);const I={revisar:f.getPendientsCancellationRequest,aprobadas:f.getaceptedCancellationAcepted,rechazadas:f.getPendientsCancellationRejected};_e(()=>{E()}),W(()=>D.numberTransferRequests,()=>{T()});const le=l=>{w.value=!0,y.value.order_id=l},oe=l=>{k.value=!0,$.value.order_id=l},re=async(l,t,F)=>{const m={authorized:l,responsible_id:z.rawUserData.id,responsible_observation:y.value.reason||"sin observaciones"};await f.resolveCancellationRequest(t,m),w.value=!1,R.value=!1,V.value=await I.revisar()},x=ve(),h=n(),E=()=>{h.value={global:{value:null,matchMode:ye.CONTAINS}}};E(),U(()=>{T()}),U(async()=>{T()});const T=async()=>{V.value=await f.getOrdersTransfer()};return W(()=>x.params.request_status,async()=>{V.value=await I.revisar()},{deep:!0}),(l,t)=>{const F=c("Textarea"),m=c("Button"),L=c("Dialog"),ne=c("Dropdown"),ie=c("InputText"),u=c("Column"),H=c("DataTable"),de=c("Calendar"),ue=c("calendar"),ce=c("MultiSelect");return g(),Y("div",xe,[Te,s(L,{visible:R.value,"onUpdate:visible":t[2]||(t[2]=e=>R.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[Pe]),default:o(()=>[a("form",{onSubmit:t[1]||(t[1]=M(e=>re(!1,y.value.id,y.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(F,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:y.value.reason,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),s(m,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),s(L,{visible:w.value,"onUpdate:visible":t[4]||(t[4]=e=>w.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[Ve]),default:o(()=>[a("form",{onSubmit:t[3]||(t[3]=M(e=>te(y.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(m,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (Transferencia confirmada)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),s(L,{visible:k.value,"onUpdate:visible":t[6]||(t[6]=e=>k.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[ke]),default:o(()=>[a("form",{onSubmit:t[5]||(t[5]=M(e=>ae($.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(m,{style:{width:"100%","border-radius":"0.5rem"},label:"Archivar (Transferencia no confirmada)",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),a("div",Se,[a("div",Ce,[De,_(),s(ne,{modelValue:S.value,"onUpdate:modelValue":t[7]||(t[7]=e=>S.value=e),options:se.value,optionLabel:"name"},null,8,["modelValue","options"])]),a("div",Re,[a("div",{style:Z(`transform:translateX(${S.value.slide}%)`),class:"slider-item"},[s(H,{paginator:!0,rows:15,filters:h.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":t[9]||(t[9]=e=>h.value=e),class:"col-12 m-auto",value:V.value,tableStyle:"min-width: 50rem;"},{header:o(()=>[a("div",ze,[Le,a("span",Ue,[Me,s(ie,{class:"",modelValue:h.value.global.value,"onUpdate:modelValue":t[8]||(t[8]=e=>h.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:o(()=>[s(u,{style:{"min-width":"max-content"},class:"py-1",field:"order_id",header:"ID orden",frozen:""}),s(u,{style:{},class:"py-1",field:"total_order_price",header:"Monto de la orden"},{body:o(e=>[_(d(b(O)(e.data.total_order_price)),1)]),_:1}),s(u,{style:{},class:"py-1",field:"total_order_price",header:"Fecha"},{body:o(e=>{var r,i;return[_(d((i=(r=e.data.latest_status_timestamp)==null?void 0:r.split("T")[0].split("-"))==null?void 0:i.reverse().join("-")),1)]}),_:1}),s(u,{style:{},class:"py-1",field:"total_order_price",header:"Hora"},{body:o(e=>{var r,i,G,X;return[_(d((X=(G=(i=(r=e.data.latest_status_timestamp)==null?void 0:r.split("T")[1])==null?void 0:i.split(":"))==null?void 0:G.slice(0,2))==null?void 0:X.join(":")),1)]}),_:1}),s(u,{style:{},class:"py-1",field:"delivery_price",header:"Domicilio"},{body:o(e=>{var r,i;return[_(d(b(O)((i=(r=e.data.pe_json)==null?void 0:r.delivery)==null?void 0:i.delivery_costoenvio)),1)]}),_:1}),s(u,{style:{},class:"py-1",field:"Total",header:"Total"},{body:o(e=>{var r,i;return[_(d(b(O)(((i=(r=e.data.pe_json)==null?void 0:r.delivery)==null?void 0:i.delivery_costoenvio)+e.data.total_order_price)),1)]}),_:1}),s(u,{style:{},class:"py-1",field:"user_name",header:"Cliente"},{body:o(e=>[_(d(e.data.user_name)+" "+d(e.data.second_name)+" "+d(e.data.first_last_name)+" "+d(e.data.second_last_name),1)]),_:1}),s(u,{style:{},class:"py-1",field:"user_phone",header:"Telefono cliente"}),s(u,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:o(e=>[a("div",Oe,[b(x).params.request_status!="aprobadas"?(g(),C(m,{key:0,size:"",onClick:r=>ee(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):j("",!0),b(x).params.request_status!="aprobadas"?(g(),C(m,{key:1,size:"",onClick:r=>le(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):j("",!0),b(x).params.request_status!="aprobadas"?(g(),C(m,{key:2,size:"",onClick:r=>oe(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"danger",class:"p-1",icon:"pi pi-trash"},null,8,["onClick"])):j("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),a("div",{style:Z(`transform:translateX(${S.value.slide}%)`),class:"slider-item"},[s(H,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:N.value,tableStyle:"min-width: 50rem;",filters:h.value},{header:o(()=>[a("div",je,[a("h4",qe,[Ae,_(),a("b",Be,[_("Transferencias "),a("b",null,d(b(x).params.section),1)])]),s(de,{modelValue:p.value.start_date,"onUpdate:modelValue":t[10]||(t[10]=e=>p.value.start_date=e)},null,8,["modelValue"]),s(ue,{modelValue:p.value.end_date,"onUpdate:modelValue":t[11]||(t[11]=e=>p.value.end_date=e)},null,8,["modelValue"]),s(ce,{style:{"max-width":"30rem"},modelValue:p.value.sites,"onUpdate:modelValue":t[12]||(t[12]=e=>p.value.sites=e),optionLabel:"site_name",options:q.value.filter(e=>e.show_on_web)},null,8,["modelValue","options"]),s(m,{severity:"help",onClick:B,label:"Buscar",icon:"pi pi-search"})])]),default:o(()=>[(g(!0),Y(fe,null,be(A.value,e=>(g(),C(u,{class:"py-1",style:{"text-transform":"uppercase"},header:e},{body:o(r=>[a("h6",Ne,d(r.data[e]),1)]),_:2},1032,["header"]))),256))]),_:1},8,["value","filters"])],4)])]),s(we)])}}},Je=pe($e,[["__scopeId","data-v-16e528f0"]]);export{Je as default};
