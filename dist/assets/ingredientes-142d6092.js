import{r as o,y as G,k as H,h as J,E as Q,a as d,o as i,c as g,d as s,w as c,b as r,F as C,K as y,U as w,I as W,f as m,e as M,t as k,m as f,q as N,s as P,u as X}from"./index-66648269.js";import{f as Y}from"./formatoPesos-78ea101b.js";const Z={class:"m-0 my-3"},ee={style:{display:"flex","justify-content":"end"}},te={style:{"margin-top":"3rem"}},ae={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},ne=r("h3",{class:"px-2"},[r("i",{class:"fa fa-carrot"}),N(),r("b",null,"Ingredientes")],-1),le={style:{display:"flex",width:"100%","justify-content":"end","flex-wrap":"wrap",gap:"1rem","align-items":"center"}},ie={style:{display:"flex","justify-content":"end",gap:".5rem"}},ue={__name:"ingredientes",setup(oe){const V=o({}),v=o(!1),a=o({}),D=o([{}]),b=o([]),h=o(!1),_=o(!1),E=t=>{_.value=!0,V.value=t},F=()=>{h.value=!1,a.value={},v.value=!0},S=async()=>{const t=V.value.id;await y.delete(`${w}/delete-ingredient/${t}`,"Borrando ingrediente"),_.value=!1,I()},z=t=>{var n;h.value=!0,a.value={id:t.id,name:t.ingredient_name,purchasing_unit_measure:b.value.find(u=>u.name==t.purchasing_unit_measure),purchasing_unit_measure_id:(n=b.value.find(u=>u.name==t.purchasing_unit_measure)[0])==null?void 0:n.id,purchasing_price:t.purchasing_price,net_gross_weight:t.net_gross_weight},console.log(a.value),v.value=!0},$=[{header:"Id",value:"id",width:"1"},{header:"Nombre ingrediente",value:"ingredient_name",type:"max-content",width:""},{header:"UM de compra",value:"purchasing_unit_measure",width:"10"},{header:"Precio de compra",value:"purchasing_price",width:"10",type:"money"},{header:"No. Un. por compra",value:"number_units_purchasing",width:"10"},{header:"Form de compra",value:"purchasing_format",width:"10"},{header:"Peso bruto (Kg/Li)",value:"net_gross_weight",width:"10"},{header:"porcentaje de Merma (%)",value:"shrinkage_persent",width:"8"},{header:"Costo unitario",value:"unit_cost",type:"max-content"}],R=o([...$]);G(()=>{var t;return(t=R.value)==null?void 0:t.map(n=>n.value)});const j=o([{name:"Nombre del ingrediente",fiel:"name",type:"text"},{name:"Unidad de medida de compra",fiel:"purchasing_unit_measure",type:"drop",Options:o(b),optionLable:"name"},{name:"precio de compra",fiel:"purchasing_price",type:"money"},{name:"Peso Bruto (Kg/Litros)",fiel:"net_gross_weight",type:"number"}]);H(a,async(t,n)=>{var u;a.value.purchasing_unit_measure_id=((u=t.purchasing_unit_measure)==null?void 0:u.id)||null},{deep:!0});const T=async()=>{const t=a.value;if(!t.name||!t.purchasing_unit_measure_id||!t.purchasing_price||!t.net_gross_weight){alert("Por favor llene todos los campos");return}h.value?await y.post(`${w}/update-ingredient/${a.value.id}`,t,"Editando ingrediente"):await y.post(`${w}/create-ingredient`,t,"creando un nuevo ingrediente"),I(),v.value=!1},I=async()=>{D.value=await y.get(`${w}/list-ingredients`,"cargando ingredientes"),b.value=await y.get(`${w}/daily_inventory_unit_measures`)};J(async()=>{I()});const x=o(null),O=()=>{x.value={global:{value:null,matchMode:W.CONTAINS}}};return Q(()=>{O()}),(t,n)=>{const u=d("inputText"),A=d("Dropdown"),U=d("InputNumber"),p=d("Button"),L=d("Dialog"),K=d("InputText"),B=d("column"),q=d("DataTable");return i(),g(C,null,[s(L,{style:{width:"30rem"},header:h.value?"Actualizar Ingrediente":"Nuevo Ingrediente",class:"mx-2",visible:v.value,"onUpdate:visible":n[0]||(n[0]=e=>v.value=e),modal:""},{footer:c(()=>[h.value?(i(),m(p,{key:1,onClick:T,severity:"help",label:"Modificar ingrediente"})):(i(),m(p,{key:0,onClick:T,severity:"help",label:"Guardar ingrediente"}))]),default:c(()=>[(i(!0),g(C,null,M(j.value,e=>(i(),g("div",null,[r("h6",Z,k(e.name),1),e.type=="text"?(i(),m(u,{key:0,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):f("",!0),e.type=="drop"?(i(),m(A,{key:1,options:e.Options,optionLabel:"name",modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"}},null,8,["options","modelValue","onUpdate:modelValue"])):f("",!0),e.type=="money"?(i(),m(U,{key:2,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",prefix:"$"},null,8,["modelValue","onUpdate:modelValue"])):f("",!0),e.type=="number"?(i(),m(U,{key:3,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3"},null,8,["modelValue","onUpdate:modelValue"])):f("",!0),e.type=="persent"?(i(),m(U,{key:4,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",suffix:"%"},null,8,["modelValue","onUpdate:modelValue"])):f("",!0)]))),256))]),_:1},8,["header","visible"]),s(L,{class:"mx-2",header:"Eliminar ingrediente",visible:_.value,"onUpdate:visible":n[3]||(n[3]=e=>_.value=e),modal:""},{footer:c(()=>[r("div",ee,[s(p,{size:"small",label:"cancelar",onClick:n[1]||(n[1]=e=>_.value=!1),severity:"help"}),s(p,{size:"small",onClick:n[2]||(n[2]=e=>S()),label:"Eliminar ingrediente",severity:"danger",text:""})])]),default:c(()=>[r("h6",null,[N("seguro que desea eliminar el Ingrediente "),r("b",null,k(V.value.ingredient_name),1),N(" ?")])]),_:1},8,["visible"]),r("div",te,[s(q,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} recetas",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:D.value,tableStyle:"min-width: 50rem;",filters:x.value},{header:c(()=>[r("div",ae,[ne,s(K,{class:"",modelValue:x.value.global.value,"onUpdate:modelValue":n[4]||(n[4]=e=>x.value.global.value=e),placeholder:"Buscar ingrediente ..."},null,8,["modelValue"])]),r("div",le,[s(p,{size:"small",severity:"help",onClick:F,label:"Nuevo ingredinte"})])]),default:c(()=>[(i(),g(C,null,M($,e=>s(B,{header:e.header,style:P(`min-width:${e.width}rem`),field:e.value,class:"py-2"},{body:c(l=>[e.type=="money"?(i(),g("h6",{key:0,style:P([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},k(X(Y)(l.data[e.value])||"-----------"),5)):(i(),g("h6",{key:1,style:P([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},k(l.data[e.value]||"-----------"),5))]),_:2},1032,["header","style","field"])),64)),s(B,{header:"Accion",style:{width:"min-content"},field:"name",class:"py-2",frozen:"",alignFrozen:"right"},{body:c(e=>[r("div",ie,[s(p,{text:"",onClick:l=>z(e.data),class:"m-0 p-0",severity:"warning",style:{height:"2rem",width:"2rem"},icon:"pi pi-pencil"},null,8,["onClick"]),s(p,{text:"",onClick:l=>E(e.data),class:"m-0 p-0",severity:"danger",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash"},null,8,["onClick"])])]),_:1})]),_:1},8,["value","filters"])])],64)}}};export{ue as default};
