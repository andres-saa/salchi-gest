import{_ as be,x as Ae,f as i,g as W,A as n,B as we,u as xe,C as Pe,j as ne,U as _,D as B,E as R,G as F,H as q,I as H,h as Ee,r as h,o as g,c as C,d as t,w as X,a,n as z,l as r,m as U,J as oe,t as O,F as pe,b as ke,K as se,y as Te,p as Ue,e as Ce,L as le,M as $e,k as me,N as ee,s as ve,q as fe,P as Ve,O as te}from"./index-1bdf1653.js";import"./dialogoEditarProducto.vue_vue_type_style_index_0_scoped_886cb754_lang-289e7f94.js";import{f as De}from"./formatoPesos-2a38d2e7.js";const G=b=>(Ue("data-v-886cb754"),b=b(),Ce(),b),Ie={key:0,style:{}},Le=["src"],ze=G(()=>a("h5",null,"Nombre",-1)),Ge={class:"p-input-icon-left mb-0"},Ne=G(()=>a("i",{class:"pi pi-pencil"},null,-1)),Oe=G(()=>a("h5",null,"Description",-1)),Be=G(()=>a("h5",null,"Precio",-1)),Re={class:"p-input-icon-left"},Fe={style:{display:"flex","align-items":"center"}},qe=G(()=>a("span",{class:"ml-5"},"Conjunto de salsas",-1)),He={key:1,class:"p-input-icon-left"},Je={style:{display:"flex","align-items":"center"}},Me=G(()=>a("span",{class:"ml-5"},"Conjunto de adiciones",-1)),Ke={class:"p-input-icon-left"},Qe={style:{display:"flex","align-items":"center"}},We=G(()=>a("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),Xe={class:"p-input-icon-left"},Ye={style:{display:"flex","align-items":"center"}},Ze=G(()=>a("span",{class:"ml-5"},"Conjunto de toppings",-1)),eo={class:"p-input-icon-left"},oo={style:{display:"flex","align-items":"center"}},ao=G(()=>a("span",{class:"ml-5"},"Conjunto de cambios",-1)),to={class:"p-input-icon-left"},so=G(()=>a("h5",{style:{display:"flex","align-items":"center"}},[a("span",{class:""},"Estado")],-1)),lo={class:"p-input-icon-left"},no={style:{display:"flex","align-items":"center"}},io={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},ro={class:"mt-6"},uo={style:{display:"flex","align-items":"center"}},co=G(()=>a("span",{class:"ml-5"},"Todas",-1)),po={style:{display:"flex","align-items":"center"}},mo={class:"ml-5"},vo=G(()=>a("span",{class:"text-center col-12 p-0"},"Guardar",-1)),_o={__name:"dialogoEditarProducto",setup(b){const N=Ae(),w=e=>{const o=new Date().getTime();return`${_}/read-product-image/300/${e}?timestamp=${o}`},Y=i({}),J=i({});W(n,async e=>{if(e&&e.name)try{(await ie(e.name)).forEach(c=>{J.value[c.site_id]={seleccionada:!0,product_id:c.product_id}})}catch(o){console.error("Error al obtener sedes para el producto:",o)}},{immediate:!0}),W(n,async e=>{Object.keys(Y.value).forEach(c=>{Y.value[c]=!1}),(await ie(n.value.name)).forEach(c=>{Y.value[c.site_id]=!0})});const x=i(null),ae=i(null),M=e=>{const o=e.target.files[0];o&&(x.value=URL.createObjectURL(o),ae.value=o)},E=we(),K=xe(),Z=Pe(()=>K.query.category),s=i([]),m=i(!1);W(m,e=>{ne.value.forEach(o=>{s.value[o.site_id]=e})}),console.log(Z.value),i("producto sin nombre"),i("producto sin descripcion"),i(0),i("inactive");const y=i(["active","inactive"]),k=i([]),A=i([]),$=i([]),v=i([]),V=i([]),P=i(),T=i(),j=i(),D=i(),I=i(),_e=async()=>{await ge(n.value.name);for(const[e,o]of Object.entries(s.value))if(o&&J.value[e]&&J.value[e].product_id){const c={product_id:J.value[e].product_id,name:n.value.name,price:n.value.price,description:n.value.description,category_id:Z.value,porcion:"1",state:n.value.state,grupo_salsa_id:P.value?B.value.grupo_salsa_id:null,grupo_topping_id:j.value?q.value.grupo_topping_id:null,grupo_acompanante_id:I.value?H.value.grupo_acompanante_id:null,grupo_cambio_id:D.value?R.value.grupo_cambio_id:null,grupo_adicional_id:T.value?F.value.grupo_id:null,site_id:e};try{se.value=!1,N.setLoading(!0,`guardando ${n.value.name} para la sede ${e}`);const f=await fetch(`${_}/products/${c.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!f.ok)throw new Error(`Error: ${f.status}`);E.add({severity:"success",summary:`Producto actualizado en la sede ${e}`,detail:"Actualización completada",life:3e3})}catch(f){console.error("Error al actualizar el producto:",f)}}location.reload()};W(n,async e=>{if(Object.keys(s.value).forEach(o=>{s.value[o]=!1}),e&&e.name)try{(await ie(n.value.name)).forEach(c=>{s.value[c.site_id]=!0})}catch(o){console.error("Error al obtener sedes para el producto:",o)}},{immediate:!0});const ie=async e=>{try{const o=await fetch(`${_}/products/name/${e}/sites`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){console.error("Error fetching sites:",o),E.add({severity:"error",summary:"Error",detail:"Error fetching sites data",life:3e3})}},ge=async e=>{const o=new FormData;o.append("file",ae.value);try{if(!(await fetch(`${_}/upload-product-image/${e}`,{method:"POST",body:o})).ok)throw new Error("Error al subir la imagen");x.value=w(n.value.name)}catch(c){console.error("Error al subir la imagen:",c)}},re=async()=>{try{return await(await fetch(`${_}/grupo-salsas`)).json()}catch(e){console.error("Error fetching data: ",e)}},ue=async()=>{try{return await(await fetch(`${_}/grupo-cambios`)).json()}catch(e){console.error("Error fetching data: ",e)}},ce=async()=>{try{return await(await fetch(`${_}/grupo-adicionales`)).json()}catch(e){console.error("Error fetching data: ",e)}},de=async()=>{try{return await(await fetch(`${_}/grupo-toppings`)).json()}catch(e){console.error("Error fetching data: ",e)}},d=async()=>{try{return await(await fetch(`${_}/grupo-acompanantes`)).json()}catch(e){console.error("Error fetching data: ",e)}};return W(n,async()=>{x.value=w(n.value.name),n.value.grupo_salsa_id?P.value=!0:P.value=!1,n.value.grupo_adicional_id?T.value=!0:T.value=!1,n.value.grupo_acompanante_id?I.value=!0:I.value=!1,n.value.grupo_topping_id?j.value=!0:j.value=!1,n.value.grupo_cambio_id?D.value=!0:D.value=!1,re().then(p=>{k.value=p}),ce().then(p=>{A.value=p}),ue().then(p=>{$.value=p}),d().then(p=>{v.value=p}),de().then(p=>{V.value=p});const e=await re();k.value=e;const o=await ue();$.value=o;const c=await ce();A.value=c;const f=await de();V.value=f;const L=await d();v.value=L,B.value=e.find(p=>p.grupo_salsa_id===n.value.grupo_salsa_id),R.value=o.find(p=>p.grupo_cambio_id===n.value.grupo_cambio_id),F.value=c.find(p=>p.grupo_id===n.value.grupo_adicional_id),q.value=f.find(p=>p.grupo_topping_id===n.value.grupo_topping_id),H.value=L.find(p=>p.grupo_acompanante_id===n.value.grupo_acompanante_id)}),Ee(async()=>{var e,o;x.value=w(n.value.name),n.value.grupo_salsa_id?P.value=!0:P.value=!1,n.value.grupo_adicional_id?T.value=!0:T.value=!1,n.value.grupo_acompanante_id?I.value=!0:I.value=!1,n.value.grupo_topping_id?j.value=!0:j.value=!1,n.value.grupo_cambio_id?D.value=!0:D.value=!1,re().then(c=>{k.value=c}),ce().then(c=>{A.value=c}),ue().then(c=>{$.value=c}),d().then(c=>{v.value=c}),de().then(c=>{V.value=c}),(o=(e=ne)==null?void 0:e.value)==null||o.forEach(c=>{s.value[c.site_id]=!1})}),(e,o)=>{const c=h("Input"),f=h("Button"),L=h("InputText"),p=h("Textarea"),he=h("InputNumber"),Q=h("InputSwitch"),l=h("Dropdown"),ye=h("Dialog");return g(),C(pe,null,[t(ye,{visible:r(se),"onUpdate:visible":o[16]||(o[16]=u=>U(se)?se.value=u:null),style:Te([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:`Editar ${r(n).name}`,modal:!0,class:"p-fluid p-2 m-3"},{default:X(()=>[x.value?(g(),C("div",Ie,[a("img",{src:x.value,style:{width:"100%",height:"auto"}},null,8,Le)])):z("",!0),t(c,{type:"file",onChange:M,accept:"image/*"}),t(f,{text:"",style:{width:"auto"},class:"p-0",label:"Reset image",size:"small",onClick:o[0]||(o[0]=u=>x.value=`${r(_)}/read-product-image/300/${r(n).name}`)}),ze,a("span",Ge,[Ne,t(L,{disabled:"",modelValue:r(n).name,"onUpdate:modelValue":o[1]||(o[1]=u=>r(n).name=u),type:"text"},null,8,["modelValue"])]),Oe,t(p,{modelValue:r(n).description,"onUpdate:modelValue":o[2]||(o[2]=u=>r(n).description=u),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),Be,a("span",Re,[t(he,{class:"",modelValue:r(n).price,"onUpdate:modelValue":o[3]||(o[3]=u=>r(n).price=u),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),a("h5",Fe,[t(Q,{class:"p-0 m-0",modelValue:P.value,"onUpdate:modelValue":o[4]||(o[4]=u=>P.value=u)},null,8,["modelValue"]),qe]),P.value?(g(),C("span",He,[t(l,{style:{outline:"none"},class:"p-0",primary:"",modelValue:r(B),"onUpdate:modelValue":o[5]||(o[5]=u=>U(B)?B.value=u:null),options:k.value,optionLabel:"name"},null,8,["modelValue","options"])])):z("",!0),a("h5",Je,[t(Q,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":o[6]||(o[6]=u=>T.value=u)},null,8,["modelValue"]),Me]),a("span",Ke,[T.value?(g(),oe(l,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(F),"onUpdate:modelValue":o[7]||(o[7]=u=>U(F)?F.value=u:null),options:A.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Qe,[t(Q,{class:"p-0 m-0",modelValue:I.value,"onUpdate:modelValue":o[8]||(o[8]=u=>I.value=u)},null,8,["modelValue"]),We]),a("span",Xe,[I.value?(g(),oe(l,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(H),"onUpdate:modelValue":o[9]||(o[9]=u=>U(H)?H.value=u:null),options:v.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Ye,[t(Q,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":o[10]||(o[10]=u=>j.value=u)},null,8,["modelValue"]),Ze]),a("span",eo,[j.value?(g(),oe(l,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(q),"onUpdate:modelValue":o[11]||(o[11]=u=>U(q)?q.value=u:null),options:V.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",oo,[t(Q,{class:"p-0 m-0",modelValue:D.value,"onUpdate:modelValue":o[12]||(o[12]=u=>D.value=u)},null,8,["modelValue"]),ao]),a("span",to,[D.value?(g(),oe(l,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(R),"onUpdate:modelValue":o[13]||(o[13]=u=>U(R)?R.value=u:null),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),so,a("span",lo,[t(l,{style:{outline:"none"},class:"p-0",primary:"",modelValue:r(n).state,"onUpdate:modelValue":o[14]||(o[14]=u=>r(n).state=u),options:y.value},null,8,["modelValue","options"])]),a("h5",no,[a("span",io,"En que sedes quiere modificar "+O(r(n).name),1)]),a("div",ro,[a("h5",uo,[t(Q,{class:"p-0 m-0",modelValue:m.value,"onUpdate:modelValue":o[15]||(o[15]=u=>m.value=u)},null,8,["modelValue"]),co]),(g(!0),C(pe,null,ke(r(ne),u=>(g(),C("div",{key:u.site_id},[a("h5",po,[t(Q,{class:"p-0 m-0",modelValue:s.value[u.site_id],"onUpdate:modelValue":je=>s.value[u.site_id]=je,disabled:!Y.value[u.site_id]},null,8,["modelValue","onUpdate:modelValue","disabled"]),a("span",mo,O(u.site_name),1)])]))),128))]),t(f,{onClick:_e,class:"m-auto my-4 text-center"},{default:X(()=>[vo]),_:1})]),_:1},8,["visible","header"]),t(r(E))],64)}}},go=be(_o,[["__scopeId","data-v-886cb754"]]);const S=b=>(Ue("data-v-a8a20a02"),b=b(),Ce(),b),ho={key:0},yo=["src"],fo=S(()=>a("h5",null,"Nombre",-1)),Vo={class:"p-input-icon-left mb-4"},$o=S(()=>a("i",{class:"pi pi-pencil"},null,-1)),bo=S(()=>a("h5",null,"Description",-1)),wo=S(()=>a("h5",null,"Precio",-1)),xo={class:"p-input-icon-left"},Eo=S(()=>a("i",{class:"pi pi-pencil"},null,-1)),ko={style:{display:"flex","align-items":"center"}},Uo=S(()=>a("span",{class:"ml-5"},"Conjunto de salsas",-1)),Co={key:1,class:"p-input-icon-left"},So={style:{display:"flex","align-items":"center"}},Ao=S(()=>a("span",{class:"ml-5"},"Conjunto de adiciones",-1)),Po={class:"p-input-icon-left"},To={style:{display:"flex","align-items":"center"}},jo=S(()=>a("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),Do={class:"p-input-icon-left"},Io={style:{display:"flex","align-items":"center"}},Lo=S(()=>a("span",{class:"ml-5"},"Conjunto de toppings",-1)),zo={class:"p-input-icon-left"},Go={style:{display:"flex","align-items":"center"}},No=S(()=>a("span",{class:"ml-5"},"Conjunto de cambios",-1)),Oo={class:"p-input-icon-left"},Bo=S(()=>a("h5",{style:{display:"flex","align-items":"center"}},[a("span",{class:""},"Estado")],-1)),Ro={class:"p-input-icon-left"},Fo={style:{display:"flex","align-items":"center"}},qo={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},Ho={class:"mt-6"},Jo={style:{display:"flex","align-items":"center"}},Mo=S(()=>a("span",{class:"ml-5"},"Todas",-1)),Ko={style:{display:"flex","align-items":"center"}},Qo={class:"ml-5"},Wo=S(()=>a("span",{class:"text-center col-12 p-0"},"Agregar",-1)),Xo={__name:"dialogoAgregarProducto",setup(b){const N=i(null),w=i(null),Y=d=>{const e=d.target.files[0];e&&(N.value=URL.createObjectURL(e),w.value=e)},J=we(),x=xe(),ae=Pe(()=>x.query.category),M=i([]),E=i(!1);W(E,d=>{ne.value.forEach(e=>{M.value[e.site_id]=d})}),console.log(ae.value);const K=i("producto sin nombre"),Z=i("producto sin descripcion"),s=i(0),m=i("inactive"),y=i(["active","inactive"]),k=i([]),A=i([]),$=i([]),v=i([]),V=i([]),P=i(),T=i(),j=i(),D=i(),I=i(),_e=async()=>{const d=`${_}/products`;ie(K.value);for(const[e,o]of Object.entries(M.value))if(o){const c={name:K.value,price:s.value,description:Z.value,category_id:ae.value,porcion:"1",state:m.value,grupo_salsa_id:B.value?B.value.grupo_salsa_id:null,grupo_topping_id:q.value?q.value.grupo_topping_id:null,grupo_acompanante_id:H.value?H.value.grupo_acompanante_id:null,grupo_cambio_id:R.value?R.value.grupo_cambio_id:null,grupo_adicional_id:F.value?F.value.grupo_adicional_id:null,site_id:e};try{const f=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!f.ok)throw new Error(`Error: ${f.status}`);J.add({severity:"success",summary:`agregado a la sede ${e}`,detail:"espaerando las otras sedes",life:3e3}),$e.value=$e.value+1}catch(f){console.error("Error al enviar producto:",f)}}le.value=!1},ie=async d=>{const e=new FormData;e.append("file",w.value);try{if(!(await fetch(`${_}/upload-product-image/${d}`,{method:"POST",body:e})).ok)throw new Error("Error al subir la imagen")}catch(o){console.error("Error al subir la imagen:",o)}},ge=async()=>{try{return await(await fetch(`${_}/grupo-salsas`)).json()}catch(d){console.error("Error fetching data: ",d)}},re=async()=>{try{return await(await fetch(`${_}/grupo-cambios`)).json()}catch(d){console.error("Error fetching data: ",d)}},ue=async()=>{try{return await(await fetch(`${_}/grupo-adicionales`)).json()}catch(d){console.error("Error fetching data: ",d)}},ce=async()=>{try{return await(await fetch(`${_}/grupo-toppings`)).json()}catch(d){console.error("Error fetching data: ",d)}},de=async()=>{try{return await(await fetch(`${_}/grupo-acompanantes`)).json()}catch(d){console.error("Error fetching data: ",d)}};return Ee(async()=>{var d,e;ge().then(o=>{k.value=o}),ue().then(o=>{A.value=o}),re().then(o=>{$.value=o}),de().then(o=>{v.value=o}),ce().then(o=>{V.value=o}),(e=(d=ne)==null?void 0:d.value)==null||e.forEach(o=>{M.value[o.site_id]=!1})}),(d,e)=>{const o=h("Input"),c=h("InputText"),f=h("Textarea"),L=h("InputSwitch"),p=h("Dropdown"),he=h("Button"),Q=h("Dialog");return g(),C(pe,null,[t(Q,{visible:r(le),"onUpdate:visible":e[15]||(e[15]=l=>U(le)?le.value=l:null),style:Te([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:"Agregar producto",modal:!0,class:"p-fluid p-2 m-3"},{default:X(()=>[N.value?(g(),C("div",ho,[a("img",{src:N.value,alt:"Previsualización del Producto",style:{"max-width":"100%",height:"auto"}},null,8,yo)])):z("",!0),t(o,{type:"file",onChange:Y,accept:"image/*"}),fo,a("span",Vo,[$o,t(c,{modelValue:K.value,"onUpdate:modelValue":e[0]||(e[0]=l=>K.value=l),type:"text"},null,8,["modelValue"])]),bo,t(f,{modelValue:Z.value,"onUpdate:modelValue":e[1]||(e[1]=l=>Z.value=l),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),wo,a("span",xo,[Eo,t(c,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value=l),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),a("h5",ko,[t(L,{class:"p-0 m-0",modelValue:P.value,"onUpdate:modelValue":e[3]||(e[3]=l=>P.value=l)},null,8,["modelValue"]),Uo]),P.value?(g(),C("span",Co,[t(p,{style:{outline:"none"},class:"p-0",primary:"",modelValue:r(B),"onUpdate:modelValue":e[4]||(e[4]=l=>U(B)?B.value=l:null),options:k.value,optionLabel:"name"},null,8,["modelValue","options"])])):z("",!0),a("h5",So,[t(L,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":e[5]||(e[5]=l=>T.value=l)},null,8,["modelValue"]),Ao]),a("span",Po,[T.value?(g(),oe(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(F),"onUpdate:modelValue":e[6]||(e[6]=l=>U(F)?F.value=l:null),options:A.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",To,[t(L,{class:"p-0 m-0",modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=l=>I.value=l)},null,8,["modelValue"]),jo]),a("span",Do,[I.value?(g(),oe(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(H),"onUpdate:modelValue":e[8]||(e[8]=l=>U(H)?H.value=l:null),options:v.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Io,[t(L,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":e[9]||(e[9]=l=>j.value=l)},null,8,["modelValue"]),Lo]),a("span",zo,[j.value?(g(),oe(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(q),"onUpdate:modelValue":e[10]||(e[10]=l=>U(q)?q.value=l:null),options:V.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Go,[t(L,{class:"p-0 m-0",modelValue:D.value,"onUpdate:modelValue":e[11]||(e[11]=l=>D.value=l)},null,8,["modelValue"]),No]),a("span",Oo,[D.value?(g(),oe(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:r(R),"onUpdate:modelValue":e[12]||(e[12]=l=>U(R)?R.value=l:null),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),Bo,a("span",Ro,[t(p,{style:{outline:"none"},class:"p-0",primary:"",modelValue:m.value,"onUpdate:modelValue":e[13]||(e[13]=l=>m.value=l),options:y.value},null,8,["modelValue","options"])]),a("h5",Fo,[a("span",qo,"Sedes en las que estara disponible el producto "+O(K.value),1)]),a("div",Ho,[a("h5",Jo,[t(L,{class:"p-0 m-0",modelValue:E.value,"onUpdate:modelValue":e[14]||(e[14]=l=>E.value=l)},null,8,["modelValue"]),Mo]),(g(!0),C(pe,null,ke(r(ne),l=>(g(),C("div",null,[a("h5",Ko,[t(L,{class:"p-0 m-0",modelValue:M.value[l.site_id],"onUpdate:modelValue":ye=>M.value[l.site_id]=ye},null,8,["modelValue","onUpdate:modelValue"]),a("span",Qo,O(l.site_name),1)])]))),256))]),t(he,{onClick:_e,class:"m-auto my-4 text-center"},{default:X(()=>[Wo]),_:1})]),_:1},8,["visible"]),t(r(J))],64)}}},Yo=be(Xo,[["__scopeId","data-v-a8a20a02"]]);const Se=b=>(Ue("data-v-da7bcef5"),b=b(),Ce(),b),Zo={class:"col-12 p-0"},ea={class:"text-3xl titulo my-6 px-0 mx-0 text-center",style:{"text-transform":"capitalize","align-items":"center",gap:"1rem","font-weight":"bold",display:"flex"}},oa=Se(()=>a("div",{style:{height:"0.5rem",width:"100%","background-color":"#a855f7","border-radius":"1rem 0 0 1rem"}},null,-1)),aa={style:{"min-width":"max-content"}},ta=Se(()=>a("div",{style:{height:"0.5rem","background-color":"#f59e0b",width:"100%","border-radius":"0 1rem 1rem 0"}},null,-1)),sa={class:"grid p-0 m-0 col-12",style:{}},la={class:"cont p-2",style:{"background-color":"white",height:"100%",position:"relative"}},na={class:"imagen-cont",style:{position:""}},ia=["src"],ra={style:{display:""}},ua={class:"nombre-producto mt-4",style:{"font-weight":"bold"}},ca={class:"descripcion-producto mt-2 text-sm mb-4"},da={class:"info"},pa={class:"text-l",style:{"font-weight":"bold","border-radius":"100px"}},ma={class:"flex align-items-center justify-content-center"},va=Se(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),_a={__name:"sesion",setup(b){const N=i([]),w=xe(),Y=i([]),J=we(),x=Ae(),ae=s=>{console.log("hola"),se.value=!se.value,n.value=s},M=s=>{ee.value=!ee.value,te.value=s},E=async s=>{var m,y,k,A;if(console.log(localStorage),!((y=(m=ve)==null?void 0:m.value)!=null&&y.site_id)){console.log("Site ID is not available. Exiting function.");return}try{x.setLoading(!0,`cargando ${s} de ${ve.value.site_name}`);let $=await fetch(`${_}/products/category/name/${s}/site/${(A=(k=ve)==null?void 0:k.value)==null?void 0:A.site_id}`);if(!$.ok)throw N.value=[],new Error(`HTTP error! status: ${$.status}`);let v=await $.json();x.setLoading(!1,`cargando ${s}s`),N.value=v.map(V=>({...V,isActive:V.state=="active"}))}catch($){N.value=[],console.error("Error fetching data: ",$),x.setLoading(!1,`cargando ${s}s`)}},K=s=>{const m={...s};m.state=s.isActive?"active":"inactive",fetch(`${_}/products/${s.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(y=>{if(!y.ok)throw new Error("Network response was not ok");return J.add({severity:`${s.isActive?"success":"error"}`,summary:`${s.isActive?"Activado":"Desactivado"}`,detail:s.name,life:3e3}),Y.value=s.state=="active",y.json()}).then(y=>{}).catch(y=>{console.error("Error al actualizar el producto:",y)})};W(ve,(s,m)=>{s!==m&&E(w.params.sesion)}),W($e,(s,m)=>{s!==m&&E(w.params.sesion)}),Ee(async()=>{E(w.params.sesion)}),W(()=>w.params.sesion,s=>{E(s)});const Z=async()=>{if(!te.value||!te.value.product_id){console.error("No se ha seleccionado ningún producto para eliminar");return}try{const s=await fetch(`${_}/products/${te.value.product_id}`,{method:"DELETE"});if(!s.ok)throw new Error(`Error al eliminar el producto: ${s.status}`);await E(w.params.sesion),ee.value=!1,console.log(`Producto eliminado: ${te.value.name}`)}catch(s){console.error("Error al eliminar el producto:",s)}};return(s,m)=>{const y=h("Button"),k=h("Toast"),A=h("InputSwitch"),$=h("Dialog");return g(),C("div",Zo,[a("p",ea,[oa,me(),a("span",aa,O(r(w).params.sesion),1),me(),ta]),a("span",null,[t(y,{style:{height:"2.5rem"},onClick:m[0]||(m[0]=v=>le.value=!r(le)),class:"ml-2 mb-4",size:"small",severity:"help"},{default:X(()=>[a("i",{class:fe([r(Ve).PLUS,"mr-3"])},null,2),me(" Agregar "+O(r(w).params.sesion.slice(0,-1)),1)]),_:1})]),a("div",sa,[(g(!0),C(pe,null,ke(N.value,v=>(g(),C("div",{key:v.id,class:"xl:col-3 lg:col-4 md:p-3 p-1 col-6 md:col-6 mb-4"},[a("div",la,[a("div",na,[a("img",{class:"imagen",onError:m[1]||(m[1]=(...V)=>s.imagenError&&s.imagenError(...V)),style:{height:"50"},src:`${r(_)}/read-product-image/300/${v.name}`,alt:""},null,40,ia)]),a("div",ra,[a("p",ua,O(v.name),1),a("p",ca,O(v.description),1)]),t(y,{class:"p-2",size:"small",rounded:"",severity:"info",style:{position:"absolute",top:"-1rem",right:"0rem",display:"flex","align-items":"center","justify-content":"center",color:"white"},onClick:V=>ae(v)},{default:X(()=>[a("i",{class:fe(["text-2xl p-0 m-0",r(Ve).PENCIL])},null,2)]),_:2},1032,["onClick"]),t(y,{severity:"danger",style:{position:"absolute",top:"-1rem",right:"3rem",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center"},onClick:V=>M(v)},{default:X(()=>[a("i",{class:fe(["text-2xl p-0 m-0",r(Ve).TRASH])},null,2)]),_:2},1032,["onClick"]),t(k,{style:{"box-shadow":"none"}}),a("div",da,[a("div",pa,O(r(De)(v.price)),1),t(A,{modelValue:v.isActive,"onUpdate:modelValue":V=>v.isActive=V,onChange:()=>K(v)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]))),128))]),t(k),t(Yo),t(go),t($,{header:"Confirmation",visible:r(ee),"onUpdate:visible":m[3]||(m[3]=v=>U(ee)?ee.value=v:null),style:{width:"350px"},modal:!0},{footer:X(()=>[t(y,{label:"No",icon:"pi pi-times",onClick:m[2]||(m[2]=v=>ee.value=!r(ee)),class:"p-button-text"}),t(y,{label:"Si",icon:"pi pi-check",onClick:Z,class:"p-button-text",autofocus:""})]),default:X(()=>[a("div",ma,[va,a("span",null,[me("Seguro que desea eliminar "),a("b",null,O(r(te).name),1)])])]),_:1},8,["visible"])])}}},fa=be(_a,[["__scopeId","data-v-da7bcef5"]]);export{fa as default};
