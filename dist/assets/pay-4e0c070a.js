import{r as Ee}from"./resumen-6a91b778.js";import{a as De,u as Ae}from"./site-086f15f0.js";import{_ as we,j as h,I as G,k as Ne,m as B,U as H,H as w,r as f,o as c,c as y,e as r,f as v,a,u as e,F as Z,i as V,h as b,g as J,t as m,q as Te,x as Me}from"./index-f8593e29.js";import{u as Pe}from"./user-aaa83723.js";import"./ventas-9b670be4.js";import"./formatoPesos-e824e30b.js";const p=N=>(Te("data-v-31012d3b"),N=N(),Me(),N),Oe={class:"finalizar-compra-container"},Be={key:0,style:{display:"flex","flex-direction":"column",gap:"1rem"}},$e={class:"form-group"},Le={class:"flex flex-col"},Re={key:1},Fe={style:{display:"flex",gap:"1rem"}},qe=p(()=>a("p",{class:"title"},"FINALIZAR COMPRA",-1)),ze={style:{margin:"auto","max-width":"800px"}},je={class:"title",style:{margin:"3rem .5rem"}},Ge={class:"form-grid"},He={class:"form-column"},Ze=p(()=>a("span",null,"NOMBRE",-1)),Je={class:"form-group"},Ke=p(()=>a("span",null,"Ubicacio'n",-1)),Qe={class:"form-group"},We=p(()=>a("span",null,"Metodo Entrega",-1)),Xe={class:"form-group"},Ye=p(()=>a("span",null,"Direccio'n",-1)),eo=p(()=>a("span",null,"Direccio'n",-1)),oo={class:"form-group"},to=p(()=>a("span",null,"Correo Electronico",-1)),so={class:"form-group"},ao=p(()=>a("span",null,"Telefono",-1)),lo={class:"form-group"},ro=p(()=>a("span",null,"Placa de tu vehiculo",-1)),no={class:"form-group"},io={style:{display:"flex","align-items":"center",gap:"1rem"}},uo={key:3,class:"form-group"},co={key:0},mo={key:1},po=p(()=>a("span",null,"Metodo de pago",-1)),_o={class:"form-group"},yo={key:4},vo={class:"form-group"},go=p(()=>a("span",null,"Notas",-1)),ho=5,fo={__name:"pay",setup(N){const C=h(!1),K=h({}),$=G(()=>{var o;return(((o=t==null?void 0:t.lang)==null?void 0:o.name)||"es").toString().toLowerCase()==="en"?"en":"es"}),L={es:{site_selector:"Seleccionar sede",address_placeholder:"Escribe tu dirección",in_coverage:"En cobertura",not_in_coverage:"Fuera de cobertura",distance:"Distancia",miles:"Millas",ships_from_site:"Sale de la sede",delivery_price:"Costo de envío",cancel:"Cancelar",save:"Guardar",finalize_purchase:"Finalizar compra",name:"Nombre",address:"Dirección",phone:"Teléfono",email:"Correo electrónico",vehicle_plate:"Placa de tu vehículo",payment_method:"Método de pago",notes:"Notas",additional_notes:"Notas adicionales",delivery_method:"Método de entrega"},en:{site_selector:"Site selector",address_placeholder:"Type your address",in_coverage:"In coverage",not_in_coverage:"Out of coverage",distance:"Distance",miles:"Miles",ships_from_site:"Ships from",delivery_price:"Delivery price",cancel:"Cancel",save:"Save",finalize_purchase:"Checkout",name:"Name",address:"Address",phone:"Phone",email:"Email",vehicle_plate:"Vehicle plate",payment_method:"Payment method",notes:"Notes",additional_notes:"Additional notes",delivery_method:"Delivery method"}},_=l=>L[$.value]&&L[$.value][l]||L.es[l]||l;h("");const T=h([]),R=h(null),F=h(null),M=h(!1),Ve=[{id:1,name:"Demora más de una hora",percentage:"15%"},{id:2,name:"Pedido frío",percentage:"20%"},{id:3,name:"Un pelo",percentage:"100%"},{id:4,name:"Producto dañado",percentage:"100%"},{id:5,name:"Faltante de bebida y adición",percentage:"0%"},{id:6,name:"Responderle con lo que falta",percentage:"0%"},{id:7,name:"Salsas que no son",percentage:"20%"},{id:8,name:"Si se enoja y quiere cambio",percentage:"100%"},{id:9,name:"Mala atención Call Center",percentage:"20%"},{id:10,name:"Mala atención en Punto de venta",percentage:"20%"},{id:11,name:"Influencer",percentage:"100%"},{id:12,name:"No llegó el pedido",percentage:"20%"}],P=De(),n=Ae(),t=Pe(),q=h([]),O=h([]);Ne(async()=>{t.user.order_type={},O.value=await B.get(`${H}/payment_methods`),q.value=await B.get(`${H}/get_all_order_types`),K.value=await B.get(`${H}/site-payments-call-center`)}),w(()=>t.user.order_type,l=>{var o;(l==null?void 0:l.id)==2?n.location.neigborhood.delivery_price=0:n.location.neigborhood.delivery_price=(o=t.user.site)==null?void 0:o.delivery_cost_usd}),w(M,l=>{l&&alert("El esquema de comandas cambio y el modelo actual ya no es valido, la orden se envia como una orden comun")}),w(()=>{var l,o;return(o=(l=n.location)==null?void 0:l.site)==null?void 0:o.site_id},()=>{t.user.order_type=null}),w(()=>t.user.order_type,()=>{t.user.placa=null});const be=G(()=>{var o,S;return((S=(o=n.location)==null?void 0:o.site)==null?void 0:S.site_id)===33?q.value.filter(i=>(i==null?void 0:i.id)!==3):q.value.filter(i=>(i==null?void 0:i.id)!==1)}),Se={}.VITE_GEO_API_BASE||{}.VITE_PLACES_API_URI||"https://api.stripe.salchimonster.com",Ce=()=>{R.value=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}_${Math.random().toString(36).slice(2)}`},xe=G(()=>{var l,o;return((o=(l=n.location)==null?void 0:l.site)==null?void 0:o.country_code)??"co"}),Ie=async l=>{const o=((l==null?void 0:l.query)??"").trim();if(!o){T.value=[],F.value=null;return}R.value||Ce();const S=new URLSearchParams({input:o,session_token:R.value,language:$.value,region:xe.value||"",limit:String(ho)});try{const i=`${Se}/places/autocomplete?${S.toString()}`,u=await B.get(i,!1),z=Array.isArray(u)?u:Array.isArray(u==null?void 0:u.predictions)?u.predictions:[];T.value=z.filter(d=>(d==null?void 0:d.description)&&(d==null?void 0:d.place_id)),F.value=u&&!Array.isArray(u)&&u.error?u.error:null}catch(i){console.error("Autocomplete error:",i),T.value=[],F.value=null}};return w(()=>{var l;return(l=t.user.site)==null?void 0:l.delivery_cost_usd},l=>{var o;l!=null&&(!t.user.order_type||((o=t.user.order_type)==null?void 0:o.id)!==2)&&(n.location.neigborhood.delivery_price=l)}),(l,o)=>{var W,X,Y,ee,oe,te,se,ae,le,re,ne,ie,de,ue,ce,me,pe,_e,ye,ve;const S=f("AutoComplete"),i=f("Tag"),u=f("Button"),z=f("Dialog"),d=f("InputText"),j=f("Dropdown"),ke=f("Checkbox"),Ue=f("InputNumber"),Q=f("Textarea");return c(),y("div",Oe,[r(z,{header:_("site_selector"),modal:"",visible:C.value,"onUpdate:visible":o[3]||(o[3]=s=>C.value=s),style:{width:"100%","max-width":"30rem",margin:".5rem"}},{footer:v(()=>{var s,x;return[a("div",Fe,[r(u,{onClick:o[1]||(o[1]=()=>{C.value=!1,e(t).user.site={}}),label:_("cancel"),severity:"danger",text:""},null,8,["label"]),r(u,{style:{"background-color":"black",border:"none",color:"white"},label:_("save"),onClick:o[2]||(o[2]=()=>{var I,k,U,E,D,A;C.value=!1,e(n).location.site=(k=(I=e(t).user.site)==null?void 0:I.nearest)==null?void 0:k.site,e(n).location.neigborhood.delivery_price=(U=e(t).user.site)==null?void 0:U.delivery_cost_usd,e(t).user.address=(A=(D=(E=e(t).user.site)==null?void 0:E.nearest)==null?void 0:D.site)==null?void 0:A.site_address}),disabled:!((x=(s=e(t).user.site)==null?void 0:s.nearest)!=null&&x.in_coverage)},null,8,["label","disabled"])])]}),default:v(()=>{var s,x,I,k,U,E,D,A,ge,he;return[!e(t).user.order_type||e(t).user.order_type.id!==2?(c(),y("div",Be,[a("div",$e,[r(S,{size:"large",style:{"min-width":"100%"},modelValue:e(t).user.site,"onUpdate:modelValue":o[0]||(o[0]=g=>e(t).user.site=g),suggestions:T.value,"option-label":"description",minLength:1,delay:250,forceSelection:"",placeholder:_("address_placeholder"),onComplete:Ie,class:"w-full"},{item:v(({item:g})=>[a("div",Le,[a("span",null,m(g.description),1)])]),_:1},8,["modelValue","suggestions","placeholder"])]),(s=e(t).user.site)!=null&&s.nearest?(c(),J(i,{key:0,style:{width:"max-content"},severity:(I=(x=e(t).user.site)==null?void 0:x.nearest)!=null&&I.in_coverage?"success":"danger"},{default:v(()=>{var g,fe;return[b(m((fe=(g=e(t).user.site)==null?void 0:g.nearest)!=null&&fe.in_coverage?_("in_coverage"):_("not_in_coverage")),1)]}),_:1},8,["severity"])):V("",!0),a("span",null,[a("strong",null,m(_("distance"))+": ",1),b(" "+m((U=(k=e(t).user.site)==null?void 0:k.nearest)==null?void 0:U.distance_miles)+" "+m(_("miles")),1)]),(E=e(t).user.site)!=null&&E.delivery_cost_usd?(c(),y("span",Re,[a("strong",null,m(_("ships_from_site"))+": ",1),b(" "+m((ge=(A=(D=e(t).user.site)==null?void 0:D.nearest)==null?void 0:A.site)==null?void 0:ge.site_name),1)])):V("",!0),(he=e(t).user.site)!=null&&he.delivery_cost_usd?(c(),J(i,{key:2,severity:"success"},{default:v(()=>{var g;return[a("span",null,[a("strong",null,m(_("delivery_price"))+": $"+m((g=e(t).user.site)==null?void 0:g.delivery_cost_usd),1)])]}),_:1})):V("",!0)])):V("",!0)]}),_:1},8,["header","visible"]),qe,a("div",ze,[a("div",je,[r(i,{severity:"success",class:"advertice"},{default:v(()=>[b(" El tiempo promedio de entrega es de 60 a 75 minutos, por favor téngalo en cuenta antes de ordenar ")]),_:1})])]),a("div",Ge,[a("div",He,[Ze,a("div",Je,[r(d,{id:"username",placeholder:"NOMBRE",modelValue:e(t).user.name,"onUpdate:modelValue":o[4]||(o[4]=s=>e(t).user.name=s)},null,8,["modelValue"])]),Ke,a("div",Qe,[r(d,{onClick:o[5]||(o[5]=s=>e(n).setVisible("currentSite",!0)),modelValue:e(n).location.neigborhood.name,id:"neighborhood",placeholder:"Ubicacion",readonly:""},null,8,["modelValue"])]),We,a("div",Xe,[r(j,{style:{width:"100%"},modelValue:e(t).user.order_type,"onUpdate:modelValue":o[6]||(o[6]=s=>e(t).user.order_type=s),id:"metodo_de_entrega",placeholder:"Metodo de entrega",options:be.value.filter(s=>[1,2,3].includes(s.id)),optionLabel:"name"},null,8,["modelValue","options"])]),!e(t).user.order_type||((W=e(t).user.order_type)==null?void 0:W.id)!==2&&[33,35,36].includes((Y=(X=e(n).location)==null?void 0:X.site)==null?void 0:Y.site_id)?(c(),y(Z,{key:0},[Ye,r(d,{onClick:o[7]||(o[7]=()=>C.value=!0),value:e(t).user.address,readonly:""},null,8,["value"])],64)):!e(t).user.order_type||((ee=e(t).user.order_type)==null?void 0:ee.id)!==2&&![33,35,36].includes((te=(oe=e(n).location)==null?void 0:oe.site)==null?void 0:te.site_id)?(c(),y(Z,{key:1},[eo,a("div",oo,[r(d,{modelValue:e(t).user.address,"onUpdate:modelValue":o[8]||(o[8]=s=>e(t).user.address=s),id:"address",placeholder:"DIRECCION"},null,8,["modelValue"])])],64)):V("",!0),to,a("div",so,[r(d,{modelValue:e(t).user.email,"onUpdate:modelValue":o[9]||(o[9]=s=>e(t).user.email=s),id:"email",placeholder:"Correo Electronico"},null,8,["modelValue"])]),ao,a("div",lo,[r(d,{modelValue:e(t).user.phone_number,"onUpdate:modelValue":o[10]||(o[10]=s=>e(t).user.phone_number=s),id:"phone_number",mask:"999 999 9999",placeholder:"TELEFONO"},null,8,["modelValue"])]),e(t).user.order_type&&((se=e(t).user.order_type)==null?void 0:se.id)===2&&((le=(ae=e(n).location)==null?void 0:ae.site)==null?void 0:le.site_id)===33?(c(),y(Z,{key:2},[ro,a("div",no,[r(d,{modelValue:e(t).user.placa,"onUpdate:modelValue":o[11]||(o[11]=s=>e(t).user.placa=s),id:"placa",placeholder:"Placa de tu vehiculo"},null,8,["modelValue"])])],64)):V("",!0),a("span",io,[r(ke,{modelValue:M.value,"onUpdate:modelValue":o[12]||(o[12]=s=>M.value=s),binary:""},null,8,["modelValue"]),b(" Es una cortesía? ")]),M.value?(c(),y("div",uo,[r(j,{style:{width:"100%"},modelValue:e(t).user.payment_method_option,"onUpdate:modelValue":o[13]||(o[13]=s=>e(t).user.payment_method_option=s),id:"payment_method",placeholder:"Porcentaje de cortesía",options:Ve},{option:v(s=>[b(m(s.option.name)+" ",1),r(i,null,{default:v(()=>[b(m(s.option.percentage),1)]),_:2},1024)]),value:v(s=>[s.value?(c(),y("span",co,[b(m(s.value.name)+" ",1),r(i,null,{default:v(()=>[b(m(s.value.percentage),1)]),_:2},1024)])):(c(),y("span",mo," Selecciona un porcentaje "))]),_:1},8,["modelValue"])])):V("",!0),po,a("div",_o,[r(j,{style:{width:"100%"},modelValue:e(t).user.payment_method_option,"onUpdate:modelValue":o[14]||(o[14]=s=>e(t).user.payment_method_option=s),id:"payment_method",placeholder:"METODO DE PAGO",options:(ie=K.value)==null?void 0:ie[(ne=(re=e(n).location)==null?void 0:re.site)==null?void 0:ne.site_id],optionLabel:"name"},null,8,["modelValue","options"])]),((ue=(de=e(t).user)==null?void 0:de.order_type)==null?void 0:ue.id)!=2?(c(),y("span",yo,"Domicilio")):V("",!0),a("div",vo,[((me=(ce=e(t).user)==null?void 0:ce.order_type)==null?void 0:me.id)!=2?(c(),J(Ue,{key:0,style:{width:"100%"},prefix:"$",min:"0",maxFractionDigits:2,modelValue:e(n).location.neigborhood.delivery_price,"onUpdate:modelValue":o[15]||(o[15]=s=>e(n).location.neigborhood.delivery_price=s),id:"payment_method",placeholder:"Domicilio",options:((_e=(pe=e(n).location)==null?void 0:pe.site)==null?void 0:_e.site_id)===33?O.value.filter(s=>[6,8].includes(s==null?void 0:s.id)):((ve=(ye=e(n).location)==null?void 0:ye.site)==null?void 0:ve.site_id)!==33?O.value.filter(s=>![7].includes(s==null?void 0:s.id)):O.value,optionLabel:"name"},null,8,["modelValue","options"])):V("",!0)]),go,r(Q,{modelValue:e(P).cart.order_notes,"onUpdate:modelValue":o[16]||(o[16]=s=>e(P).cart.order_notes=s),class:"order-notes",placeholder:"Notas adicionales"},null,8,["modelValue"]),a("template",null,[r(Q,{modelValue:e(P).cart.order_notes,"onUpdate:modelValue":o[17]||(o[17]=s=>e(P).cart.order_notes=s),class:"order-notes",placeholder:"Notas"},null,8,["modelValue"])])]),r(Ee,{class:"resumen-column"})])])}}},ko=we(fo,[["__scopeId","data-v-31012d3b"]]);export{ko as default};
