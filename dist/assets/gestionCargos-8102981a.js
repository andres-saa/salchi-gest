import{f as r,x as L,h as U,r as m,o as a,c as n,a as o,d as l,n as E,w as d,F as _,b as S,U as v,k as g,t as u,q as z,l as M,P as F}from"./index-90c38b00.js";const J={key:0,class:"col-12",style:{display:"flex","flex-direction":"column","pointer-events":"none","align-items":"center","justify-content":"center",position:"fixed","z-index":"1000",left:"0",top:"0",height:"100%","background-color":"rgba(0, 0, 0, 0.5)"}},H=o("p",{class:"text-3xl",style:{"font-weight":"bold",color:"white","text-shadow":"0 0 10px rgba(0, 0, 0, 0.551)"}},"BUSCANDO CARGOS",-1),q={style:{display:"flex"}},W={style:{display:"flex"},class:"grid pt-6"},K={style:{display:"flex"},class:"col-12 p-0"},Q={class:"col-12 p-1",style:{display:"flex",gap:"1rem"}},X=o("p",null," Nombre",-1),Y=o("p",null," Descripcion",-1),Z=o("p",null,"Seleccionar Grupo(s)",-1),ee={class:"grid"},oe={class:"col-12 p-0 m-auto",style:{"max-width":"900px",display:"flex",gap:"1rem","align-items":"center"}},se={class:"p-5",style:{display:"flex",gap:"1rem","align-items":"center"}},te={class:"text-2xl p-0 m-0",style:{"font-weight":"bold","text-transform":"capitalize"}},le={class:"mx-5 my-0 p-5",style:{"border-radius":"0.5rem","background-color":"rgba(252, 155, 0, 0.105)",display:"1rem","align-items":"center"}},ae=o("p",{class:"text-xl p-0 m-0",style:{"font-weight":"bold"}},"Description de las funciones del Grupo: ",-1),ne={class:"text-sm md:text-lg p-0 m-0"},re={class:"grid col-12 p-6"},ie={class:"col-12 p-0 mb-6",style:{display:"flex",gap:"1rem","align-items":"center"}},ce=o("p",{style:{"font-weight":"bold"},class:"text-xl px-1 m-0"},"Cargos ",-1),de={style:{display:"flex",gap:"0.5rem","align-items":"center"}},ue={class:"p-0 m-0",style:{"text-transform":"capitalize"}},ve={__name:"gestionCargos",setup(pe){const x=r(!1),R=r([]),N=r([]),w=r(!1),f=r(!1),b=r([]),D=r(null),C=r(["todos"]),V=L(),G=async()=>{try{V.setLoading(!0,"BUSCANDO CARGOS");const e=await(await fetch(v+"/rolegroups")).json();for(const c of e){const i=await(await fetch(`${v}/rolegroup/${c.id}/roles`)).json();c.roles=i}R.value=e,charging.value=!1,V.setLoading(!1,"BUSCANDO CARGOS")}catch(t){console.error(t),V.setLoading(!1,"BUSCANDO CARGOS")}},T=async()=>{try{const e=await(await fetch(v+"/roles")).json();N.value=e}catch(t){console.error(t)}},A=async()=>{f.value=!0;const t=`${v}/assign-roles-to-group-delete-olds/${D.value}`;try{if(!(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b.value)})).ok)throw new Error("Hubo un problema al asignar los roles al grupo");x.value=!1,f.value=!1,await G()}catch(e){console.error("Error al asignar roles al grupo:",e)}},p=r({}),I=async()=>{f.value=!0;const t=`${v}/role`;try{const e={title:p.value.title,description:p.value.description},c=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!c.ok)throw new Error("Hubo un problema al crear el nuevo cargo.");const{role_id:y}=await c.json();for(const i of C.value){const k=`${v}/assign-roles-to-group/${i}`;await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([y])})}f.value=!1,w.value=!1,await G(),await T(),C.value=["todos"]}catch(e){console.error("Error al crear y asignar el nuevo rol:",e),f.value=!1}},B=t=>{D.value=t.id,b.value=t.roles.map(e=>e.id),x.value=!0};return U(G),U(T),(t,e)=>{const c=m("ProgressSpinner"),y=m("Checkbox"),i=m("Button"),k=m("Dialog"),$=m("InputText"),j=m("Textarea");return a(),n(_,null,[t.charging?(a(),n("div",J,[H,o("div",q,[l(c,{style:{width:"100px",height:"100px"},strokeWidth:"4",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])])):E("",!0),l(k,{visible:x.value,"onUpdate:visible":e[1]||(e[1]=s=>x.value=s),modal:"",header:"Seleccion de Cargos para el grupo",style:{width:"50rem",height:"80vh"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{footer:d(()=>[l(i,{onClick:A},{default:d(()=>[g("Guardar cambios")]),_:1})]),default:d(()=>[o("div",W,[(a(!0),n(_,null,S(N.value,s=>(a(),n("div",K,[o("div",Q,[l(y,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=h=>b.value=h),value:s.id},null,8,["modelValue","value"]),o("p",null,u(s.title),1)])]))),256))])]),_:1},8,["visible"]),l(k,{visible:w.value,"onUpdate:visible":e[5]||(e[5]=s=>w.value=s),modal:"",header:"Crear nuevo Cargo",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:d(()=>[X,l($,{modelValue:p.value.title,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value.title=s),class:"col-12"},null,8,["modelValue"]),Y,l(j,{modelValue:p.value.description,"onUpdate:modelValue":e[3]||(e[3]=s=>p.value.description=s),class:"col-12",style:{"max-width":"100%","min-width":"100%",height:"20vh"}},null,8,["modelValue"]),Z,o("div",ee,[(a(!0),n(_,null,S(R.value,s=>(a(),n("div",{class:"col-12 py-1",key:s.id},[l(y,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=h=>C.value=h),value:s.id},null,8,["modelValue","value"]),g(" "+u(s.group_name),1)]))),128))]),l(i,{onClick:I,class:"mt-4"},{default:d(()=>[g("Crear nuevo cargo")]),_:1})]),_:1},8,["visible"]),o("div",oe,[l(i,{severity:"success",style:{"font-weight":"bold"},onClick:e[6]||(e[6]=s=>w.value=!0)},{default:d(()=>[g("Crear nuevo cargo")]),_:1})]),o("div",null,[(a(!0),n(_,null,S(R.value,(s,h)=>(a(),n("div",{key:s.id,class:"my-6 m-auto",style:{"max-width":"900px","border-radius":"1rem","box-shadow":"0 0 20px rgba(0, 0, 0, 0.2)"}},[o("div",se,[o("p",te,u(h+1)+". Grupo "+u(s.group_name),1)]),o("div",le,[ae,o("p",ne,u(s.description),1)]),o("div",re,[o("div",ie,[ce,l(i,{severity:"warning",style:{"font-weight":"bold"},onClick:O=>B(s)},{default:d(()=>[g("Modificar")]),_:2},1032,["onClick"])]),(a(!0),n(_,null,S(s.roles,(O,P)=>(a(),n("div",{key:O.id,class:"col-12 md:col-6 p-1 text-sm lg:text-lg"},[o("div",de,[o("p",ue,[o("i",{class:z(M(F).CIRCLE_FILL)},null,2),g(" "+u(P+1)+". "+u(O.title),1)])])]))),128))])]))),128))])],64)}}};export{ve as default};
