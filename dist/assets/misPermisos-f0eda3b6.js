import{_ as oe,g as d,C as ae,q as le,D as U,h as B,a8 as ne,B as ie,e as w,o as H,c as q,b as l,f as i,n as re,s as de,U as P,a9 as F,a as e,m as c,t as n,d as J,u as ce,T as ue,j as pe,p as me,k as he}from"./index-0a31f2de.js";const o=z=>(me("data-v-d2e55022"),z=z(),he(),z),_e={class:"col-12 mx-auto p-0",style:{"margin-top":"6rem"}},fe=o(()=>e("p",{class:"mb-2 text-4xl text-center px-4",style:{"font-weight":"bold","text-transform":"capitalize"}},[e("i",{class:"fa-solid fa-person-walking-luggage"}),c(" Mis permisos ")],-1)),ve={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ye=o(()=>e("p",{class:"m-0 text-2xl my-4"},null,-1)),be={class:"block mt-2 md:mt-0 p-input-icon-left"},ge=o(()=>e("i",{class:"pi pi-search"},null,-1)),we=o(()=>e("span",{class:"p-column-title"},"Code",-1)),xe=o(()=>e("span",{class:"p-column-title"},"Code",-1)),ke=o(()=>e("span",{class:"p-column-title"},"Code",-1)),Ce=o(()=>e("span",{class:"p-column-title"},"Code",-1)),Se=o(()=>e("span",{class:"p-column-title"},"Code",-1)),Pe=o(()=>e("span",{class:"p-column-title"},"Code",-1)),ze=o(()=>e("span",{class:"p-column-title"},"Code",-1)),Te={style:{display:"flex",gap:"1rem","justify-content":"center"}},Ee=o(()=>e("div",null,null,-1)),Ie={class:"a4-size p-0 lg:p-6 mi-clase mt-4"},Ne=o(()=>e("img",{class:"m-auto",src:"https://salchimonster.com/images/logo.png",style:{width:"10%"},alt:""},null,-1)),je={style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"}},Re=o(()=>e("h6",{class:"text-center",style:{"font-size":"11pt","font-weight":"bold",color:"black","font-family":"Arial, Helvetica, sans-serif"}}," INVERSIONES SALCHIMONSTER SAS ",-1)),$e=o(()=>e("h6",{style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"},class:"text-center"},"NIT: 901.420.874-0",-1)),De={class:"text-center py-4",style:{"font-weight":"bold","text-transform":"uppercase"}},Le=o(()=>e("span",{style:{"text-transform":"capitalize"}},null,-1)),Ue={class:"text-l",style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"}},Fe={class:"p-0 m-0"},Me=o(()=>e("span",{style:{"font-weight":"bold"}},"Fecha de la solicitud: ",-1)),Oe={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Ae={class:"p-0 m-0",style:{width:"100%"}},Ve=o(()=>e("span",{style:{"font-weight":"bold"}},"Nombre: ",-1)),Be={style:{width:"100%","border-bottom":"1px solid","padding-bottom":"0","padding-right":"3rem"}},He={class:"p-0 m-0"},qe=o(()=>e("span",{style:{"font-weight":"bold"}},"Cargo: ",-1)),Je={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Ke={class:"p-0 m-0"},Ye=o(()=>e("span",{style:{"font-weight":"bold"}},"IdentificaciÃ³n No: ",-1)),Ge={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Qe={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},We={style:{display:"flex","flex-direction":"column"},class:""},Xe=o(()=>e("div",{style:{"font-weight":"bold"}}," Desde ",-1)),Ze={style:{display:"flex","flex-direction":"column"}},et=o(()=>e("div",{style:{"font-weight":"bold"}}," Hasta ",-1)),tt={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},st={style:{display:"flex","flex-direction":"column"},class:""},ot={style:{display:"flex","flex-direction":"column"}},at=o(()=>e("div",{style:{"font-weight":"bold"}}," Observaciones ",-1)),lt={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},nt={style:{display:"flex","flex-direction":"column"},class:""},it={style:{display:"flex","flex-direction":"column"}},rt=o(()=>e("div",{class:"mb-2",style:{"font-weight":"bold"}}," Estado actual ",-1)),dt={class:"mb-1"},ct=o(()=>e("span",{style:{"font-weight":"bold"}},"Resumen:",-1)),ut={class:"mb-1"},pt=o(()=>e("span",{style:{"font-weight":"bold"}},"Fecha:",-1)),mt={class:"mb-1"},ht=o(()=>e("span",{style:{"font-weight":"bold"}}," Responsable:",-1)),_t={key:0},ft=o(()=>e("span",{style:{"font-weight":"bold"}},"Motivos del rechazo:",-1)),vt={style:{display:"flex",position:"absolute",top:"3.5rem",right:"-1rem",gap:"1rem"}},yt=o(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),bt=o(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),gt=o(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),wt=o(()=>e("h6",null,"Razones para rechazar este permiso ",-1)),xt=o(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),kt=o(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),Ct=o(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),St={__name:"misPermisos",setup(z){const K=d(null),f=ae(),Y=d(f.params.status),v=d(f.params.tipo),x=d(f.params.status),I=d(""),G=()=>{T.value={global:{value:null,matchMode:de.CONTAINS}}},Q=()=>{window.print()},y=d(!1),N=d("2029-12-21 16:19"),u=d(),T=d(null),_=d([]),b=d({}),j=d(!1),R=d(!1),M=d([]),W=d(!0);le(()=>{G()}),U(()=>f.params.status,s=>{Y.value=s}),U(()=>f.params.tipo,s=>{v.value=s,console.log(v),k(s,x.value).then(t=>_.value=t)}),U(()=>f.params.status,s=>{x.value=s,k(v.value).then(t=>_.value=t)});const X=async s=>{y.value=!0,u.value=s,se(s.employer_id)};function Z(s){s.status={status:"aprobado",timestamp:N.value,responsable:F()},s.history.push({...s.status}),fetch(`${P}/permission/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(t=>{t.json(),y.value=!1,j.value=!1,k(v.value,x.value).then(r=>_.value=r)}).then(t=>console.log("Permiso aprobado:",t)).catch(t=>console.error("Error:",t))}function ee(s){s.status={status:"rechazado",timestamp:N.value,razones:I.value,responsable:F()},s.history.push({...s.status}),fetch(`${P}/permission/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(t=>{t.json(),R.value=!1,y.value=!1,k(v.value,x.value).then(r=>_.value=r)}).then(t=>console.log("Permiso rechazado:",t)).catch(t=>console.error("Error:",t))}function $(s){var t=new Date(s),r={day:"numeric",month:"long",year:"numeric"};return t.toLocaleDateString("es-ES",r)}const te=async()=>{fetch(`${P}/server_time`).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>{console.log("Employer data:",s),N.value=s}).catch(s=>{console.error("There has been a problem with your fetch operation:",s),mensaje.value="error"})};function O(s){s||(s="2029-12-21 16:19");const t=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];let[r,p]=s.split(" "),[m,D,C]=r.split("-").map(Number),L=t[D-1];return`${C} de ${L} de ${m}`}const se=async s=>{fetch(`${P}/employer/${s}`).then(t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()}).then(t=>{console.log("Employer data:",t),b.value=t}).catch(t=>{console.error("There has been a problem with your fetch operation:",t)})},A=d([]);B(()=>{ne().then(s=>A.value=s)});const E=ie();async function k(){E.setLoading(!0,"Cargando permisos");const s=await F(),t=`${P}/permissions/user/${s}  `;try{const r=await fetch(t);if(!r.ok)throw E.setLoading(!1,"Cargando permisos"),new Error(`Error al obtener los permisos: ${r.status}`);W.value=!1;const p=await r.json();return E.setLoading(!1,"Cargando permisos"),p}catch(r){throw console.error("Error en getPermissions:",r),E.setLoading(!1,"Cargando permisos"),[r]}}return B(()=>{k(v.value,x.value).then(s=>_.value=s).catch(()=>_.value=[]),te()}),(s,t)=>{const r=w("InputText"),p=w("Column"),m=w("Button"),D=w("DataTable"),C=w("Dialog"),L=w("Textarea");return H(),q("div",_e,[fe,l(D,{ref_key:"dt",ref:K,value:_.value,selection:M.value,"onUpdate:selection":t[1]||(t[1]=a=>M.value=a),dataKey:"id",paginator:!0,rows:10,filters:T.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} permisoes",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{header:i(()=>[e("div",ve,[ye,e("span",be,[ge,l(r,{class:"",modelValue:T.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=a=>T.value.global.value=a),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:i(()=>[l(p,{class:"p-2",selectionMode:"multiple",headerStyle:"width: 3rem; ",frozen:""}),l(p,{class:"p-2",field:"id",header:"Id",sortable:!0,headerStyle:"width:3rem; min-width:min-content; "},{body:i(a=>[we,c(" "+n(a.data.id),1)]),_:1}),l(p,{class:"p-2",field:"tipo",header:"Tipo",sortable:!0,headerStyle:"width:10rem; min-width:min-content; "},{body:i(a=>[xe,c(" "+n(a.data.tipo),1)]),_:1}),l(p,{class:"p-2",field:"fecha",header:"Fecha de solicitud",sortable:!0,headerStyle:"width:10rem; min-width:min-content; "},{body:i(a=>{var g,S;return[ke,c(" "+n((S=(g=a.data.history)==null?void 0:g.filter(h=>h.status=="generado")[0].timestamp)==null?void 0:S.split(" ")[0]),1)]}),_:1}),l(p,{class:"p-2",field:"start_date",header:"Fecha de inicio",sortable:!0,headerStyle:"width:15rem; min-width:10rem; "},{body:i(a=>[Ce,c(" "+n(a.data.start_date),1)]),_:1}),l(p,{class:"p-2",field:"end_date",header:"Fecha finalizacion",sortable:!0,headerStyle:"width:15rem; min-width:max-content; "},{body:i(a=>[Se,c(" "+n(a.data.end_date),1)]),_:1}),l(p,{class:"p-2",field:"observations",header:"Observaciones del empleado",sortable:!0,headerStyle:"width:30rem; min-width:max-content; "},{body:i(a=>[Pe,c(" "+n(a.data.observations),1)]),_:1}),l(p,{class:"p-2",field:"status.status",header:"Estado",sortable:!0,headerStyle:"width:10rem; min-width:max-content; "},{body:i(a=>[ze,e("div",{class:J(["p-2",a.data.status.status]),style:{"border-radius":"10rem"}},n(a.data.status.status),3)]),_:1}),l(p,{class:"p-2",field:"location",header:"Acciones",sortable:!0,frozen:"",alignFrozen:"right",headerStyle:"width:1rem; min-width:min-content; "},{body:i(a=>[e("div",Te,[l(m,{class:"p-0",outlined:"",severity:"info",label:"Small",onClick:g=>X(a.data),text:""},{default:i(()=>[e("i",{class:J(["text-xl",ce(ue).EYE]),style:{"font-weight":"bold"}},null,2)]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["value","selection","filters"]),Ee,l(C,{closable:!1,style:re([{border:"none","box-shadow":"none",position:"relative"},{width:"700px"}]),visible:y.value,"onUpdate:visible":t[3]||(t[3]=a=>y.value=a),modal:!0,class:"p-fluid m-2 pt-8"},{default:i(()=>{var a,g,S;return[e("div",Ie,[Ne,e("h6",je,n(O(u.value.history.filter(h=>h.status=="generado")[0].timestamp)),1),Re,$e,e("h6",De,[c("FORMATO SOLICITUD DE PERMISO "+n(u.value.tipo)+" ",1),Le]),e("h5",Ue,[e("p",Fe,[Me,c(),e("span",Oe,n(O(u.value.history.filter(h=>h.status=="generado")[0].timestamp)),1)]),e("p",Ae,[Ve,c(),e("span",Be,n(b.value.name),1)]),e("p",He,[qe,c(),e("span",Je,n(b.value.position),1)]),e("p",Ke,[Ye,c(),e("span",Ge,n(b.value.dni),1)]),e("div",Qe,[e("div",We,[Xe,e("div",null,n($(u.value.start_date)),1)]),e("div",Ze,[et,e("div",null,n($(u.value.end_date)),1)])]),e("div",tt,[e("div",st,[e("div",ot,[at,e("div",null,n(u.value.observations),1)])])]),e("div",lt,[e("div",nt,[e("div",it,[rt,e("div",dt,[ct,c(" "+n(u.value.status.status),1)]),e("div",ut,[pt,c(" "+n($(u.value.status.timestamp)),1)]),e("div",mt,[ht,c(" "+n((g=(a=A.value.filter(h=>{var V;return h.id==((V=u.value.status)==null?void 0:V.responsable)}))==null?void 0:a[0])==null?void 0:g.name),1)]),u.value.status.status=="rechazado"?(H(),q("div",_t,[ft,c(" "+n((S=u.value.status)==null?void 0:S.razones),1)])):pe("",!0)])])])])]),e("div",vt,[l(m,{class:"botonera",style:{width:"min-content"},label:"Imprimir",icon:"pi pi-print",onClick:Q,severity:"help"}),l(m,{class:"botonera",rounded:"",style:{},label:"",icon:"pi pi-times",onClick:t[2]||(t[2]=h=>y.value=!1),severity:"danger"})])]}),_:1},8,["visible"]),l(C,{header:"Confirmacion",visible:j.value,"onUpdate:visible":t[5]||(t[5]=a=>j.value=a),style:{width:"350px"},modal:!0},{default:i(()=>[e("h5",null,"Seguro que desea aceptar el permiso de "+n(b.value.name),1),yt,l(m,{onClick:t[4]||(t[4]=a=>Z(u.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:i(()=>[bt]),_:1}),l(m,{style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:i(()=>[gt]),_:1})]),_:1},8,["visible"]),l(C,{header:"Confirmacion",visible:R.value,"onUpdate:visible":t[8]||(t[8]=a=>R.value=a),style:{width:"350px"},modal:!0},{default:i(()=>[e("h5",null,"Seguro que desea Rechazar el permiso de "+n(b.value.name)+"?",1),wt,l(L,{modelValue:I.value,"onUpdate:modelValue":t[6]||(t[6]=a=>I.value=a),style:{"max-width":"100%","min-width":"100%","min-height":"100px"},class:"col-12"},null,8,["modelValue"]),xt,l(m,{onClick:t[7]||(t[7]=a=>ee(u.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:i(()=>[kt]),_:1}),l(m,{style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:i(()=>[Ct]),_:1})]),_:1},8,["visible"])])}}},zt=oe(St,[["__scopeId","data-v-d2e55022"]]);export{zt as default};
