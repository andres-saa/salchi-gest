import{h as _,U as f,_ as U,r as p,l as B,k as M,i as N,m as O,a as h,o as x,c as T,d as a,w as i,B as E,b as r,X as A,s as j,t as P,u as q,f as k,D,p as F,g as Q}from"./index-a9681f94.js";const g={async getPendientsCancellationRequest(){try{const e=await _.get(`${f}/get_all_cancellation_request_pendients`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async getaceptedCancellationAcepted(){try{const e=await _.get(`${f}/get_all_cancellation_request_acepted`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async getPendientsCancellationRejected(){try{const e=await _.get(`${f}/get_all_cancellation_request_rejected`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async resolveCancellationRequest(e,c){try{const l=await _.put(`${f}/resolve-cancellation/${e}`,c);return l.status===200?l.data:(console.error("An error occurred while fetching the ingredients:",l.status),null)}catch(l){return console.error("An error occurred while fetching the ingredients:",l),null}}};const V=e=>(F("data-v-3f157f7e"),e=e(),Q(),e),X={class:"container"},G=V(()=>r("h3",null,[r("b",null,"Rechazar esta solicitud")],-1)),H=V(()=>r("h3",null,[r("b",null,"Aprobar esta solicitud")],-1)),J={class:"grid",style:{"align-items":"center"}},K={class:"col-12 md:col-6 p-3"},L={class:"text-xl",style:{width:"100%"}},W={style:{"text-transform":"capitalize"}},Y={style:{display:"flex",gap:"0.5rem"}},Z={__name:"cancellationOrderRequestSesion",setup(e){const c=p(!1),l=p([]),m=p(!1),z=B(),n=p({}),y={revisar:g.getPendientsCancellationRequest,aprobadas:g.getaceptedCancellationAcepted,rechazadas:g.getPendientsCancellationRejected},C=(v,t)=>{n.value.id=t,v?m.value=!0:c.value=!0},S=async(v,t,w)=>{const d={authorized:v,responsible_id:z.rawUserData.id,responsible_observation:n.value.reason||"sin observaciones"};await g.resolveCancellationRequest(t,d),m.value=!1,c.value=!1,l.value=await y[o.params.request_status]()},o=M(),b=p();return(()=>{b.value={global:{value:null,matchMode:E.CONTAINS}}})(),N(async()=>{l.value=await y[o.params.request_status]()}),O(()=>o.params.request_status,async()=>{l.value=await y[o.params.request_status]()},{deep:!0}),(v,t)=>{const w=h("Textarea"),d=h("Button"),R=h("Dialog"),u=h("Column"),$=h("DataTable");return x(),T("div",X,[a(R,{visible:c.value,"onUpdate:visible":t[2]||(t[2]=s=>c.value=s),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:i(()=>[G]),default:i(()=>[r("form",{onSubmit:t[1]||(t[1]=A(s=>S(!1,n.value.id,n.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[a(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:n.value.reason,"onUpdate:modelValue":t[0]||(t[0]=s=>n.value.reason=s),rows:"5",placeholder:"Escribe la raz贸n de la cancelaci贸n"},null,8,["modelValue"]),a(d,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),a(R,{visible:m.value,"onUpdate:visible":t[5]||(t[5]=s=>m.value=s),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:i(()=>[H]),default:i(()=>[r("form",{onSubmit:t[4]||(t[4]=A(s=>S(!0,n.value.id,n.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[a(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:n.value.reason,"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.reason=s),rows:"5",placeholder:"Escribe la raz贸n de la cancelaci贸n"},null,8,["modelValue"]),a(d,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),a($,{stripedRows:"",style:{"max-width":"1024px"},filters:b.value,"onUpdate:filters":t[6]||(t[6]=s=>b.value=s),class:"col-12 m-auto",value:l.value,tableStyle:"min-width: 50rem;"},{header:i(()=>[r("div",J,[r("div",K,[r("span",L,[j(" Solicitudes de cancelacion - "),r("span",W,P(q(o).params.request_status.split("-").join(" ")),1)])])])]),default:i(()=>[a(u,{class:"py-1",field:"id",header:"ID"}),a(u,{class:"py-1",field:"site_name",header:"Sede"}),a(u,{class:"py-1",field:"order_id",header:"ID orden"}),a(u,{class:"py-1",field:"reason",header:"Motivo"}),a(u,{class:"py-1",field:"responsible",header:"Quien solicita?"}),a(u,{style:{},class:"py-1 px-0",field:"date",header:"Action"},{body:i(s=>[r("div",Y,[q(o).params.request_status!="aprobadas"?(x(),k(d,{key:0,onClick:I=>C(!0,s.data.id),style:{height:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):D("",!0),q(o).params.request_status!="rechazadas"?(x(),k(d,{key:1,onClick:I=>C(!1,s.data.id),style:{height:"2rem",background:"var(--primary-color)",border:"none"},severity:"danger",class:"p-1",icon:"pi pi-times"},null,8,["onClick"])):D("",!0)])]),_:1})]),_:1},8,["filters","value"])])}}},se=U(Z,[["__scopeId","data-v-3f157f7e"]]);export{se as default};
