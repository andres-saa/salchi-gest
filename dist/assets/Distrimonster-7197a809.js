import{_ as B,g as u,H as J,h as O,o as l,c as h,b as o,f as d,u as t,a as s,x,j as D,F as W,i as M,U as k,cg as c,ch as F,S as w,ci as q,cj as S,t as V,ck as A,p as G,k as H,m as I}from"./index-0a31f2de.js";import{f as C}from"./formatoPesos-8aa989a0.js";const _=b=>(G("data-v-c083183b"),b=b(),H(),b),T={style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",width:"100%"}},X=_(()=>s("h3",null,[s("b",null,"Melo")],-1)),K=_(()=>s("i",{class:"pi pi-check text-7xl",style:{"font-weight":"bold",color:"green"}},null,-1)),L={class:"p-3"},Q={class:"field"},Y=_(()=>s("label",{for:"descuentoMayor"},[s("b",null,"Descuento para Precio Mayor (%)")],-1)),Z={class:"field mt-3"},ee=_(()=>s("label",{for:"descuentoDistribuidor"},[s("b",null,"Descuento para Precio Distribuidor (%)")],-1)),te={class:"flex justify-content-end gap-2 mt-4"},ae={style:{"margin-top":"10rem","max-width":"900px",margin:"10rem auto"},class:"px-3"},se={style:{width:"100%","justify-content":"center",display:"flex"},class:"my-4"},oe=["src"],ie=_(()=>s("h5",null,[I(" ¿No ves algún producto? Prueba "),s("b",null,"Sincronizar la Districarta"),I(" (tardará un poco mientras obtenemos todos los datos de restaurant.PE) "),s("b",null,"2 minutos como máximo.")],-1)),re={style:{display:"flex","justify-content":"end",width:"100%"}},le={class:"m-0 p-0"},ne={class:"m-0 p-0"},de={key:0},ce={key:1,class:"m-0 p-0"},ue={key:0},me={key:1,class:"m-0 p-0"},pe={style:{display:"flex",gap:"1rem","justify-content":"end",margin:"1rem 0"}},ye={__name:"Distrimonster",setup(b){const f=u(!0),p=u(!1),y=u(0),v=u(0),m=u([]),$=u([]),i=u(!1),N=J(()=>JSON.stringify(m.value)!==JSON.stringify($.value)),g=async()=>{var r,a;try{const n=((a=(r=(await M.get(`${k}/get-product-integration-distrimonster`)).data)==null?void 0:r.data)==null?void 0:a.filter(U=>U.categoria_id==107))||[];m.value=n,$.value=JSON.parse(JSON.stringify(n))}catch(e){console.error("Error al actualizar los datos:",e)}},j=()=>{i.value=!1,g()};O(async()=>{g()});const E=async()=>{try{await M.post(`${k}/refresh-cache-distrimonster?quipupos=0`),g()}catch(r){console.error("Error al refrescar la caché:",r)}},P=async()=>{var a;const r={prices:(a=m.value)==null?void 0:a.map(e=>({id:e.id,mayor:parseInt(e.mayor),distribuidor:parseInt(e.distribuidor)}))};try{await M.put(`${k}/update-prices`,r),f.value=!0,i.value=!1,g()}catch(e){console.error("Error al actualizar precios:",e)}},R=()=>{const r=parseInt(y.value,10)||0,a=parseInt(v.value,10)||0;m.value=m.value.map(e=>{const n=e.minor*(1-r/100),U=e.minor*(1-a/100);return{...e,mayor:parseFloat(n.toFixed(0)),distribuidor:parseFloat(U.toFixed(0))}}),p.value=!1,y.value=0,v.value=0},z=()=>{p.value=!1,y.value=0,v.value=0};return(r,a)=>(l(),h(W,null,[o(t(F),{visible:f.value,"onUpdate:visible":a[1]||(a[1]=e=>f.value=e),modal:"",closable:!1,style:{display:"flex","justify-content":"center",width:"10rem"}},{default:d(()=>[s("div",T,[X,K,o(t(c),{onClick:a[0]||(a[0]=e=>f.value=!1),icon:"pi pi-times",style:{position:"absolute","aspect-ratio":"1/1","border-radius":"50%",right:"-1.5rem",top:"-1.5rem"},severity:"danger"})])]),_:1},8,["visible"]),o(t(F),{visible:p.value,"onUpdate:visible":a[4]||(a[4]=e=>p.value=e),modal:"",header:"Modificar precios masivamente",closable:!0,style:{width:"20rem"}},{default:d(()=>[s("div",L,[s("div",Q,[Y,o(t(w),{inputStyle:{width:"100%",height:"2rem",borderRadius:"0"},id:"descuentoMayor",modelValue:y.value,"onUpdate:modelValue":a[2]||(a[2]=e=>y.value=e),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),s("div",Z,[ee,o(t(w),{inputStyle:{width:"100%",height:"2rem",borderRadius:"0"},id:"descuentoDistribuidor",modelValue:v.value,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value=e),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),s("div",te,[o(t(c),{label:"Cancelar",severity:"danger",onClick:z}),o(t(c),{label:"Aplicar",severity:"success",onClick:R})])])]),_:1},8,["visible"]),s("div",ae,[s("div",se,[s("img",{src:`${t(k)}/read-photo-product/iX6UiE6e`,alt:"",style:{height:"5rem",width:"min-content",margin:"auto"}},null,8,oe)]),o(t(q),{class:"p-4",severity:"success"},{default:d(()=>[ie]),_:1}),s("div",re,[o(t(c),{onClick:E,severity:"help",label:"Sincronizar Districarta",class:"my-4"})]),o(t(A),{value:m.value,class:"shadow-1"},{default:d(()=>[o(t(S),{header:"Producto",class:"m-0 py-0"},{body:d(e=>[s("h6",le,V(e.data.productogeneral_descripcion),1)]),_:1}),o(t(S),{header:"Precio base",class:"m-0 py-0 py-2"},{body:d(e=>[s("h6",ne,V(t(C)(e.data.minor)),1)]),_:1}),o(t(S),{header:"Precio Mayor",class:"m-0 py-0"},{body:d(e=>[i.value?(l(),h("div",de,[o(t(w),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.mayor,"onUpdate:modelValue":n=>e.data.mayor=n,mode:"currency",currency:"USD",locale:"en-US",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(l(),h("h6",ce,V(t(C)(e.data.mayor)),1))]),_:1}),o(t(S),{header:"Precio Distribuidor",class:"m-0 py-0"},{body:d(e=>[i.value?(l(),h("div",ue,[o(t(w),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.distribuidor,"onUpdate:modelValue":n=>e.data.distribuidor=n,mode:"currency",currency:"USD",locale:"en-US",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(l(),h("h6",me,V(t(C)(e.data.distribuidor)),1))]),_:1})]),_:1},8,["value"]),s("div",pe,[i.value&&N.value?(l(),x(t(c),{key:0,onClick:P,severity:"success",label:"Guardar cambios"})):D("",!0),i.value?D("",!0):(l(),x(t(c),{key:1,onClick:a[5]||(a[5]=e=>i.value=!0),severity:"info",label:"Editar"})),i.value?(l(),x(t(c),{key:2,onClick:j,severity:"danger",label:"Descartar"})):D("",!0),i.value?(l(),x(t(c),{key:3,onClick:a[6]||(a[6]=e=>p.value=!0),severity:"warning",label:"Modificar Masiva"})):D("",!0)])])],64))}},_e=B(ye,[["__scopeId","data-v-c083183b"]]);export{_e as default};
