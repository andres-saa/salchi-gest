import{f as k}from"./formatoPesos-e824e30b.js";import{a as I,u as H}from"./site-6bfd2350.js";import{ab as F,U as j,B as z,l as K,_ as Q,j as U,G as W,k as X,H as Y,r as C,o as n,c as _,a as e,F as O,b as R,t as d,h as $,u as t,i as x,n as Z,g as v,f as S,e as A,q as ee,x as te}from"./index-3b25a85f.js";import{u as M}from"./ventas-93316357.js";import{u as J}from"./user-ae2c339d.js";const b=M(),h=I(),N=H(),l=J(),q=()=>{var L,P,i,c,D,V;l.user.was_reserva=!1,h.sending_order=!0;const o=h.cart,r=K(),s=N.location.site.site_id,u=N.location.site.pe_site_id,m=(L=l.user.payment_method_option)==null?void 0:L.id,a=(P=l.user.order_type)==null?void 0:P.id;if(!a){alert("Error: Debe seleccionar un método de entrega.");return}const g=l.user.placa,f=m===7?0:N.location.neigborhood.delivery_price;if(a===2&&s===33&&(!g||g.trim()==="")){alert("Error: Debe proporcionar la placa del vehículo para recogida.");return}let y=((i=h==null?void 0:h.cart)==null?void 0:i.order_notes)??"";const T={user_name:l.user.name,user_phone:(c=l.user.phone_number)==null?void 0:c.split(" ").join(""),user_address:` ${l.user.address} ${(V=(D=N.location)==null?void 0:D.neigborhood)==null?void 0:V.name}`||"",email:l.user.email};return{order_products:[],site_id:s,pe_site_id:u,order_type_id:a,placa:g,delivery_person_id:4,payment_method_id:m,delivery_price:f,order_notes:y||"SIN NOTAS",user_data:T,order_aditionals:[],pe_json:o,total:0,inserted_by:r.rawUserData.id}},oe=()=>{var g,f;l.user.was_reserva=!0,h.sending_order=!0;const o=h.cart.products.map(p=>({product_instance_id:p.product.id,quantity:p.quantity})),r=N.location.siteReservas.site_id,s=(g=l.user.payment_method_option)==null?void 0:g.id,u=h.cart.order_notes,m={user_name:l.user.name,user_phone:(f=l.user.phone_number)==null?void 0:f.split(" ").join(""),user_address:"Debe ir a la sede",email:l.user.email};return{order_products:o,site_id:r,delivery_person_id:4,payment_method_id:s,delivery_price:0,order_notes:u||"SIN NOTAS",user_data:m,order_aditionals:[]}},E={async sendOrder(){const o=q(),r=I();if(!G(o))return r.sending_order=!1,null;try{b.setLoading(!0,`enviando tu pedido ${l.user.name}`);const s=await F.post(`${j}/order`,o);if(s.status===200)r.sending_order=!1,r.last_order=s.data,b.setLoading(!0,"enviando tu pedido"),z.push("/call-center-vender/gracias");else return console.error("An error occurred while sending the order:",s.status),alert("An error occurred while sending the order. Please try again."),b.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,null}catch(s){return console.error("An error occurred while sending the order:",s),b.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),r.sending_order=!1,null}},preparar_orden(){q()},async sendOrderReserva(){const o=oe(),r=I();if(l.user.was_reserva=!0,!G(o))return r.sending_order=!1,null;try{b.setLoading(!0,`enviando tu pedido ${l.user.name}`);const s=await F.post(`${j}/order`,o);if(s.status===200)r.sending_order=!1,r.last_order=s.data,b.setLoading(!1,"enviando tu pedido"),z.push("/gracias");else return console.error("An error occurred while sending the order:",s.status),alert("An error occurred while sending the order. Please try again."),b.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,null}catch(s){return console.error("An error occurred while sending the order:",s),b.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),r.sending_order=!1,null}}};function G(o){return!o.user_data.user_name||o.user_data.user_name.trim()==""||!o.user_data.user_phone||o.user_data.user_phone.trim()==""||!o.user_data.user_address||o.user_data.user_address.trim()==""||o.user_data.email.trim()==""?(alert("Sus datos estan incompletos por favor reviselos"),h.sending_order=!1,!1):!o.site_id||o.delivery_price==null?(alert("Site information is missing. Please select a valid site."),h.sending_order=!1,!1):!0}const w=o=>(ee("data-v-73e00d2e"),o=o(),te(),o),re={class:"43f1 43f5 md:43f0 43f12"},se={class:"sticky-summary 43f12 43f3 43f0"},ne=w(()=>e("h5",null,[e("b",null,"Resumen")],-1)),ae=w(()=>e("h5",null,[e("b",null,"productos")],-1)),ie={class:"43f0 43f0 product-line"},de={class:"43f6 43f2 43f0 43f0"},le={class:"43f0"},ce={class:"span-minwidth"},ue={style:{"font-weight":"400"}},_e={style:{"margin-right":".5rem"}},pe={class:"font-weight-400"},he={class:"43f6 43f0 text-right 43f2"},me={key:0,class:"text-end"},fe={key:1,class:"text-end"},be={class:"addition-ite43finner"},ge={class:"text adicion"},ye={key:0,class:"pl-2 text-sm"},ve=w(()=>e("hr",{class:"43f0 43f2"},null,-1)),we={class:"grid summary-grid"},ke=w(()=>e("div",{class:"col-6 my-0 py-0"},[e("span",null,[e("b",null,"Subtotal")])],-1)),xe={class:"col-6 my-0 text-right py-0 text-right text-end",style:{}},Se={class:"col-6 my-0 py-0"},Le=w(()=>e("b",null,"Domicilio",-1)),Pe=[Le],Ae={class:"col-6 my-0 text-right py-0 text-end"},Ne={key:0,class:"primary-color"},Ie=w(()=>e("div",{class:"col-6 my-0 py-0"},[e("span",null,[e("b",null,"Total")])],-1)),Te={key:0,class:"col-6 my-0 text-right py-0 text-end"},Be=w(()=>e("div",null,null,-1)),Ce={__name:"resumen",setup(o){const r=M(),s=U(!1),u=W(),m=I(),a=H();return J(),U({}),X(()=>{}),Y(()=>m.cart.additions,()=>{update()},{deep:!0}),(g,f)=>{var B,L,P;const p=C("Button"),y=C("router-link"),T=C("Tag");return n(),_("div",re,[e("div",se,[ne,ae,(n(!0),_(O,null,R(t(m).cart,i=>(n(),_("div",{key:i.productogeneral_id},[e("div",ie,[e("div",de,[e("h6",le,[e("span",ce,"( "+d(i.pedido_cantidad)+" ) ",1),e("span",ue,d(i.pedido_nombre_producto),1)]),(n(!0),_(O,null,R(i.lista_productocombo,c=>(n(),_("h6",{class:"43f0 43f3",style:{"margin-left":"1rem"},key:c.producto_id},[$(" ( "+d(i.pedido_cantidad)+" ) ",1),e("b",_e,d(parseInt(c.pedido_cantidad)),1),e("span",pe,d(c.pedido_nombre),1)]))),128))]),e("div",he,[i.modificadorseleccionList.length<1?(n(),_("h6",me,d(t(k)(i.pedido_precio*i.pedido_cantidad)),1)):(n(),_("h6",fe,d(t(k)(i.pedido_base_price*i.pedido_cantidad)),1))])]),(n(!0),_(O,null,R(i.modificadorseleccionList,c=>(n(),_("div",{class:"addition-item",key:c},[e("div",be,[e("span",ge,[e("span",null,[e("b",null,"- ( "+d(i.pedido_cantidad)+" ) "+d(c.modificadorseleccion_cantidad),1)]),$(" "+d(c.modificadorseleccion_nombre),1)]),c.pedido_precio>0?(n(),_("span",ye,[e("b",null,d(t(k)(c.pedido_precio*c.modificadorseleccion_cantidad*i.pedido_cantidad)),1)])):x("",!0)])]))),128))]))),128)),ve,e("div",we,[ke,e("div",xe,[e("span",null,[e("b",null,d(t(k)(t(m).cartTotal)),1)])]),e("div",Se,[e("span",{style:Z(t(a).location.neigborhood.delivery_price==0?"text-decoration: line-through;":"")},Pe,4)]),e("div",Ae,[t(a).location.neigborhood.delivery_price===0&&t(a).location.site.site_id!=33?(n(),_("span",Ne,[e("b",null,d(t(u).path.includes("reservas")?"Ir a la sede":"$0"),1)])):x("",!0),e("span",null,[e("b",null,d(t(k)(t(a).location.neigborhood.delivery_price)),1)])]),Ie,t(a).location.neigborhood.delivery_price||t(a).location.neigborhood.delivery_price===0?(n(),_("div",Te,[e("span",null,[e("b",null,d(t(k)(t(m).cartTotal+t(a).location.neigborhood.delivery_price)),1)])])):x("",!0)]),t(u).path.includes("cart")?(n(),v(y,{key:0,to:"/call-center-vender"},{default:S(()=>[A(p,{outlined:"",icon:"pi pi-shopping-cart",label:"Volver al menu'",class:"43f4 button-common button-transparent button-fullwidth button-bold",severity:"danger"})]),_:1})):t(u).path!="/reservas"?(n(),v(y,{key:1,to:"/call-center-vender/cart"},{default:S(()=>[A(p,{outlined:"",icon:"pi pi-arrow-left",label:"Volver al carrito",class:"43f4 button-common button-transparent button-fullwidth button-bold",severity:"danger"})]),_:1})):x("",!0),((B=t(a).status)==null?void 0:B.status)=="closed"&&t(u).path!="/reservas"?(n(),v(T,{key:2,class:"43f2 tag-fullheight",severity:"danger"},{default:S(()=>[$(" Cerrado, abre a las "+d(t(a).status.next_opening_time),1)]),_:1})):x("",!0),Be,t(u).path.includes("cart")?(n(),v(y,{key:3,to:"/call-center-vender/pay"},{default:S(()=>[A(p,{iconPos:"right",icon:"pi pi-arrow-right",label:"Pedir",class:"43f2 button-common button-black button-fullwidth button-bold button-no-border button-no-outline",severity:"help"})]),_:1})):t(u).path.includes("reservas")?(n(),v(y,{key:4,to:"/pay"},{default:S(()=>[A(p,{onClick:f[0]||(f[0]=()=>{t(E).sendOrderReserva(),s.value=!0}),iconPos:"right",icon:"pi pi-arrow-right",label:"Finalizar pedido",class:"43f2 button-common button-black button-fullwidth button-bold button-no-border button-no-outline",severity:"help"})]),_:1})):((L=t(a).status)==null?void 0:L.status)!=="closed"&&((P=t(a).status)!=null&&P.status)&&t(u).path=="/cart"?(n(),v(y,{key:5,to:"/pay"},{default:S(()=>[A(p,{iconPos:"right",icon:"pi pi-arrow-right",label:"Finalizar pedido",class:"43f2 button-common button-black button-fullwidth button-bold button-no-border button-no-outline",severity:"help"})]),_:1})):t(u).path=="/call-center-vender/pay"&&!t(r).loading.visible?(n(),v(p,{key:6,disabled:t(r).loading.visible,onClick:f[1]||(f[1]=()=>{t(E).sendOrder(),s.value=!0}),iconPos:"right",icon:"pi pi-arrow-right",label:"Finalizar pedido",class:"43f2 button-common button-black button-fullwidth button-bold button-no-border button-no-outline",severity:"help"},null,8,["disabled"])):x("",!0)])])}}},Fe=Q(Ce,[["__scopeId","data-v-73e00d2e"]]);export{Fe as r};
