import{_ as te,G as se,l as le,y as oe,j as p,z as re,H as G,k as ie,r as b,o as g,c as ne,e as s,f as l,a as t,d as X,n as J,A as de,av as L,m as K,U as Q,N as O,h as u,t as v,u as d,p as w,g as C,i as T,q as ce,x as ue}from"./index-bc571c19.js";import{D as pe}from"./DialogoPedido-ba74e705.js";import{e as W}from"./formatDate-262296cf.js";import"./formatoPesos-2293ab52.js";/* empty css                                                                      */const _=S=>(ce("data-v-50394eac"),S=S(),ue(),S),ve={class:"container",style:{"margin-top":"7rem"}},me=_(()=>t("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"6rem"}},[t("i",{class:"fa-solid fa-truck-arrow-right"}),u(" Pedidos pendidentes ")],-1)),_e=_(()=>t("h3",null,[t("b",null,"Rechazar orden")],-1)),ye=_(()=>t("h3",null,[t("b",null,"Aprobar esta orden")],-1)),fe=_(()=>t("h3",null,[t("b",null,"Archivar pedido")],-1)),he={style:{display:"flex",gap:".5rem"}},be={style:{"max-width":"1280px"},class:"mx-auto"},ge={class:"nav-bar"},we={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},xe={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},ke=_(()=>t("div",{class:"col-12 md:col-6 p-3"},[t("span",{class:"text-xl",style:{width:"100%"}}," Pedidos pendientes de validación ")],-1)),Pe={class:"md:mt-0 p-input-icon-right m-3"},Ce=_(()=>t("i",{class:"pi pi-search"},null,-1)),Te={style:{display:"flex",gap:"0.5rem"}},Se={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},Ve=_(()=>t("h4",{class:"px-2 m-0"},[t("i",{class:"fa-regular fa-circle-xmark"}),t("b",null,"Pedidos rechazados (cliente no confirma)")],-1)),De={class:"p-input-icon-right m-3"},ze=_(()=>t("i",{class:"pi pi-search"},null,-1)),Re={style:{display:"flex",gap:"0.5rem"}},$e={__name:"ValidateSection",setup(S){const h=se(),M=le(),D=oe(),z=p(!1),x=p(!1),N=p([]),U=p([]),k=p(!1),R=p({order_id:null}),m=p(),j=()=>{m.value={global:{value:null,matchMode:de.CONTAINS}}};j();const I=p([{index:1,slide:0,name:"pendientes"},{index:2,slide:-100,name:"rechazadas"}]),P=p(I.value[0]),A=async o=>{const a=I.value.find(V=>V.index===o);a&&(P.value=a,o===2?await $():await y())},B=o=>{D.setVisible("currentOrder",!0),D.setOrder(o)},E=o=>{x.value=!0,f.value.order_id=o},Y=o=>{R.value.order_id=o,k.value=!0},Z=async o=>{const a=M.rawUserData.id;await L.aproveOrder(o,a),x.value=!1,await y()},ee=async o=>{try{await K.put(`${Q}/reject_order_cliente_no_confirma/`,{order_id:o}),k.value=!1,await y(),await $()}catch(a){console.error("Error archivando pedido:",a)}},y=async()=>{N.value=await L.getOrdersValidate()},$=async()=>{try{const o=await K.get(`${Q}/order-to-transfer-no-confirmed`);U.value=o||[]}catch(o){console.error("Error cargando rechazadas:",o)}},f=p({}),ae=async(o,a,V)=>{const n={authorized:o,responsible_id:M.rawUserData.id,responsible_observation:f.value.reason||"sin observaciones"};await L.resolveCancellationRequest(a,n),x.value=!1,z.value=!1,await y()};return re(()=>{j()}),G(()=>D.numberOders,async()=>{await y()}),G(()=>h.params.request_status,async()=>{await y()},{deep:!0}),ie(async()=>{await y(),await $()}),(o,a)=>{const V=b("Textarea"),n=b("Button"),q=b("Dialog"),H=b("InputText"),r=b("Column"),F=b("DataTable");return g(),ne("div",ve,[me,s(q,{visible:z.value,"onUpdate:visible":a[2]||(a[2]=e=>z.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[_e]),default:l(()=>[t("form",{onSubmit:a[1]||(a[1]=O(e=>ae(!1,f.value.id,f.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(V,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:f.value.reason,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),s(n,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),s(q,{visible:x.value,"onUpdate:visible":a[4]||(a[4]=e=>x.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[ye]),default:l(()=>[t("form",{onSubmit:a[3]||(a[3]=O(e=>Z(f.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(n,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (usuario contactado)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),s(q,{visible:k.value,"onUpdate:visible":a[7]||(a[7]=e=>k.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[fe]),default:l(()=>[t("form",{onSubmit:a[6]||(a[6]=O(e=>ee(R.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column"}},[t("p",null,[u(" ¿Seguro que deseas archivar el pedido "),t("b",null,v(R.value.order_id),1),u("? Esta acción no intentará cobrar al cliente. ")]),t("div",he,[s(n,{type:"button",label:"Cancelar",class:"w-full p-button-secondary",onClick:a[5]||(a[5]=e=>k.value=!1)}),s(n,{type:"submit",label:"Archivar pedido",class:"w-full p-button-danger"})])],32)]),_:1},8,["visible"]),t("div",be,[t("div",ge,[t("ul",null,[t("li",null,[s(n,{class:X(["nav-var--item-button",P.value.index===1?"nav-var--item-button-selected":""]),onClick:a[8]||(a[8]=e=>A(1)),label:"Pendientes"},null,8,["class"])]),t("li",null,[s(n,{class:X(["nav-var--item-button",P.value.index===2?"nav-var--item-button-selected":""]),onClick:a[9]||(a[9]=e=>A(2)),label:"Rechazadas"},null,8,["class"])])])]),t("div",we,[t("div",{style:J(`transform:translateX(${P.value.slide}%)`),class:"slider-item"},[s(F,{paginator:!0,rows:15,filters:m.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"","onUpdate:filters":a[11]||(a[11]=e=>m.value=e),class:"col-12 m-auto",value:N.value,tableStyle:"min-width: 50rem;"},{header:l(()=>[t("div",xe,[ke,t("span",Pe,[Ce,s(H,{modelValue:m.value.global.value,"onUpdate:modelValue":a[10]||(a[10]=e=>m.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:l(()=>[s(r,{class:"py-1",field:"order_id",header:"ID orden",frozen:""}),s(r,{class:"py-1",field:"total_order_price",header:"Monto de la orden"},{body:l(e=>[u(v(d(w)(e.data.total_order_price)),1)]),_:1}),s(r,{class:"py-1",field:"Hora",header:"Hora"},{body:l(e=>[u(v(d(W)(e.data.latest_status_timestamp)),1)]),_:1}),s(r,{class:"py-1",field:"delivery_price",header:"Domicilio"},{body:l(e=>{var i,c;return[u(v(d(w)((c=(i=e.data.pe_json)==null?void 0:i.delivery)==null?void 0:c.delivery_costoenvio)),1)]}),_:1}),s(r,{class:"py-1",field:"Total",header:"Total"},{body:l(e=>{var i,c;return[u(v(d(w)((((c=(i=e.data.pe_json)==null?void 0:i.delivery)==null?void 0:c.delivery_costoenvio)||0)+(e.data.total_order_price||0))),1)]}),_:1}),s(r,{class:"py-1",field:"user_name",header:"Cliente"}),s(r,{class:"py-1",field:"user_phone",header:"Teléfono cliente"}),s(r,{style:{"max-width":"10rem"},class:"py-1",field:"order_notes",header:"Notas"}),s(r,{class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:l(e=>[t("div",Te,[d(h).params.request_status!="aprobadas"?(g(),C(n,{key:0,onClick:i=>B(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):T("",!0),d(h).params.request_status!="aprobadas"?(g(),C(n,{key:1,onClick:i=>E(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):T("",!0),d(h).params.request_status!="aprobadas"?(g(),C(n,{key:2,onClick:i=>Y(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"danger",class:"p-1",icon:"pi pi-trash"},null,8,["onClick"])):T("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),t("div",{style:J(`transform:translateX(${P.value.slide}%)`),class:"slider-item"},[s(F,{paginator:!0,rows:15,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords}",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:U.value,tableStyle:"min-width: 50rem;",filters:m.value},{header:l(()=>[t("div",Se,[Ve,t("span",De,[ze,s(H,{modelValue:m.value.global.value,"onUpdate:modelValue":a[12]||(a[12]=e=>m.value.global.value=e),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:l(()=>[s(r,{class:"py-1",field:"order_id",header:"ID orden",frozen:""}),s(r,{class:"py-1",field:"total_order_price",header:"Monto de la orden"},{body:l(e=>[u(v(d(w)(e.data.total_order_price)),1)]),_:1}),s(r,{class:"py-1",field:"Hora",header:"Hora"},{body:l(e=>[u(v(d(W)(e.data.latest_status_timestamp)),1)]),_:1}),s(r,{class:"py-1",field:"delivery_price",header:"Domicilio"},{body:l(e=>{var i,c;return[u(v(d(w)((c=(i=e.data.pe_json)==null?void 0:i.delivery)==null?void 0:c.delivery_costoenvio)),1)]}),_:1}),s(r,{class:"py-1",field:"Total",header:"Total"},{body:l(e=>{var i,c;return[u(v(d(w)((((c=(i=e.data.pe_json)==null?void 0:i.delivery)==null?void 0:c.delivery_costoenvio)||0)+(e.data.total_order_price||0))),1)]}),_:1}),s(r,{class:"py-1",field:"user_name",header:"Cliente"}),s(r,{class:"py-1",field:"user_phone",header:"Teléfono cliente"}),s(r,{style:{"max-width":"10rem"},class:"py-1",field:"order_notes",header:"Notas"}),s(r,{class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:l(e=>[t("div",Re,[d(h).params.request_status!="aprobadas"?(g(),C(n,{key:0,onClick:i=>B(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):T("",!0),d(h).params.request_status!="aprobadas"?(g(),C(n,{key:1,onClick:i=>E(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):T("",!0)])]),_:1})]),_:1},8,["value","filters"])],4)])]),s(pe)])}}},Ue=te($e,[["__scopeId","data-v-50394eac"]]);export{Ue as default};
