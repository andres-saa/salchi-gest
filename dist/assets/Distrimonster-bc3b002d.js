import{_ as J,h as u,H as O,i as P,o as i,c as m,b as o,f as d,u as t,a as s,e as w,k as V,F as K,j as M,U as S,cf as c,cg as $,T as f,ch as W,ci as b,t as g,cj as q,p as T,m as A,q as I}from"./index-4d808e00.js";import{f as C}from"./formatoPesos-8aa989a0.js";const x=k=>(T("data-v-e7126458"),k=k(),A(),k),G={style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",width:"100%"}},H=x(()=>s("h3",null,[s("b",null,"Melo")],-1)),X=x(()=>s("i",{class:"pi pi-check text-7xl",style:{"font-weight":"bold",color:"green"}},null,-1)),L={class:"p-3"},Q={class:"field"},Y=x(()=>s("label",{for:"descuentoMayor"},[s("b",null,"Descuento para Precio Mayor (%)")],-1)),Z={class:"field mt-3"},ee=x(()=>s("label",{for:"descuentoDistribuidor"},[s("b",null,"Descuento para Precio Distribuidor (%)")],-1)),te={class:"flex justify-content-end gap-2 mt-4"},ae={style:{"margin-top":"10rem","max-width":"900px",margin:"10rem auto"},class:"px-3"},se={style:{width:"100%","justify-content":"center",display:"flex"},class:"my-4"},oe=["src"],ie=x(()=>s("h5",null,[I(" ¿No ves algún producto? Prueba "),s("b",null,"Sincronizar la Districarta"),I(" (tardará un poco mientras obtenemos todos los datos de restaurant.PE) "),s("b",null,"2 minutos como máximo.")],-1)),re={style:{display:"flex","justify-content":"end",width:"100%"}},le={class:"m-0 p-0"},ne={class:"m-0 p-0"},de={key:0},ce={key:1,class:"m-0 p-0"},ue={key:0},me={key:1,class:"m-0 p-0"},pe={key:0},ye={key:1,class:"m-0 p-0"},ve={style:{display:"flex",gap:"1rem","justify-content":"end",margin:"1rem 0"}},he={__name:"Distrimonster",setup(k){const y=u(!1),v=u(!1),h=u(0),_=u(0),p=u([]),F=u([]),r=u(!1),N=O(()=>JSON.stringify(p.value)!==JSON.stringify(F.value)),D=async()=>{var n,a;try{const l=((a=(n=(await M.get(`${S}/get-product-integration-distrimonster`)).data)==null?void 0:n.data)==null?void 0:a.filter(U=>U.categoria_id==107))||[];p.value=l,F.value=JSON.parse(JSON.stringify(l))}catch(e){console.error("Error al actualizar los datos:",e)}},j=()=>{r.value=!1,D()};P(async()=>{D()});const E=async()=>{try{await M.post(`${S}/refresh-cache-distrimonster?quipupos=0`),D(),y.value=!0}catch(n){console.error("Error al refrescar la caché:",n)}},R=async()=>{var a;const n={prices:(a=p.value)==null?void 0:a.map(e=>({id:e.id,mayor:parseInt(e.mayor),distribuidor:parseInt(e.distribuidor),kilos:e.kilos}))};try{await M.put(`${S}/update-prices`,n),y.value=!0,r.value=!1,D()}catch(e){console.error("Error al actualizar precios:",e)}},z=()=>{const n=parseInt(h.value,10)||0,a=parseInt(_.value,10)||0;p.value=p.value.map(e=>{const l=e.minor*(1-n/100),U=e.minor*(1-a/100);return{...e,mayor:parseFloat(l.toFixed(0)),distribuidor:parseFloat(U.toFixed(0))}}),v.value=!1,h.value=0,_.value=0},B=()=>{v.value=!1,h.value=0,_.value=0};return(n,a)=>(i(),m(K,null,[o(t($),{visible:y.value,"onUpdate:visible":a[1]||(a[1]=e=>y.value=e),modal:"",closable:!1,style:{display:"flex","justify-content":"center",width:"10rem"}},{default:d(()=>[s("div",G,[H,X,o(t(c),{onClick:a[0]||(a[0]=e=>y.value=!1),icon:"pi pi-times",style:{position:"absolute","aspect-ratio":"1/1","border-radius":"50%",right:"-1.5rem",top:"-1.5rem"},severity:"danger"})])]),_:1},8,["visible"]),o(t($),{visible:v.value,"onUpdate:visible":a[4]||(a[4]=e=>v.value=e),modal:"",header:"Modificar precios masivamente",closable:!0,style:{width:"20rem"}},{default:d(()=>[s("div",L,[s("div",Q,[Y,o(t(f),{inputStyle:{width:"100%",height:"2rem",borderRadius:"0"},id:"descuentoMayor",modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=e=>h.value=e),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),s("div",Z,[ee,o(t(f),{inputStyle:{width:"100%",height:"2rem",borderRadius:"0"},id:"descuentoDistribuidor",modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=e=>_.value=e),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),s("div",te,[o(t(c),{label:"Cancelar",severity:"danger",onClick:B}),o(t(c),{label:"Aplicar",severity:"success",onClick:z})])])]),_:1},8,["visible"]),s("div",ae,[s("div",se,[s("img",{src:`${t(S)}/read-photo-product/iX6UiE6e`,alt:"",style:{height:"5rem",width:"min-content",margin:"auto"}},null,8,oe)]),o(t(W),{class:"p-4",severity:"success"},{default:d(()=>[ie]),_:1}),s("div",re,[o(t(c),{onClick:E,severity:"help",label:"Sincronizar Districarta",class:"my-4"})]),o(t(q),{value:p.value,class:"shadow-1"},{default:d(()=>[o(t(b),{header:"Producto",class:"m-0 py-0"},{body:d(e=>[s("h6",le,g(e.data.productogeneral_descripcion),1)]),_:1}),o(t(b),{header:"Precio base",class:"m-0 py-0 py-2"},{body:d(e=>[s("h6",ne,g(t(C)(e.data.minor)),1)]),_:1}),o(t(b),{header:"Precio Mayor",class:"m-0 py-0"},{body:d(e=>[r.value?(i(),m("div",de,[o(t(f),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.mayor,"onUpdate:modelValue":l=>e.data.mayor=l,mode:"currency",currency:"USD",locale:"en-US",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(i(),m("h6",ce,g(t(C)(e.data.mayor)),1))]),_:1}),o(t(b),{header:"Precio Distribuidor",class:"m-0 py-0"},{body:d(e=>[r.value?(i(),m("div",ue,[o(t(f),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.distribuidor,"onUpdate:modelValue":l=>e.data.distribuidor=l,mode:"currency",currency:"USD",locale:"en-US",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(i(),m("h6",me,g(t(C)(e.data.distribuidor)),1))]),_:1}),o(t(b),{header:"Kilos",class:"m-0 py-0"},{body:d(e=>[r.value?(i(),m("div",pe,[o(t(f),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.kilos,"onUpdate:modelValue":l=>e.data.kilos=l,suffix:" Kg",locale:"en-US",min:"0",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(i(),m("h6",ye,g(e.data.kilos)+" Kg ",1))]),_:1})]),_:1},8,["value"]),s("div",ve,[r.value&&N.value?(i(),w(t(c),{key:0,onClick:R,severity:"success",label:"Guardar cambios"})):V("",!0),r.value?V("",!0):(i(),w(t(c),{key:1,onClick:a[5]||(a[5]=e=>r.value=!0),severity:"info",label:"Editar"})),r.value?(i(),w(t(c),{key:2,onClick:j,severity:"danger",label:"Descartar"})):V("",!0),r.value?(i(),w(t(c),{key:3,onClick:a[6]||(a[6]=e=>v.value=!0),severity:"warning",label:"Modificar Masiva"})):V("",!0)])])],64))}},be=J(he,[["__scopeId","data-v-e7126458"]]);export{be as default};
