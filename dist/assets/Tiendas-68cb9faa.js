import{_ as F,j as l,k as S,m as b,U as d,I as U,r as V,o as y,c as x,e as o,f,u as t,a as e,F as B,b as E,t as O,a1 as _,a5 as $,ah as M,a3 as z,q as A,x as J,h as L}from"./index-bc571c19.js";const r=m=>(A("data-v-c4c7fd42"),m=m(),J(),m),T={class:"page-wrap theme-gray px-2 md:px-4 xl:px-6 mt-7"},j={class:"success-body"},q={class:"success-title"},P=r(()=>e("i",{class:"pi pi-check success-icon"},null,-1)),W={class:"p-3 form-grid-vertical"},K={class:"field"},G=r(()=>e("label",{for:"descuentoMayor"},[e("b",null,"Descuento para Precio Mayor (%)")],-1)),H={class:"field"},Q=r(()=>e("label",{for:"descuentoDistribuidor"},[e("b",null,"Descuento para Precio Distribuidor (%)")],-1)),X={class:"actions-row"},Y={class:"brands card-block"},Z={class:"brands-row"},ee=["src"],se=["src"],ae=["src"],te=r(()=>e("img",{src:"https://restaurant.pe/assets/images/logo-header.svg",alt:"logo"},null,-1)),oe=r(()=>e("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/85/WhatsApp_Business_icon.png/169px-WhatsApp_Business_icon.png",alt:"logo"},null,-1)),ie=r(()=>e("h5",{class:"m-0"},[e("b",null,"Sincronizar las cartas"),L(" — ¿Cómo funciona? El servidor principal ejecuta un script que toma la carta de restaurant.pe y descarga contenido nuevo (incluyendo fotos). Así servimos el menú desde nuestro servidor (más rápido) sin consultar cada vez a restaurant.pe. "),e("b",null,"Esta tarea debería tomar máximo 2 minutos.")],-1)),le={class:"actions-row"},ce={class:"card-block"},re={class:"chips-grid"},ne=r(()=>e("i",{class:"pi pi-map-marker chip-icon"},null,-1)),de={class:"route-outlet"},ue={__name:"Tiendas",setup(m){const k=l([]);S(async()=>{k.value=await b.get(`${d}/sites`)});const v=l(!1),h=l(!1),u=l(0),p=l(0),g=l([]),w=l([]);l(!1),U(()=>JSON.stringify(g.value)!==JSON.stringify(w.value));const C=async()=>{var i,a;try{const n=((a=(i=(await b.get(`${d}/get-product-integration-distrimonster`)).data)==null?void 0:i.data)==null?void 0:a.filter(s=>s.categoria_id==107))||[];g.value=n,w.value=JSON.parse(JSON.stringify(n))}catch(c){console.error("Error al actualizar los datos:",c)}};S(async()=>{C()});const D=l(""),I=async()=>{try{const i=await b.get(`${d}/tiendas/refresh_all`);D.value=i,v.value=!0}catch(i){console.error("Error al refrescar la caché:",i)}},N=()=>{const i=parseInt(u.value,10)||0,a=parseInt(p.value,10)||0;g.value=g.value.map(c=>{const n=c.minor*(1-i/100),s=c.minor*(1-a/100);return{...c,mayor:parseFloat(n.toFixed(0)),distribuidor:parseFloat(s.toFixed(0))}}),h.value=!1,u.value=0,p.value=0},R=()=>{h.value=!1,u.value=0,p.value=0};return(i,a)=>{const c=V("RouterLink"),n=V("RouterView");return y(),x("div",T,[o(t($),{visible:v.value,"onUpdate:visible":a[1]||(a[1]=s=>v.value=s),modal:"",closable:!1,draggable:!1,class:"success-dialog"},{default:f(()=>{var s;return[e("div",j,[e("h3",q,[e("b",null,O((s=D.value)==null?void 0:s.message),1)]),P,o(t(_),{onClick:a[0]||(a[0]=pe=>v.value=!1),icon:"pi pi-times",class:"success-close",severity:"danger",text:""})])]}),_:1},8,["visible"]),o(t($),{visible:h.value,"onUpdate:visible":a[4]||(a[4]=s=>h.value=s),modal:"",header:"Modificar precios masivamente",closable:!0,draggable:!1,class:"mass-dialog"},{default:f(()=>[e("div",W,[e("div",K,[G,o(t(M),{inputStyle:{width:"100%",height:"2.25rem",borderRadius:"0"},id:"descuentoMayor",modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=s=>u.value=s),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),e("div",H,[Q,o(t(M),{inputStyle:{width:"100%",height:"2.25rem",borderRadius:"0"},id:"descuentoDistribuidor",modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=s=>p.value=s),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),e("div",X,[o(t(_),{label:"Cancelar",severity:"danger",onClick:R,icon:"pi pi-times",text:""}),o(t(_),{label:"Aplicar",severity:"success",onClick:N,icon:"pi pi-check"})])])]),_:1},8,["visible"]),e("section",Y,[e("div",Z,[e("img",{style:{},src:`${t(d)}/read-photo-product/xai0dVnL`,alt:"logo"},null,8,ee),e("img",{style:{filter:"grayscale(1)"},src:`${t(d)}/read-photo-product/a1roeK3y`,alt:"logo"},null,8,se),e("img",{style:{filter:"grayscale(1)"},src:`${t(d)}/read-photo-product/mm9Ohnu7`,alt:"logo"},null,8,ae),te,oe]),o(t(z),{class:"info-tag p-4"},{default:f(()=>[ie]),_:1}),e("div",le,[o(t(_),{onClick:I,severity:"help",style:{"background-color":"black",color:"white"},label:"Sincronizar las cartas",icon:"pi pi-refresh"})])]),e("section",ce,[e("div",re,[(y(!0),x(B,null,E(k.value.filter(s=>s.show_on_web),s=>(y(),x("div",{key:s.site_id||s.site_name,class:"chip"},[o(c,{"active-class":"active","exact-active-class":"full-active",to:`/tiendas/site/${s.pe_site_id}/${s.site_name}`,class:"chip-link"},{default:f(()=>[ne,o(t(_),{label:s.site_name,text:"",class:"chip-btn"},null,8,["label"])]),_:2},1032,["to"])]))),128))])]),e("section",de,[o(n)])])}}},me=F(ue,[["__scopeId","data-v-c4c7fd42"]]);export{me as default};
