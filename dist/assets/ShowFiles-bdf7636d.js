import{_ as fe,c6 as ve,f as r,x as _e,u as he,B as ge,h as K,g as we,r as f,o as I,c as O,d as a,w as i,a as o,F as Q,U as p,l as C,c7 as S,b as be,t as D,k as R,c1 as W,bV as X,q as xe,n as Ce,p as ke,e as Ee}from"./index-567bc661.js";import{b as $e}from"./dropDownAux-6dc2b3e0.js";import{u as Y}from"./sendFileService-24814be6.js";/* empty css                                                                  */const n=V=>(ke("data-v-7595db92"),V=V(),Ee(),V),Te=n(()=>o("h3",null,"Tipos de archivo",-1)),Se=n(()=>o("p",{class:"text-xl",style:{"font-weight":"bold"},for:"type_name"},"Nuevo",-1)),De={class:"col-12 p-0",style:{display:"flex","justify-content":"end"}},Ve=n(()=>o("p",{class:"text-xl my-4",style:{"font-weight":"bold"},for:"type_name"},"Editar exixtentes",-1)),Ne={class:"col-12 p-0",style:{display:"flex",gap:"1rem","justify-content":"space-between"}},Pe=n(()=>o("i",{class:"fa-solid fa-trash-can text-2xl"},null,-1)),je=n(()=>o("div",null,null,-1)),Le={class:"col-12 p-0 m-auto",style:{}},Ue={class:""},ze={class:"col-12 p-0",style:{display:"flex","justify-content":"end"}},Ie={class:"mt-4 col-12 md:col-6 xl:col-4 p-0",style:{display:"flex","max-width":"35rem","justify-content":"end",gap:"1rem"}},Oe=n(()=>o("i",{class:"fa-solid fa-plus mr-2 text-2xl"},null,-1)),Re=n(()=>o("i",{class:"fa-solid fa-file mr-2 text-2xl"},null,-1)),Ae=n(()=>o("i",{class:"fa-solid fa-plus mr-2 text-2xl"},null,-1)),Fe=n(()=>o("i",{class:"fa-solid fa-house mr-2 text-2xl"},null,-1)),qe=n(()=>o("i",{class:"fa-solid fa-plus mr-2 text-2xl"},null,-1)),Be=n(()=>o("i",{class:"fa-solid fa-font"},null,-1)),Je={style:{"min-width":"max-content"}},He=n(()=>o("span",{class:"p-column-title"},"Category",-1)),Me={style:{"min-width":"max-content"}},Ge={style:{display:"flex"}},Ke=n(()=>o("i",{class:"fa-solid fa-file-arrow-down"},null,-1)),Qe=n(()=>o("i",{class:"fa-solid fa-pen-to-square"},null,-1)),We=n(()=>o("i",{class:"fa-solid fa-trash"},null,-1)),Xe={class:"col-12 p-0",style:{}},Ye=n(()=>o("label",{for:"position"},"FECHA DE RENOVACION",-1)),Ze={class:"p-3",style:{"background-color":"rgba(115, 255, 76, 0.306)"}},et=n(()=>o("i",{class:"pi pi-check",style:{color:"slateblue"}},null,-1)),tt={class:"grid",style:{display:"flex","justify-content":"space-between"}},ot={class:"col-12 xl:col-6"},st={class:"col-12 xl:col-6"},at={class:"grid",style:{}},lt={class:"col-12"},nt=n(()=>o("label",{for:"position"},"TIPO DE DOCUMENTO",-1)),it={class:"col-12"},rt=n(()=>o("label",{for:"position"},"FECHA DE RENOVACION",-1)),dt={class:"p-3",style:{"background-color":"rgba(19, 164, 0, 0.306)"}},ct=n(()=>o("i",{class:"pi pi-check",style:{color:"slateblue"}},null,-1)),ut={class:"",style:{display:"flex","justify-content":"space-between",gap:"1rem","flex-direction":"column"}},pt=n(()=>o("h3",null,"Nueva Sede",-1)),mt={class:""},yt=n(()=>o("p",{class:"mt-4"},"Nombre de la Sede:",-1)),ft=n(()=>o("p",{class:"mt-4"},"Dirección:",-1)),vt=n(()=>o("p",{class:"mt-4"},"Teléfono:",-1)),_t={key:0,style:{"margin-top":"20px"}},ht=["src"],gt=n(()=>o("i",{class:"fa-solid fa-camera"},null,-1)),wt={__name:"ShowFiles",setup(V){const J=ve(),A=r(!1),k=r(""),Z=async()=>{if(!k.value){alert("Por favor, ingrese un nombre para el tipo de documento.");return}try{const t=await fetch(`${p}/site-file-type`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type_name:k.value})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();console.log("Tipo de documento agregado:",e),k.value="",P()}catch(t){console.error("Error al agregar el tipo de documento:",t)}},v=_e(),H=r([]),c=r(),_=r(),E=r([]),F=r(),h=r(""),g=r(""),N=he(),$=r({}),u=ge();H.value=F.value;const M=t=>{const e=t.target.files[0];e&&(console.log("Archivo seleccionado:",e),c.value=e)},P=async()=>{try{const t=await fetch(`${p}/site-file-types`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();E.value=e}catch(t){console.error("Error al obtener los tipos de documentos:",t)}},ee=t=>{J.require({target:event.currentTarget,message:`Esta seguro de eliminar ${t.document_name}`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-info p-button-outlined p-button-sm",acceptClass:"p-button-sm p-button-danger",rejectLabel:"Cancelar",acceptLabel:"Eliminar",accept:()=>{te(t)},reject:()=>{}})},te=async t=>{try{if(!(await fetch(`${p}/site_document/${t.document_id}`,{method:"DELETE"})).ok)throw new Error("Error al eliminar el documento");T(),u.add({severity:"success",summary:"Documento eliminado",detail:"El documento ha sido eliminado correctamente.",life:3e3})}catch(e){console.error("Error al eliminar el documento:",e),u.add({severity:"error",summary:"Error al eliminar",detail:"No se pudo eliminar el documento.",life:3e3})}},oe=async t=>{let e="post";const l=`${p}/site-document/`,d={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return(await fetch(l,d)).json()},T=async()=>{try{const t=`${p}/get-site-documents-info/${N.params.site_id}`,e=await fetch(t);if(console.log(e),!e.ok)return;const l=await e.json();F.value=l}catch(t){console.error("Error al enviar la solicitud:",t)}},se=async t=>{let e="put";const l={...t},d=`${p}/site-document/${l.document_id}`;l.renovation_date=g.value;const m={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(l)};try{const y=await fetch(d,m);if(!y.ok)throw new Error(`Error en la solicitud: ${y.status}`);const b=await y.json();return T(),q(),u.add({severity:"success",summary:"Actualización exitosa",detail:"Documento actualizado correctamente",life:3e3}),b}catch(y){u.add({severity:"error",summary:"Error en la actualización",detail:y.message,life:3e3})}};K(()=>{v.setLoading(!0),v.setLoading(!1),P()}),we(()=>N.params.site_id,()=>{T(),v.setLoading(!0),v.setLoading(!1)}),K(()=>{const t=localStorage.getItem("currentSiteFiles");t&&($.value=JSON.parse(t))});const ae=async t=>{try{const e=await fetch(`${p}/site-file-type/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({type_name:t.type_name})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();console.log("Tipo de documento actualizado:",l),u.add({severity:"success",summary:"Actualizado",detail:"Tipo de archivo actualizado con éxito",life:3e3})}catch(e){console.error("Error al actualizar el tipo de documento:",e),u.add({severity:"error",summary:"Error al actualizar",detail:"No se pudo actualizar el tipo de archivo.",life:3e3})}},j=r(!1),L=r(!1),le=(t,e,l)=>{const d={document_name:`${$.value.site_name} ${h.value.type_name}`,document_type:h.value.type_name,renovation_date:g.value,site_id:N.params.site_id};oe(d).then(m=>{console.log(m),Y(t,m.document_id,h.value.type_name),T()}),u.add({severity:"success",summary:"hecho",detail:"",life:3e3}),q()},ne=(t,e)=>{console.log(H,h.value),`${_.value.document_name}`,_.value.document_type,g.value,N.params.site_id,console.log(e),se(e),Y(t,e.document_id,e.document_type),u.add({severity:"success",summary:"hecho",detail:"",life:3e3}),q()},ie=t=>{j.value=!0,_.value=t},re=t=>{L.value=!0,_.value=t},q=()=>{j.value=!1,L.value=!1,c.value=null,T()},U=r(null),z=r(!1),w=r({site_name:"",site_address:"",site_phone:"",site_business_hours:""}),B=r(null);r(null);const de=()=>{z.value=!0,U.value=null},ce=t=>{const e=t.target.files[0];B.value=e,e&&(U.value=URL.createObjectURL(e))},ue=async()=>{try{const t=await fetch(`${p}/site`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w.value)});if(!t.ok)throw new Error("Error al crear la sede");const l=(await t.json()).site_id;if(B.value){const d=new FormData;d.append("file",B.value),await fetch(`${p}/upload-product-image/site-${l}`,{method:"POST",body:d})}z.value=!1}catch(t){console.error("Error al crear la sede:",t)}},pe=async t=>{J.require({target:event.currentTarget,message:"¿Está seguro de que desea eliminar este tipo de archivo?",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-info p-button-outlined p-button-sm",acceptClass:"p-button-sm p-button-danger",rejectLabel:"Cancelar",acceptLabel:"Eliminar",accept:async()=>{try{if(v.setLoading(!0,"eliminando"),!(await fetch(`${p}/site-file-type/${t}`,{method:"DELETE"})).ok)throw new Error("Error al eliminar el tipo de archivo");E.value=E.value.filter(l=>l.type_id!==t),u.add({severity:"success",summary:"Eliminado",detail:"Tipo de archivo eliminado con éxito",life:3e3}),v.setLoading(!1,"eliminando"),P()}catch(e){v.setLoading(!1,"eliminando"),console.error("Error al eliminar el tipo de archivo:",e),u.add({severity:"error",summary:"Error al eliminar",detail:"No se pudo eliminar el tipo de archivo.",life:3e3}),P()}}})};return(t,e)=>{const l=f("Button"),d=f("Dialog"),m=f("Toast"),y=f("ConfirmPopup"),b=f("Column"),me=f("DataTable"),G=f("Calendar"),ye=f("Dropdown");return I(),O(Q,null,[a(d,{visible:A.value,"onUpdate:visible":e[1]||(e[1]=s=>A.value=s),style:{width:"450px"},modal:!0},{header:i(()=>[Te]),default:i(()=>[o("div",null,[Se,a(C(S),{class:"col-12",id:"type_name",modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s)},null,8,["modelValue"])]),o("div",De,[a(l,{class:"my-4",label:"Agregar",onClick:Z})]),Ve,(I(!0),O(Q,null,be(E.value,s=>(I(),O("div",{class:"my-2 col-12 p-0",key:s.type_id},[o("div",Ne,[a(C(S),{class:"col-11",modelValue:s.type_name,"onUpdate:modelValue":x=>s.type_name=x,onBlur:x=>ae(s)},null,8,["modelValue","onUpdate:modelValue","onBlur"]),a(l,{rounded:"",style:{"aspect-ratio":"1 / 1",width:"3rem",height:"3rem",display:"flex","justify-content":"center"},severity:"danger",text:"",class:"pi-button-rounded",onClick:x=>pe(s.id)},{default:i(()=>[Pe]),_:2},1032,["onClick"])])]))),128)),je]),_:1},8,["visible"]),a(m),o("div",Le,[a(m),a(y),o("div",Ue,[a(me,{ref:"dt",value:F.value,dataKey:"id",paginator:!0,rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll",frozenValue:t.lockedCustomers},{header:i(()=>[]),default:i(()=>[o("div",ze,[o("div",Ie,[a(l,{size:"small ",style:{width:"100%","font-weight":"bold",display:"flex","align-items":"center","justify-content":"center"},rounded:"",class:"p-button-info py-2",onClick:e[2]||(e[2]=s=>re())},{default:i(()=>[Oe,Re]),_:1}),a(l,{size:"small ",style:{width:"100%","font-weight":"bold",display:"flex","align-items":"center","justify-content":"center"},rounded:"",class:"p-button-warning py-2",onClick:de},{default:i(()=>[Ae,Fe]),_:1}),a(l,{size:"small ",style:{width:"100%","font-weight":"bold",display:"flex","align-items":"center","justify-content":"center"},rounded:"",class:"p-button-success py-2",onClick:e[3]||(e[3]=s=>A.value=!0)},{default:i(()=>[qe,Be]),_:1})])]),a(b,{class:"",field:"name",header:"Tipo",sortable:!0,headerStyle:"width:20rem; min-width:max-content; "},{body:i(s=>[o("p",Je,D(s.data.document_type),1)]),_:1}),a(b,{class:"py-0",field:"position",header:"Nombre ",sortable:!0,headerStyle:"width:20rem; min-width:10rem;"},{body:i(s=>[He,o("p",Me,D(s.data.document_name),1)]),_:1}),a(b,{class:"p-0",field:"birth_date",header:"Renovacion",sortable:!0,headerStyle:"width:5rem; min-width:10rem;"},{body:i(s=>[R(D(s.data.renovation_date),1)]),_:1}),a(b,{style:{},class:"py-0",header:"Acciones",fieldheaderStyle:"width:10rem; min-width:max-content",frozen:"",alignFrozen:"right"},{body:i(s=>[o("div",Ge,[a(l,{text:"",size:"large",style:{"aspect-ratio":"1 / 1"},class:"p-button-success mr-2 mb-2 p-0 text-3xl",onClick:x=>C($e)(s.data.document_id,s.data.document_type)},{default:i(()=>[Ke]),_:2},1032,["onClick"]),a(l,{text:"",size:"large",style:{},class:"p-button-info mr-2 mb-2 p-0 text-3xl",onClick:x=>ie(s.data)},{default:i(()=>[Qe]),_:2},1032,["onClick"]),a(l,{text:"",size:"large",style:{},class:"p-button-danger mr-2 mb-2 p-0 text-3xl",onClick:x=>ee(s.data)},{default:i(()=>[We]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["value","frozenValue"]),a(d,{class:"p-0",closable:!0,header:` CARGAR PARA ${$.value.site_name}`,visible:j.value,"onUpdate:visible":e[7]||(e[7]=s=>j.value=s),style:{width:"5000px"},modal:!0},{default:i(()=>[o("input",{ref:"fileInput",type:"file",onChange:M,style:{display:"none"}},null,544),o("div",Xe,[Ye,a(G,{id:"entry_date",style:{width:"100%",margin:"20px 0"},modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=s=>g.value=s),required:"true",autofocus:""},null,8,["modelValue"])]),W(o("p",Ze,[et,R(" "+D(c.value?`${c.value.name} : si este no es
                    su documento por
                    favor carguelo`:""),1)],512),[[X,c.value]]),o("div",tt,[o("div",ot,[a(l,{label:"Seleccionar documento",class:"col-12",style:{"background-color":"var(--primary-color)"},onClick:e[5]||(e[5]=s=>{t.$refs.fileInput.click()})})]),o("div",st,[a(l,{class:"col-12",label:"Enviar",style:{"background-color":"var(--primary-color)"},onClick:e[6]||(e[6]=s=>ne(c.value,_.value))})])])]),_:1},8,["header","visible"]),a(d,{header:` CARGAR ${_.value?_.value:""} PARA ${$.value.site_name}`,visible:L.value,"onUpdate:visible":e[12]||(e[12]=s=>L.value=s),style:{width:"450px"},modal:!0},{default:i(()=>[o("div",at,[o("div",lt,[nt,a(ye,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=s=>h.value=s),modelModifiers:{trim:!0},options:E.value,optionLabel:"type_name",placeholder:"",required:"true",class:xe({"p-invalid":t.submitted}),style:{width:"100%",margin:"20px 0"}},null,8,["modelValue","options","class"])]),o("div",it,[rt,a(G,{id:"entry_date",style:{width:"100%",margin:"20px 0"},modelValue:g.value,"onUpdate:modelValue":e[9]||(e[9]=s=>g.value=s),required:"true",autofocus:""},null,8,["modelValue"])])]),o("input",{ref:"fileInput",type:"file",onChange:M,style:{display:"none"}},null,544),W(o("p",dt,[ct,R(" "+D(c.value?`${c.value.name} : verifique si
                    este es su documeto
                    antes de envirlo`:""),1)],512),[[X,c.value]]),o("div",ut,[a(l,{class:"",severity:"help",label:"Seleccionar documento",style:{width:"100%"},onClick:e[10]||(e[10]=s=>{t.$refs.fileInput.click()})}),a(l,{label:"Enviar",style:{width:"100%"},severity:"success",onClick:e[11]||(e[11]=s=>le(c.value,h.value,$.value.site_id))})])]),_:1},8,["header","visible"])])]),a(d,{visible:z.value,"onUpdate:visible":e[17]||(e[17]=s=>z.value=s),style:{width:"450px",padding:"0px"},modal:!0},{header:i(()=>[pt]),footer:i(()=>[a(l,{onClick:ue},{default:i(()=>[R("Crear Sede")]),_:1})]),default:i(()=>[o("div",mt,[yt,a(C(S),{class:"col-12",modelValue:w.value.site_name,"onUpdate:modelValue":e[13]||(e[13]=s=>w.value.site_name=s)},null,8,["modelValue"])]),o("div",null,[ft,a(C(S),{class:"col-12",modelValue:w.value.site_address,"onUpdate:modelValue":e[14]||(e[14]=s=>w.value.site_address=s)},null,8,["modelValue"])]),o("div",null,[vt,a(C(S),{class:"col-12",modelValue:w.value.site_phone,"onUpdate:modelValue":e[15]||(e[15]=s=>w.value.site_phone=s)},null,8,["modelValue"])]),U.value?(I(),O("div",_t,[o("img",{src:U.value,alt:"Vista previa de la imagen",style:{"max-width":"100%","max-height":"300px"}},null,8,ht)])):Ce("",!0),a(l,{class:"my-5",onClick:e[16]||(e[16]=s=>t.$refs.imageInput.click())},{default:i(()=>[gt]),_:1}),o("input",{type:"file",ref:"imageInput",onChange:ce,style:{display:"none"}},null,544)]),_:1},8,["visible"])],64)}}},Et=fe(wt,[["__scopeId","data-v-7595db92"]]);export{Et as default};
