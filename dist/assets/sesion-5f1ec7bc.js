import{_ as ye,f as n,g as K,z as s,A as fe,u as Ve,B as Ue,j as se,U as g,C as O,D as R,E as F,G as q,H,h as be,r as V,o as f,c as P,b as l,w as X,k as ge,t as J,l as u,a as e,n as D,m as S,I as Q,F as me,d as $e,J as ae,v as Ce,p as we,e as xe,K as te,L as he,M as oe,s as _e,q as Ee,P as ke,N as pe}from"./index-a0a883f6.js";import"./dialogoEditarProducto.vue_vue_type_style_index_0_scoped_90edd45b_lang-0b2a2d09.js";import{f as Pe}from"./formatoPesos-2a38d2e7.js";const I=x=>(we("data-v-90edd45b"),x=x(),xe(),x),Ae={key:0},je=["src"],Te=I(()=>e("h5",null,"Nombre",-1)),De={class:"p-input-icon-left mb-4"},Ie=I(()=>e("i",{class:"pi pi-pencil"},null,-1)),ze=I(()=>e("h5",null,"Description",-1)),Le=I(()=>e("h5",null,"Precio",-1)),Ge={class:"p-input-icon-left"},Ne={style:{display:"flex","align-items":"center"}},Be=I(()=>e("span",{class:"ml-5"},"Conjunto de salsas",-1)),Oe={key:1,class:"p-input-icon-left"},Re={style:{display:"flex","align-items":"center"}},Fe=I(()=>e("span",{class:"ml-5"},"Conjunto de adiciones",-1)),qe={class:"p-input-icon-left"},He={style:{display:"flex","align-items":"center"}},Je=I(()=>e("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),Me={class:"p-input-icon-left"},Ke={style:{display:"flex","align-items":"center"}},Qe=I(()=>e("span",{class:"ml-5"},"Conjunto de toppings",-1)),We={class:"p-input-icon-left"},Xe={style:{display:"flex","align-items":"center"}},Ye=I(()=>e("span",{class:"ml-5"},"Conjunto de cambios",-1)),Ze={class:"p-input-icon-left"},eo=I(()=>e("h5",{style:{display:"flex","align-items":"center"}},[e("span",{class:""},"Estado")],-1)),oo={class:"p-input-icon-left"},ao={style:{display:"flex","align-items":"center"}},to={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},so={class:"mt-6"},lo={style:{display:"flex","align-items":"center"}},no=I(()=>e("span",{class:"ml-5"},"Todas",-1)),io={style:{display:"flex","align-items":"center"}},ro={class:"ml-5"},uo=I(()=>e("span",{class:"text-center col-12 p-0"},"Guardar",-1)),co={__name:"dialogoEditarProducto",setup(x){const U=n({});K(s,async r=>{Object.keys(U.value).forEach(t=>{U.value[t]=!1}),(await ee(s.value.name)).forEach(t=>{U.value[t.site_id]=!0})});const b=n(null),Y=n(null),Z=r=>{const o=r.target.files[0];o&&(b.value=URL.createObjectURL(o),Y.value=o)},W=fe(),N=Ve(),B=Ue(()=>N.query.category),E=n([]),d=n(!1);K(d,r=>{se.value.forEach(o=>{E.value[o.site_id]=r})}),console.log(B.value),n("producto sin nombre"),n("producto sin descripcion"),n(0),n("inactive");const p=n(["active","inactive"]),h=n([]),k=n([]),z=n([]),$=n([]),v=n([]),y=n(),L=n(),G=n(),j=n(),T=n(),le=async()=>{await ne(s.value.name);for(const[r,o]of Object.entries(E.value))if(o){const t={product_id:s.value.product_id,name:s.value.name,price:s.value.price,description:s.value.description,category_id:B.value,porcion:"1",state:s.value.state,grupo_salsa_id:y.value?O.value.grupo_salsa_id:null,grupo_topping_id:G.value?q.value.grupo_topping_id:null,grupo_acompanante_id:T.value?H.value.grupo_acompanante_id:null,grupo_cambio_id:j.value?R.value.grupo_cambio_id:null,grupo_adicional_id:L.value?F.value.grupo_id:null,site_id:r};try{const a=await fetch(`${g}/products/${t.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw new Error(`Error: ${a.status}`);W.add({severity:"success",summary:`Producto actualizado en la sede ${r}`,detail:"Actualización completada",life:3e3})}catch(a){console.error("Error al actualizar el producto:",a)}}ae.value=!1,location.reload()};K(s,async r=>{if(Object.keys(E.value).forEach(o=>{E.value[o]=!1}),r&&r.name)try{(await ee(s.value.name)).forEach(t=>{E.value[t.site_id]=!0})}catch(o){console.error("Error al obtener sedes para el producto:",o)}},{immediate:!0});const ee=async r=>{try{const o=await fetch(`${g}/products/name/${r}/sites`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){console.error("Error fetching sites:",o),W.add({severity:"error",summary:"Error",detail:"Error fetching sites data",life:3e3})}},ne=async r=>{const o=new FormData;o.append("file",Y.value);try{if(!(await fetch(`${g}/upload-product-image/${r}`,{method:"POST",body:o})).ok)throw new Error("Error al subir la imagen");b.value=`${g}/read-product-image/600/${s.value.name}`}catch(t){console.error("Error al subir la imagen:",t)}},ie=async()=>{try{return await(await fetch(`${g}/grupo-salsas`)).json()}catch(r){console.error("Error fetching data: ",r)}},re=async()=>{try{return await(await fetch(`${g}/grupo-cambios`)).json()}catch(r){console.error("Error fetching data: ",r)}},ue=async()=>{try{return await(await fetch(`${g}/grupo-adicionales`)).json()}catch(r){console.error("Error fetching data: ",r)}},de=async()=>{try{return await(await fetch(`${g}/grupo-toppings`)).json()}catch(r){console.error("Error fetching data: ",r)}},ce=async()=>{try{return await(await fetch(`${g}/grupo-acompanantes`)).json()}catch(r){console.error("Error fetching data: ",r)}};return K(s,async()=>{b.value=`${g}/read-product-image/600/${s.value.name}`,s.value.grupo_salsa_id?y.value=!0:y.value=!1,s.value.grupo_adicional_id?L.value=!0:L.value=!1,s.value.grupo_acompanante_id?T.value=!0:T.value=!1,s.value.grupo_topping_id?G.value=!0:G.value=!1,s.value.grupo_cambio_id?j.value=!0:j.value=!1,ie().then(m=>{h.value=m}),ue().then(m=>{k.value=m}),re().then(m=>{z.value=m}),ce().then(m=>{$.value=m}),de().then(m=>{v.value=m});const r=await ie();h.value=r;const o=await re();z.value=o;const t=await ue();k.value=t;const a=await de();v.value=a;const _=await ce();$.value=_,O.value=r.find(m=>m.grupo_salsa_id===s.value.grupo_salsa_id),R.value=o.find(m=>m.grupo_cambio_id===s.value.grupo_cambio_id),F.value=t.find(m=>m.grupo_id===s.value.grupo_adicional_id),q.value=a.find(m=>m.grupo_topping_id===s.value.grupo_topping_id),H.value=_.find(m=>m.grupo_acompanante_id===s.value.grupo_acompanante_id)}),be(async()=>{var r,o;b.value=`${g}/read-product-image/600/${s.value.name}`,s.value.grupo_salsa_id?y.value=!0:y.value=!1,s.value.grupo_adicional_id?L.value=!0:L.value=!1,s.value.grupo_acompanante_id?T.value=!0:T.value=!1,s.value.grupo_topping_id?G.value=!0:G.value=!1,s.value.grupo_cambio_id?j.value=!0:j.value=!1,ie().then(t=>{h.value=t}),ue().then(t=>{k.value=t}),re().then(t=>{z.value=t}),ce().then(t=>{$.value=t}),de().then(t=>{v.value=t}),(o=(r=se)==null?void 0:r.value)==null||o.forEach(t=>{E.value[t.site_id]=!1})}),(r,o)=>{const t=V("Input"),a=V("Button"),_=V("InputText"),m=V("Textarea"),M=V("InputNumber"),w=V("InputSwitch"),C=V("Dropdown"),ve=V("Dialog");return f(),P(me,null,[l(ve,{visible:u(ae),"onUpdate:visible":o[16]||(o[16]=i=>S(ae)?ae.value=i:null),style:Ce([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:`Editar ${u(s).name}`,modal:!0,class:"p-fluid p-2 m-3"},{default:X(()=>[ge(J(u(s))+" ",1),b.value?(f(),P("div",Ae,[e("img",{src:b.value,alt:"Previsualización del Producto",style:{"max-width":"100%",height:"auto"}},null,8,je)])):D("",!0),l(t,{type:"file",onChange:Z,accept:"image/*"}),l(a,{text:"",style:{width:"auto"},class:"p-0",label:"Reset image",size:"small",onClick:o[0]||(o[0]=i=>b.value=`${u(g)}/read-product-image/300/${u(s).name}`)}),Te,e("span",De,[Ie,l(_,{modelValue:u(s).name,"onUpdate:modelValue":o[1]||(o[1]=i=>u(s).name=i),type:"text"},null,8,["modelValue"])]),ze,l(m,{modelValue:u(s).description,"onUpdate:modelValue":o[2]||(o[2]=i=>u(s).description=i),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),Le,e("span",Ge,[l(M,{class:"",modelValue:u(s).price,"onUpdate:modelValue":o[3]||(o[3]=i=>u(s).price=i),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),e("h5",Ne,[l(w,{class:"p-0 m-0",modelValue:y.value,"onUpdate:modelValue":o[4]||(o[4]=i=>y.value=i)},null,8,["modelValue"]),Be]),y.value?(f(),P("span",Oe,[l(C,{style:{outline:"none"},class:"p-0",primary:"",modelValue:u(O),"onUpdate:modelValue":o[5]||(o[5]=i=>S(O)?O.value=i:null),options:h.value,optionLabel:"name"},null,8,["modelValue","options"])])):D("",!0),e("h5",Re,[l(w,{class:"p-0 m-0",modelValue:L.value,"onUpdate:modelValue":o[6]||(o[6]=i=>L.value=i)},null,8,["modelValue"]),Fe]),e("span",qe,[L.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(F),"onUpdate:modelValue":o[7]||(o[7]=i=>S(F)?F.value=i:null),options:k.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),e("h5",He,[l(w,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":o[8]||(o[8]=i=>T.value=i)},null,8,["modelValue"]),Je]),e("span",Me,[T.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(H),"onUpdate:modelValue":o[9]||(o[9]=i=>S(H)?H.value=i:null),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),e("h5",Ke,[l(w,{class:"p-0 m-0",modelValue:G.value,"onUpdate:modelValue":o[10]||(o[10]=i=>G.value=i)},null,8,["modelValue"]),Qe]),e("span",We,[G.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(q),"onUpdate:modelValue":o[11]||(o[11]=i=>S(q)?q.value=i:null),options:v.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),e("h5",Xe,[l(w,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":o[12]||(o[12]=i=>j.value=i)},null,8,["modelValue"]),Ye]),e("span",Ze,[j.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(R),"onUpdate:modelValue":o[13]||(o[13]=i=>S(R)?R.value=i:null),options:z.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),eo,e("span",oo,[l(C,{style:{outline:"none"},class:"p-0",primary:"",modelValue:u(s).state,"onUpdate:modelValue":o[14]||(o[14]=i=>u(s).state=i),options:p.value},null,8,["modelValue","options"])]),e("h5",ao,[e("span",to,"En que sedes quiere modificar "+J(u(s).name),1)]),e("div",so,[e("h5",lo,[l(w,{class:"p-0 m-0",modelValue:d.value,"onUpdate:modelValue":o[15]||(o[15]=i=>d.value=i)},null,8,["modelValue"]),no]),(f(!0),P(me,null,$e(u(se),i=>(f(),P("div",{key:i.site_id},[e("h5",io,[l(w,{class:"p-0 m-0",modelValue:E.value[i.site_id],"onUpdate:modelValue":c=>E.value[i.site_id]=c,disabled:!U.value[i.site_id]},null,8,["modelValue","onUpdate:modelValue","disabled"]),e("span",ro,J(i.site_name),1)])]))),128))]),l(a,{onClick:le,class:"m-auto my-4 text-center"},{default:X(()=>[uo]),_:1})]),_:1},8,["visible","header"]),l(u(W))],64)}}},po=ye(co,[["__scopeId","data-v-90edd45b"]]);const A=x=>(we("data-v-a8a20a02"),x=x(),xe(),x),mo={key:0},vo=["src"],_o=A(()=>e("h5",null,"Nombre",-1)),go={class:"p-input-icon-left mb-4"},ho=A(()=>e("i",{class:"pi pi-pencil"},null,-1)),yo=A(()=>e("h5",null,"Description",-1)),fo=A(()=>e("h5",null,"Precio",-1)),Vo={class:"p-input-icon-left"},bo=A(()=>e("i",{class:"pi pi-pencil"},null,-1)),$o={style:{display:"flex","align-items":"center"}},wo=A(()=>e("span",{class:"ml-5"},"Conjunto de salsas",-1)),xo={key:1,class:"p-input-icon-left"},Eo={style:{display:"flex","align-items":"center"}},ko=A(()=>e("span",{class:"ml-5"},"Conjunto de adiciones",-1)),Uo={class:"p-input-icon-left"},Co={style:{display:"flex","align-items":"center"}},So=A(()=>e("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),Po={class:"p-input-icon-left"},Ao={style:{display:"flex","align-items":"center"}},jo=A(()=>e("span",{class:"ml-5"},"Conjunto de toppings",-1)),To={class:"p-input-icon-left"},Do={style:{display:"flex","align-items":"center"}},Io=A(()=>e("span",{class:"ml-5"},"Conjunto de cambios",-1)),zo={class:"p-input-icon-left"},Lo=A(()=>e("h5",{style:{display:"flex","align-items":"center"}},[e("span",{class:""},"Estado")],-1)),Go={class:"p-input-icon-left"},No={style:{display:"flex","align-items":"center"}},Bo={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},Oo={class:"mt-6"},Ro={style:{display:"flex","align-items":"center"}},Fo=A(()=>e("span",{class:"ml-5"},"Todas",-1)),qo={style:{display:"flex","align-items":"center"}},Ho={class:"ml-5"},Jo=A(()=>e("span",{class:"text-center col-12 p-0"},"Agregar",-1)),Mo={__name:"dialogoAgregarProducto",setup(x){const U=n(null),b=n(null),Y=t=>{const a=t.target.files[0];a&&(U.value=URL.createObjectURL(a),b.value=a)},Z=fe(),W=Ve(),N=Ue(()=>W.query.category),B=n([]),E=n(!1);K(E,t=>{se.value.forEach(a=>{B.value[a.site_id]=t})}),console.log(N.value);const d=n("producto sin nombre"),p=n("producto sin descripcion"),h=n(0),k=n("inactive"),z=n(["active","inactive"]),$=n([]),v=n([]),y=n([]),L=n([]),G=n([]),j=n(),T=n(),le=n(),ee=n(),ne=n(),ie=async()=>{const t=`${g}/products`;re(d.value);for(const[a,_]of Object.entries(B.value))if(_){const m={name:d.value,price:h.value,description:p.value,category_id:N.value,porcion:"1",state:k.value,grupo_salsa_id:O.value?O.value.grupo_salsa_id:null,grupo_topping_id:q.value?q.value.grupo_topping_id:null,grupo_acompanante_id:H.value?H.value.grupo_acompanante_id:null,grupo_cambio_id:R.value?R.value.grupo_cambio_id:null,grupo_adicional_id:F.value?F.value.grupo_adicional_id:null,site_id:a};try{const M=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!M.ok)throw new Error(`Error: ${M.status}`);Z.add({severity:"success",summary:`agregado a la sede ${a}`,detail:"espaerando las otras sedes",life:3e3}),he.value=he.value+1}catch(M){console.error("Error al enviar producto:",M)}}te.value=!1},re=async t=>{const a=new FormData;a.append("file",b.value);try{if(!(await fetch(`${g}/upload-product-image/${t}`,{method:"POST",body:a})).ok)throw new Error("Error al subir la imagen")}catch(_){console.error("Error al subir la imagen:",_)}},ue=async()=>{try{return await(await fetch(`${g}/grupo-salsas`)).json()}catch(t){console.error("Error fetching data: ",t)}},de=async()=>{try{return await(await fetch(`${g}/grupo-cambios`)).json()}catch(t){console.error("Error fetching data: ",t)}},ce=async()=>{try{return await(await fetch(`${g}/grupo-adicionales`)).json()}catch(t){console.error("Error fetching data: ",t)}},r=async()=>{try{return await(await fetch(`${g}/grupo-toppings`)).json()}catch(t){console.error("Error fetching data: ",t)}},o=async()=>{try{return await(await fetch(`${g}/grupo-acompanantes`)).json()}catch(t){console.error("Error fetching data: ",t)}};return be(async()=>{var t,a;ue().then(_=>{$.value=_}),ce().then(_=>{v.value=_}),de().then(_=>{y.value=_}),o().then(_=>{L.value=_}),r().then(_=>{G.value=_}),(a=(t=se)==null?void 0:t.value)==null||a.forEach(_=>{B.value[_.site_id]=!1})}),(t,a)=>{const _=V("Input"),m=V("InputText"),M=V("Textarea"),w=V("InputSwitch"),C=V("Dropdown"),ve=V("Button"),i=V("Dialog");return f(),P(me,null,[l(i,{visible:u(te),"onUpdate:visible":a[15]||(a[15]=c=>S(te)?te.value=c:null),style:Ce([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:"Agregar producto",modal:!0,class:"p-fluid p-2 m-3"},{default:X(()=>[U.value?(f(),P("div",mo,[e("img",{src:U.value,alt:"Previsualización del Producto",style:{"max-width":"100%",height:"auto"}},null,8,vo)])):D("",!0),l(_,{type:"file",onChange:Y,accept:"image/*"}),_o,e("span",go,[ho,l(m,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=c=>d.value=c),type:"text"},null,8,["modelValue"])]),yo,l(M,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=c=>p.value=c),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),fo,e("span",Vo,[bo,l(m,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=c=>h.value=c),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),e("h5",$o,[l(w,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":a[3]||(a[3]=c=>j.value=c)},null,8,["modelValue"]),wo]),j.value?(f(),P("span",xo,[l(C,{style:{outline:"none"},class:"p-0",primary:"",modelValue:u(O),"onUpdate:modelValue":a[4]||(a[4]=c=>S(O)?O.value=c:null),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])])):D("",!0),e("h5",Eo,[l(w,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":a[5]||(a[5]=c=>T.value=c)},null,8,["modelValue"]),ko]),e("span",Uo,[T.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(F),"onUpdate:modelValue":a[6]||(a[6]=c=>S(F)?F.value=c:null),options:v.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),e("h5",Co,[l(w,{class:"p-0 m-0",modelValue:ne.value,"onUpdate:modelValue":a[7]||(a[7]=c=>ne.value=c)},null,8,["modelValue"]),So]),e("span",Po,[ne.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(H),"onUpdate:modelValue":a[8]||(a[8]=c=>S(H)?H.value=c:null),options:L.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),e("h5",Ao,[l(w,{class:"p-0 m-0",modelValue:le.value,"onUpdate:modelValue":a[9]||(a[9]=c=>le.value=c)},null,8,["modelValue"]),jo]),e("span",To,[le.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(q),"onUpdate:modelValue":a[10]||(a[10]=c=>S(q)?q.value=c:null),options:G.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),e("h5",Do,[l(w,{class:"p-0 m-0",modelValue:ee.value,"onUpdate:modelValue":a[11]||(a[11]=c=>ee.value=c)},null,8,["modelValue"]),Io]),e("span",zo,[ee.value?(f(),Q(C,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:u(R),"onUpdate:modelValue":a[12]||(a[12]=c=>S(R)?R.value=c:null),options:y.value,optionLabel:"name"},null,8,["modelValue","options"])):D("",!0)]),Lo,e("span",Go,[l(C,{style:{outline:"none"},class:"p-0",primary:"",modelValue:k.value,"onUpdate:modelValue":a[13]||(a[13]=c=>k.value=c),options:z.value},null,8,["modelValue","options"])]),e("h5",No,[e("span",Bo,"Sedes en las que estara disponible el producto "+J(d.value),1)]),e("div",Oo,[e("h5",Ro,[l(w,{class:"p-0 m-0",modelValue:E.value,"onUpdate:modelValue":a[14]||(a[14]=c=>E.value=c)},null,8,["modelValue"]),Fo]),(f(!0),P(me,null,$e(u(se),c=>(f(),P("div",null,[e("h5",qo,[l(w,{class:"p-0 m-0",modelValue:B.value[c.site_id],"onUpdate:modelValue":Se=>B.value[c.site_id]=Se},null,8,["modelValue","onUpdate:modelValue"]),e("span",Ho,J(c.site_name),1)])]))),256))]),l(ve,{onClick:ie,class:"m-auto my-4 text-center"},{default:X(()=>[Jo]),_:1})]),_:1},8,["visible"]),l(u(Z))],64)}}},Ko=ye(Mo,[["__scopeId","data-v-a8a20a02"]]);const Qo=x=>(we("data-v-6ae0aa27"),x=x(),xe(),x),Wo={class:"col-12 px-6"},Xo={class:"text-2xl titulo my-6 px-2",style:{"text-transform":"capitalize","font-weight":"bold"}},Yo={class:"grid p-5 md:p-0 m-0 col-12 m-auto"},Zo={class:"cont p-2",style:{"background-color":"white",height:"100%",position:"relative"}},ea=["onClick"],oa={class:"imagen-cont",style:{position:""}},aa=["src"],ta={style:{display:""}},sa={class:"nombre-producto mt-4",style:{"font-weight":"bold"}},la={class:"descripcion-producto mt-2 text-sm mb-4"},na={class:"info"},ia={class:"text-l",style:{"font-weight":"bold","border-radius":"100px"}},ra={class:"flex align-items-center justify-content-center"},ua=Qo(()=>e("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),da={__name:"sesion",setup(x){const U=n([]),b=Ve(),Y=n([]),Z=fe(),W=d=>{console.log("hola"),ae.value=!ae.value,s.value=d},N=async d=>{var p,h,k,z;if(console.log(localStorage),!((h=(p=_e)==null?void 0:p.value)!=null&&h.site_id)){console.log("Site ID is not available. Exiting function.");return}try{let $=await fetch(`${g}/products/category/name/${d}/site/${(z=(k=_e)==null?void 0:k.value)==null?void 0:z.site_id}`);if(!$.ok)throw U.value=[],new Error(`HTTP error! status: ${$.status}`);let v=await $.json();U.value=v.map(y=>({...y,isActive:y.state=="active"}))}catch($){U.value=[],console.error("Error fetching data: ",$)}},B=d=>{const p={...d};p.state=d.isActive?"active":"inactive",fetch(`${g}/products/${d.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then(h=>{if(!h.ok)throw new Error("Network response was not ok");return Z.add({severity:`${d.isActive?"success":"error"}`,summary:`${d.isActive?"Activado":"Desactivado"}`,detail:d.name,life:3e3}),Y.value=d.state=="active",h.json()}).then(h=>{}).catch(h=>{console.error("Error al actualizar el producto:",h)})};K(_e,(d,p)=>{d!==p&&N(b.params.sesion)}),K(he,(d,p)=>{d!==p&&N(b.params.sesion)}),be(async()=>{N(b.params.sesion)}),K(()=>b.params.sesion,d=>{N(d)});const E=async()=>{if(!pe.value||!pe.value.product_id){console.error("No se ha seleccionado ningún producto para eliminar");return}try{const d=await fetch(`${g}/products/${pe.value.product_id}`,{method:"DELETE"});if(!d.ok)throw new Error(`Error al eliminar el producto: ${d.status}`);await N(b.params.sesion),oe.value=!1,console.log(`Producto eliminado: ${pe.value.name}`)}catch(d){console.error("Error al eliminar el producto:",d)}};return(d,p)=>{const h=V("Button"),k=V("Toast"),z=V("InputSwitch"),$=V("Dialog");return f(),P("div",Wo,[e("p",Xo,J(u(b).params.sesion),1),e("span",null,[l(h,{onClick:p[0]||(p[0]=v=>te.value=!u(te)),class:"ml-2 mb-4"},{default:X(()=>[ge(" Agregar ")]),_:1})]),e("div",Yo,[(f(!0),P(me,null,$e(U.value,v=>(f(),P("div",{key:v.id,class:"xl:col-3 lg:col-4 md:p-3 p-2 col-12 md:col-6 mb-4"},[e("div",Zo,[e("button",{style:{position:"absolute",top:"-1rem",right:"-1rem","background-color":"var(--primary-color)",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center",color:"white","z-index":"99"},onClick:y=>W(v),class:"add-cart-btn text-xl"},[e("i",{class:Ee(["icono text-2xl p-0 m-0",u(ke).PENCIL])},null,2)],8,ea),e("button",{style:{position:"absolute",top:"-1rem",right:"2rem","background-color":"var(--red-500)",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center",color:"white","z-index":"99"},onClick:p[1]||(p[1]=(...y)=>d.pregpararParaEliminar&&d.pregpararParaEliminar(...y)),class:"add-cart-btn text-xl"},[e("i",{class:Ee(["icono text-2xl p-0 m-0",u(ke).TRASH])},null,2)]),e("div",oa,[e("img",{class:"imagen",onError:p[2]||(p[2]=(...y)=>d.imagenError&&d.imagenError(...y)),style:{height:"50"},src:`${u(g)}/read-product-image/300/${v.name}`,alt:""},null,40,aa)]),e("div",ta,[e("p",sa,J(v.name),1),e("p",la,J(v.description),1)]),l(k,{style:{"box-shadow":"none"}}),e("div",na,[e("div",ia,J(u(Pe)(v.price)),1),l(z,{modelValue:v.isActive,"onUpdate:modelValue":y=>v.isActive=y,onChange:()=>B(v)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]))),128))]),l(k),l(Ko),l(po),l($,{header:"Confirmation",visible:u(oe),"onUpdate:visible":p[4]||(p[4]=v=>S(oe)?oe.value=v:null),style:{width:"350px"},modal:!0},{footer:X(()=>[l(h,{label:"No",icon:"pi pi-times",onClick:p[3]||(p[3]=v=>oe.value=!u(oe)),class:"p-button-text"}),l(h,{label:"Si",icon:"pi pi-check",onClick:E,class:"p-button-text",autofocus:""})]),default:X(()=>[e("div",ra,[ua,e("span",null,[ge("Seguro que desea eliminar "),e("b",null,J(u(pe).name),1)])])]),_:1},8,["visible"])])}}},va=ye(da,[["__scopeId","data-v-6ae0aa27"]]);export{va as default};
