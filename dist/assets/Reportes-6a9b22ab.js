import{_ as ue,h as w,s as de,i as ce,j as le,U as se,g as R,o as a,c as s,a as l,f as u,F as E,r as A,t as o,u as C,k as n,e as i,x as me,b as pe,d as j,n as d,q as V,p as ye,m as _e}from"./index-281a46b6.js";import{f as L}from"./formatoPesos-e824e30b.js";import{F as he}from"./FileSaver.min-cc8488c4.js";import{u as N,w as ve}from"./xlsx-4cca7150.js";import"./_commonjsHelpers-23102255.js";const F=z=>(ye("data-v-186e5b24"),z=z(),_e(),z),fe={class:"container px-2"},ge={class:"my-3 shadow p-2",style:{width:"100%","border-radius":".5rem","min-width":"400px",display:"flex","justify-content":"center",gap:"1rem","align-items":"center"}},we=F(()=>l("h6",{class:"m-0"},[l("b",null,"Sedes")],-1)),Ve=F(()=>l("h6",{class:"m-0"},[l("b",null,"Desde")],-1)),be=F(()=>l("h6",{class:"m-0"},[l("b",null,"Hasta")],-1)),xe={class:"nav_bar shadow-2 p-0 my-0 mx-2",style:{position:"sticky",top:"0rem",width:"100%","min-width":"1200px",overflow:"auto","border-radius":".5rem","background-color":"white","z-index":"99"}},ke={class:"nav_bar--buttons p-0 m-1",style:{}},Te={key:"",class:""},Pe={key:0,class:"px-4",style:{"text-align":"end",width:"100%","border-radius":".5rem","background-color":"#00ff365e"}},Re={style:{display:"flex",width:"100%","justify-content":"end"}},Ce=F(()=>l("div",{class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},[l("p",{class:"text-2xl my-3"},[l("b",null,"Entregado por los cajeros")])],-1)),Le={class:"px-4",style:{display:"flex","justify-content":"end"}},Ne={key:0,style:{"min-width":"max-content"},class:"m-0 p-0"},Se={key:2,class:"m-0 p-0"},je={key:3,class:"m-0 p-0"},Fe={key:5,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},$e={key:6,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},De={key:7,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},ze=F(()=>l("div",{class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},[l("p",{class:"text-2xl my-0"},[l("b",null,"Compras")])],-1)),Ue={key:0,style:{"min-width":"max-content"},class:"m-0 p-0"},Be={key:2,class:"m-0 p-0"},Me={key:3,class:"m-0 p-0"},Ee={key:5,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Ae={key:6,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Oe={key:7,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Ie={class:"px-4",style:{display:"flex","justify-content":"end"}},Ge=F(()=>l("div",{class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},[l("p",{class:"text-2xl my-0"},[l("b",null,"Gastos")])],-1)),He={key:0,style:{"min-width":"max-content"},class:"m-0 p-0"},Je={key:2,class:"m-0 p-0"},qe={key:3,class:"m-0 p-0"},Ye={key:5,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Ke={key:6,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Qe={key:7,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},We={class:"px-4",style:{display:"flex","justify-content":"end"}},Xe={__name:"Reportes",setup(z){const U=w(null),oe=()=>{const v=N.book_new();if(p.value){const f=p.value.report.map(r=>({Fecha:r.transaction_date,Cajero:r.cachier_name,"Valor Entregado":r.received_value,Jornada:r.work_schedule})),g=N.json_to_sheet(f);N.book_append_sheet(v,g,"Reportes de Caja");const P=p.value.shops.map(r=>({Fecha:r.date,Responsable:r.responsible,Valor:r.value,Concepto:r.content,Jornada:r.schedule})),m=N.json_to_sheet(P);N.book_append_sheet(v,m,"Compras");const $=p.value.outputs.map(r=>({Fecha:r.date,Responsable:r.responsible,Valor:r.value,Concepto:r.content,Jornada:r.schedule})),D=N.json_to_sheet($);N.book_append_sheet(v,D,"Gastos")}const c=ve(v,{bookType:"xlsx",type:"binary"});function T(f){const g=new ArrayBuffer(f.length),P=new Uint8Array(g);for(let m=0;m<f.length;m++)P[m]=f.charCodeAt(m)&255;return g}he.saveAs(new Blob([T(c)],{type:"application/octet-stream"}),"DatosFinancieros.xlsx")},h=w({}),ne=()=>{U.value={global:{value:null,matchMode:me.CONTAINS}}};de(()=>{ne()});const b=w([]),B=w(),M=w(),O=w([]);function S(v=[]){return v.reduce((c,T)=>c+(T.received_value||0),0)}const I=w([{columnName:"Fecha",columnValue:"date",columnType:"other",size:"1rem",vif:!0},{columnName:"Responsable",columnValue:"responsible",columnType:"other",size:"1rem",vif:!0},{columnName:"Valor",columnValue:"value",columnType:"money",size:"1rem",vif:!0},{columnName:"Concepto",columnValue:"content",columnType:"other",size:"1rem",vif:!0},{columnName:"Jornada",columnValue:"schedule",columnType:"other",size:"1rem",vif:!0}]),ie=w([{columnName:"Fecha",columnValue:"transaction_date",columnType:"other",size:"1rem",vif:!0},{columnName:"Cajero",columnValue:"cachier_name",columnType:"other",size:"1rem",vif:!0},{columnName:"Valor entregado",columnValue:"received_value",columnType:"money",size:"1rem",vif:!0},{columnName:"Jornada",columnValue:"work_schedule",columnType:"other",size:"1rem",vif:!0}]),G=v=>{const c=new Date(v),T=String(c.getDate()).padStart(2,"0"),f=String(c.getMonth()+1).padStart(2,"0");return`${c.getFullYear()}-${f}-${T}`},p=w([]);ce(async()=>{O.value=await le.get(`${se}/sites`)});const re=async()=>{if(!b.value||b.value.length===0){alert("Por favor, selecciona al menos una sede.");return}if(!B.value){alert("Por favor, selecciona una fecha de inicio.");return}if(!M.value){alert("Por favor, selecciona una fecha de fin.");return}const v={sites:b.value.map(c=>c.site_id),start_date:G(B.value),end_date:G(M.value)};try{p.value=await le.post(`${se}/get-all-cachier-money-by-filtered/`,v),h.value=b.value[0]}catch{alert("Hubo un error al obtener los datos del cajero.")}};return(v,c)=>{var r,H,J,q,Y,K,Q,W,X,Z,ee,te,ae;const T=R("MultiSelect"),f=R("Calendar"),g=R("Button"),P=R("Rating"),m=R("Tag"),$=R("column"),D=R("DataTable");return a(),s("div",fe,[l("div",ge,[we,u(T,{modelValue:b.value,"onUpdate:modelValue":c[0]||(c[0]=e=>b.value=e),filter:"",options:O.value.filter(e=>e.show_on_web),optionLabel:"site_name",style:{width:"200px"}},null,8,["modelValue","options"]),Ve,u(f,{style:{width:"8rem"},dateFormat:"dd/mm/yy",modelValue:B.value,"onUpdate:modelValue":c[1]||(c[1]=e=>B.value=e)},null,8,["modelValue"]),be,u(f,{style:{width:"8rem"},dateFormat:"dd/mm/yy",modelValue:M.value,"onUpdate:modelValue":c[2]||(c[2]=e=>M.value=e)},null,8,["modelValue"]),u(g,{onClick:re,label:"Buscar",severity:"help"})]),l("nav",xe,[l("ul",ke,[(a(!0),s(E,null,A(b.value.filter(e=>e.show_on_web),e=>(a(),s("li",Te,[u(g,{onClick:t=>h.value=e,class:pe(["nav_bar--buttons-button p-2",h.value.site_id==e.site_id?"nav_bar--buttons-button-selected":""]),label:e.site_name},null,8,["onClick","class","label"])]))),128))])]),b.value.length>0&&((r=p.value)!=null&&r.report)?(a(),s("h1",Pe,[l("b",null,"DEBE TENER "+o(C(L)(S((J=(H=p.value)==null?void 0:H.report)==null?void 0:J.filter(e=>e.site_id==h.value.site_id))-S((Y=(q=p.value)==null?void 0:q.shops)==null?void 0:Y.filter(e=>e.site_id==h.value.site_id))-S((Q=(K=p.value)==null?void 0:K.outputs)==null?void 0:Q.filter(e=>e.site_id==h.value.site_id)))),1)])):n("",!0),l("div",Re,[u(g,{label:"Descargar Excel",severity:"help",onClick:oe,class:"download-button"})]),u(D,{paginator:!0,rows:15,style:{width:"100%","min-width":"900px"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} solicitudes",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:(X=(W=p.value)==null?void 0:W.report)==null?void 0:X.filter(e=>e.site_id==h.value.site_id),tableStyle:"min-width: 50rem;",filters:U.value},{header:i(()=>[Ce]),footer:i(()=>{var e,t;return[l("div",Le,[l("h3",null,[l("b",null," TOTAL: "+o(C(L)(S((t=(e=p.value)==null?void 0:e.report)==null?void 0:t.filter(y=>y.site_id==h.value.site_id)))),1)])])]}),default:i(()=>[(a(!0),s(E,null,A(ie.value,e=>(a(),j($,{header:e.columnName,style:d(`min-width:${e.size}`),field:e.columnValue,class:"my-0 py-2"},{body:i(t=>{var y,x,k;return[e.columnType=="date"?(a(),s("h6",Ne,o(((y=t.data[e.columnValue])==null?void 0:y.split("-").reverse().join("-"))||"---------"),1)):n("",!0),e.columnType=="max-content"?(a(),s("h6",{key:1,style:d(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},o(t.data[e.columnValue]||"---------"),5)):n("",!0),e.columnType=="other"?(a(),s("h6",Se,o(t.data[e.columnValue]||"---------"),1)):n("",!0),e.columnType=="rating"?(a(),s("h6",je,[t.data[e.columnValue]>0?(a(),j(P,{key:0,cancel:!1,readonly:"",modelValue:t.data[e.columnValue],"onUpdate:modelValue":_=>t.data[e.columnValue]=_},null,8,["modelValue","onUpdate:modelValue"])):n("",!0)])):n("",!0),e.columnType=="money"?(a(),s("h6",{key:4,style:d(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},o(C(L)(t.data[e.columnValue])||"---------"),5)):n("",!0),e.columnValue=="current_status"?(a(),s("div",Fe,[u(m,{style:d([{color:"white"},`background-color:${(x=t.data[e.columnValue])==null?void 0:x.color}`])},{default:i(()=>{var _;return[V(o(((_=t.data[e.columnValue])==null?void 0:_.status)||"---------"),1)]}),_:2},1032,["style"]),l("b",null,o(((k=t.data[e.columnValue])==null?void 0:k.timestamp)||"---------"),1)])):n("",!0),e.columnValue=="channel"?(a(),s("div",$e,[u(m,{style:d([{color:"white"},`background-color:${t.data.channel_color}`])},{default:i(()=>[V(o(t.data[e.columnValue]||"---------"),1)]),_:2},1032,["style"])])):n("",!0),e.columnValue=="tag_name"?(a(),s("div",De,[u(m,{style:d([{color:"white"},`background-color:${t.data.tag_color}`])},{default:i(()=>[V(o(t.data[e.columnValue]),1)]),_:2},1032,["style"])])):n("",!0)]}),_:2},1032,["header","style","field"]))),256))]),_:1},8,["value","filters"]),u(D,{paginator:!0,rows:15,style:{width:"100%","min-width":"900px"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} solicitudes",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:(ee=(Z=p.value)==null?void 0:Z.shops)==null?void 0:ee.filter(e=>e.site_id==h.value.site_id),tableStyle:"min-width: 50rem;",filters:U.value},{header:i(()=>[ze]),footer:i(()=>{var e,t;return[l("div",Ie,[l("h3",null,[l("b",null," TOTAL: "+o(C(L)(S((t=(e=p.value)==null?void 0:e.shops)==null?void 0:t.filter(y=>y.site_id==h.value.site_id)))),1)])])]}),default:i(()=>[(a(!0),s(E,null,A(I.value,e=>(a(),j($,{header:e.columnName,style:d(`min-width:${e.size}`),field:e.columnValue,class:"my-0 py-2"},{body:i(t=>{var y,x,k;return[e.columnType=="date"?(a(),s("h6",Ue,o(((y=t.data[e.columnValue])==null?void 0:y.split("-").reverse().join("-"))||"---------"),1)):n("",!0),e.columnType=="max-content"?(a(),s("h6",{key:1,style:d(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},o(t.data[e.columnValue]||"---------"),5)):n("",!0),e.columnType=="other"?(a(),s("h6",Be,o(t.data[e.columnValue]||"---------"),1)):n("",!0),e.columnType=="rating"?(a(),s("h6",Me,[t.data[e.columnValue]>0?(a(),j(P,{key:0,cancel:!1,readonly:"",modelValue:t.data[e.columnValue],"onUpdate:modelValue":_=>t.data[e.columnValue]=_},null,8,["modelValue","onUpdate:modelValue"])):n("",!0)])):n("",!0),e.columnType=="money"?(a(),s("h6",{key:4,style:d(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},o(C(L)(t.data[e.columnValue])||"---------"),5)):n("",!0),e.columnValue=="current_status"?(a(),s("div",Ee,[u(m,{style:d([{color:"white"},`background-color:${(x=t.data[e.columnValue])==null?void 0:x.color}`])},{default:i(()=>{var _;return[V(o(((_=t.data[e.columnValue])==null?void 0:_.status)||"---------"),1)]}),_:2},1032,["style"]),l("b",null,o(((k=t.data[e.columnValue])==null?void 0:k.timestamp)||"---------"),1)])):n("",!0),e.columnValue=="channel"?(a(),s("div",Ae,[u(m,{style:d([{color:"white"},`background-color:${t.data.channel_color}`])},{default:i(()=>[V(o(t.data[e.columnValue]||"---------"),1)]),_:2},1032,["style"])])):n("",!0),e.columnValue=="tag_name"?(a(),s("div",Oe,[u(m,{style:d([{color:"white"},`background-color:${t.data.tag_color}`])},{default:i(()=>[V(o(t.data[e.columnValue]),1)]),_:2},1032,["style"])])):n("",!0)]}),_:2},1032,["header","style","field"]))),256))]),_:1},8,["value","filters"]),u(D,{paginator:!0,rows:15,style:{width:"100%","min-width":"900px"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} solicitudes",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:(ae=(te=p.value)==null?void 0:te.outputs)==null?void 0:ae.filter(e=>e.site_id==h.value.site_id),tableStyle:"min-width: 50rem;",filters:U.value},{header:i(()=>[Ge]),footer:i(()=>{var e,t;return[l("div",We,[l("h3",null,[l("b",null," TOTAL: "+o(C(L)(S((t=(e=p.value)==null?void 0:e.outputs)==null?void 0:t.filter(y=>y.site_id==h.value.site_id)))),1)])])]}),default:i(()=>[(a(!0),s(E,null,A(I.value,e=>(a(),j($,{header:e.columnName,style:d(`min-width:${e.size}`),field:e.columnValue,class:"my-0 py-2"},{body:i(t=>{var y,x,k;return[e.columnType=="date"?(a(),s("h6",He,o(((y=t.data[e.columnValue])==null?void 0:y.split("-").reverse().join("-"))||"---------"),1)):n("",!0),e.columnType=="max-content"?(a(),s("h6",{key:1,style:d(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},o(t.data[e.columnValue]||"---------"),5)):n("",!0),e.columnType=="other"?(a(),s("h6",Je,o(t.data[e.columnValue]||"---------"),1)):n("",!0),e.columnType=="rating"?(a(),s("h6",qe,[t.data[e.columnValue]>0?(a(),j(P,{key:0,cancel:!1,readonly:"",modelValue:t.data[e.columnValue],"onUpdate:modelValue":_=>t.data[e.columnValue]=_},null,8,["modelValue","onUpdate:modelValue"])):n("",!0)])):n("",!0),e.columnType=="money"?(a(),s("h6",{key:4,style:d(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},o(C(L)(t.data[e.columnValue])||"---------"),5)):n("",!0),e.columnValue=="current_status"?(a(),s("div",Ye,[u(m,{style:d([{color:"white"},`background-color:${(x=t.data[e.columnValue])==null?void 0:x.color}`])},{default:i(()=>{var _;return[V(o(((_=t.data[e.columnValue])==null?void 0:_.status)||"---------"),1)]}),_:2},1032,["style"]),l("b",null,o(((k=t.data[e.columnValue])==null?void 0:k.timestamp)||"---------"),1)])):n("",!0),e.columnValue=="channel"?(a(),s("div",Ke,[u(m,{style:d([{color:"white"},`background-color:${t.data.channel_color}`])},{default:i(()=>[V(o(t.data[e.columnValue]||"---------"),1)]),_:2},1032,["style"])])):n("",!0),e.columnValue=="tag_name"?(a(),s("div",Qe,[u(m,{style:d([{color:"white"},`background-color:${t.data.tag_color}`])},{default:i(()=>[V(o(t.data[e.columnValue]),1)]),_:2},1032,["style"])])):n("",!0)]}),_:2},1032,["header","style","field"]))),256))]),_:1},8,["value","filters"])])}}},st=ue(Xe,[["__scopeId","data-v-186e5b24"]]);export{st as default};
