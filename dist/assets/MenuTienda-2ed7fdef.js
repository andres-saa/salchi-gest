import{v as X,U as z,_ as ae,r as _,i as Y,x as M,s as W,o as x,c as $,b as t,F as q,d as H,n as F,t as A,y as re,a as d,e as Z,w as h,g as a,u as i,j as G,A as ie,f as ne,D as te,E as oe}from"./index-0d1140a0.js";import{u as ee}from"./site-ea3b5224.js";import{s as de}from"./siteService-eac42438.js";import{u as J,p as B}from"./ProductService-7a1f2192.js";import{a as O}from"./aditionalService-321a11a3.js";import{f as se}from"./formatoPesos-8aa989a0.js";const ce=ee(),le={async getCategories(){const m=ce.restaurant;try{const e=await X.get(`${z}/categories/1/${m}`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async getCategoriesByRestaurantId(V){try{const e=await X.get(`${z}/categories/1/all/${V}`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}}};const ue={class:"barra align-items-center p-0 md:p-1",style:{"overflow-x":"auto",display:"flex","background-color":"rgba(255, 255, 255, 0.913)"}},pe=["onClick"],me={class:"text-lg",style:{"min-width":"max-content"}},_e={__name:"BarraCategorias",setup(V){const m=ee(),e=_([]),n=(b,y)=>{y>=1e3?W.push("/tienda-menu/productos/adicionales"):W.push({name:"sesion",params:{menu_name:b,category_id:y}})},s=async()=>{e.value=await le.getCategories()};Y(async()=>{s()});const v=b=>re().params.category_id==b.category_id;return M(()=>m.restaurant,b=>{s(),W.push("/tienda-menu/")},{depth:!0}),(b,y)=>(x(),$("div",{class:F([e.value.length>0?"apear":"hide","shadow-3 d-flex p lg:justify-content-center align-items-center mb-5 p-0 md:p-0 m-0"]),style:{position:"sticky",top:"3rem","min-height":"3rem","min-width":"100%","z-index":"99"}},[t("div",ue,[(x(!0),$(q,null,H(e.value,P=>(x(),$("div",{key:P.id,class:"p-1"},[t("button",{onClick:D=>n(P.category_name,P.category_id),class:F([v(P)?"selected menu-button":"menu-button","p-2 text-lg titulo"]),style:{"font-weight":"400","text-transform":"uppercase","min-width":"max-content"}},[t("span",me,A(P.category_name),1)],10,pe)]))),128))])],2))}},ve=ae(_e,[["__scopeId","data-v-ae4a7a6c"]]),ge={class:"image",style:{display:"flex","flex-direction":"column","justify-content":"end","align-items":"end"}},ye=["src"],fe=["src"],he={style:{display:"flex","flex-direction":"column",gap:"1rem"}},be=t("span",null,"Nombre:",-1),we=t("span",null,"descripcion:",-1),xe=t("span",null,"Precio anterior:",-1),Pe=t("span",null,"Precio actual:",-1),Ve={class:"text-center text-2xl py-4",style:{"font-weight":"bold","text-transform":"capitalize",display:"flex","align-items":"center","justify-content":"center",gap:"1rem"}},Ee={style:{"text-transform":"uppercase"}},$e={style:{"font-weight":"bold"}},Te={class:"col-12 px-0 pb-0"},De={__name:"dialogEditProduct",setup(V){const m=_([]),e=J(),n=_([]),s=_(null),v=_(null),b=async c=>{const l=c.target.files[0];if(!l)return;s.value=URL.createObjectURL(l);const u=new FormData;u.append("file",l);try{const o=(await B.uploadPhoto(u)).image_identifier;e.currentProductToEdit.img_identifier=o,URL.revokeObjectURL(s.value)}catch(r){console.error("Error al subir la imagen:",r)}},y=()=>{!n.value||n.value.length===0||Object.entries(n.value).forEach(([c,l])=>{l.forEach(u=>{const r=m.value.some(o=>o.items.some(p=>p.aditional_item_name.toLowerCase()===u.item_name.toLowerCase()&&p.aditional_item_price===u.item_price&&p.aditional_item_type_name===u.type_name));u.status=r})})},P=c=>n.value[c].every(l=>l.status),D=(c,l)=>{n.value[c].forEach(u=>{u.status=l,E(u.item_id,c,l)})},E=(c,l,u)=>{const r=n.value[l].findIndex(o=>o.item_id===c);r!==-1&&(n.value[l][r].status=u)};M(()=>e.currentProductToEdit.id,async()=>{m.value=await O.getAditional(e.currentProductToEdit.id),n.value=await O.getAllAditionsRegistered(),y()});const g=_([]),U=()=>{let c=[];for(const l in n.value)n.value.hasOwnProperty(l)&&n.value[l].forEach(u=>{u.status&&c.push(u.item_id)});g.value=c,C()},C=()=>{const c={product_id:e.currentProductToEdit.id,name:e.currentProductToEdit.product_name,price:e.currentProductToEdit.price,last_price:e.currentProductToEdit.last_price,description:e.currentProductToEdit.product_description,category_id:e.currentProductToEdit.category_id,status:!0,img_identifier:e.currentProductToEdit.img_identifier,parent_id:e.currentProductToEdit.product_id},l=g.value;B.updateProductInstance(c,l)};return(c,l)=>{const u=d("Button"),r=d("InputText"),o=d("Textarea"),p=d("InputNumber"),T=d("InputSwitch"),L=d("Column"),K=d("DataTable"),N=d("Dialog");return x(),Z(N,{closeOnEscape:"",visible:i(e).visibles.dialogEditProduct,"onUpdate:visible":l[6]||(l[6]=w=>i(e).visibles.dialogEditProduct=w),modal:"",style:{width:"40rem"}},{footer:h(()=>[t("div",Te,[a(u,{class:"",onClick:U,severity:"success",label:"Guardar"})])]),default:h(()=>[a(u,{onClick:l[0]||(l[0]=w=>i(e).visibles.dialogEditProduct=!1),severity:"danger",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",icon:"pi pi-times"}),t("div",ge,[s.value?(x(),$("img",{key:0,src:s.value,alt:"Preview",style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"}},null,8,ye)):(x(),$("img",{key:1,class:"",style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"},src:`${i(z)}/read-photo-product/${i(e).currentProductToEdit.img_identifier}/600`,alt:""},null,8,fe)),a(u,{style:{},class:"my-3",severity:"help",onClick:l[1]||(l[1]=w=>v.value.click())},{default:h(()=>[G("Cambiar foto")]),_:1}),t("input",{type:"file",ref_key:"fileInput",ref:v,onChange:b,style:{display:"none"}},null,544)]),t("div",he,[t("div",null,[be,a(r,{modelValue:i(e).currentProductToEdit.product_name,"onUpdate:modelValue":l[2]||(l[2]=w=>i(e).currentProductToEdit.product_name=w),style:{width:"100%"}},null,8,["modelValue"])]),t("div",null,[we,a(o,{modelValue:i(e).currentProductToEdit.product_description,"onUpdate:modelValue":l[3]||(l[3]=w=>i(e).currentProductToEdit.product_description=w),rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])]),t("div",null,[xe,a(p,{modelValue:i(e).currentProductToEdit.last_price,"onUpdate:modelValue":l[4]||(l[4]=w=>i(e).currentProductToEdit.last_price=w),prefix:"$",maxFractionDigits:"0",rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])]),t("div",null,[Pe,a(p,{modelValue:i(e).currentProductToEdit.price,"onUpdate:modelValue":l[5]||(l[5]=w=>i(e).currentProductToEdit.price=w),prefix:"$",maxFractionDigits:"0",rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])])]),(x(!0),$(q,null,H(n.value,(w,S)=>(x(),$("div",{class:"m-auto col-12 p-0",style:{"max-width":"600px"},key:S},[t("p",Ve,[t("span",null,A(S),1),a(T,{modelValue:P(S),"onUpdate:modelValue":k=>D(S,k)},null,8,["modelValue","onUpdate:modelValue"])]),a(K,{stripedRows:"",value:w,class:"p-0"},{default:h(()=>[a(L,{style:{"text-transform":"capitalize"},class:"p-0",field:"aditional_item_name",header:"Nombre"},{body:h(k=>[t("span",Ee,A(k.data.item_name),1)]),_:1}),a(L,{class:"p-0",field:"aditional_item_price",header:"Precio"},{body:h(k=>[t("span",$e,A(i(se)(k.data.item_price)),1)]),_:1}),a(L,{class:"py-0 pl-4 p-0",header:"Estado",headerStyle:"width:1rem"},{body:h(k=>[a(T,{modelValue:k.data.status,"onUpdate:modelValue":[j=>k.data.status=j,j=>E(k.data.item_id,S,j)]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["value"])]))),128))]),_:1},8,["visible"])}}},ke={async getAllRestaurants(){try{const V=await X.get(`${z}/restaurants`);return V.status===200?V.data:(console.error("Error al obtener los restaurantes:",V.status),[])}catch(V){return console.error("Error al obtener los restaurantes:",V),[]}}},Ce={class:"image",style:{display:"flex","flex-direction":"column","justify-content":"end","align-items":"end"}},Ue=["src"],Se={style:{display:"flex","flex-direction":"column",gap:"1rem"}},Ie=t("span",null,"ID de Restaurante:",-1),Ae=t("span",null,"ID de Categoría:",-1),Le=t("span",null,"Nombre:",-1),je=t("span",null,"Descripción:",-1),Re=t("span",null,"Anterior Precio:",-1),Be=t("span",null,"Precio Actual:",-1),Oe={class:"text-center text-2xl py-4",style:{"font-weight":"bold","text-transform":"capitalize",display:"flex","align-items":"center","justify-content":"center",gap:"1rem"}},Ne={style:{"text-transform":"uppercase"}},ze={style:{"font-weight":"bold"}},Fe={class:"col-12 px-0 pb-0"},Ge={__name:"dialogAddProduct",setup(V){const m=_([]),e=J(),n=_([]),s=_({product_name:"",product_description:"",price:0,last_price:0,category_id:null,restaurant_id:null,img_identifier:null}),v=_([]),b=_([]),y=_(null),P=_(null);Y(async()=>{try{b.value=await ke.getAllRestaurants(),n.value=await O.getAllAditionsRegistered()}catch(r){console.error("Error loading data:",r)}});const D=ie(()=>s.value.restaurant_id);M(D,async(r,o)=>{r!==o&&(v.value=await le.getCategoriesByRestaurantId(r),s.value.category_id=null)},{deep:!0});const E=async r=>{const o=r.target.files[0];if(!o)return;y.value=URL.createObjectURL(o);const p=new FormData;p.append("file",o);try{const T=await B.uploadPhoto(p);s.value.img_identifier=T.image_identifier,URL.revokeObjectURL(y.value)}catch(T){console.error("Error uploading image:",T)}},g=r=>n.value[r].every(o=>o.status),U=(r,o)=>{n.value[r].forEach(p=>{p.status=o,C(p.item_id,r,o)})},C=(r,o,p)=>{const T=n.value[o].findIndex(L=>L.item_id===r);T!==-1&&(n.value[o][T].status=p)},c=()=>{if(typeof n.value!="object"||n.value===null){console.error("adicionales.value no es un objeto",n.value);return}let r=[];for(const o in n.value)n.value.hasOwnProperty(o)&&n.value[o].forEach(p=>{p.status&&r.push(p.item_id)});m.value=r,l()},l=()=>{const r={name:s.value.product_name,price:s.value.price,last_price:s.value.last_price,description:s.value.product_description,category_id:s.value.category_id,restaurant_id:s.value.restaurant_id,status:!0,img_identifier:s.value.img_identifier||"",parent_id:null},o=m.value;B.createProductInstance(r,o),u()},u=()=>{s.value={product_name:"",product_description:"",price:0,last_price:0,category_id:null,restaurant_id:null,img_identifier:null},y.value=null,n.value.forEach(r=>{r.forEach(o=>{o.status=!1})})};return(r,o)=>{const p=d("Button"),T=d("Dropdown"),L=d("InputText"),K=d("Textarea"),N=d("InputNumber"),w=d("InputSwitch"),S=d("Column"),k=d("DataTable"),j=d("Dialog");return x(),Z(j,{closeOnEscape:"",visible:i(e).visibles.dialogAddProduct,"onUpdate:visible":o[8]||(o[8]=f=>i(e).visibles.dialogAddProduct=f),modal:"",style:{width:"40rem"}},{footer:h(()=>[t("div",Fe,[a(p,{onClick:c,severity:"success",label:"Guardar"})])]),default:h(()=>[a(p,{onClick:o[0]||(o[0]=f=>i(e).visibles.dialogAddProduct=!1),severity:"danger",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",icon:"pi pi-times"}),t("div",Ce,[y.value?(x(),$("img",{key:0,src:y.value,alt:"Preview",style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"}},null,8,Ue)):ne("",!0),a(p,{class:"my-3",severity:"help",onClick:o[1]||(o[1]=f=>P.value.click())},{default:h(()=>[G("Agregar foto")]),_:1}),t("input",{type:"file",ref_key:"fileInput",ref:P,onChange:E,style:{display:"none"}},null,544)]),t("div",Se,[t("div",null,[Ie,a(T,{modelValue:s.value.restaurant_id,"onUpdate:modelValue":o[2]||(o[2]=f=>s.value.restaurant_id=f),options:b.value,optionLabel:"name",optionValue:"id",placeholder:"Selecciona un restaurante",style:{width:"100%"}},null,8,["modelValue","options"])]),t("div",null,[Ae,a(T,{modelValue:s.value.category_id,"onUpdate:modelValue":o[3]||(o[3]=f=>s.value.category_id=f),options:v.value,optionLabel:"category_name",optionValue:"category_id",placeholder:"Selecciona una categoría",style:{width:"100%"}},null,8,["modelValue","options"])]),t("div",null,[Le,a(L,{modelValue:s.value.product_name,"onUpdate:modelValue":o[4]||(o[4]=f=>s.value.product_name=f),style:{width:"100%"}},null,8,["modelValue"])]),t("div",null,[je,a(K,{modelValue:s.value.product_description,"onUpdate:modelValue":o[5]||(o[5]=f=>s.value.product_description=f),rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])]),t("div",null,[Re,a(N,{modelValue:s.value.last_price,"onUpdate:modelValue":o[6]||(o[6]=f=>s.value.last_price=f),prefix:"$",maxFractionDigits:"0",style:{width:"100%"}},null,8,["modelValue"])]),t("div",null,[Be,a(N,{modelValue:s.value.price,"onUpdate:modelValue":o[7]||(o[7]=f=>s.value.price=f),prefix:"$",maxFractionDigits:"0",style:{width:"100%"}},null,8,["modelValue"])])]),(x(!0),$(q,null,H(n.value,(f,R)=>(x(),$("div",{class:"m-auto col-12 p-0",style:{"max-width":"600px"},key:R},[t("p",Oe,[t("span",null,A(R),1),a(w,{modelValue:g(R),"onUpdate:modelValue":I=>U(R,I)},null,8,["modelValue","onUpdate:modelValue"])]),a(k,{stripedRows:"",value:f,class:"p-0"},{default:h(()=>[a(S,{style:{"text-transform":"capitalize"},class:"p-0",field:"aditional_item_name",header:"Nombre"},{body:h(I=>[t("span",Ne,A(I.data.item_name),1)]),_:1}),a(S,{class:"p-0",field:"aditional_item_price",header:"Precio"},{body:h(I=>[t("span",ze,A(i(se)(I.data.item_price)),1)]),_:1}),a(S,{class:"py-0 pl-4 p-0",header:"Estado",headerStyle:"width:1rem"},{body:h(I=>[a(w,{modelValue:I.data.status,"onUpdate:modelValue":[Q=>I.data.status=Q,Q=>C(I.data.item_id,R,Q)]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["value"])]))),128))]),_:1},8,["visible"])}}};const Me={class:"py-3",style:{overflow:"hidden"}},qe=["src"],He={class:"col-12 p-0"},Je={__name:"dialogDeleteProduct",setup(V){const m=_(!1),e=()=>{m.value=!0,n.value=!n.value},n=_(!1),s=_([]),v=J(),b=_([]);_(v.currentProductToDelete);const y=()=>{!b.value||b.value.length===0||Object.entries(b.value).forEach(([D,E])=>{E.forEach(g=>{const U=s.value.some(C=>C.items.some(c=>c.aditional_item_name.toLowerCase()===g.item_name.toLowerCase()&&c.aditional_item_price===g.item_price&&c.aditional_item_type_name===g.type_name));g.status=U})})},P=async D=>{await B.deleteProduct(D),v.visibles.dialogDeleteProduct=!1,location.reload()};return M(()=>v.currentProductToEdit.id,async()=>{s.value=await O.getAditional(v.currentProductToEdit.id),b.value=await O.getAllAditionsRegistered(),y()}),_([]),(D,E)=>{const g=d("Button"),U=d("Dialog");return x(),Z(U,{close:m.value=!1,closeOnEscape:"",visible:i(v).visibles.dialogDeleteProduct,"onUpdate:visible":E[1]||(E[1]=C=>i(v).visibles.dialogDeleteProduct=C),modal:"",style:{width:"20rem"}},{footer:h(()=>[t("div",He,[a(g,{style:{width:"100%"},onClick:E[0]||(E[0]=C=>P(i(v).currentProductToDelete.product_id)),severity:"danger",label:"Eliminar producto"})])]),default:h(()=>[G(" Esta seguro de eliminar "),t("b",null,A(i(v).currentProductToDelete.product_name),1),G(" ? "),t("div",Me,[te(t("img",{onLoad:e,class:F([m.value&&n.value?"cargado1":m.value&&!n.value?"cargado2":"nada",""]),style:{width:"100%",height:"100%","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"},src:`https://backend.salchimonster.com/read-product-image/300/${i(v).currentProductToDelete.product_name}`,alt:""},null,42,qe),[[oe,m.value]]),te(t("div",{onLoad:e,class:F([m.value?"cargado":"sin-cargar","p-0"]),style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)",height:"100%","object-fit":"contain","border-radius":"0.2rem"},alt:""},null,34),[[oe,!m.value]])])]),_:1},8,["close","visible"])}}},Ke=ae(Je,[["__scopeId","data-v-2893cd90"]]),Qe={style:{"border-radius":"1rem",position:"relative"},class:"mx-auto mx-0 p-0 mt-6 mb-8"},We={class:"mx-3 my-4 mx-auto px-4",style:{"min-width":"max-content","max-width":"1024px",display:"flex","align-items":"center"}},Xe=t("span",{class:"mr-4"},[t("b",null,"SEDE")],-1),Ye={style:{position:"fixed",overflow:"hidden","background-color":"white","border-radius":"0 1rem 1rem 0",left:"0",top:"12rem",display:"flex","flex-direction":"column"}},Ze={style:{display:"flex","align-items":"center",width:"2rem","flex-direction":"column"}},et=["src"],tt={key:0,style:{"border-top":".1rem solid white"}},it={__name:"MenuTienda",setup(V){const m=J(),e=ee(),n=_([]),s=()=>{m.visibles.dialogAddProduct=!0},v=async()=>{n.value=await de.getSites()};return Y(async()=>{v()}),(b,y)=>{const P=d("Dropdown"),D=d("Button"),E=d("router-view");return x(),$("div",Qe,[a(ve,{class:"m-0"}),t("div",We,[Xe,a(P,{modelValue:i(e).site,"onUpdate:modelValue":y[0]||(y[0]=g=>i(e).site=g),options:n.value.filter(g=>g.show_on_web),optionLabel:"site_name",class:"",style:{width:"100%"}},null,8,["modelValue","options"]),a(D,{onClick:s,class:"ml-3",style:{"min-width":"max-content"},severity:"help",label:"Nuevo producto"})]),a(E,{class:""}),a(De,{class:"m-3"}),a(Ke),a(Ge),t("div",Ye,[(x(),$(q,null,H([{name:"S",id:1,imagen:"https://www.salchimonster.com/images/logo.png"},{name:"B",id:2,imagen:"https://burgermonsterr.com/images/LOGO.png"},{name:"P",id:4,imagen:"https://papasmonster.com/images/LOGO.png"}],(g,U)=>t("div",Ze,[a(D,{size:"small",text:"",label:g.name,class:"text-white",onClick:C=>i(e).restaurant=g.id},{default:h(()=>[t("img",{style:{width:"2rem"},src:g.imagen,alt:""},null,8,et)]),_:2},1032,["label","onClick"]),U!=2?(x(),$("span",tt)):ne("",!0)])),64))])])}}};export{it as default};
