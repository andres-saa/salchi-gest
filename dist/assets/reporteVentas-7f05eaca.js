import{_ as q,q as G,B as W,f as l,u as Y,g as K,i as g,U as E,C as Q,r as u,o as k,c as S,a as s,d as n,k as r,w as _,F as X,b as Z,n as R,T as ee,P as te,D as oe,v as C,t as V,p as se,e as ae,E as le}from"./index-da6d24f6.js";const I=b=>(se("data-v-42b50b54"),b=b(),ae(),b),ne={class:"col-12 m-auto",style:{position:"relative","max-width":"1366px"},cls:""},ie={class:"grid",style:{"background-color":"rgba(250, 250, 250, 0)"}},re={class:"text-sm col-12 md:col-3 p-2 xl:col-2"},ce={class:"text-sm col-12 p-2 md:col-4 xl:col-6"},de={class:"text-center col-12 p-2 md:col-3"},pe={class:"col-12 md:col-1 md:p-0",style:{display:"flex","align-items":"center","justify-content":"end"}},ue={class:"contenedor mt-5",style:{position:"sticky",top:"0.8rem","z-index":"99"}},me=I(()=>s("span",{class:"text-3xl mt-8 ml-3",style:{"font-weight":"bold"}},[s("i",{class:"fa-solid fa-chart-simple"}),C(" Vision General")],-1)),fe={class:"col-12 px-3 py-0 my-3 p-2",style:{"overflow-x":"auto","background-color":"#fafafa"}},ve={class:"px-0 mx-0",style:{width:"max-content","background-color":"#fafafa",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},_e=I(()=>s("div",{class:"app",style:{position:""}},null,-1)),ye={class:"grid p-0 m-0"},xe={class:"grid"},ge={class:"col-12 px-0 mx-0"},be={class:"col-12",style:{display:"flex","flex-direction":"column"}},he={class:"text-l",style:{"font-weight":"bold"}},De={class:"col-12",style:{display:"flex","flex-direction":"column"}},we={style:{"font-weight":"bold"},class:"text-l"},ke={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},Se={class:"col-12",style:{display:"flex","justify-content":"center"}},Re={__name:"reporteVentas",setup(b){const a=G(),{isDarkTheme:L}=W(),N=l(["enviada","cancelada","en preparacion"]),U=l("enviada"),P=Y(),$=l([]),B=l([]),f=l(!1),h=l(new Date(new Date().setDate(new Date().getDate()-7))),D=l(new Date),m=l(new Date),c=l(new Date);l("");function y(t){const e=new Date,d=new Date(e);d.setDate(d.getDate()+1);const p=new Date(e);p.setDate(e.getDate()-t),m.value=p,t==1?(c.value=e,a.setDateRange(m.value,c.value),f.value=!1):(c.value=d,a.setDateRange(m.value,c.value),f.value=!1),a.fetchSalesReport()}K(()=>{M().then(t=>{$.value=t}),a.fetchSalesReport()});const F=async()=>{const t=v(h.value),e=v(D.value),d=B.value.map(i=>i.site_id).join(","),p=new URLSearchParams({site_ids:d,status:U.value,start_date:t,end_date:e}),x=`${E}/sales_report?${p.toString()}`;try{const i=await fetch(x,{method:"GET",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const w=await i.json();le.value=w,console.log(w)}catch(i){console.error("Fetch error:",i)}};g([h,D],()=>{F()},{deep:!0}),g(()=>a.order_status,(t,e)=>{console.log(`El estado de orden ha cambiado de ${e} a ${t}`),a.fetchSalesReport()}),g(a.selectedSites,t=>{a.setSelectedSites(t)},{deep:!0});const M=async()=>{try{const t=await fetch(`${E}/sites`);if(!t.ok)throw"paila";return await t.json()}catch(t){console.log(t)}},A=l([{name:"Valor ventas",to:"/reporte-ventas/valor-ventas",icon:"fa-solid fa-dollar-sign"},{name:"No. Ordenes",to:"/reporte-ventas/no-ordenes",icon:"fa-solid fa-sort"},{name:"Ticket promedio",to:"/reporte-ventas/ticket",icon:"fa-solid fa-money-bill"},{name:"Ordenes",to:"/reporte-ventas/ordenes",icon:"fa-solid fa-table"}]);l(null),Q({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const T=l(null),z=()=>{T.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},H=()=>{T.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};g(L,t=>{t?H():z()},{immediate:!0}),l(`${h.value} - ${D.value}`);function v(t){const e=new Date(t),d=e.getFullYear(),p=(e.getMonth()+1).toString().padStart(2,"0"),x=e.getDate().toString().padStart(2,"0");return`${d}-${p}-${x}`}return l({}),l(),g([m,c],([t,e])=>{t>e&&(alert("La fecha de inicio debe ser anterior o igual a la fecha final."),c.value=t)}),(t,e)=>{const d=u("Dropdown"),p=u("MultiSelect"),x=u("InputText"),i=u("Button"),w=u("RouterLink"),J=u("RouterView"),j=u("Calendar"),O=u("Dialog");return k(),S("div",ne,[s("div",ie,[s("div",re,[n(d,{class:"text-sm col-12 p-0",modelValue:r(a).order_status,"onUpdate:modelValue":e[0]||(e[0]=o=>r(a).order_status=o),options:N.value,placeholder:"Estado"},null,8,["modelValue","options"])]),s("div",ce,[n(p,{style:{},display:"chip",multiple:"",modelValue:r(a).selectedSites,"onUpdate:modelValue":e[1]||(e[1]=o=>r(a).selectedSites=o),optionLabel:"site_name",options:$.value.filter(o=>o.site_id!=12&o.site_id!=13),class:"text-sm col-12 p-0",placeholder:"Sedes"},null,8,["modelValue","options"])]),s("div",de,[n(x,{class:"col-12 p-3",onClick:e[2]||(e[2]=o=>f.value=!0),style:{height:"2.7rem"},value:r(a).dateRangeDifference.rangeName||`${v(r(a).dateRange.startDate)}  |  ${v(r(a).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"])]),s("div",pe,[n(i,{severity:"info",class:"text-center p-0 col-12 md:p-0",style:{height:"3rem",width:"min-content","aspect-ratio":"1 / 1","border-radius":"50%",display:"flex","justify-content":"center"},onClick:r(a).fetchSalesReport},{default:_(()=>[s("i",{class:R(r(te).SEARCH),style:{padding:"0.2rem"}},null,2)]),_:1},8,["onClick"])])]),s("div",ue,[me,s("div",fe,[s("div",ve,[(k(!0),S(X,null,Z(A.value,o=>(k(),S("div",null,[n(w,{to:o.to},{default:_(()=>[n(i,{size:"medium",style:oe([r(P).fullPath==o.to?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0"}]),class:"text-md px-0 py-2 my-3 mx-0",text:"",severity:"secondary"},{default:_(()=>[s("i",{class:R(["mr-2",o.icon])},null,2),C(" "+V(o.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256))])])]),_e,s("div",ye,[s("div",{class:R(["",r(a).visibleNotifications?"col-9":"col-12"])},[n(ee,{name:"fade"},{default:_(()=>[n(J)]),_:1})],2)]),n(O,{visible:f.value,"onUpdate:visible":e[11]||(e[11]=o=>f.value=o),modal:"",header:"Periodo",style:{width:"25rem"}},{default:_(()=>[s("div",xe,[s("div",ge,[n(i,{text:"",label:"Hoy",onClick:e[3]||(e[3]=o=>y(0)),class:"p-button-text col-12 p-1 m-0"}),n(i,{text:"",label:"Ayer",onClick:e[4]||(e[4]=o=>y(1)),class:"p-button-text col-12 p-1 m-0"}),n(i,{text:"",label:"Últimos 7 días",onClick:e[5]||(e[5]=o=>y(7)),class:"p-button-text col-12 p-1 m-0"}),n(i,{text:"",label:"Últimos 14 días",onClick:e[6]||(e[6]=o=>y(14)),class:"p-button-text col-12 p-1"}),n(i,{text:"",label:"Últimos 28 días",onClick:e[7]||(e[7]=o=>y(28)),class:"p-button-text col-12 p-0"})]),s("div",be,[s("span",he,"Desde - "+V(v(h.value)),1),n(j,{style:{"min-width":"max-content"},modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=o=>m.value=o)},null,8,["modelValue"])]),s("div",De,[s("span",we,"Hasta - "+V(v(D.value)),1),n(j,{style:{"min-width":"max-content"},modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=o=>c.value=o),showWeek:""},null,8,["modelValue"])]),s("div",ke,[s("div",Se,[n(i,{onClick:e[10]||(e[10]=()=>{r(a).setDateRange(m.value,c.value),f.value=!1,r(a).fetchSalesReport()})},{default:_(()=>[C("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},Ce=q(Re,[["__scopeId","data-v-42b50b54"]]);export{Ce as default};
