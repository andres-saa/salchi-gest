import{_ as y,l,z as g,g as x,e as c,o as k,c as b,a as n,b as p,w as I,a3 as T,P as B,p as S,k as U,$ as V,U as u,y as i,K as D}from"./index-2b62de6a.js";const m=s=>(S("data-v-13fd55f5"),s=s(),U(),s),L={style:{display:"flex",position:"relative","background-size":"cover",height:"100vh",width:"100vw",overflow:"hidden"},class:"p-0 fondo"},z=m(()=>n("img",{src:V,alt:"",style:{width:"48px"},class:"m-3"},null,-1)),$=m(()=>n("p",{class:"text-2xl",style:{"font-weight":"bold"}},"Iniciar sesión",-1)),C={__name:"Login",setup(s){const h=l(),d=g(),_=t=>{const e=l();return D.get(`${u}/validate-token`,{headers:{Authorization:`Bearer ${t}`}}).then(o=>(o.data.access_token&&e.setUserData(o.data),o.data)).catch(o=>{throw console.error("Error durante la validación del token:",o),o})},w=()=>{const t=l();setInterval(async()=>{const e=t.userData.access_token;if(!e){i.push("/auth/login");return}try{await _(e)}catch(o){console.error("La sesión ha expirado o el token es inválido:",o),t.userData={},i.push("/auth/login")}},3e4)},a=x({username:"",password:""}),f=async()=>{const t=new URLSearchParams;t.append("username",a.value.username),t.append("password",a.value.password);try{const e=await fetch(`${u}/token-employer`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});if(!e.ok)throw new Error("Network response was not ok");const o=await e.json();h.setUserData(o),w(),i.push("/"),d.add({severity:"success",summary:"Bienvenido",detail:"Hoy es un gran dia",life:3e3})}catch(e){d.add({severity:"error",summary:"Algo salio mal",detail:"Revisate los datos monstruo",life:3e3}),console.error(e)}};return(t,e)=>{const o=c("InputText"),v=c("Button");return k(),b("div",L,[n("form",{class:"col-12 m-auto",onSubmit:B(f,["prevent"]),style:{"max-width":"min-content",display:"flex","border-radius":"0.5rem","box-shadow":"0 0 10px rgba(0, 0, 0, 0.389)","flex-direction":"column","background-color":"rgb(255, 255, 255)","align-items":"center"}},[z,$,p(o,{class:"my-3 m-0",modelValue:a.value.username,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.username=r),type:"text",autocomplete:"username",placeholder:"identificación",style:{width:"100%"}},null,8,["modelValue"]),I(n("input",{class:"p-inputtext p-component p-password-input",type:"password","onUpdate:modelValue":e[1]||(e[1]=r=>a.value.password=r),autocomplete:"current-password","aria-controls":"pv_id_3_panel","aria-expanded":"false","aria-haspopup":"true",placeholder:"Clave",value:""},null,512),[[T,a.value.password]]),p(v,{size:"samll",style:{width:"100%","background-color":"rgb(255, 98, 0)",border:"none",color:"#fff"},label:"Iniciar sesion",class:"my-3",type:"submit"})],32)])}}},N=y(C,[["__scopeId","data-v-13fd55f5"]]);export{N as default};
