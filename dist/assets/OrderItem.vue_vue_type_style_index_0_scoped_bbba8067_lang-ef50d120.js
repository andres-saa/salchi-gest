import{_ as Q,r as v,Y as W,G as q,i as X,j as Y,U as G,a as O,o as m,c as y,b as e,g as r,w as d,a1 as L,u as s,a0 as R,m as u,t as i,e as H,f as E,F as S,d as U,p as ee,h as te}from"./index-94a9853b.js";import{f as k}from"./formatoPesos-8aa989a0.js";const n=D=>(ee("data-v-f957cab9"),D=D(),te(),D),le=n(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),oe=n(()=>e("span",{for:"responsible"},"Responsable",-1)),se=n(()=>e("span",{for:"reason"},"Razón",-1)),ne=n(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),ie=n(()=>e("span",{class:"advert",style:{"text-transform":"lowercase",color:"red","font-weight":"bold"}}," Desde el 16 de mayo de 2024, la cancelación de órdenes requerirá autorización.",-1)),re=n(()=>e("span",{for:"responsible"},"Responsable",-1)),ae=n(()=>e("span",{for:"reason"},"Razón",-1)),de={style:{"text-transform":"capitalize"}},ce={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},ue={id:"factura",style:{width:"100%"}},pe=n(()=>e("i",{class:"pi pi-whatsapp mr-2"},null,-1)),_e=n(()=>e("br",null,null,-1)),me={class:"",style:{width:"auto"}},be={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},ve={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},ye={style:{padding:"0",color:"black","text-align":"center",margin:"auto","margin-bottom":"1rem",width:"max-content","min-width":"max-content",display:"flex","justify-content":"center","flex-direction":"column"}},he=n(()=>e("div",{class:"",style:{"font-weight":"bold",color:"white",margin:"0","background-color":"black","align-items":"center",display:"grid","grid-template-columns":"auto auto"}},[e("div",{style:{width:"100%"}},[e("b",null," productos")]),e("div",null,[e("p",{style:{"text-align":"end","font-weight":"bold"}},[e("b",null," total ")])])],-1)),fe={style:{display:"grid","grid-template-columns":"auto auto"}},ge={class:"p-0 m-0"},we=n(()=>e("br",null,null,-1)),xe={style:{"text-align":"end",color:"black"}},Oe={key:0,class:"p-0 m-0"},ke=n(()=>e("b",null,"COMBO INCLUYE",-1)),De=[ke],Ve={class:"p-0 m-0 ml-5",style:{}},Ce={style:{display:"flex",width:"","justify-content":"space-between"},class:"p-0 m-0"},Ee={class:"p-0 m-0 ml-5",style:{}},Se={class:"p-0 m-0",style:{"text-align":"end"}},Te=n(()=>e("div",{style:{"background-color":"rgba(0, 0, 0, 0.286)",height:"1px"}},null,-1)),Ne={class:"",style:{display:"grid",color:"","margin-top":"0.5rem","grid-template-columns":"auto auto"}},Le=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Subtotal")])],-1)),Re={class:""},Ue={style:{"text-align":"end","font-weight":"bold",color:"black"}},ze=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Domicilio")])],-1)),Ae={class:""},Ie={style:{"text-align":"end","font-weight":"bold",color:"black"}},$e=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold",color:"black"}},[e("b",null,"Total")])],-1)),Be={class:""},je={style:{"text-align":"end",color:"black","font-weight":"bold"}},Pe=n(()=>e("div",{class:""},null,-1)),Me=n(()=>e("p",{style:{"font-weight":"bold","background-color":"black",color:"white",padding:"0",margin:"0","margin-top":"0.5rem"}},[e("b",null,"Notas")],-1)),Fe={class:"notas",style:{border:"1px solid",margin:"0",color:"black",padding:"0.5rem"}},qe=n(()=>e("p",{style:{"background-color":"black","font-weight":"bold","margin-top":"1rem",color:"white"}},[e("b",null,"cliente")],-1)),Ye={style:{display:"grid","grid-template-columns":"auto auto"}},Ge=n(()=>e("div",{class:"",style:{}},[e("span",null,[e("b",null,"NOMBRE")])],-1)),He={class:""},Ze={style:{"text-align":"end",color:"black"}},Je=n(()=>e("div",{style:{}},[e("span",null,[e("b",null,"telefono")])],-1)),Ke={style:{"text-align":"end",color:"black"}},Qe=n(()=>e("div",{style:{}},[e("span",null,[e("b",null,"direccion ")])],-1)),We={style:{"text-align":"end",color:"black"}},Xe=n(()=>e("div",null,[e("span",null,[e("b",null,"metodo de pago")])],-1)),et={style:{"text-align":"end",color:"black"}},tt={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},lt=n(()=>e("h3",null,[e("b",null,"TRASLADO DE SEDE")],-1)),ot=n(()=>e("span",{for:"responsible"},"SELECCIONE LA SEDE DESTINO",-1)),st={__name:"DialogoPedido",setup(D){const T=v(0),V=v(!1),o=W(),z=q(()=>o.currentOrder.pe_json.listaPedidos.reduce((c,t)=>{var x;let f=t.pedido_cantidad*t.pedido_precio;if(t.modificadorseleccionList&&t.modificadorseleccionList.length>0){const h=((x=t.modificadorseleccionList)==null?void 0:x.filter(g=>g.pedido_productoid==t.pedido_productoid)).reduce((g,l)=>g+l.modificadorseleccion_cantidad*l.pedido_precio,0);f+=h}return c+f},0)),Z=q(()=>z.value+o.currentOrder.delivery_price),J=async()=>{var t;const c={order_id:o.currentOrder.order_id,responsible:(t=a.value.responsible)==null?void 0:t.name,reason:a.value.reason};await R.create_cancellling_request(c),V.value=!1,o.Notification.pause(),o.Notification.currentTime=0},w=v(!1),A=v([]);X(async()=>{o.currentOrder.value=o.currentOrder,A.value=await Y.get(`${G}/sites`)});const N=v(!1),C=v(!1),a=v({responsible:null,reason:"Sin razon"}),I=v([{name:"Restaurante",value:"restaurant"},{name:"Cliente",value:"client"}]),$=()=>{a.value.responsible&&R.cancelOrder(o.currentOrder.order_id,a.value.reason,a.value.responsible.name).then(c=>{c&&(N.value=!1,console.log("Order canceled successfully"))}).catch(c=>{console.error("Failed to cancel order:",c)})},K=async()=>{const c=o.currentOrder.order_id,t=T.value;await Y.put(`${G}/traslate-order`,{site_id:t,order_id:c},`trasladando orden ${c}`),o.visibles.currentOrder=!1,C.value=!1};return(c,t)=>{const f=O("Dropdown"),x=O("Textarea"),p=O("Button"),h=O("Dialog"),g=O("Tag");return m(),y(S,null,[e("div",null,[r(h,{visible:N.value,"onUpdate:visible":t[2]||(t[2]=l=>N.value=l),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:d(()=>[le]),default:d(()=>[e("form",{onSubmit:L($,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[oe,r(f,{style:{width:"100%"},id:"responsible",modelValue:a.value.responsible,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.responsible=l),options:I.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),se,r(x,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:a.value.reason,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.reason=l),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),r(p,{style:{width:"100%","border-radius":"0.5rem"},label:"cancelar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),r(h,{visible:V.value,"onUpdate:visible":t[5]||(t[5]=l=>V.value=l),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:d(()=>[ne]),default:d(()=>[e("form",{onSubmit:L(J,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[ie,re,r(f,{style:{width:"100%"},id:"responsible",modelValue:a.value.responsible,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.responsible=l),options:I.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),ae,r(x,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:a.value.reason,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.reason=l),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),r(p,{style:{width:"100%","border-radius":"0.5rem"},label:"solicitar cancelacion",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),r(h,{closable:!1,style:{width:"30rem"},modal:"",visible:w.value,"onUpdate:visible":t[8]||(t[8]=l=>w.value=l)},{footer:d(()=>[e("div",ce,[r(p,{text:"",size:"small",onClick:t[6]||(t[6]=()=>{s(R).deliveryZero(s(o).currentOrder.order_id),w.value=!1}),style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"si"}),r(p,{onClick:t[7]||(t[7]=l=>w.value=!1),size:"small",style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"no"})])]),default:d(()=>[e("span",de,[u(" Esta seguro de llevar a $0.00 el valor del domicilio para la orden "),e("b",null,i(s(o).currentOrder.order_id),1),u(" del cliente "),e("b",null,i(s(o).currentOrder.user_name),1),u("? ")])]),_:1},8,["visible"]),r(h,{class:"mx-3",closeOnEscape:"",closable:!1,visible:s(o).visibles.currentOrder,"onUpdate:visible":t[13]||(t[13]=l=>s(o).visibles.currentOrder=l),modal:"",style:{"max-height":"95vh",width:"35rem",position:"relative"}},{footer:d(()=>[e("div",tt,[r(p,{severity:"help",onClick:t[9]||(t[9]=l=>w.value=!0),style:{width:"100%"},label:"domi $0.00"}),r(p,{size:"small",style:{"border-radius":"0.3rem",width:"100%"},onClick:t[10]||(t[10]=l=>V.value=!0),severity:"danger",label:"CANCELAR "}),r(p,{severity:"warning",onClick:t[11]||(t[11]=l=>C.value=!0),style:{width:"100%","background-color":"black",border:"none"},icon:"pi pi-airplane",label:"traslado"})])]),default:d(()=>{var l,B,j,P,M;return[e("div",ue,[s(o).currentOrder.responsible_id?(m(),H(g,{key:0,style:{},class:"tag mb-2",severity:"success"},{default:d(()=>[pe,u(" TRANSFERENCIA APROBADA")]),_:1})):E("",!0),u(),_e,s(o).currentOrder.responsible_id?(m(),H(g,{key:1,class:"tag",severity:"success"},{default:d(()=>[u(i(s(o).currentOrder.name),1)]),_:1})):E("",!0),e("div",me,[e("p",be," ID:"+i(s(o).currentOrder.order_id),1),e("p",ve,i(s(o).currentOrder.user_name),1),e("p",ye,[e("b",null," fecha: "+i((l=s(o).currentOrder.latest_status_timestamp)==null?void 0:l.split("T")[0]),1),e("b",null," Hora: "+i((M=(P=(j=(B=s(o).currentOrder.latest_status_timestamp)==null?void 0:B.split("T")[1])==null?void 0:j.split(":"))==null?void 0:P.slice(0,2))==null?void 0:M.join(":")),1)]),he,(m(!0),y(S,null,U(s(o).currentOrder.pe_json.listaPedidos,_=>{var F;return m(),y("div",null,[e("div",fe,[e("p",ge,[u(i(_.pedido_cantidad)+" "+i(_.pedido_nombre_producto)+" ",1),we]),e("div",null,[e("p",xe,i(s(k)(_.pedido_precio*_.pedido_cantidad)),1)])]),_.lista_productocombo?(m(),y("p",Oe,De)):E("",!0),_.lista_productocombo?(m(!0),y(S,{key:1},U(_.lista_productocombo,b=>(m(),y("p",Ve,[u(" -- "),e("b",null,i(b.pedido_cantidad),1),u(" "+i(b.pedido_nombre),1)]))),256)):E("",!0),(m(!0),y(S,null,U((F=_.modificadorseleccionList)==null?void 0:F.filter(b=>b.pedido_productoid==_.pedido_productoid),b=>(m(),y("div",Ce,[e("p",Ee,[u(" -- "),e("b",null,i(b.modificadorseleccion_cantidad),1),u(" "+i(b.modificador_nombre),1)]),e("p",Se,i(s(k)(b.pedido_precio)),1)]))),256)),Te])}),256)),e("div",Ne,[Le,e("div",Re,[e("p",Ue,[e("b",null,i(s(k)(z.value)),1)])]),ze,e("div",Ae,[e("p",Ie,[e("b",null,i(s(k)(s(o).currentOrder.delivery_price)),1)])]),$e,e("div",Be,[e("p",je,[e("b",null,i(s(k)(Z.value)),1)])]),Pe]),Me,e("p",Fe,i(s(o).currentOrder.order_notes),1),qe,e("div",Ye,[Ge,e("div",He,[e("p",Ze,i(s(o).currentOrder.user_name),1)]),Je,e("div",null,[e("p",Ke,i(s(o).currentOrder.user_phone),1)]),Qe,e("div",null,[e("p",We,i(s(o).currentOrder.user_address),1)]),Xe,e("div",null,[e("p",et,i(s(o).currentOrder.payment_method),1)])])])]),r(p,{class:"shadow-4",onClick:t[12]||(t[12]=_=>s(o).setVisible("currentOrder",!1)),icon:"pi pi-times",rounded:"",severity:"danger",style:{position:"absolute",top:"-1rem","border-radius":"50%",right:"-1rem"}})]}),_:1},8,["visible"])]),r(h,{visible:C.value,"onUpdate:visible":t[16]||(t[16]=l=>C.value=l),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:d(()=>[lt]),default:d(()=>[e("form",{onSubmit:L($,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[ot,r(f,{style:{width:"100%"},id:"responsible",modelValue:T.value,"onUpdate:modelValue":t[14]||(t[14]=l=>T.value=l),optionValue:"site_id",options:A.value.filter(l=>l.show_on_web),optionLabel:"site_name",placeholder:"Seleccione la sede destino"},null,8,["modelValue","options"]),r(p,{onClick:t[15]||(t[15]=l=>K()),style:{width:"100%","border-radius":"0.5rem"},label:"Trasladar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"])],64)}}},rt=Q(st,[["__scopeId","data-v-f957cab9"]]);export{rt as D};
