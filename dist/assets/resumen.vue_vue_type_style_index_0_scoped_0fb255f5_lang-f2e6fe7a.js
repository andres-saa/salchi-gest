import{u as L,a as _}from"./site-2ae45613.js";import{L as A,K as y,U as v,y as w,l as P}from"./index-7dd807de.js";import{u as k}from"./ventas-3955f29a.js";import"./sass.default-a5b7a582.js";const b={init(){(function(r,t,s,c,n,a,d){r.fbq||(n=r.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},r._fbq||(r._fbq=n),n.push=n,n.loaded=!0,n.version="2.0",n.queue=[],a=t.createElement(s),a.async=!0,a.src=c,d=t.getElementsByTagName(s)[0],d.parentNode.insertBefore(a,d))})(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),fbq("init","9692941457447887");const e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-HGS98CQWJN",e.onload=()=>{window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config","G-HGS98CQWJN")},document.head.appendChild(e)},sendTrackingEvent(e,r){window.fbq&&(e==="Purchase"?fbq("track","Purchase",r):fbq("track",e)),window.gtag&&gtag("event",e,{value:r.total,currency:"COP",items:r.items})}},O=A("client",{persist:{key:"client",storage:localStorage,paths:["user"]},state:()=>({user:{name:"",neigborhood:"",address:"",phone_number:"",payment_method_option:""}}),getters:{fucion:e=>0},actions:{async func(){return func}}}),i=k(),u=L(),o=O(),S=()=>{var g,m,f,h;const e=_();o.user.was_reserva=!1,e.sending_order=!0;const r=e.cart,t=P();o.user.was_reserva=!1,e.sending_order=!0;const s=u.location.site.site_id,c=u.location.site.pe_site_id,n=(g=o.user.payment_method_option)==null?void 0:g.id,a=n===7?0:u.location.neigborhood.delivery_price,d=e.cart.order_notes,l={user_name:o.user.name,user_phone:(m=o.user.phone_number)==null?void 0:m.split(" ").join(""),user_address:` ${o.user.address} ${(h=(f=u.location)==null?void 0:f.neigborhood)==null?void 0:h.name}`||""},p={order_products:[],site_id:s,pe_site_id:c,delivery_person_id:4,payment_method_id:n,delivery_price:a,order_notes:d||"SIN NOTAS",user_data:l,order_aditionals:[],pe_json:r,total:e.cartTotal,inserted_by:t.rawUserData.id};return console.log(p),p},T=()=>{var a,d;o.user.was_reserva=!0,cart.sending_order=!0;const e=cart.cart.products.map(l=>({product_instance_id:l.product.id,quantity:l.quantity})),r=u.location.siteReservas.site_id,t=(a=o.user.payment_method_option)==null?void 0:a.id,s=cart.cart.order_notes,c={user_name:o.user.name,user_phone:(d=o.user.phone_number)==null?void 0:d.split(" ").join(""),user_address:"Debe ir a la sede"};return{order_products:e,site_id:r,delivery_person_id:4,payment_method_id:t,delivery_price:0,order_notes:s||"SIN NOTAS",user_data:c,order_aditionals:[]}},$={async sendOrder(){const e=S(),r=_();if(!q(e))return r.sending_order=!1,null;try{i.setLoading(!0,`enviando tu pedido ${o.user.name}`);const t=await y.post(`${v}/order`,e);if(t.status===200)r.sending_order=!1,r.last_order=t.data,i.setLoading(!1,"enviando tu pedido"),b.sendTrackingEvent("Purchase",{total:r.cart.total_cost,currency:"COP",items:r.cart.products.map(s=>({id:s.product.id,name:s.product.product_name,quantity:s.quantity,price:s.product.price})),value:r.cart.total_cost}),w.push("/call-center-vender/gracias");else return console.error("An error occurred while sending the order:",t.status),alert("An error occurred while sending the order. Please try again."),i.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,null}catch(t){return console.error("An error occurred while sending the order:",t),i.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),r.sending_order=!1,null}},preparar_orden(){S()},async sendOrderReserva(){const e=T(),r=_();if(o.user.was_reserva=!0,!q(e))return r.sending_order=!1,null;try{i.setLoading(!0,`enviando tu pedido ${o.user.name}`);const t=await y.post(`${v}/order`,e);if(t.status===200)r.sending_order=!1,r.last_order=t.data,i.setLoading(!1,"enviando tu pedido"),b.sendTrackingEvent("Purchase",{total:r.cart.total_cost,currency:"COP",items:r.cart.products.map(s=>({id:s.product.id,name:s.product.product_name,quantity:s.quantity,price:s.product.price})),value:r.cart.total_cost}),w.push("/call-center-vender/gracias");else return console.error("An error occurred while sending the order:",t.status),alert("An error occurred while sending the order. Please try again."),i.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,null}catch(t){return console.error("An error occurred while sending the order:",t),i.setLoading(!1,"enviando tu pedido"),r.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),r.sending_order=!1,null}}};function q(e){return!e.user_data.user_name||e.user_data.user_name.trim()==""||!e.user_data.user_phone||e.user_data.user_phone.trim()==""||!e.user_data.user_address||e.user_data.user_address.trim()==""?(alert("Sus datos estan incompletos por favor reviselos"),cart.sending_order=!1,!1):!e.site_id||e.delivery_price==null?(alert("Site information is missing. Please select a valid site."),cart.sending_order=!1,!1):!0}export{$ as o,O as u};
