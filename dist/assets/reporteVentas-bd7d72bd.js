import{_ as W,z as Y,S as K,f as n,u as Q,h as X,g,U as E,T as Z,r as p,o as S,c as R,a as t,d as l,l as i,w as u,F as ee,b as te,q as V,V as I,P as L,v as oe,k as C,t as D,p as se,e as ae,W as le}from"./index-8299c8c8.js";import{R as ne}from"./RepNotificaciones-53c76330.js";const U=h=>(se("data-v-15887e6d"),h=h(),ae(),h),ie={style:{position:"relative"}},re={class:"px-0 pt-0 col-12",style:{display:"flex","z-index":"900",position:"sticky",top:"4rem","background-color":"#fafafa","align-items":"center"}},ce={class:"col-12 grid gap m-0 py-2 px-0"},de={class:"col-12 xl:col-2 px-2 p-2",style:{height:"100%"}},pe={class:"col-12 xl:col-5 p-2",style:{height:"100%"}},ue={class:"col-12 xl:col-3 p-2",style:{height:"100%"}},fe={class:"col-12 xl:col-2 p-2",style:{height:"100%"}},me={class:"contenedor mt-8",style:{position:"sticky",top:"4rem","z-index":"99"}},ve=U(()=>t("span",{class:"text-5xl pt-8",style:{"font-weight":"bold"}},"Vision General",-1)),_e={class:"col-12 px-0 p-0 my-4 p-2",style:{"overflow-x":"auto","background-color":"#ffffff","box-shadow":"0 1rem  1rem rgb(255, 255, 255)"}},ye={class:"px-0 mx-0",style:{width:"max-content","background-color":"#ffffff",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},ge={class:"p-3",style:{display:"flex","align-items":"center","background-color":"rgba(245, 222, 179, 0)"}},he=U(()=>t("div",{class:"app",style:{position:""}},null,-1)),xe={class:"grid p-0 m-0"},be={class:"grid"},we={class:"col-12 px-0 mx-0"},De={class:"col-12",style:{display:"flex","flex-direction":"column"}},ke={class:"text-l",style:{"font-weight":"bold"}},Se={class:"col-12",style:{display:"flex","flex-direction":"column"}},Re={style:{"font-weight":"bold"},class:"text-l"},Ve={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},Ce={class:"col-12",style:{display:"flex","justify-content":"center"}},$e={__name:"reporteVentas",setup(h){const s=Y(),{isDarkTheme:j}=K(),M=n(["enviada","cancelada","en preparacion"]),P=n("enviada"),B=Q(),$=n([]),F=n([]),_=n(!1),x=n(new Date(new Date().setDate(new Date().getDate()-7))),b=n(new Date),m=n(new Date),f=n(new Date);n("");function k(o){const e=new Date,c=new Date(e);c.setDate(c.getDate()+1);const d=new Date(e);d.setDate(e.getDate()-o),m.value=d,f.value=c,s.setDateRange(m.value,f.value),_.value=!1,s.fetchSalesReport()}X(()=>{A().then(o=>{$.value=o}),s.fetchSalesReport()});const z=async()=>{const o=v(x.value),e=v(b.value),c=F.value.map(r=>r.site_id).join(","),d=new URLSearchParams({site_ids:c,status:P.value,start_date:o,end_date:e}),y=`${E}/sales_report?${d.toString()}`;try{const r=await fetch(y,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const w=await r.json();le.value=w,console.log(w)}catch(r){console.error("Fetch error:",r)}};g([x,b],()=>{z()},{deep:!0}),g(()=>s.order_status,(o,e)=>{console.log(`El estado de orden ha cambiado de ${e} a ${o}`),s.fetchSalesReport()}),g(s.selectedSites,o=>{s.setSelectedSites(o)},{deep:!0});const A=async()=>{try{const o=await fetch(`${E}/sites`);if(!o.ok)throw"paila";return await o.json()}catch(o){console.log(o)}},O=n([{name:"Valor ventas",to:"/reporte-ventas/valor-ventas"},{name:"No. Ordenes",to:"/reporte-ventas/no-ordenes"},{name:"Ticket promedio",to:"/reporte-ventas/ticket"},{name:"Ordenes",to:"/reporte-ventas/ordenes"}]);n(null),Z({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),n([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const T=n(null),G=()=>{T.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},H=()=>{T.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};g(j,o=>{o?H():G()},{immediate:!0}),n(`${x.value} - ${b.value}`);function v(o){const e=new Date(o),c=e.getFullYear(),d=(e.getMonth()+1).toString().padStart(2,"0"),y=e.getDate().toString().padStart(2,"0");return`${c}-${d}-${y}`}return n({}),n(),g([m,f],([o,e])=>{o>e&&(alert("La fecha de inicio debe ser anterior o igual a la fecha final."),f.value=o)}),(o,e)=>{const c=p("Dropdown"),d=p("MultiSelect"),y=p("InputText"),r=p("Button"),w=p("RouterLink"),J=p("RouterView"),N=p("Calendar"),q=p("Dialog");return S(),R("div",ie,[t("div",re,[t("div",ce,[t("div",de,[l(c,{modelValue:i(s).order_status,"onUpdate:modelValue":e[0]||(e[0]=a=>i(s).order_status=a),options:M.value,class:"col-12 p-0 m-0",placeholder:"Estado"},null,8,["modelValue","options"])]),t("div",pe,[l(d,{display:"chip",multiple:"",modelValue:i(s).selectedSites,"onUpdate:modelValue":e[1]||(e[1]=a=>i(s).selectedSites=a),optionLabel:"site_name",options:$.value.filter(a=>a.site_id!=12&a.site_id!=13),class:"col-12 p-0 m-0",placeholder:"Sedes"},null,8,["modelValue","options"])]),t("div",ue,[l(y,{onClick:e[2]||(e[2]=a=>_.value=!0),style:{width:"100%"},value:i(s).dateRangeDifference.rangeName||`${v(i(s).dateRange.startDate)} | ${v(i(s).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"])]),t("div",fe,[l(r,{style:{height:"100"},onClick:i(s).fetchSalesReport},{default:u(()=>[t("i",{class:V(i(L).SEARCH)},null,2)]),_:1},8,["onClick"])])])]),t("div",me,[ve,t("div",_e,[t("div",ye,[(S(!0),R(ee,null,te(O.value,a=>(S(),R("div",null,[l(w,{to:a.to},{default:u(()=>[l(r,{style:oe([i(B).fullPath==a.to?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0"}]),class:"text-xl px-0 py-4 mx-0",text:"",severity:"secondary"},{default:u(()=>[C(D(a.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256)),t("div",ge,[l(r,{class:"text-l btn-ocultar",text:"",onClick:i(s).toogleVisibleNotifications,severity:i(s).visibleNotifications?"danger":"success",rounded:"",style:{"font-weight":"bold"}},{default:u(()=>[t("span",null,[t("span",null,D(i(s).visibleNotifications?"Ocultar notificaciones":"Mostrar notificaciones"),1),C(),t("i",{class:V(i(L).ANGLE_DOUBLE_RIGHT)},null,2)])]),_:1},8,["onClick","severity"])])])])]),he,t("div",xe,[t("div",{class:V(["",i(s).visibleNotifications?"col-9":"col-12"])},[l(I,{name:"fade"},{default:u(()=>[l(J)]),_:1})],2),l(I,{name:"noti"},{default:u(()=>[l(ne)]),_:1})]),l(q,{visible:_.value,"onUpdate:visible":e[9]||(e[9]=a=>_.value=a),modal:"",header:"Periodo",style:{width:"25rem"}},{default:u(()=>[t("div",be,[t("div",we,[l(r,{text:"",label:"Últimos 7 días",onClick:e[3]||(e[3]=a=>k(7)),class:"p-button-text col-12 p-1 m-0"}),l(r,{text:"",label:"Últimos 14 días",onClick:e[4]||(e[4]=a=>k(14)),class:"p-button-text col-12 p-1"}),l(r,{text:"",label:"Últimos 28 días",onClick:e[5]||(e[5]=a=>k(28)),class:"p-button-text col-12 p-0"})]),t("div",De,[t("span",ke,"Desde - "+D(v(x.value)),1),l(N,{style:{"min-width":"max-content"},modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value=a)},null,8,["modelValue"])]),t("div",Se,[t("span",Re,"Hasta - "+D(v(b.value)),1),l(N,{style:{"min-width":"max-content"},modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=a=>f.value=a),showWeek:""},null,8,["modelValue"])]),t("div",Ve,[t("div",Ce,[l(r,{onClick:e[8]||(e[8]=()=>{i(s).setDateRange(m.value,f.value),_.value=!1,i(s).fetchSalesReport()})},{default:u(()=>[C("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},Ee=W($e,[["__scopeId","data-v-15887e6d"]]);export{Ee as default};
