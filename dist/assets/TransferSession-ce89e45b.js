import{_ as ce,h as n,af as X,i as M,j as G,U as J,l as pe,s as me,D as K,C as _e,x as ve,au as y,g as d,o as g,c as Q,f as s,e as l,a,q as m,n as W,L as O,t as u,u as f,E as q,d as R,k as $,F as ye,r as fe,p as he,m as ge}from"./index-dbb24084.js";/* empty css                                                                  */import{D as be}from"./DialogoPedido-f6d9bbcc.js";import"./index-558f534d.js";import"./formatoPesos-2293ab52.js";import"./_commonjsHelpers-23102255.js";const _=S=>(he("data-v-4727027a"),S=S(),ge(),S),we={class:"container",style:{"margin-top":"3rem"}},xe=_(()=>a("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"0rem"}}," Transferencias Por Confirmar ",-1)),Te=_(()=>a("h3",null,[a("b",null,"Rechazar orden")],-1)),Pe=_(()=>a("h3",null,[a("b",null,"Aprobar esta orden")],-1)),Se=_(()=>a("h3",null,[a("b",null,"El cliente no realizo' la transferencia")],-1)),De={style:{"max-width":"1280px"},class:"mx-auto"},Ve={style:{display:"flex","align-items":"center",gap:"1rem"}},ke=_(()=>a("h3",{style:{width:"min-content",padding:"0"}},[a("b",null,"Modos")],-1)),Ce={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},Re={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},ze=_(()=>a("span",null,null,-1)),Le={class:"md:mt-0 p-input-icon-right m-3"},Ue=_(()=>a("i",{class:"pi pi-search"},null,-1)),Me={style:{display:"flex",gap:"0.5rem"}},Oe={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"start",display:"flex",gap:"1rem"}},qe={class:"px-2 m-0"},$e=_(()=>a("i",{class:"fa-regular fa-bars-progress"},null,-1)),je={style:{"text-transform":"uppercase"}},Ae={class:"m-0"},Be={__name:"TransferSession",setup(S){const j=n([]),Y=o=>{const t={weekday:"long",year:"numeric",month:"long",day:"numeric"},C={hour:"2-digit",minute:"2-digit",hour12:!0},r=new Date(o).toLocaleDateString("es-ES",t),T=new Date(o).toLocaleTimeString("es-ES",C);return`${r} a las ${T}`};n([{columnName:"SEDE",columnValue:"sede",columnType:"other",size:"1rem",vif:!0},{columnName:"ASESOR",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);const c=n({start_date:new Date,end_date:new Date,sites:[]}),A=n([]),z=X(),Z=o=>{z.setVisible("currentOrder",!0),z.setOrder(o)},ee=async o=>{const t=U.rawUserData.id;await y.authorizeOrder(o,t),b.value=!1,x()},te=async o=>{const t=U.rawUserData.id;await y.rejectOrder(o,t),V.value=!1,x()},B=async()=>{const o=await G.post(`${J}/transaction_report/`,{start_date:c.value.start_date,end_date:c.value.end_date,sites:c.value.sites.map(t=>t.site_id)});E.value=o,o!=null&&o[0]&&(A.value=Object.keys(o[0]))},E=n([]);M(async()=>{j.value=await G.get(`${J}/sites/`),await B()});const L=n(!1),D=n([]),b=n(!1),V=n(!1),U=pe(),v=n({}),N=n({}),ae=n([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]),k=n({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),X(),n(null);const F={revisar:y.getPendientsCancellationRequest,aprobadas:y.getaceptedCancellationAcepted,rechazadas:y.getPendientsCancellationRejected};me(()=>{I()}),K(()=>z.numberTransferRequests,()=>{x()});const se=o=>{b.value=!0,v.value.order_id=o},oe=o=>{V.value=!0,N.value.order_id=o},le=async(o,t,C)=>{const r={authorized:o,responsible_id:U.rawUserData.id,responsible_observation:v.value.reason||"sin observaciones"};await y.resolveCancellationRequest(t,r),b.value=!1,L.value=!1,D.value=await F.revisar()},w=_e(),h=n(),I=()=>{h.value={global:{value:null,matchMode:ve.CONTAINS}}};I(),M(()=>{x()}),M(async()=>{x()});const x=async()=>{D.value=await y.getOrdersTransfer()};return K(()=>w.params.request_status,async()=>{D.value=await F.revisar()},{deep:!0}),(o,t)=>{const C=d("Textarea"),r=d("Button"),T=d("Dialog"),ne=d("Dropdown"),re=d("InputText"),p=d("Column"),H=d("DataTable"),ie=d("Calendar"),de=d("calendar"),ue=d("MultiSelect");return g(),Q("div",we,[xe,s(T,{visible:L.value,"onUpdate:visible":t[2]||(t[2]=e=>L.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[Te]),default:l(()=>[a("form",{onSubmit:t[1]||(t[1]=O(e=>le(!1,v.value.id,v.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(C,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:v.value.reason,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),s(r,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),s(T,{visible:b.value,"onUpdate:visible":t[4]||(t[4]=e=>b.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[Pe]),default:l(()=>[a("form",{onSubmit:t[3]||(t[3]=O(e=>ee(v.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(r,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (Transferencia confirmada)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),s(T,{visible:V.value,"onUpdate:visible":t[6]||(t[6]=e=>V.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[Se]),default:l(()=>[a("form",{onSubmit:t[5]||(t[5]=O(e=>te(N.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(r,{style:{width:"100%","border-radius":"0.5rem"},label:"Archivar (Transferencia no confirmada)",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),a("div",De,[a("div",Ve,[ke,m(),s(ne,{modelValue:k.value,"onUpdate:modelValue":t[7]||(t[7]=e=>k.value=e),options:ae.value,optionLabel:"name"},null,8,["modelValue","options"])]),a("div",Ce,[a("div",{style:W(`transform:translateX(${k.value.slide}%)`),class:"slider-item"},[s(H,{paginator:!0,rows:15,filters:h.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":t[9]||(t[9]=e=>h.value=e),class:"col-12 m-auto",value:D.value,tableStyle:"min-width: 50rem;"},{header:l(()=>[a("div",Re,[ze,a("span",Le,[Ue,s(re,{class:"",modelValue:h.value.global.value,"onUpdate:modelValue":t[8]||(t[8]=e=>h.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:l(()=>[s(p,{style:{"min-width":"max-content"},class:"py-1",field:"order_id",header:"ID orden",frozen:""}),s(p,{style:{},class:"py-1",field:"total_order_price",header:"Monto de la orden"},{body:l(e=>[m(u(f(q)(e.data.total_order_price)),1)]),_:1}),s(p,{style:{},class:"py-1",field:"total_order_price",header:"Fecha y Hora"},{body:l(e=>[m(u(Y(e.data.latest_status_timestamp)),1)]),_:1}),s(p,{style:{},class:"py-1",field:"delivery_price",header:"Domicilio"},{body:l(e=>{var i,P;return[m(u(f(q)((P=(i=e.data.pe_json)==null?void 0:i.delivery)==null?void 0:P.delivery_costoenvio)),1)]}),_:1}),s(p,{style:{},class:"py-1",field:"Total",header:"Total"},{body:l(e=>{var i,P;return[m(u(f(q)(((P=(i=e.data.pe_json)==null?void 0:i.delivery)==null?void 0:P.delivery_costoenvio)+e.data.total_order_price)),1)]}),_:1}),s(p,{style:{},class:"py-1",field:"user_name",header:"Cliente"},{body:l(e=>[m(u(e.data.user_name)+" "+u(e.data.second_name)+" "+u(e.data.first_last_name)+" "+u(e.data.second_last_name),1)]),_:1}),s(p,{style:{},class:"py-1",field:"user_phone",header:"Telefono cliente"}),s(p,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:l(e=>[a("div",Me,[f(w).params.request_status!="aprobadas"?(g(),R(r,{key:0,size:"",onClick:i=>Z(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):$("",!0),f(w).params.request_status!="aprobadas"?(g(),R(r,{key:1,size:"",onClick:i=>se(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):$("",!0),f(w).params.request_status!="aprobadas"?(g(),R(r,{key:2,size:"",onClick:i=>oe(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"danger",class:"p-1",icon:"pi pi-trash"},null,8,["onClick"])):$("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),a("div",{style:W(`transform:translateX(${k.value.slide}%)`),class:"slider-item"},[s(H,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:E.value,tableStyle:"min-width: 50rem;",filters:h.value},{header:l(()=>[a("div",Oe,[a("h4",qe,[$e,m(),a("b",je,[m("Transferencias "),a("b",null,u(f(w).params.section),1)])]),s(ie,{modelValue:c.value.start_date,"onUpdate:modelValue":t[10]||(t[10]=e=>c.value.start_date=e)},null,8,["modelValue"]),s(de,{modelValue:c.value.end_date,"onUpdate:modelValue":t[11]||(t[11]=e=>c.value.end_date=e)},null,8,["modelValue"]),s(ue,{style:{"max-width":"30rem"},modelValue:c.value.sites,"onUpdate:modelValue":t[12]||(t[12]=e=>c.value.sites=e),optionLabel:"site_name",options:j.value.filter(e=>e.show_on_web)},null,8,["modelValue","options"]),s(r,{severity:"help",onClick:B,label:"Buscar",icon:"pi pi-search"})])]),default:l(()=>[(g(!0),Q(ye,null,fe(A.value,e=>(g(),R(p,{class:"py-1",style:{"text-transform":"uppercase"},header:e},{body:l(i=>[a("h6",Ae,u(i.data[e]),1)]),_:2},1032,["header"]))),256))]),_:1},8,["value","filters"])],4)])]),s(be)])}}},Ge=ce(Be,[["__scopeId","data-v-4727027a"]]);export{Ge as default};
