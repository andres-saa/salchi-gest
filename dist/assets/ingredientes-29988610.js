import{g as s,K as J,D as Q,h as W,q as X,d as u,o as i,c as p,e as o,f as m,a as r,F as D,i as f,U as w,s as Y,x as v,r as E,t as g,j as x,m as N,n as b,u as P}from"./index-eb2a5b3d.js";import{f as Z,a as S}from"./formatoPesos-8aa989a0.js";/* empty css                                                     */const ee={class:"m-0 my-3"},te={style:{display:"flex","justify-content":"end"}},ae={style:{"margin-top":"3rem"}},ne={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},le=r("h3",{class:"px-2"},[r("i",{class:"fa fa-carrot"}),N(),r("b",null,"Ingredientes")],-1),ie={style:{display:"flex",width:"100%","justify-content":"end","flex-wrap":"wrap",gap:"1rem","align-items":"center"}},se={style:{display:"flex","justify-content":"end",gap:".5rem"}},pe={__name:"ingredientes",setup(oe){const I=s({}),y=s(!1),a=s({}),$=s([{}]),k=s([]),h=s(!1),_=s(!1),z=t=>{_.value=!0,I.value=t},F=()=>{h.value=!1,a.value={},y.value=!0},R=async()=>{const t=I.value.id;await f.delete(`${w}/delete-ingredient/${t}`,"Borrando ingrediente"),_.value=!1,U()},j=t=>{var n;h.value=!0,a.value={id:t.id,name:t.ingredient_name,purchasing_unit_measure:k.value.find(d=>d.name==t.purchasing_unit_measure),purchasing_unit_measure_id:(n=k.value.find(d=>d.name==t.purchasing_unit_measure)[0])==null?void 0:n.id,purchasing_price:t.purchasing_price,net_gross_weight:t.net_gross_weight},console.log(a.value),y.value=!0},T=[{header:"Id",value:"id",width:"1"},{header:"Nombre ingrediente",value:"ingredient_name",type:"max-content",width:""},{header:"UM de compra",value:"purchasing_unit_measure",width:"10"},{header:"Precio de compra",value:"purchasing_price",width:"10",type:"money"},{header:"Iva",value:"iva",width:"10",type:"percent"}],O=s([...T]);J(()=>{var t;return(t=O.value)==null?void 0:t.map(n=>n.value)});const A=s([{name:"Nombre del ingrediente",fiel:"name",type:"text"},{name:"Unidad de medida de compra",fiel:"purchasing_unit_measure",type:"drop",Options:s(k),optionLable:"name"},{name:"precio de compra",fiel:"purchasing_price",type:"money"},{name:"Presentacion convertir a gramos",fiel:"net_gross_weight",type:"number"},{name:"iva (%)",fiel:"iva",type:"persent"}]);Q(a,async(t,n)=>{var d;a.value.purchasing_unit_measure_id=((d=t.purchasing_unit_measure)==null?void 0:d.id)||null},{deep:!0});const B=async()=>{const t=a.value;if(!t.name||!t.purchasing_unit_measure_id||!t.purchasing_price||!t.net_gross_weight){alert("Por favor llene todos los campos");return}h.value?await f.post(`${w}/update-ingredient/${a.value.id}`,t,"Editando ingrediente"):await f.post(`${w}/create-ingredient`,t,"creando un nuevo ingrediente"),U(),y.value=!1},U=async()=>{$.value=await f.get(`${w}/list-ingredients`,"cargando ingredientes"),k.value=await f.get(`${w}/daily_inventory_unit_measures`)};W(async()=>{U()});const V=s(null),q=()=>{V.value={global:{value:null,matchMode:Y.CONTAINS}}};return X(()=>{q()}),(t,n)=>{const d=u("inputText"),G=u("Dropdown"),C=u("InputNumber"),c=u("Button"),L=u("Dialog"),H=u("InputText"),M=u("column"),K=u("DataTable");return i(),p(D,null,[o(L,{style:{width:"30rem"},header:h.value?"Actualizar Ingrediente":"Nuevo Ingrediente",class:"mx-2",visible:y.value,"onUpdate:visible":n[0]||(n[0]=e=>y.value=e),modal:""},{footer:m(()=>[h.value?(i(),v(c,{key:1,onClick:B,severity:"help",label:"Modificar ingrediente"})):(i(),v(c,{key:0,onClick:B,severity:"help",label:"Guardar ingrediente"}))]),default:m(()=>[(i(!0),p(D,null,E(A.value,e=>(i(),p("div",null,[r("h6",ee,g(e.name),1),e.type=="text"?(i(),v(d,{key:0,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):x("",!0),e.type=="drop"?(i(),v(G,{key:1,options:e.Options,optionLabel:"name",modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"}},null,8,["options","modelValue","onUpdate:modelValue"])):x("",!0),e.type=="money"?(i(),v(C,{key:2,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",prefix:"$"},null,8,["modelValue","onUpdate:modelValue"])):x("",!0),e.type=="number"?(i(),v(C,{key:3,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3"},null,8,["modelValue","onUpdate:modelValue"])):x("",!0),e.type=="persent"?(i(),v(C,{key:4,modelValue:a.value[e.fiel],"onUpdate:modelValue":l=>a.value[e.fiel]=l,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",suffix:"%"},null,8,["modelValue","onUpdate:modelValue"])):x("",!0)]))),256))]),_:1},8,["header","visible"]),o(L,{class:"mx-2",header:"Eliminar ingrediente",visible:_.value,"onUpdate:visible":n[3]||(n[3]=e=>_.value=e),modal:""},{footer:m(()=>[r("div",te,[o(c,{size:"small",label:"cancelar",onClick:n[1]||(n[1]=e=>_.value=!1),severity:"help"}),o(c,{size:"small",onClick:n[2]||(n[2]=e=>R()),label:"Eliminar ingrediente",severity:"danger",text:""})])]),default:m(()=>[r("h6",null,[N("seguro que desea eliminar el Ingrediente "),r("b",null,g(I.value.ingredient_name),1),N(" ?")])]),_:1},8,["visible"]),r("div",ae,[o(K,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} recetas",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:$.value,tableStyle:"min-width: 50rem;",filters:V.value},{header:m(()=>[r("div",ne,[le,o(H,{class:"",modelValue:V.value.global.value,"onUpdate:modelValue":n[4]||(n[4]=e=>V.value.global.value=e),placeholder:"Buscar ingrediente ..."},null,8,["modelValue"])]),r("div",ie,[o(c,{size:"small",severity:"help",onClick:F,label:"Nuevo ingredinte"})])]),default:m(()=>[(i(),p(D,null,E(T,e=>o(M,{header:e.header,style:b(`min-width:${e.width}rem`),field:e.value,class:"py-1"},{body:m(l=>[e.type=="money"?(i(),p("h6",{key:0,style:b([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},g(P(Z)(l.data[e.value])||"-----------"),5)):e.type=="number"?(i(),p("h6",{key:1,style:b([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},g(P(S)(l.data[e.value])||"-----------"),5)):e.type=="percent"?(i(),p("h6",{key:2,style:b([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},g(`${P(S)(l.data[e.value])}%`||"-----------"),5)):(i(),p("h6",{key:3,style:b([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},g(l.data[e.value]||"-----------"),5))]),_:2},1032,["header","style","field"])),64)),o(M,{header:"Accion",style:{width:"min-content"},field:"name",class:"py-1",frozen:"",alignFrozen:"right"},{body:m(e=>[r("div",se,[o(c,{text:"",onClick:l=>j(e.data),class:"m-0 p-0",severity:"warning",style:{height:"2rem",width:"2rem"},icon:"pi pi-pencil"},null,8,["onClick"]),o(c,{text:"",onClick:l=>z(e.data),class:"m-0 p-0",severity:"danger",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash"},null,8,["onClick"])])]),_:1})]),_:1},8,["value","filters"])])],64)}}};export{pe as default};
