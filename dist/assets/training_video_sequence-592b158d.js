import{v as te}from"./videoTrainingService-d345aeaa.js";import{u as pe}from"./urlService-89e3f0c9.js";import{a as se,u as W}from"./dataToInteract-ed054299.js";import{_ as ie,j as u,z as me,I as ee,H,r as p,o as i,g as D,f as d,a as e,e as a,c as L,i as U,F as K,b as Q,d as le,u as b,U as z,h as Y,t as E,A as _e,m as G,q as re,x as de,l as ne,G as ce,k as ve,B as he}from"./index-3fffce46.js";const ae=R=>(re("data-v-360cdd0c"),R=R(),de(),R),ge={style:{width:"100%"}},ye=ae(()=>e("h5",null,[e("b",null,"Estudiantes")],-1)),fe={style:{display:"flex","align-items":"center",gap:"1rem"}},be=ae(()=>e("h6",{class:"m-0"},[e("b",null," Buscar empleado")],-1)),we={key:0,class:"m-0 header"},Se=ae(()=>e("b",null,"Buscar Por Sede",-1)),qe=[Se],xe={key:2,class:"m-0 header"},ke=ae(()=>e("b",null," Buscar Por Cargo",-1)),$e=[ke],Ce={class:"shadow-2 my-2",style:{display:"flex",gap:"1rem",width:"100%","border-radius":".3rem","align-items":"center"}},Te={class:"shadow-2",style:{display:"flex",gap:"1rem",width:"100%","border-radius":".3rem"}},Pe={class:"container",style:{height:"80vh"}},De={key:0,style:{}},Le={class:"students",style:{display:"flex","align-items":"center",gap:"1rem"}},Ie=["src","onError"],Ue={class:"p-0 my-0",style:{"text-transform":"capitalize"}},Re={key:1},Ve={class:"students",style:{display:"flex","align-items":"center",gap:"1rem"}},Be=["onClick","src","onError"],Ee={style:{"text-transform":"capitalize"},class:"p-0 my-0"},Ne={key:2},ze={class:"students",style:{display:"flex","align-items":"center",gap:"1rem"}},Ae=["onClick","src","onError"],Me={class:"p-0 my-0",style:{"text-transform":"capitalize"}},je={class:"pt-4",style:{display:"flex","justify-content":"end",gap:"1rem"}},Oe={__name:"dialogStudents",setup(R){u("");const m=u(""),_=u(""),g=u(null),x=()=>{g.value={global:{value:null,matchMode:_e.CONTAINS}}};me(()=>{x()});const c=se(),k=W(),f=(t,s)=>{var I;const h={masculino:"/images/male-avatar.png",femenino:"/images/female-avatar.png",default:"/images/who.png"};!t||t==""||t=="N/A"?s.target.src=h.default:s.target.src=h[(I=t.trim())==null?void 0:I.toLowerCase()]};u({});function v(t){let s=[];for(let h in t)t.hasOwnProperty(h)&&(s=s.concat(t[h]));return[...s,...j.value]}const $=ee(()=>v(S.value)),w=u([{name:"INSCRITOS",id:0},{name:"INSCRIBIR",id:1}]),A=u([{name:"INDIVIDUAL",id:0},{name:"SEDES",id:1},{name:"CARGOS",id:2}]),r=u(A.value[0]),C=async()=>{const t={sequence_id:c.secuence_students.sequence_id,users:$.value.map(s=>s.id)};console.log(t),await G.put(`${z}/togle_users_to_sequence_video`,t,"actualizando estudiantes"),n.value=w.value[0]},n=u(w.value[0]),T=async(t,s)=>{var I;const h=c.secuence_students.sequence_id;if(t==0&&(s==0?y.value=await G.get(`${z}/list-video-training-student-enrolled-by-sequence-id/${h}`):s==1?y.value=await G.get(`${z}/list-video-training-student-enrolled-by-sequence-id-group-by-site/${h}`):s==2&&(y.value=await G.get(`${z}/list-video-training-student-enrolled-by-sequence-id-group-by-position/${h}`))),t==1&&(s==0?y.value=await G.get(`${z}/list-all-video-training-student-by-sequence-id/${h}`):s==1?y.value=await G.get(`${z}/list-all-video-training-student-by-sequence-id-group-by-site/${h}`):s==2&&(y.value=await G.get(`${z}/list-all-video-training-student-by-sequence-id-group-by-position/${h}`))),s===0)j.value=((I=y.value)==null?void 0:I.filter(B=>B.enrolled))||[];else{S.value={};for(const[B,N]of Object.entries(y.value||{}))S.value[B]=N==null?void 0:N.filter(O=>O.enrolled)}};u("");const y=u([{}]),j=u([]),S=u({});u({}),H(()=>k.showSequenceStudents,async t=>{t&&(n.value=w.value[0],r.value=A.value[0],await T(0,0))},{deep:!0}),H(n,async t=>{c.secuence_students.sequence_id,await T(t.id,r.value.id)},{deep:!0}),H(r,async(t,s)=>{j.value=[],S.value={},console.log(v(S.value)),await T(n.value.id,t.id),console.log(n.value.id,t.id)},{deep:!0}),H(r,t=>{t.id===1?_.value="":t.id===2&&(m.value="")}),H(m,()=>{m.value&&(_.value="")}),H(_,()=>{_.value&&(m.value="")});const M=t=>{n.value=t},oe=t=>{r.value=t},o=t=>(t??"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),V=ee(()=>{var t,s;return o((s=(t=g.value)==null?void 0:t.global)==null?void 0:s.value)});ee(()=>{if(r.value.id!==0)return y.value;const t=V.value;return(Array.isArray(y.value)?y.value:[]).filter(s=>o(s.user_name).includes(t)||o(s.dni).includes(t))});const F=ee(()=>{if(r.value.id===0||!y.value)return{};const t=V.value,s=o(m.value),h=o(_.value),I={};for(const[B,N]of Object.entries(y.value)){if(!Array.isArray(N)||r.value.id===1&&s&&!o(B).includes(s)||r.value.id===2&&h&&!o(B).includes(h))continue;const O=N.filter(X=>o(X.user_name).includes(t)||o(X.dni).includes(t));O.length&&(I[B]=O)}return I});return(t,s)=>{const h=p("InputText"),I=p("Button"),B=p("Column"),N=p("column"),O=p("DataTable"),X=p("Dialog");return i(),D(X,{visible:b(k).showSequenceStudents,"onUpdate:visible":s[5]||(s[5]=l=>b(k).showSequenceStudents=l),closable:!1,class:"p-0 m-3",header:"Estudiantes",style:{width:"60rem","min-height":"80vh"},modal:""},{header:d(()=>[e("div",ge,[ye,e("div",fe,[be,a(h,{style:{height:"2rem"},modelValue:g.value.global.value,"onUpdate:modelValue":s[0]||(s[0]=l=>g.value.global.value=l),placeholder:"Buscar a un trabajador"},null,8,["modelValue"]),r.value.id==1?(i(),L("h6",we,qe)):U("",!0),r.value.id==1?(i(),D(h,{key:1,class:"header",style:{height:"2rem"},modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=l=>m.value=l),placeholder:"Buscar una sede..."},null,8,["modelValue"])):U("",!0),r.value.id==2?(i(),L("h6",xe,$e)):U("",!0),r.value.id==2?(i(),D(h,{key:3,class:"header",style:{height:"2rem"},modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=l=>_.value=l),placeholder:"Buscar un cargo..."},null,8,["modelValue"])):U("",!0)]),e("div",Ce,[(i(!0),L(K,null,Q(w.value,l=>(i(),D(I,{class:le([n.value==l?"selected":"","px-3 py-2"]),style:{"border-radius":"0",color:"var(--text-color)"},onClick:P=>M(l),text:"",label:l.name},null,8,["class","onClick","label"]))),256))]),e("div",Te,[(i(!0),L(K,null,Q(A.value,l=>(i(),D(I,{size:"small",class:le([r.value==l?"selected":"","px-3 py-2 my-"]),style:{"border-radius":"0",color:"var(--text-color)"},onClick:P=>oe(l),text:"",label:l.name},null,8,["class","onClick","label"]))),256))])])]),footer:d(()=>[e("div",je,[a(I,{text:"",class:"m-0",onClick:s[4]||(s[4]=l=>b(k).showSequenceStudents=!1),severity:"danger",label:"Cerrar"}),a(I,{class:"m-0",onClick:C,severity:"help",label:"Actualizar Estudiantes"})])]),default:d(()=>[e("div",Pe,[r.value.id==0?(i(),L("div",De,[r.value.id==0&&y.value.length>0?(i(),D(O,{key:0,paginator:!1,rows:10,style:{width:"100%"},selection:j.value,"onUpdate:selection":s[3]||(s[3]=l=>j.value=l),paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} contratos",rowsPerPageOptions:[5,10,25,100],showGridlines:"",stripedRows:"",class:"col-12 m-auto p-0",filters:g.value,value:y.value},{default:d(()=>[n.value.id==1?(i(),D(B,{key:0,class:"py-2",selectionMode:"multiple",headerStyle:"width: 3rem; "})):U("",!0),a(N,{class:"p-2",header:"Empleados",field:"user_name"},{body:d(l=>{var P;return[e("div",Le,[e("img",{src:`${b(z)}/read-product-image/96/employer-${l.data.dni}`,onError:q=>f(l.data.gender,q),class:"shadow-2 img-profile",style:{border:"none",position:"relative",height:"2rem",width:"2rem","object-fit":"cover","border-radius":"50%"}},null,40,Ie),Y(),e("h6",Ue,E((P=l.data.user_name)==null?void 0:P.toLowerCase()),1)])]}),_:1})]),_:1},8,["selection","filters","value"])):U("",!0)])):U("",!0),r.value.id==1?(i(),L("div",Re,[(i(!0),L(K,null,Q(F.value,(l,P)=>(i(),L("div",{style:{},key:P},[r.value.id==1&&l.length>0?(i(),D(O,{key:0,paginator:!1,rows:15,style:{width:"100%"},selection:S.value[P],"onUpdate:selection":q=>S.value[P]=q,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} contratos",rowsPerPageOptions:[5,10,25,100],showGridlines:"",stripedRows:"",class:"col-12 m-auto p-0",value:l,filters:g.value},{default:d(()=>[n.value.id==1?(i(),D(B,{key:0,class:"py-2",selectionMode:"multiple",headerStyle:"width: 3rem; "})):U("",!0),a(N,{class:"p-2",style:{"text-transform":"uppercase"},header:P,field:"user_name"},{body:d(q=>{var Z;return[e("div",Ve,[e("img",{onClick:J=>t.verIMagen(q.option.dni),src:`${b(z)}/read-product-image/96/employer-${q.data.dni}`,onError:J=>f(q.data.gender,J),class:"shadow-2 img-profile",style:{border:"none",position:"relative",height:"2rem",width:"2rem","object-fit":"cover","border-radius":"50%"}},null,40,Be),e("h6",Ee,E((Z=q.data.user_name)==null?void 0:Z.toLowerCase()),1)])]}),_:2},1032,["header"])]),_:2},1032,["selection","onUpdate:selection","value","filters"])):U("",!0)]))),128))])):U("",!0),r.value.id==2?(i(),L("div",Ne,[(i(!0),L(K,null,Q(F.value,(l,P)=>(i(),L("div",{style:{},key:P},[r.value.id==2&&l.length>0?(i(),D(O,{key:0,paginator:!1,rows:15,style:{width:"100%"},selection:S.value[P],"onUpdate:selection":q=>S.value[P]=q,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} contratos",rowsPerPageOptions:[5,10,25,100],showGridlines:"",stripedRows:"",class:"col-12 m-auto p-0",value:l,filters:g.value},{default:d(()=>[n.value.id==1?(i(),D(B,{key:0,class:"py-2",selectionMode:"multiple",headerStyle:"width: 3rem; "})):U("",!0),a(N,{class:"p-2",style:{"text-transform":"uppercase"},header:P,field:"user_name"},{body:d(q=>{var Z;return[e("div",ze,[e("img",{onClick:J=>t.verIMagen(q.option.dni),src:`${b(z)}/read-product-image/96/employer-${q.data.dni}`,onError:J=>f(q.data.gender,J),class:"shadow-2 img-profile",style:{border:"none",position:"relative",height:"2rem",width:"2rem","object-fit":"cover","border-radius":"50%","text-transform":"capitalize"}},null,40,Ae),Y(),e("h6",Me,E((Z=q.data.user_name)==null?void 0:Z.toLowerCase()),1)])]}),_:2},1032,["header"])]),_:2},1032,["selection","onUpdate:selection","value","filters"])):U("",!0)]))),128))])):U("",!0)])]),_:1},8,["visible"])}}},Fe=ie(Oe,[["__scopeId","data-v-360cdd0c"]]),Ge={style:{height:"100%"}},He=e("h6",null,"Nombre del nuevo curso",-1),Ye=e("h6",null,"Descripcion u objetivo",-1),Ze={__name:"dialogToAddSequence",emits:["update"],setup(R,{emit:m}){const _=m,g=ne(),x=W(),c=u({}),k=ce(),f=async()=>{const v={...c.value,created_by:g.rawUserData.id,sesion_id:k.params.sesion_id};await te.createSequence(v),x.addSequence=!1,_("update")};return(v,$)=>{const w=p("InputText"),A=p("Textarea"),r=p("Button"),C=p("Dialog");return i(),D(C,{visible:b(x).addSequence,"onUpdate:visible":$[2]||($[2]=n=>b(x).addSequence=n),class:"p-0 m-3",header:"Registrar nuevo curso",style:{width:"30rem"},modal:""},{footer:d(()=>[a(r,{class:"m-0",onClick:f,severity:"help",label:"Crear Curso"})]),default:d(()=>[e("div",Ge,[He,a(w,{modelValue:c.value.name,"onUpdate:modelValue":$[0]||($[0]=n=>c.value.name=n),style:{width:"100%"}},null,8,["modelValue"]),Ye,a(A,{modelValue:c.value.description,"onUpdate:modelValue":$[1]||($[1]=n=>c.value.description=n),style:{width:"100%",resize:"none"},rows:"4"},null,8,["modelValue"])])]),_:1},8,["visible"])}}},Je={style:{height:"100%"}},Ke=e("br",null,null,-1),Qe={__name:"dialogToDeleteSequence",emits:["update"],setup(R,{emit:m}){const _=m;ne();const g=W(),x=se();u({});const c=async()=>{const k=x.sequenceToDelete.sequence_id;await te.deleteSequence(k),g.deleteSequence=!1,_("update")};return(k,f)=>{const v=p("Button"),$=p("Dialog");return i(),D($,{visible:b(g).deleteSequence,"onUpdate:visible":f[0]||(f[0]=w=>b(g).deleteSequence=w),class:"p-0 m-3",header:"Borrar un curso",style:{width:"30rem"},modal:""},{footer:d(()=>[a(v,{icon:"pi pi-trash",class:"m-0",onClick:c,severity:"danger",label:"Eliminar Curso"})]),default:d(()=>{var w;return[e("div",Je,[e("h6",null,[Y("Seguro que desea borrar el curso "),Ke,Y(),e("b",null,E((w=b(x).sequenceToDelete)==null?void 0:w.sequence_name),1),Y(" ? ")])])]}),_:1},8,["visible"])}}},We={style:{height:"100%"}},Xe=e("h6",null,"Nombre del Curso",-1),et=e("h6",null,"Descripcion u objetivo",-1),tt={__name:"dialogToEditSequence",emits:["update"],setup(R,{emit:m}){const _=se(),g=m;ne();const x=W(),c=u({..._.sequenceToUpdate});H(()=>_.sequenceToUpdate,f=>{c.value={...f}},{deep:!0}),u({});const k=async()=>{const f=c.value.sequence_id,v={name:c.value.sequence_name,description:c.value.description};await te.updateSequence(f,v),x.updateSequence=!1,g("update")};return(f,v)=>{const $=p("InputText"),w=p("Textarea"),A=p("Button"),r=p("Dialog");return i(),D(r,{visible:b(x).updateSequence,"onUpdate:visible":v[2]||(v[2]=C=>b(x).updateSequence=C),class:"p-0 m-3",header:"Actualizar Curso",style:{width:"30rem"},modal:""},{footer:d(()=>[a(A,{class:"m-0",onClick:k,severity:"warning",label:"Actualizar CURSO"})]),default:d(()=>[e("div",We,[Xe,a($,{modelValue:c.value.sequence_name,"onUpdate:modelValue":v[0]||(v[0]=C=>c.value.sequence_name=C),style:{width:"100%"}},null,8,["modelValue"]),et,a(w,{modelValue:c.value.description,"onUpdate:modelValue":v[1]||(v[1]=C=>c.value.description=C),style:{width:"100%",resize:"none"},rows:"4"},null,8,["modelValue"])])]),_:1},8,["visible"])}}};const ue=R=>(re("data-v-3d4f87e0"),R=R(),de(),R),st={class:"container py-6"},at={style:{height:"100%"}},ot=["src"],nt={class:"text-center"},lt={class:"grid p-2",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},it=ue(()=>e("h4",{class:"px-2"},[e("i",{class:"fa fa-glasses"}),Y(),e("b",null,"Cursos")],-1)),rt={style:{display:"flex","justify-content":"start","align-items":"center"}},dt={class:"",style:{"text-transform":"capitalize"}},ct={class:"date"},ut={class:"date"},pt={style:{"min-width":"max-content"}},mt={class:"",style:{display:"flex",gap:"1rem","align-items":"center"}},_t=["onClick","src"],vt=ue(()=>e("span",{class:""},[e("b",null,[e("i",{class:"text-4xl pi pi-ellipsis-h"})])],-1)),ht={__name:"training_video_sequence",setup(R){const m=se(),_=W(),g=ce(),x=(n,T)=>{he.push({name:"video-training-video-admin",params:{sequence_id:n,sequence_name:T}})},c=n=>{const T=n.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]+)(?:\?.*)?/);return T&&T[1]?`https://www.youtube.com/embed/${T[1]}`:(console.error("La URL del video no es vÃ¡lida: ",n),"")},k=u({}),f=u(!1),v=u([]),$=n=>{m.sequenceToDelete={},m.sequenceToDelete=n,_.deleteSequence=!0},w=n=>{m.secuence_students={},m.secuence_students=n,_.showSequenceStudents=!0},A=n=>{k.value=n,f.value=!0},r=n=>{m.sequenceToUpdate={},m.sequenceToUpdate=n,_.updateSequence=!0},C=async()=>{v.value=await te.getVideoSequencesBySesionId(g.params.sesion_id)};return ve(async()=>{C()}),(n,T)=>{const y=p("Dialog"),j=p("InputText"),S=p("Button"),M=p("column"),oe=p("DataTable");return i(),L("div",st,[a(Ze,{onUpdate:C}),a(Qe,{onUpdate:C}),a(tt,{onUpdate:C}),a(Fe),a(y,{visible:f.value,"onUpdate:visible":T[0]||(T[0]=o=>f.value=o),class:"p-0 m-3",header:`Reproductor de video\r
    `,modal:"",style:{width:"100%","max-width":"150vh","aspect-ratio":"16  / 9"}},{default:d(()=>[e("div",at,[e("iframe",{class:"p-0",width:"100%",style:{"aspect-ratio":"16 / 9"},src:c(k.value),title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:""},null,8,ot)])]),_:1},8,["visible"]),e("h2",nt,[e("b",null,"GESTIONAR ESCUELA "+E(b(g).params.sesion_name),1)]),a(oe,{paginator:!0,rows:15,style:{width:"100%","max-width":"1280px"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Capacitaciones",showGridlines:"",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:v.value,tableStyle:"min-width: 50rem;"},{header:d(()=>[e("div",lt,[it,a(j,{class:"",style:{width:"100%","max-width":"500px"},placeholder:"Buscar Secuencia..."}),a(S,{onClick:T[1]||(T[1]=o=>b(_).addSequence=!0),severity:"help",label:"Nuevo curso"})])]),default:d(()=>[a(M,{header:"Id",class:"",field:"created_time"},{body:d(o=>[e("h6",null,E(o.data.sequence_id),1)]),_:1}),a(M,{header:"Nombre",class:"",field:"created_time"},{body:d(o=>[e("h6",null,E(o.data.sequence_name),1),e("div",rt,[a(S,{severity:"help",onClick:V=>x(o.data.sequence_id,o.data.sequence_name),text:"",icon:"fa-solid fa-eye"},null,8,["onClick"]),a(S,{onClick:V=>r(o.data),text:"",icon:"fa-solid fa-pencil"},null,8,["onClick"]),a(S,{text:"",onClick:V=>$(o.data),severity:"danger",icon:"fa-solid fa-trash"},null,8,["onClick"]),a(S,{severity:"success",onClick:V=>w(o.data),text:"",label:"Estudiantes",icon:"fa-solid fa-graduation-cap"},null,8,["onClick"])])]),_:1}),a(M,{header:"Descripcion",style:{"min-width":"30rem"},class:"px-4",field:"created_time"},{body:d(o=>{var V;return[e("h6",dt,E((V=o.data.description)==null?void 0:V.toLowerCase()),1)]}),_:1}),a(M,{header:"Fecha",class:"",field:"created_time"},{body:d(o=>[e("h6",ct,E(o.data.created_date),1)]),_:1}),a(M,{header:"Hora",field:"created_time"},{body:d(o=>[e("h6",ut,E(o.data.created_time),1)]),_:1}),a(M,{header:"Creador",class:"date",field:"created_time"},{body:d(o=>[e("h6",pt,E(o.data.creator_name),1)]),_:1}),a(M,{header:"Clases",class:"px-4"},{body:d(o=>{var V;return[e("div",mt,[(i(!0),L(K,null,Q((V=o.data.video_links)==null?void 0:V.filter(F=>F),F=>(i(),L("img",{onClick:t=>A(F),class:"img-courses",style:{width:"9rem",cursor:"pointer","border-radius":".3rem","aspect-ratio":"16 / 9","object-fit":"cover"},src:b(pe).getThumbnail(F),alt:""},null,8,_t))),256)),Y(),vt])]}),_:1})]),_:1},8,["value"])])}}},wt=ie(ht,[["__scopeId","data-v-3d4f87e0"]]);export{wt as default};
