import{r as D}from"./resumen-deb0d0b5.js";import{u as F,a as N}from"./site-99fcb486.js";import{f as T}from"./formatoPesos-2a38d2e7.js";import{a as I}from"./aditionalService-71616c6a.js";import{r as k,x as B,i as U,a as b,o as n,e as E,w as P,b as e,g as r,c as l,F as x,d as $,t as v,u,f as S,k as G,_ as L,p as H,h as M}from"./index-0d1140a0.js";import{u as O}from"./user-4200a8ac.js";import"./ventas-85fbf1e3.js";const J="/images/empty-cart.jpg",K={style:{color:"black"},class:"grid"},Q={class:"mb-2"},R={class:"mb-2 text-center"},W={class:"mt-2"},X={key:0,class:"p-0",style:{display:"flex",width:"100%",gap:"1rem"}},Y={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},Z={class:"text-sm adicion",style:{"text-transform":"capitalize"}},ee={key:0,style:{display:"flex","align-items":"center"}},te={key:0,class:"pl-2 py-1 text-sm"},ie={key:1,class:"pl-2 py-1 text-sm"},oe=e("hr",null,null,-1),se={class:"col-12 p-0",style:{display:"flex","justify-content":"center","font-weight":"bold"}},ne={__name:"dialogAddAditions",setup(w){const o=k({}),C=F(),y=N(),A=(s,a)=>{if(s.checked){const h={id:s.aditional_item_instance_id,name:s.aditional_item_name,price:s.aditional_item_price,group:a};o.value[h.id]={...h,quantity:s.quantity||1}}else delete o.value[s.aditional_item_instance_id]},q=s=>{if(s.checked){const a={id:s.aditional_item_instance_id,name:s.aditional_item_name,price:s.aditional_item_price};o.value[a.id].quantity++}},V=s=>{o.value[s.aditional_item_instance_id].quantity>1&&o.value[s.aditional_item_instance_id]&&o.value[s.aditional_item_instance_id].quantity--};B(()=>y.visibles.addAdditionToCart,async s=>{var a,h;if(!s)o.value={},f.value=[];else{const i=y.cart.products.map(d=>d.product.id);i.length>0&&(f.value=await I.getAditionalGroup(i,(h=(a=C.location)==null?void 0:a.site)==null?void 0:h.site_id))}},{deep:!0});const j=()=>{Object.values(o.value).forEach(a=>{y.addAdditionToCart(a),console.log(a)}),o.value={},y.setVisible("addAdditionToCart",!1)},f=k([]);return k(!0),U(async()=>{var a,h;const s=y.cart.products.map(i=>i.product.id);s.length>0&&(f.value=await I.getAditionalGroup(s,(h=(a=C.location)==null?void 0:a.site)==null?void 0:h.site_id))}),(s,a)=>{const h=b("Checkbox"),i=b("Button"),d=b("InputText"),c=b("Dialog");return n(),E(c,{class:"mx-3",closable:!0,style:G([{"background-color":"white"},{width:"30rem","border-radius":"0.5rem"}]),visible:u(y).visibles.addAdditionToCart,"onUpdate:visible":a[1]||(a[1]=p=>u(y).visibles.addAdditionToCart=p),modal:"",header:"Header"},{footer:P(()=>[e("div",se,[r(i,{onClick:j,style:{width:"auto"},severity:"danger",label:"Agregar al carrito"})])]),default:P(()=>[e("div",K,[(n(!0),l(x,null,$(f.value,p=>(n(),l("div",{class:"col-12",style:{},key:p.category},[e("div",Q,[e("span",R,[e("b",null,v(p.category),1)]),e("div",W,[(n(!0),l(x,null,$(p.items,t=>{var _,m;return n(),l("div",{key:t.aditional_item_instance_id,style:{display:"flex",gap:"1rem"}},[u(y).cart.products.some(g=>g.product.category_name==t.product_category_name)?(n(),l("div",X,[r(h,{class:"my-1",binary:!0,modelValue:t.checked,"onUpdate:modelValue":g=>t.checked=g,onChange:()=>A(t,p.category)},null,8,["modelValue","onUpdate:modelValue","onChange"]),e("div",Y,[e("span",Z,v(t.aditional_item_name),1),t.checked&&p.category!="SALSAS"?(n(),l("span",ee,[t.aditional_item_price>0?(n(),l("span",te,[e("b",null,v(u(T)(t.aditional_item_price*((_=o.value[t.aditional_item_instance_id])==null?void 0:_.quantity))),1)])):S("",!0),r(i,{onClick:g=>V(t),class:"ml-2",severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none"},icon:"pi pi-minus"},null,8,["onClick"]),r(d,{modelValue:(m=o.value[t.aditional_item_instance_id])==null?void 0:m.quantity,readonly:"",style:{width:"2rem",border:"none",height:"1.5rem"},class:"p-0 text-center"},null,8,["modelValue"]),r(i,{onClick:g=>q(t),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none"},icon:"pi pi-plus"},null,8,["onClick"])])):t.aditional_item_price>0?(n(),l("span",ie,[e("b",null,v(u(T)(t.aditional_item_price)),1)])):S("",!0)])])):S("",!0)])}),128)),oe])])]))),128))]),r(i,{onClick:a[0]||(a[0]=p=>u(y).setVisible("addAdditionToCart",!1)),icon:"pi pi-times",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",severity:"danger"})]),_:1},8,["visible"])}}};const z=w=>(H("data-v-3f2f5639"),w=w(),M(),w),ae={key:0,class:"col-12 my-4 md:my-8 p-0"},le={class:"grid mx-auto",style:{"max-width":"800px"}},re={class:"col-12 text-sm md:col-6 p-2 md:px-4",style:{display:"flex","flex-direction":"column",gap:"1rem","justify-content":"center"}},de={class:"col-12 py-3 p-shadow",style:{display:"flex","align-items":"end",position:"relative",gap:"1rem","border-radius":"0.3rem"}},ce=["src"],pe={style:{display:"flex","flex-direction":"column",gap:"0.4rem",width:"100%"}},ue={style:{display:"flex","flex-direction":"column",gap:"0.3rem",width:"100%"}},_e={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"100%",gap:"1rem"}},me={class:"p-0 m-0"},he={style:{"text-transform":"uppercase","font-weight":"bold"}},ye={style:{display:"flex"}},ve=z(()=>e("div",null,null,-1)),ge={class:"p-0",style:{"box-shadow":"0 0 0.5rem rgba(0, 0, 0, 0.2)","background-color":"#ff620000","border-radius":"5rem",display:"flex"}},fe={class:"p-0 m-0"},be={class:"col-12 p-0 mt-1"},xe={class:"mb-2"},ke={class:"mb-2 text-center"},we={class:"mt-2"},Ce={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},Ae={class:"text adicion",style:{"text-transform":"capitalize"}},$e={style:{display:"flex","align-items":"center"}},Se={key:0,class:"pl-2 py-1 text-sm"},Ve={key:1,style:{"box-shadow":"0 0 5px rgba(0, 0, 0, 0.411)",display:"flex","border-radius":"0.3rem"},class:"ml-2"},Te={key:1,class:"col-12",style:{display:"flex","justify-content":"center",height:"90vh","align-items":"center"}},qe=z(()=>e("img",{style:{"border-radius":"0",width:"100%","max-width":"500px"},src:J,alt:""},null,-1)),je=[qe],Ie={__name:"cart",setup(w){const o=N(),C=F(),y=k({}),A=k({}),q=O(),V=()=>{A.value=o.cart.additions.reduce((i,d)=>{let c=d.group;return i[c]||(i[c]=[]),i[c].push(d),i},{})};B(()=>o.cart.additions,()=>{V()},{deep:!0});const j=i=>{const d={...i};d.quantity=1,o.addAdditionToCart(d)},f=i=>{i.quantity>1&&o.removeAdditionFromCart(i.id)},s=i=>{o.removeAdditionCompletelyFromCart(i.id),V()},a=i=>{i.forEach(d=>{s(d)})};B(()=>o.visibles.addAdditionToCart,i=>{i&&(y.value={})},{deep:!0});const h=k([]);return U(async()=>{var d,c;((c=(d=q.user)==null?void 0:d.payment_method_option)==null?void 0:c.id)!=7?C.setNeighborhoodPrice():C.setNeighborhoodPriceCero();const i=53;h.value=await I.getAditional(i),A.value=o.cart.additions.reduce((p,t)=>{let _=t.group;return p[_]||(p[_]=[]),p[_].push(t),p},{})}),(i,d)=>{const c=b("Button"),p=b("InputText");return n(),l(x,null,[u(o).cart.products.length>0?(n(),l("div",ae,[e("div",le,[e("div",re,[(n(!0),l(x,null,$(u(o).cart.products,t=>(n(),l("div",de,[e("img",{style:{width:"5rem","object-fit":"cover",height:"5rem"},src:`https://backend.salchimonster.com/read-product-image/96/${t.product.product_name}`,alt:""},null,8,ce),r(c,{class:"ml-2",onClick:_=>u(o).removeProductFromCart(t.product.id),icon:"pi pi-trash",severity:"danger",rounded:"",style:{border:"none",right:"-.5rem",top:"-.5rem",position:"absolute",outline:"none",width:"2rem",height:"2rem"}},null,8,["onClick"]),e("div",pe,[e("div",ue,[e("div",_e,[e("span",me,v(t.product.product_name),1)]),e("span",he,v(t.product.category_name),1),e("div",ye,[ve,e("div",ge,[r(c,{onClick:_=>u(o).removeProductInstance(t.product.id),icon:"pi pi-minus",severity:"danger",style:{border:"none",outline:"none",width:"2rem",height:"1.5rem","border-radius":"0.4rem 0 0 0.4rem"}},null,8,["onClick"]),r(p,{class:"text-center",style:{"background-color":"transparent","font-weight":"bold",width:"3rem",height:"1.5rem",color:"black",border:"none"},modelValue:t.quantity,readonly:""},null,8,["modelValue"]),r(c,{onClick:_=>u(o).addProductToCart(t.product),icon:"pi pi-plus ",severity:"danger",style:{"font-weight":"bold",border:"none",outline:"none",width:"2rem",height:"1.5rem","border-radius":"0 0.4rem   0.4rem 0"}},null,8,["onClick"])])])])]),e("h5",fe,[e("b",null,v(u(T)(t.total_cost)),1)])]))),256)),e("div",be,[(n(!0),l(x,null,$(A.value,(t,_)=>(n(),l("div",{class:"p-shadow p-3 mb-4",key:_,style:{position:"relative","border-radius":"0.3rem"}},[r(c,{class:"ml-2",onClick:m=>a(t),icon:"pi pi-trash",severity:"danger",rounded:"",style:{border:"none",right:"-.5rem",top:"-.5rem",position:"absolute",outline:"none",width:"2rem",height:"2rem"}},null,8,["onClick"]),e("div",xe,[e("span",ke,[e("b",null,v(_),1)]),e("div",we,[(n(!0),l(x,null,$(t,m=>(n(),l("div",{key:m.aditional_item_instance_id,style:{display:"flex",gap:"1rem","align-items":"center"}},[r(c,{text:"",rounded:"",onClick:g=>s(m),class:"p-0 m-0",severity:"danger",style:{width:"2rem",height:"2rem",border:"none"},icon:"pi pi-trash m-0"},null,8,["onClick"]),e("div",Ce,[e("span",Ae,v(m.name),1),e("span",$e,[m.price>0?(n(),l("span",Se,[e("b",null,v(u(T)(m.price*m.quantity)),1)])):S("",!0),_!="SALSAS"?(n(),l("div",Ve,[r(c,{onClick:g=>f(m),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none","border-radius":"0.3rem 0 0 0.3rem"},icon:"pi pi-minus"},null,8,["onClick"]),r(p,{modelValue:m.quantity,readonly:"",style:{width:"2rem",border:"none",height:"1.5rem"},class:"p-0 text-center"},null,8,["modelValue"]),r(c,{onClick:g=>j(m),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none","border-radius":"0 0.3rem 0.3rem 0"},icon:"pi pi-plus"},null,8,["onClick"])])):S("",!0)])])]))),128))])])]))),128)),e("div",{onClick:d[0]||(d[0]=t=>u(o).setVisible("addAdditionToCart",!0)),class:"col-12 p-0 m-0",style:{display:"flex","justify-content":"end"}},[r(c,{style:{width:"2rem",left:".3rem",height:"2rem"},rounded:"",severity:"danger",icon:"pi pi-plus"})])])]),r(D,{class:"md:col-6"})])])):(n(),l("div",Te,je)),r(ne)],64)}}},Ee=L(Ie,[["__scopeId","data-v-3f2f5639"]]);export{Ee as default};
