import{_ as pe,f as r,h as L,O as H,A as me,u as he,r as v,o as f,c as g,d as o,w as i,v as M,I as G,n as D,bX as _e,bY as N,U as S,a as s,k as y,t as p,F as W,b as q,q as R,l as A,P as J,p as ve,e as fe,y as ye}from"./index-e90c6192.js";import{g as ge}from"./dropDownAux-c60e105c.js";const n=C=>(ve("data-v-a0a08d28"),C=C(),fe(),C),we={class:"col-12 m-auto"},be={style:{display:"flex"}},xe=n(()=>s("div",{style:{display:"flex"}},null,-1)),Se={class:"grid"},Ce={class:"col-12 lg:col-6"},ke=n(()=>s("p",{class:"col-12 text-3xl",style:{"font-weight":"bold"}}," Configuración ",-1)),Ve={class:"col-12 m-auto pb-4 p-4",style:{"background-color":"var(--orange-400)","box-shadow":"0 0 10px rgba(0, 0, 0, 0.137)",height:"max-content","border-radius":"1rem"}},Pe=n(()=>s("div",{class:"col-12 m-0 mb-3",style:{}},[s("p",{class:"text-2xl",style:{"font-weight":"bold","text-transform":"capitalize",color:"white"}})],-1)),Ue={class:"flex flex-column gap-2 my-4 text-white"},Te=n(()=>s("label",{for:"username"},"Nombre de la capacitacion",-1)),Ie={class:"flex flex-column gap-2 my-4 text-white"},Ee=n(()=>s("label",{for:"username"},"Tematica",-1)),De={class:"flex flex-column gap-2 my-4 text-white"},$e=n(()=>s("label",{for:"switch-incluir-link"},"¿Incluir enlace de la reunión?",-1)),Be={key:0,class:"flex flex-column gap-2 my-4 text-white"},Le=n(()=>s("label",{for:"input-enlace-reunion"},"Enlace de la reunión",-1)),Ne={class:"flex flex-column gap-2 my-4 text-white"},Re=n(()=>s("label",{for:"username"},"Ubicacion",-1)),Ae={class:"flex flex-column gap-2 my-4 text-white"},Oe=n(()=>s("label",{for:"username"},"Fecha de la capacitacion",-1)),ze=n(()=>s("span",{class:"col-12 p-0"},"Agendar",-1)),je={class:"col-12 lg:col-6"},Fe=n(()=>s("p",{class:"col-12 my-0 text-3xl",style:{"font-weight":"bold"}}," Asistentes ",-1)),He={class:"col-12",style:{display:"flex"}},Me={key:0,class:"col-12 p-0 ml-3",style:{display:"flex",gap:"1rem","align-items":"center"}},Ge=n(()=>s("span",{class:"",style:{"font-weight":"bold"}},"TODOS ",-1)),We={class:"col-12 m-auto pb-4 p-5",style:{"background-color":"rgba(255, 255, 255, 0)",height:"100%","border-radius":"1rem","height overflow":"hidden"}},qe={class:"grid",style:{height:"70vh","overflow-y":"auto"}},Je={class:"col-12 grid py-4",style:{"border-bottom":"2px solid rgba(0, 0, 0, 0.375)"}},Ye={class:"col-12 p-1",style:{display:"flex",gap:"1rem","align-items":"center"}},Ke={style:{"font-weight":"bold"}},Xe={class:"col-12 p-1",style:{display:"flex","min-width":"max-content",gap:"1rem","align-items":"center","justify-content":"start"}},Qe={class:"",style:{"font-weight":""}},Ze={style:{display:"flex"}},et={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},tt={class:"m-0 text-2xl my-4"},at={class:"block mt-2 md:mt-0 p-input-icon-left"},st=n(()=>s("i",{class:"pi pi-search"},null,-1)),ot=n(()=>s("span",{class:"p-column-title"},"Code",-1)),lt=n(()=>s("span",{class:"p-column-title"},"Code",-1)),nt=n(()=>s("span",{class:"p-column-title"},"Code",-1)),it=n(()=>s("span",{class:"p-column-title"},"Code",-1)),rt=n(()=>s("span",{class:"p-column-title"},"Code",-1)),dt=n(()=>s("span",{class:"p-column-title"},"Code",-1)),ct=n(()=>s("span",{class:"p-column-title"},"Code",-1)),ut=n(()=>s("span",{class:"p-column-title"},"Code",-1)),pt={class:"text-right"},mt={class:"text-right",style:{}},ht={key:1,class:"col-12 text-6xl text-center",style:{"font-weight":"bold",display:"flex",height:"85vh","justify-content":"center","align-items":"center"}},_t=n(()=>s("p",null,"No tienes invitaciones a capacitaciones",-1)),vt=[_t],ft={__name:"capacitaciones-invitaciones",setup(C){const k=r(!1),V=r(),O=r(),P=r(null),Y=()=>{P.value={global:{value:null,matchMode:_e.CONTAINS}}},z=async()=>{const a=N();try{const e=await fetch(`${S}/attendee/${a}/invited-trainings`);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return await e.json()}catch(e){throw console.error("Error al obtener las capacitaciones:",e),e}};L(()=>{z().then(a=>V.value=a)}),H(()=>{Y()});const w=r(!1),U=r(!1),T=me();he();const $=r(!1),x=r([]),K=r([]);r({});const X=a=>{try{return new URL(a),!0}catch{return!1}},u=r({}),b=r(!0);r(!1);const Q=(a,e)=>{const l=x.value.find(d=>d.site_name===a);if(!l)return;let c=[...m.value];l.employers.forEach(d=>{const h=c.indexOf(d.id);e&&h===-1?c.push(d.id):!e&&h!==-1&&c.splice(h,1)}),m.value=c},Z=a=>{a?m.value=x.value.reduce((e,l)=>e.concat(l.employers.map(c=>c.id)),[]):m.value=[]},j=a=>{const e=x.value.find(l=>l.site_name===a);return e?e.employers.every(l=>m.value.includes(l.id)):!1};r({}),r([]);const m=r([]),ee=a=>({attendees:m.value.map(e=>({training_id:a,attendee_id:e,assigned:!1,attendance_time:new Date().toISOString()}))}),te=async a=>{const e=ee(a);try{const l=await fetch(`${S}/training/attendees`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok)throw new Error(`HTTP error! Status: ${l.status}`);const c=await l.json();T.add({severity:"success",summary:"asistentes modificados",detail:"hecho",life:3e3}),console.log("Respuesta del servidor:",c),ye.push(`capacitacion/${a}/configuracion`),w.value=!1}catch(l){console.error("Error al enviar los datos de los asistentes:",l)}};async function ae(){try{const a=await fetch(`${S}/employers/grouped-by-site`);if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);let e=await a.json();e=e.map(l=>{const c=l.employers.reduce((d,h)=>(d[h.position]=d[h.position]||[],d[h.position].push(h),d),{});return{...l,positions:c}}),x.value=e,b.value=!1}catch(a){console.error("Error al obtener usuarios agrupados por sede:",a)}}async function se(){try{const a=await fetch(`${S}/employers/grouped-by-position`);if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);K.value=await a.json()}catch(a){console.error("Error al obtener usuarios agrupados por posición:",a)}}const oe=r([]);H(()=>{ge().then(a=>oe.value=a)}),L(async()=>{await ae(),await se()});const le=a=>{const e=m.value.indexOf(a);e>-1?m.value.splice(e,1):m.value.push(a)},ne=a=>m.value.includes(a),ie=async()=>{w.value=!0;const a={...u.value};if(a.creator_id=await N(),a.status="Agendada",!U.value||!a.material_url)a.material_url=null;else if(!X(a.material_url)){T.add({severity:"error",summary:"Error",detail:"El enlace de la reunión no es válido",life:3e3}),w.value=!1;return}if(!a.name||!a.topic||!a.location||!a.scheduled_time){T.add({severity:"warn",summary:"Advertencia",detail:"Por favor, completa todos los campos requeridos.",life:3e3}),w.value=!1;return}try{const e=await fetch(`${S}/training/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const c=(await e.json()).training_id;await te(c),console.log("Capacitación actualizada con éxito",e),T.add({severity:"success",summary:"Capacitación actualizada",detail:"Hecho",life:3e3}),z().then(d=>V.value=d),re.value=!1}catch(e){console.error("Error al actualizar la capacitación:",e)}},re=r(!1);return L(()=>{}),(a,e)=>{var F;const l=v("ProgressSpinner"),c=v("Dialog"),d=v("InputText"),h=v("InputSwitch"),de=v("Calendar"),I=v("Button"),B=v("Checkbox"),_=v("Column"),ce=v("RouterLink"),ue=v("DataTable");return f(),g("div",we,[o(c,{visible:w.value,"onUpdate:visible":e[0]||(e[0]=t=>w.value=t),modal:"",header:"Enviando datos",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:i(()=>[s("div",be,[o(l,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])]),_:1},8,["visible"]),o(c,{style:M([{"max-width":"1024px"},{width:"90%"}]),visible:k.value,"onUpdate:visible":e[9]||(e[9]=t=>k.value=t),modal:"",header:"Agendar capacitacion",breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:i(()=>[y(p(u.value)+" "+p(m.value)+" ",1),xe,s("div",Se,[s("div",Ce,[ke,s("div",Ve,[Pe,s("div",Ue,[Te,o(d,{id:"username",modelValue:u.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value.name=t),"aria-describedby":"username-help"},null,8,["modelValue"])]),s("div",Ie,[Ee,o(d,{id:"username",modelValue:u.value.topic,"onUpdate:modelValue":e[2]||(e[2]=t=>u.value.topic=t),"aria-describedby":"username-help"},null,8,["modelValue"])]),s("div",De,[$e,o(h,{id:"switch-incluir-link",modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=t=>U.value=t)},null,8,["modelValue"])]),U.value?(f(),g("div",Be,[Le,o(d,{id:"input-enlace-reunion",modelValue:u.value.material_url,"onUpdate:modelValue":e[4]||(e[4]=t=>u.value.material_url=t)},null,8,["modelValue"])])):D("",!0),s("div",Ne,[Re,o(d,{id:"username",modelValue:u.value.location,"onUpdate:modelValue":e[5]||(e[5]=t=>u.value.location=t),"aria-describedby":"username-help"},null,8,["modelValue"])]),s("div",Ae,[Oe,o(de,{id:"username",modelValue:u.value.scheduled_time,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.scheduled_time=t),"aria-describedby":"username-help"},null,8,["modelValue"])])]),o(I,{onClick:ie,class:"my-6 col-12",outlined:""},{default:i(()=>[ze]),_:1})]),s("div",je,[Fe,s("div",He,[b.value?(f(),G(l,{key:0,style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})):D("",!0)]),b.value?D("",!0):(f(),g("div",Me,[o(B,{class:"mt-3",style:{"margin-left":"3px"},modelValue:$.value,"onUpdate:modelValue":e[7]||(e[7]=t=>$.value=t),binary:!0,onChange:e[8]||(e[8]=t=>Z($.value))},null,8,["modelValue"]),Ge])),s("div",We,[s("div",qe,[(f(!0),g(W,null,q(x.value,t=>(f(),g("div",Je,[s("div",Ye,[o(B,{style:{},binary:!0,modelValue:j(t.site_name),onChange:E=>Q(t.site_name,!j(t.site_name))},null,8,["modelValue","onChange"]),s("span",Ke,p(t.site_name),1)]),(f(!0),g(W,null,q(t.employers,E=>(f(),g("div",Xe,[o(B,{class:"",style:{},binary:!0,modelValue:ne(E.id),onChange:()=>le(E.id)},null,8,["modelValue","onChange"]),s("p",Qe,p(E.name),1)]))),256))]))),256))])])])])]),_:1},8,["visible"]),o(c,{visible:b.value,"onUpdate:visible":e[10]||(e[10]=t=>b.value=t),modal:"",style:M([{width:"50rem"},{}]),breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:i(()=>[s("div",Ze,[o(l,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])]),_:1},8,["visible"]),((F=V.value)==null?void 0:F.length)>0?(f(),G(ue,{key:0,ref:"dt",value:V.value,selection:O.value,"onUpdate:selection":e[13]||(e[13]=t=>O.value=t),dataKey:"id",paginator:!0,rows:10,filters:P.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Capacitaciones",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh",frozenValue:a.lockedCustomers},{header:i(()=>[s("div",et,[s("p",tt,[y(" Invitaciones "),o(I,{onClick:e[11]||(e[11]=t=>k.value=!k.value),class:"ml-0 p-2 col-12 lg:ml-0 lg:col-12 mt-4"},{default:i(()=>[y(" Agendar nueva capacitacion")]),_:1})]),s("span",at,[st,o(d,{class:"",modelValue:P.value.global.value,"onUpdate:modelValue":e[12]||(e[12]=t=>P.value.global.value=t),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:i(()=>[o(_,{class:"p-2",selectionMode:"multiple",headerStyle:"width: 3rem; ",frozen:""}),o(_,{class:"p-2",field:"id",header:"Id",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[ot,y(" "+p(t.data.id),1)]),_:1}),o(_,{class:"p-2",field:"creator_id",header:"Responsable",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[lt,y(" "+p(t.data.creator_id),1)]),_:1}),o(_,{class:"p-2",field:"name",header:"Nombre",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[nt,y(" "+p(t.data.name),1)]),_:1}),o(_,{class:"p-2",field:"name",header:"Tema",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[it,y(" "+p(t.data.topic),1)]),_:1}),o(_,{class:"p-2",field:"location",header:"Ubicacion",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[rt,y(" "+p(t.data.location),1)]),_:1}),o(_,{class:"p-2",field:"location",header:"Fecha de la capacitacion",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[dt,y(" "+p(t.data.scheduled_time),1)]),_:1}),o(_,{class:"p-2",field:"location",header:"Fecha de creacion",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[ct,y(" "+p(t.data.created_at),1)]),_:1}),o(_,{class:"p-2",field:"location",header:"Estado",sortable:!0,headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[ut,s("p",{class:R(["p-2 text-center",t.data.status])},p(t.data.status),3)]),_:1}),o(_,{class:"p-2",field:"location",header:"Detalles",sortable:!0,frozen:"",alignFrozen:"right",headerStyle:"width:min-content; min-width:min-content; "},{body:i(t=>[o(ce,{to:A(N)()==t.data.creator_id?`capacitacion/${t.data.id}/configuracion`:`capacitacion/${t.data.id}/archivos`},{default:i(()=>[o(I,{text:"",class:"p-0 mx-2",severity:"success",style:{width:"100"}},{default:i(()=>[s("span",pt,[s("i",{class:R(A(J).EYE)},null,2)])]),_:1})]),_:2},1032,["to"]),o(I,{text:"",class:"p-0 mx-2",severity:"danger",style:{width:"100"}},{default:i(()=>[s("span",mt,[s("i",{class:R(A(J).TRASH)},null,2)])]),_:1})]),_:1})]),_:1},8,["value","selection","filters","frozenValue"])):b.value?D("",!0):(f(),g("div",ht,vt))])}}},wt=pe(ft,[["__scopeId","data-v-a0a08d28"]]);export{wt as default};
