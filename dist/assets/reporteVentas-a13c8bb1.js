import{_ as A,z as O,h as G,r as d,l as o,o as f,c as v,a as e,d as l,F as L,b as U,U as N,t as b,v as H,n as oe,p as J,e as q,S as ae,f as i,u as le,g as $,T as ne,w as _,q as I,V as F,P as z,k as E,W as ie}from"./index-76095ea0.js";const M=u=>(J("data-v-1081580c"),u=u(),q(),u),ce={class:""},re={class:"flex align-items-center justify-content-between mb-4"},de=M(()=>e("h5",null,"Notificaciones",-1)),ue=M(()=>e("span",{class:"block text-600 font-medium mb-3"},"Sedes en linea",-1)),pe={style:{height:"100%","overflow-y":"auto"},class:"p-0 mx-0 mt-0 mb-4 list-none"},me={style:{display:"flex","align-items":"center","justify-content":"space-between"},class:"flex align-items-center py-2 border-bottom-1 surface-border"},_e={style:{display:"flex","align-items":"center"},class:"p-0"},fe={class:"w-3rem h-3rem flex align-items-center justify-content-center bg-blue-100 border-circle mr-3 flex-shrink-0"},ve=["src"],he={class:"text-900 line-height-3"},ye=M(()=>e("span",{class:"block text-600 font-medium mb-3"},"Sedes desconectadas",-1)),ge={style:{height:"100% overflow-y: auto"},class:"p-0 mx-0 mt-0 mb-4 list-none"},be={style:{display:"flex","align-items":"center","justify-content":"space-between"},class:"flex align-items-center py-2 border-bottom-1 surface-border"},xe={style:{display:"flex","align-items":"center"},class:"p-0"},we={class:"w-3rem h-3rem flex align-items-center justify-content-center bg-blue-100 border-circle mr-3 flex-shrink-0"},De=["src"],$e={class:"text-900 line-height-3"},ke={__name:"RepNotificaciones",setup(u){const s=O();return G(()=>{s.startSitesStatusUpdate()}),(k,S)=>{const x=d("Button"),T=d("Menu");return o(s).visibleNotifications?(f(),v("div",{key:0,class:"card col-12 xl:col-3 mt-3 m-0 notificaciones",style:H(o(s).visibleNotifications?"transform:scaleX(100%)":"transform:scaleX(100%);")},[e("div",ce,[e("div",re,[de,e("div",null,[l(x,{icon:"pi pi-ellipsis-v",class:"p-button-text p-button-plain p-button-rounded",onClick:S[0]||(S[0]=r=>k.$refs.menu1.toggle(r))}),l(T,{ref:"menu1",popup:!0,model:k.items},null,8,["model"])])]),ue,e("ul",pe,[(f(!0),v(L,null,U(o(s).sitesStatus.filter(r=>r.online_status),r=>(f(),v("li",me,[e("div",_e,[e("div",fe,[e("img",{style:{width:"100%","border-radius":"0.5rem","object-fit":"cover","aspect-ratio":"1 / 1"},src:`${o(N)}/read-product-image/96/site-${r.id}`,alt:""},null,8,ve)]),e("span",he,b(r.site_name),1)]),l(x,{style:{width:"0.5rem","aspect-ratio":"1 / 1"},rounded:"",class:"p-0 mr-3 indicador",severity:"success"})]))),256))]),ye,e("ul",ge,[(f(!0),v(L,null,U(o(s).sitesStatus.filter(r=>!r.online_status),r=>(f(),v("li",be,[e("div",xe,[e("div",we,[e("img",{style:{width:"100%","border-radius":"0.5rem","object-fit":"cover","aspect-ratio":"1 / 1"},src:`${o(N)}/read-product-image/96/site-${r.id}`,alt:""},null,8,De)]),e("span",$e,b(r.site_name),1)]),l(x,{style:{width:"0.5rem","aspect-ratio":"1 / 1"},rounded:"",class:"p-0 mr-3 indicador",severity:"danger"})]))),256))])])],4)):oe("",!0)}}},Se=A(ke,[["__scopeId","data-v-1081580c"]]);const W=u=>(J("data-v-15887e6d"),u=u(),q(),u),Re={style:{position:"relative"}},Ve={class:"px-0 pt-0 col-12",style:{display:"flex","z-index":"900",position:"sticky",top:"4rem","background-color":"#fafafa","align-items":"center"}},Ce={class:"col-12 grid gap m-0 py-2 px-0"},Ne={class:"col-12 xl:col-2 px-2 p-2",style:{height:"100%"}},Te={class:"col-12 xl:col-5 p-2",style:{height:"100%"}},je={class:"col-12 xl:col-3 p-2",style:{height:"100%"}},Ie={class:"col-12 xl:col-2 p-2",style:{height:"100%"}},Ee={class:"contenedor mt-8",style:{position:"sticky",top:"4rem","z-index":"99"}},Le=W(()=>e("span",{class:"text-5xl pt-8",style:{"font-weight":"bold"}},"Vision General",-1)),Ue={class:"col-12 px-0 p-0 my-4 p-2",style:{"overflow-x":"auto","background-color":"#ffffff","box-shadow":"0 1rem  1rem rgb(255, 255, 255)"}},Me={class:"px-0 mx-0",style:{width:"max-content","background-color":"#ffffff",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},Be={class:"p-3",style:{display:"flex","align-items":"center","background-color":"rgba(245, 222, 179, 0)"}},Pe=W(()=>e("div",{class:"app",style:{position:""}},null,-1)),Fe={class:"grid p-0 m-0"},ze={class:"grid"},Ae={class:"col-12 px-0 mx-0"},Oe={class:"col-12",style:{display:"flex","flex-direction":"column"}},Ge={class:"text-l",style:{"font-weight":"bold"}},He={class:"col-12",style:{display:"flex","flex-direction":"column"}},Je={style:{"font-weight":"bold"},class:"text-l"},qe={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},We={class:"col-12",style:{display:"flex","justify-content":"center"}},Xe={__name:"reporteVentas",setup(u){const s=O(),{isDarkTheme:k}=ae(),S=i(["enviada","cancelada","en preparacion"]),x=i("enviada"),T=le(),r=i([]),X=i([]),w=i(!1),R=i(new Date(new Date().setDate(new Date().getDate()-7))),V=i(new Date),y=i(new Date),h=i(new Date);i("");function j(a){const t=new Date,p=new Date(t);p.setDate(p.getDate()+1);const m=new Date(t);m.setDate(t.getDate()-a),y.value=m,h.value=p,s.setDateRange(y.value,h.value),w.value=!1,s.fetchSalesReport()}G(()=>{K().then(a=>{r.value=a}),s.fetchSalesReport()});const Y=async()=>{const a=g(R.value),t=g(V.value),p=X.value.map(c=>c.site_id).join(","),m=new URLSearchParams({site_ids:p,status:x.value,start_date:a,end_date:t}),D=`${N}/sales_report?${m.toString()}`;try{const c=await fetch(D,{method:"GET",headers:{"Content-Type":"application/json"}});if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);const C=await c.json();ie.value=C,console.log(C)}catch(c){console.error("Fetch error:",c)}};$([R,V],()=>{Y()},{deep:!0}),$(()=>s.order_status,(a,t)=>{console.log(`El estado de orden ha cambiado de ${t} a ${a}`),s.fetchSalesReport()}),$(s.selectedSites,a=>{s.setSelectedSites(a)},{deep:!0});const K=async()=>{try{const a=await fetch(`${N}/sites`);if(!a.ok)throw"paila";return await a.json()}catch(a){console.log(a)}},Q=i([{name:"Valor ventas",to:"/reporte-ventas/valor-ventas"},{name:"No. Ordenes",to:"/reporte-ventas/no-ordenes"},{name:"Ticket promedio",to:"/reporte-ventas/ticket"},{name:"Ordenes",to:"/reporte-ventas/ordenes"}]);i(null),ne({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),i([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const B=i(null),Z=()=>{B.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},ee=()=>{B.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};$(k,a=>{a?ee():Z()},{immediate:!0}),i(`${R.value} - ${V.value}`);function g(a){const t=new Date(a),p=t.getFullYear(),m=(t.getMonth()+1).toString().padStart(2,"0"),D=t.getDate().toString().padStart(2,"0");return`${p}-${m}-${D}`}return i({}),i(),$([y,h],([a,t])=>{a>t&&(alert("La fecha de inicio debe ser anterior o igual a la fecha final."),h.value=a)}),(a,t)=>{const p=d("Dropdown"),m=d("MultiSelect"),D=d("InputText"),c=d("Button"),C=d("RouterLink"),te=d("RouterView"),P=d("Calendar"),se=d("Dialog");return f(),v("div",Re,[e("div",Ve,[e("div",Ce,[e("div",Ne,[l(p,{modelValue:o(s).order_status,"onUpdate:modelValue":t[0]||(t[0]=n=>o(s).order_status=n),options:S.value,class:"col-12 p-0 m-0",placeholder:"Estado"},null,8,["modelValue","options"])]),e("div",Te,[l(m,{display:"chip",multiple:"",modelValue:o(s).selectedSites,"onUpdate:modelValue":t[1]||(t[1]=n=>o(s).selectedSites=n),optionLabel:"site_name",options:r.value.filter(n=>n.site_id!=12&n.site_id!=13),class:"col-12 p-0 m-0",placeholder:"Sedes"},null,8,["modelValue","options"])]),e("div",je,[l(D,{onClick:t[2]||(t[2]=n=>w.value=!0),style:{width:"100%"},value:o(s).dateRangeDifference.rangeName||`${g(o(s).dateRange.startDate)} | ${g(o(s).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"])]),e("div",Ie,[l(c,{style:{height:"100"},onClick:o(s).fetchSalesReport},{default:_(()=>[e("i",{class:I(o(z).SEARCH)},null,2)]),_:1},8,["onClick"])])])]),e("div",Ee,[Le,e("div",Ue,[e("div",Me,[(f(!0),v(L,null,U(Q.value,n=>(f(),v("div",null,[l(C,{to:n.to},{default:_(()=>[l(c,{style:H([o(T).fullPath==n.to?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0"}]),class:"text-xl px-0 py-4 mx-0",text:"",severity:"secondary"},{default:_(()=>[E(b(n.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256)),e("div",Be,[l(c,{class:"text-l btn-ocultar",text:"",onClick:o(s).toogleVisibleNotifications,severity:o(s).visibleNotifications?"danger":"success",rounded:"",style:{"font-weight":"bold"}},{default:_(()=>[e("span",null,[e("span",null,b(o(s).visibleNotifications?"Ocultar notificaciones":"Mostrar notificaciones"),1),E(),e("i",{class:I(o(z).ANGLE_DOUBLE_RIGHT)},null,2)])]),_:1},8,["onClick","severity"])])])])]),Pe,e("div",Fe,[e("div",{class:I(["",o(s).visibleNotifications?"col-9":"col-12"])},[l(F,{name:"fade"},{default:_(()=>[l(te)]),_:1})],2),l(F,{name:"noti"},{default:_(()=>[l(Se)]),_:1})]),l(se,{visible:w.value,"onUpdate:visible":t[9]||(t[9]=n=>w.value=n),modal:"",header:"Periodo",style:{width:"25rem"}},{default:_(()=>[e("div",ze,[e("div",Ae,[l(c,{text:"",label:"Últimos 7 días",onClick:t[3]||(t[3]=n=>j(7)),class:"p-button-text col-12 p-1 m-0"}),l(c,{text:"",label:"Últimos 14 días",onClick:t[4]||(t[4]=n=>j(14)),class:"p-button-text col-12 p-1"}),l(c,{text:"",label:"Últimos 28 días",onClick:t[5]||(t[5]=n=>j(28)),class:"p-button-text col-12 p-0"})]),e("div",Oe,[e("span",Ge,"Desde - "+b(g(R.value)),1),l(P,{style:{"min-width":"max-content"},modelValue:y.value,"onUpdate:modelValue":t[6]||(t[6]=n=>y.value=n)},null,8,["modelValue"])]),e("div",He,[e("span",Je,"Hasta - "+b(g(V.value)),1),l(P,{style:{"min-width":"max-content"},modelValue:h.value,"onUpdate:modelValue":t[7]||(t[7]=n=>h.value=n),showWeek:""},null,8,["modelValue"])]),e("div",qe,[e("div",We,[l(c,{onClick:t[8]||(t[8]=()=>{o(s).setDateRange(y.value,h.value),w.value=!1,o(s).fetchSalesReport()})},{default:_(()=>[E("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},Ke=A(Xe,[["__scopeId","data-v-15887e6d"]]);export{Ke as default};
