import{_ as g,l as r,z as x,r as k,a as l,o as b,c as I,b as c,d as i,X as V,p as S,g as B,O as T,U as p,i as d,j as U}from"./index-b678ff89.js";const m=a=>(S("data-v-42d36496"),a=a(),B(),a),D={style:{display:"flex",position:"relative","background-size":"cover",height:"100vh",width:"100vw",overflow:"hidden"},class:"p-0 fondo"},L=["onSubmit"],z=m(()=>c("img",{src:T,alt:"",style:{width:"48px"},class:"m-3"},null,-1)),P=m(()=>c("p",{class:"text-2xl",style:{"font-weight":"bold"}},"Iniciar sesión",-1)),C={__name:"Login",setup(a){const _=r(),u=x(),h=t=>{const e=r();return U.get(`${p}/validate-token`,{headers:{Authorization:`Bearer ${t}`}}).then(o=>(o.data.access_token&&e.setUserData(o.data),o.data)).catch(o=>{throw console.error("Error durante la validación del token:",o),o})},w=()=>{const t=r();setInterval(async()=>{const e=t.userData.access_token;if(!e){d.push("/auth/login");return}try{await h(e)}catch(o){console.error("La sesión ha expirado o el token es inválido:",o),t.userData={},d.push("/auth/login")}},6e4)},s=k({username:"",password:""}),v=async()=>{const t=new URLSearchParams;t.append("username",s.value.username),t.append("password",s.value.password);try{const e=await fetch(`${p}/token-employer`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});if(!e.ok)throw new Error("Network response was not ok");const o=await e.json();_.setUserData(o),w(),d.push("/"),u.add({severity:"success",summary:"Bienvenido",detail:"Hoy es un gran dia",life:1e4})}catch(e){u.add({severity:"error",summary:"Algo salio mal",detail:"Revisate los datos monstruo",life:1e4}),console.error(e)}};return(t,e)=>{const o=l("InputText"),y=l("Password"),f=l("Button");return b(),I("div",D,[c("form",{class:"col-12 m-auto",onSubmit:V(v,["prevent"]),style:{"max-width":"min-content",display:"flex","border-radius":"0.5rem","box-shadow":"0 0 10px rgba(0, 0, 0, 0.389)","flex-direction":"column","background-color":"rgb(255, 255, 255)","align-items":"center"}},[z,P,i(o,{class:"my-3 m-0",modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=n=>s.value.username=n),type:"text",placeholder:"identificación",style:{width:"100%"}},null,8,["modelValue"]),i(y,{class:"",toggleMask:"",modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=n=>s.value.password=n),placeholder:"Clave"},null,8,["modelValue"]),i(f,{size:"samll",style:{width:"100%","background-color":"rgb(255, 98, 0)",border:"none",color:"#fff"},label:"Iniciar sesion",class:"my-3",type:"submit"})],40,L)])}}},N=g(C,[["__scopeId","data-v-42d36496"]]);export{N as default};
