import{_ as se,h as r,Y as $,i as C,j as E,U as F,l as le,s as oe,D as j,C as re,x as ne,ad as v,g as d,o as g,c as H,b as s,f as o,a,n as X,P as G,q as c,t as y,u as m,E as T,e as D,k as Y,F as ie,r as de,p as ce,m as ue}from"./index-03a193b1.js";import{D as pe}from"./OrderItem.vue_vue_type_style_index_0_scoped_bbba8067_lang-9b2e50b9.js";import"./index-558f534d.js";import{e as me}from"./formatDate-262296cf.js";import"./formatoPesos-8aa989a0.js";import"./_commonjsHelpers-23102255.js";const f=b=>(ce("data-v-c2c968f7"),b=b(),ue(),b),_e={class:"container",style:{"margin-top":"7rem"}},ve=f(()=>a("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"6rem"}},[a("i",{class:"fa-solid fa-truck-arrow-right"}),c(" Pedidos pendidentes ")],-1)),ye=f(()=>a("h3",null,[a("b",null,"Rechazar orden")],-1)),fe=f(()=>a("h3",null,[a("b",null,"Aprobar esta orden")],-1)),he={style:{"max-width":"1280px"},class:"mx-auto"},ge={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},be={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},we=f(()=>a("div",{class:"col-12 md:col-6 p-3"},[a("span",{class:"text-xl",style:{width:"100%"}},[c(" Pedidos pendientes de validacion"),a("span",{style:{"text-transform":"capitalize"}})])],-1)),xe={class:"md:mt-0 p-input-icon-right m-3"},Pe=f(()=>a("i",{class:"pi pi-search"},null,-1)),Ve={style:{display:"flex",gap:"0.5rem"}},ke={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"start",display:"flex",gap:"1rem"}},Se={class:"px-2 m-0"},Ce=f(()=>a("i",{class:"fa-regular fa-bars-progress"},null,-1)),Te={style:{"text-transform":"uppercase"}},De={class:"m-0"},Re={__name:"ValidateSection",setup(b){const R=r([]);r([{columnName:"SEDE",columnValue:"sede",columnType:"other",size:"1rem",vif:!0},{columnName:"ASESOR",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);const n=r({start_date:new Date,end_date:new Date,sites:[]}),z=r([]),V=$(),J=l=>{V.setVisible("currentOrder",!0),V.setOrder(l)},K=async l=>{const t=O.rawUserData.id;await v.aproveOrder(l,t),h.value=!1,P()},L=async()=>{const l=await E.post(`${F}/transaction_report/`,{start_date:n.value.start_date,end_date:n.value.end_date,sites:n.value.sites.map(t=>t.site_id)});M.value=l,l!=null&&l[0]&&(z.value=Object.keys(l[0]))},M=r([]);C(async()=>{R.value=await E.get(`${F}/sites/`),await L()});const k=r(!1),w=r([]),h=r(!1),O=le(),u=r({});r([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]);const U=r({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),$(),r(null);const B={revisar:v.getPendientsCancellationRequest,aprobadas:v.getaceptedCancellationAcepted,rechazadas:v.getPendientsCancellationRejected};oe(()=>{q()}),j(()=>V.numberOders,()=>{P()});const Q=l=>{h.value=!0,u.value.order_id=l},W=async(l,t,A)=>{const p={authorized:l,responsible_id:O.rawUserData.id,responsible_observation:u.value.reason||"sin observaciones"};await v.resolveCancellationRequest(t,p),h.value=!1,k.value=!1,w.value=await B.revisar()},x=re(),_=r(),q=()=>{_.value={global:{value:null,matchMode:ne.CONTAINS}}};q(),C(()=>{P()}),C(async()=>{P()});const P=async()=>{w.value=await v.getOrdersValidate()};return j(()=>x.params.request_status,async()=>{w.value=await B.revisar()},{deep:!0}),(l,t)=>{const A=d("Textarea"),p=d("Button"),N=d("Dialog"),Z=d("InputText"),i=d("Column"),I=d("DataTable"),ee=d("Calendar"),te=d("calendar"),ae=d("MultiSelect");return g(),H("div",_e,[ve,s(N,{visible:k.value,"onUpdate:visible":t[2]||(t[2]=e=>k.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[ye]),default:o(()=>[a("form",{onSubmit:t[1]||(t[1]=G(e=>W(!1,u.value.id,u.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(A,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:u.value.reason,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),s(p,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),s(N,{visible:h.value,"onUpdate:visible":t[4]||(t[4]=e=>h.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[fe]),default:o(()=>[a("form",{onSubmit:t[3]||(t[3]=G(e=>K(u.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(p,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (usuario contactado)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),a("div",he,[a("div",ge,[a("div",{style:X(`transform:translateX(${U.value.slide}%)`),class:"slider-item"},[s(I,{paginator:!0,rows:15,filters:_.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":t[6]||(t[6]=e=>_.value=e),class:"col-12 m-auto",value:w.value,tableStyle:"min-width: 50rem;"},{header:o(()=>[a("div",be,[we,a("span",xe,[Pe,s(Z,{class:"",modelValue:_.value.global.value,"onUpdate:modelValue":t[5]||(t[5]=e=>_.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:o(()=>[s(i,{style:{},class:"py-1 pl-0",field:"order_id",header:"ID orden",frozen:""}),s(i,{style:{},class:"py-1 pl-0",field:"total_order_price",header:"Monto de la orden"},{body:o(e=>[c(y(m(T)(e.data.total_order_price)),1)]),_:1}),s(i,{style:{},class:"py-1 pl-0",field:"total_order_price",header:"Hora"},{body:o(e=>[c(y(m(me)(e.data.latest_status_timestamp)),1)]),_:1}),s(i,{style:{},class:"py-1 pl-0",field:"delivery_price",header:"Domicilio"},{body:o(e=>[c(y(m(T)(e.data.delivery_price)),1)]),_:1}),s(i,{style:{},class:"py-1 pl-0",field:"Total",header:"Total"},{body:o(e=>[c(y(m(T)(e.data.delivery_price+e.data.total_order_price)),1)]),_:1}),s(i,{style:{},class:"py-1 pl-0",field:"user_name",header:"Cliente"}),s(i,{style:{},class:"py-1 pl-0",field:"user_phone",header:"Telefono cliente"}),s(i,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:o(e=>[a("div",Ve,[m(x).params.request_status!="aprobadas"?(g(),D(p,{key:0,size:"",onClick:S=>J(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):Y("",!0),m(x).params.request_status!="aprobadas"?(g(),D(p,{key:1,size:"",onClick:S=>Q(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):Y("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),a("div",{style:X(`transform:translateX(${U.value.slide}%)`),class:"slider-item"},[s(I,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:M.value,tableStyle:"min-width: 50rem;",filters:_.value},{header:o(()=>[a("div",ke,[a("h4",Se,[Ce,c(),a("b",Te,[c("Pedidos pendientes "),a("b",null,y(m(x).params.section),1)])]),s(ee,{modelValue:n.value.start_date,"onUpdate:modelValue":t[7]||(t[7]=e=>n.value.start_date=e)},null,8,["modelValue"]),s(te,{modelValue:n.value.end_date,"onUpdate:modelValue":t[8]||(t[8]=e=>n.value.end_date=e)},null,8,["modelValue"]),s(ae,{style:{"max-width":"30rem"},modelValue:n.value.sites,"onUpdate:modelValue":t[9]||(t[9]=e=>n.value.sites=e),optionLabel:"site_name",options:R.value.filter(e=>e.show_on_web)},null,8,["modelValue","options"]),s(p,{severity:"help",onClick:L,label:"Buscar",icon:"pi pi-search"})])]),default:o(()=>[(g(!0),H(ie,null,de(z.value,e=>(g(),D(i,{class:"py-1",style:{"text-transform":"uppercase"},header:e},{body:o(S=>[a("h6",De,y(S.data[e]),1)]),_:2},1032,["header"]))),256))]),_:1},8,["value","filters"])],4)])]),s(pe)])}}},qe=se(Re,[["__scopeId","data-v-c2c968f7"]]);export{qe as default};
