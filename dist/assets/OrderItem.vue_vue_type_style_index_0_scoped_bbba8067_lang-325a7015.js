import{_ as ee,g as p,h as Y,i as x,U as O,Z as oe,H as G,e as k,o as v,c as y,b as r,f as c,a as e,P as U,t as a,u as s,a1 as z,m as h,F as L,r as j,j as J,p as te,k as le}from"./index-22c9d1ba.js";import{f as C}from"./formatoPesos-8aa989a0.js";const n=V=>(te("data-v-f60ccb74"),V=V(),le(),V),se=n(()=>e("h3",null,[e("b",null,"Cambiar Método de Pago")],-1)),ne=n(()=>e("span",{for:"paymentMethod"},"Método de Pago actual",-1)),re={for:"paymentMethod"},ae=n(()=>e("span",{for:"paymentMethod"},"Nuevo método de Pago",-1)),ie=n(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),de=n(()=>e("span",{for:"responsible"},"Responsable",-1)),ce=n(()=>e("span",{for:"reason"},"Razón",-1)),ue=n(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),pe=n(()=>e("span",{class:"advert",style:{"text-transform":"lowercase",color:"red","font-weight":"bold"}}," Desde el 16 de mayo de 2024, la cancelación de órdenes requerirá autorización.",-1)),me=n(()=>e("span",{for:"responsible"},"Responsable",-1)),_e=n(()=>e("span",{for:"reason"},"Razón",-1)),be={style:{"text-transform":"capitalize"}},ve={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},ye={class:"",style:{width:"auto"}},he={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},ge={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},fe={style:{padding:"0",color:"black","text-align":"center",margin:"auto","margin-bottom":"1rem",width:"max-content","min-width":"max-content",display:"flex","justify-content":"center","flex-direction":"column"}},we=n(()=>e("div",{class:"",style:{"font-weight":"bold",color:"white",margin:"0","background-color":"black","align-items":"center",display:"grid","grid-template-columns":"auto auto"}},[e("div",{style:{width:"100%"}},[e("b",null," productos")]),e("div",null,[e("p",{style:{"text-align":"end","font-weight":"bold"}},[e("b",null," total ")])])],-1)),xe={style:{display:"grid","grid-template-columns":"auto auto"}},Oe={class:"p-0 m-0"},ke=n(()=>e("br",null,null,-1)),Ce={style:{"text-align":"end",color:"black"}},Ve={key:0,class:"p-0 m-0"},De=n(()=>e("b",null,"COMBO INCLUYE",-1)),Ee=[De],Se={class:"p-0 m-0 ml-5",style:{}},$e={style:{display:"flex",width:"","justify-content":"space-between"},class:"p-0 m-0"},Me={class:"p-0 m-0 ml-5",style:{}},Ue={class:"p-0 m-0",style:{"text-align":"end"}},Le=n(()=>e("div",{style:{"background-color":"rgba(0, 0, 0, 0.286)",height:"1px"}},null,-1)),Pe={class:"",style:{display:"grid",color:"","margin-top":"0.5rem","grid-template-columns":"auto auto"}},Te=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Subtotal")])],-1)),Ne={class:""},ze={style:{"text-align":"end","font-weight":"bold",color:"black"}},je=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Domicilio")])],-1)),Ie={class:""},Re={style:{"text-align":"end","font-weight":"bold",color:"black"}},Be=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold",color:"black"}},[e("b",null,"Total")])],-1)),Ae={class:""},qe={style:{"text-align":"end",color:"black","font-weight":"bold"}},Fe=n(()=>e("div",{class:""},null,-1)),He=n(()=>e("p",{style:{"font-weight":"bold","background-color":"black",color:"white",padding:"0",margin:"0","margin-top":"0.5rem"}},[e("b",null,"Notas")],-1)),Ze={class:"notas",style:{border:"1px solid",margin:"0",color:"black",padding:"0.5rem"}},Ye=n(()=>e("p",{style:{"background-color":"black","font-weight":"bold","margin-top":"1rem",color:"white"}},[e("b",null,"cliente")],-1)),Ge={style:{display:"grid","grid-template-columns":"auto auto"}},Je=n(()=>e("div",{class:"",style:{}},[e("span",null,[e("b",null,"NOMBRE")])],-1)),Ke={class:""},Qe={style:{"text-align":"end",color:"black"}},We=n(()=>e("div",{style:{}},[e("span",null,[e("b",null,"telefono")])],-1)),Xe={style:{"text-align":"end",color:"black"}},eo=n(()=>e("div",{style:{}},[e("span",null,[e("b",null,"direccion ")])],-1)),oo={style:{"text-align":"end",color:"black"}},to=n(()=>e("div",null,[e("span",null,[e("b",null,"metodo de pago")])],-1)),lo={style:{"text-align":"end",color:"black"}},so={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},no={class:"mt-3"},ro=n(()=>e("h3",null,[e("b",null,"TRASLADO DE SEDE")],-1)),ao=n(()=>e("span",{for:"responsible"},"SELECCIONE LA SEDE DESTINO",-1)),io={__name:"DialogoPedido",setup(V){const D=p(!1),E=p(null),I=p([]);Y(async()=>{try{const i=await x.get(`${O}/payment_methods`);I.value=i}catch(i){console.error("Error al obtener métodos de pago:",i)}l.currentOrder.value=l.currentOrder,T.value=await x.get(`${O}/sites`)});const K=async()=>{if(E.value)try{await x.put(`${O}/change-method/${l.currentOrder.order_id}/${E.value}`,`Cambiando método de pago para la orden ${l.currentOrder.order_id}`),D.value=!1,l.visibles.currentOrder=!1,console.log("Método de pago cambiado exitosamente")}catch(i){console.error("Error al cambiar el método de pago:",i)}},P=p(0),S=p(!1),l=oe(),Q=G(()=>l.currentOrder.pe_json.listaPedidos.reduce((i,o)=>{var g;let M=o.pedido_cantidad*o.pedido_precio;if(o.modificadorseleccionList&&o.modificadorseleccionList.length>0){const b=((g=o.modificadorseleccionList)==null?void 0:g.filter(f=>f.pedido_productoid==o.pedido_productoid)).reduce((f,t)=>f+t.modificadorseleccion_cantidad*t.pedido_precio,0);M+=b}return i+M},0));G(()=>Q.value+l.currentOrder.delivery_price);const W=async()=>{var o;const i={order_id:l.currentOrder.order_id,responsible:(o=d.value.responsible)==null?void 0:o.name,reason:d.value.reason};await z.create_cancellling_request(i),S.value=!1,l.Notification.pause(),l.Notification.currentTime=0},w=p(!1),T=p([]);Y(async()=>{l.currentOrder.value=l.currentOrder,T.value=await x.get(`${O}/sites`)});const N=p(!1),$=p(!1),d=p({responsible:null,reason:"Sin razon"}),R=p([{name:"Restaurante",value:"restaurant"},{name:"Cliente",value:"client"}]),B=()=>{d.value.responsible&&z.cancelOrder(l.currentOrder.order_id,d.value.reason,d.value.responsible.name).then(i=>{i&&(N.value=!1,console.log("Order canceled successfully"))}).catch(i=>{console.error("Failed to cancel order:",i)})},X=async()=>{const i=l.currentOrder.order_id,o=P.value;await x.put(`${O}/traslate-order`,{site_id:o,order_id:i},`trasladando orden ${i}`),l.visibles.currentOrder=!1,$.value=!1};return(i,o)=>{const M=k("Tag"),g=k("Dropdown"),u=k("Button"),b=k("Dialog"),f=k("Textarea");return v(),y(L,null,[r(b,{visible:D.value,"onUpdate:visible":o[1]||(o[1]=t=>D.value=t),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:c(()=>[se]),default:c(()=>[e("form",{onSubmit:U(K,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[ne,r(M,{class:"px-4",severity:"warning"},{default:c(()=>[e("span",re,[e("b",null,a(s(l).currentOrder.payment_method),1)])]),_:1}),ae,r(g,{style:{width:"100%"},id:"paymentMethod",modelValue:E.value,"onUpdate:modelValue":o[0]||(o[0]=t=>E.value=t),options:I.value,optionLabel:"name",optionValue:"id",placeholder:"Selecciona un método de pago",required:""},null,8,["modelValue","options"]),r(u,{style:{width:"100%","border-radius":"0.5rem"},label:"Cambiar",type:"submit",class:"p-button-help"})],32)]),_:1},8,["visible"]),e("div",null,[r(b,{visible:N.value,"onUpdate:visible":o[4]||(o[4]=t=>N.value=t),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:c(()=>[ie]),default:c(()=>[e("form",{onSubmit:U(B,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[de,r(g,{style:{width:"100%"},id:"responsible",modelValue:d.value.responsible,"onUpdate:modelValue":o[2]||(o[2]=t=>d.value.responsible=t),options:R.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),ce,r(f,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:d.value.reason,"onUpdate:modelValue":o[3]||(o[3]=t=>d.value.reason=t),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),r(u,{style:{width:"100%","border-radius":"0.5rem"},label:"cancelar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),r(b,{visible:S.value,"onUpdate:visible":o[7]||(o[7]=t=>S.value=t),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:c(()=>[ue]),default:c(()=>[e("form",{onSubmit:U(W,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[pe,me,r(g,{style:{width:"100%"},id:"responsible",modelValue:d.value.responsible,"onUpdate:modelValue":o[5]||(o[5]=t=>d.value.responsible=t),options:R.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),_e,r(f,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:d.value.reason,"onUpdate:modelValue":o[6]||(o[6]=t=>d.value.reason=t),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),r(u,{style:{width:"100%","border-radius":"0.5rem"},label:"solicitar cancelacion",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),r(b,{closable:!1,style:{width:"30rem"},modal:"",visible:w.value,"onUpdate:visible":o[10]||(o[10]=t=>w.value=t)},{footer:c(()=>[e("div",ve,[r(u,{text:"",size:"small",onClick:o[8]||(o[8]=()=>{s(z).deliveryZero(s(l).currentOrder.order_id),w.value=!1}),style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"si"}),r(u,{onClick:o[9]||(o[9]=t=>w.value=!1),size:"small",style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"no"})])]),default:c(()=>[e("span",be,[h(" Esta seguro de llevar a $0.00 el valor del domicilio para la orden "),e("b",null,a(s(l).currentOrder.order_id),1),h(" del cliente "),e("b",null,a(s(l).currentOrder.user_name),1),h("? ")])]),_:1},8,["visible"]),r(b,{class:"mx-3",closeOnEscape:"",closable:!1,visible:s(l).visibles.currentOrder,"onUpdate:visible":o[16]||(o[16]=t=>s(l).visibles.currentOrder=t),modal:"",style:{"max-height":"95vh",width:"35rem",position:"relative"}},{footer:c(()=>[e("div",so,[r(u,{severity:"help",onClick:o[11]||(o[11]=t=>w.value=!0),style:{width:"100%"},label:"domi $0.00"}),r(u,{size:"small",style:{"border-radius":"0.3rem",width:"100%"},onClick:o[12]||(o[12]=t=>S.value=!0),severity:"danger",label:"CANCELAR "}),r(u,{severity:"warning",onClick:o[13]||(o[13]=t=>$.value=!0),style:{width:"100%","background-color":"black",border:"none"},icon:"pi pi-airplane",label:"traslado"})]),e("div",no,[r(u,{onClick:o[14]||(o[14]=t=>D.value=!0),label:"Cambiar metodo de pago",severity:"success"})])]),default:c(()=>{var t,A,q,F,H;return[e("div",ye,[e("p",he," ID:"+a(s(l).currentOrder.order_id),1),e("p",ge,a(s(l).currentOrder.user_name),1),e("p",fe,[e("b",null," fecha: "+a((t=s(l).currentOrder.latest_status_timestamp)==null?void 0:t.split("T")[0]),1),e("b",null," Hora: "+a((H=(F=(q=(A=s(l).currentOrder.latest_status_timestamp)==null?void 0:A.split("T")[1])==null?void 0:q.split(":"))==null?void 0:F.slice(0,2))==null?void 0:H.join(":")),1)]),we,(v(!0),y(L,null,j(s(l).currentOrder.pe_json.listaPedidos,m=>{var Z;return v(),y("div",null,[e("div",xe,[e("p",Oe,[h(a(m.pedido_cantidad)+" "+a(m.pedido_nombre_producto)+" ",1),ke]),e("div",null,[e("p",Ce,a(s(C)(m.pedido_precio*m.pedido_cantidad)),1)])]),m.lista_productocombo?(v(),y("p",Ve,Ee)):J("",!0),m.lista_productocombo?(v(!0),y(L,{key:1},j(m.lista_productocombo,_=>(v(),y("p",Se,[h(" -- "),e("b",null,a(_.pedido_cantidad),1),h(" "+a(_.pedido_nombre),1)]))),256)):J("",!0),(v(!0),y(L,null,j((Z=m.modificadorseleccionList)==null?void 0:Z.filter(_=>_.pedido_productoid==m.pedido_productoid),_=>(v(),y("div",$e,[e("p",Me,[h(" -- "),e("b",null,a(_.modificadorseleccion_cantidad),1),h(" "+a(_.modificador_nombre),1)]),e("p",Ue,a(s(C)(_.pedido_precio*_.modificadorseleccion_cantidad)),1)]))),256)),Le])}),256)),e("div",Pe,[Te,e("div",Ne,[e("p",ze,[e("b",null,a(s(C)(s(l).currentOrder.pe_json.delivery.delivery_pagocon-s(l).currentOrder.delivery_price)),1)])]),je,e("div",Ie,[e("p",Re,[e("b",null,a(s(C)(s(l).currentOrder.delivery_price)),1)])]),Be,e("div",Ae,[e("p",qe,[e("b",null,a(s(C)(s(l).currentOrder.pe_json.delivery.delivery_pagocon)),1)])]),Fe]),He,e("p",Ze,a(s(l).currentOrder.order_notes),1),Ye,e("div",Ge,[Je,e("div",Ke,[e("p",Qe,a(s(l).currentOrder.user_name),1)]),We,e("div",null,[e("p",Xe,a(s(l).currentOrder.user_phone),1)]),eo,e("div",null,[e("p",oo,a(s(l).currentOrder.user_address),1)]),to,e("div",null,[e("p",lo,a(s(l).currentOrder.payment_method),1)])])]),r(u,{class:"shadow-4",onClick:o[15]||(o[15]=m=>s(l).setVisible("currentOrder",!1)),icon:"pi pi-times",rounded:"",severity:"danger",style:{position:"absolute",top:"-1rem","border-radius":"50%",right:"-1rem"}})]}),_:1},8,["visible"])]),r(b,{visible:$.value,"onUpdate:visible":o[19]||(o[19]=t=>$.value=t),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:c(()=>[ro]),default:c(()=>[e("form",{onSubmit:U(B,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[ao,r(g,{style:{width:"100%"},id:"responsible",modelValue:P.value,"onUpdate:modelValue":o[17]||(o[17]=t=>P.value=t),optionValue:"site_id",options:T.value.filter(t=>t.show_on_web),optionLabel:"site_name",placeholder:"Seleccione la sede destino"},null,8,["modelValue","options"]),r(u,{onClick:o[18]||(o[18]=t=>X()),style:{width:"100%","border-radius":"0.5rem"},label:"Trasladar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"])],64)}}},po=ee(io,[["__scopeId","data-v-f60ccb74"]]);export{po as D};
