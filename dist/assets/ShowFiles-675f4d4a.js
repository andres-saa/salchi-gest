import{_ as ue,c6 as pe,f as d,x as me,u as ve,B as fe,h as J,g as ye,r as v,o as M,c as H,d as a,w as n,a as o,y as _e,F as he,U as f,t as C,k as I,l as ge,c1 as G,bV as K,q as we,n as be,p as xe,e as Ce}from"./index-18a13e21.js";import{b as ke}from"./dropDownAux-c09de2e3.js";import{u as Q}from"./sendFileService-aca0002a.js";/* empty css                                                                  */const i=k=>(xe("data-v-8a2840b2"),k=k(),Ce(),k),Se=i(()=>o("h3",null,"Nuevo Tipo",-1)),De=i(()=>o("p",{for:"type_name"},"Nombre del Tipo de Documento:",-1)),$e={class:"col-12 p-0 m-auto",style:{}},Te={class:""},Ee={class:"col-12 p-0",style:{display:"flex","justify-content":"end"}},Ve={class:"mt-4 col-12 md:col-6 xl:col-4 p-0",style:{display:"flex","max-width":"35rem","justify-content":"end",gap:"1rem"}},Ne=i(()=>o("i",{class:"fa-solid fa-plus mr-2 text-2xl"},null,-1)),Pe=i(()=>o("i",{class:"fa-solid fa-file mr-2 text-2xl"},null,-1)),Ie=i(()=>o("i",{class:"fa-solid fa-plus mr-2 text-2xl"},null,-1)),je=i(()=>o("i",{class:"fa-solid fa-house mr-2 text-2xl"},null,-1)),Oe=i(()=>o("i",{class:"fa-solid fa-plus mr-2 text-2xl"},null,-1)),Re=i(()=>o("i",{class:"fa-solid fa-font"},null,-1)),Ue={style:{"min-width":"max-content"}},Ae=i(()=>o("span",{class:"p-column-title"},"Category",-1)),Le={style:{"min-width":"max-content"}},ze={style:{display:"flex"}},Fe=i(()=>o("i",{class:"fa-solid fa-file-arrow-down"},null,-1)),qe=i(()=>o("i",{class:"fa-solid fa-pen-to-square"},null,-1)),Be=i(()=>o("i",{class:"fa-solid fa-trash"},null,-1)),Je={class:"col-12 p-0",style:{"max-width":""}},Me=i(()=>o("label",{for:"position"},"FECHA DE RENOVACION",-1)),He={class:"p-3",style:{"background-color":"rgba(115, 255, 76, 0.306)"}},Ge=i(()=>o("i",{class:"pi pi-check",style:{color:"slateblue"}},null,-1)),Ke={class:"grid",style:{display:"flex","justify-content":"space-between"}},Qe={class:"col-12 xl:col-6"},We={class:"col-12 xl:col-6"},Xe={class:"grid",style:{display:"flex",padding:"0",margin:"0"}},Ye={class:"col-12 xl:col-6"},Ze=i(()=>o("label",{for:"position"},"TIPO DE DOCUMENTO",-1)),et={class:"col-12 xl:col-6"},tt=i(()=>o("label",{for:"position"},"FECHA DE RENOVACION",-1)),ot={class:"p-3",style:{"background-color":"rgba(19, 164, 0, 0.306)"}},st=i(()=>o("i",{class:"pi pi-check",style:{color:"slateblue"}},null,-1)),at={style:{display:"flex","justify-content":"space-between"}},lt=i(()=>o("h3",null,"Nueva Sede",-1)),nt={class:""},it=i(()=>o("p",{class:"mt-4"},"Nombre de la Sede:",-1)),rt=i(()=>o("p",{class:"mt-4"},"Dirección:",-1)),dt=i(()=>o("p",{class:"mt-4"},"Teléfono:",-1)),ct={key:0,style:{"margin-top":"20px"}},ut=["src"],pt=i(()=>o("i",{class:"fa-solid fa-camera"},null,-1)),mt={__name:"ShowFiles",setup(k){const W=pe(),S=d(!1),w=d(""),X=async()=>{if(!w.value){alert("Por favor, ingrese un nombre para el tipo de documento.");return}try{const t=await fetch(`${f}/site-file-type`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type_name:w.value})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();console.log("Tipo de documento agregado:",e),w.value="",S.value=!1,F()}catch(t){console.error("Error al agregar el tipo de documento:",t)}},D=me(),A=d([]),c=d(),p=d(),L=d([]),j=d(),y=d(""),_=d(""),$=ve(),b=d({}),g=fe();A.value=j.value;const z=t=>{const e=t.target.files[0];e&&(console.log("Archivo seleccionado:",e),c.value=e)},F=async()=>{try{const t=await fetch(`${f}/site-file-types`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();L.value=e.map(r=>r.type_name)}catch(t){console.error("Error al obtener los tipos de documentos:",t)}},Y=t=>{W.require({target:event.currentTarget,message:`Esta seguro de eliminar ${t.document_name}`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-info p-button-outlined p-button-sm",acceptClass:"p-button-sm p-button-danger",rejectLabel:"Cancelar",acceptLabel:"Eliminar",accept:()=>{Z(t)},reject:()=>{}})},Z=async t=>{try{if(!(await fetch(`${f}/site_document/${t.document_id}`,{method:"DELETE"})).ok)throw new Error("Error al eliminar el documento");x(),g.add({severity:"success",summary:"Documento eliminado",detail:"El documento ha sido eliminado correctamente.",life:3e3})}catch(e){console.error("Error al eliminar el documento:",e),g.add({severity:"error",summary:"Error al eliminar",detail:"No se pudo eliminar el documento.",life:3e3})}},ee=async t=>{let e="post";const r=`${f}/site-document/`,l={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return(await fetch(r,l)).json()},x=async()=>{try{const t=`${f}/get-site-documents-info/${$.params.site_id}`,e=await fetch(t);if(console.log(e),!e.ok)return;const r=await e.json();j.value=r}catch(t){console.error("Error al enviar la solicitud:",t)}},te=async t=>{let e="put";const r={...t},l=`${f}/site-document/${r.document_id}`;r.renovation_date=_.value;const u={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};try{const m=await fetch(l,u);if(!m.ok)throw new Error(`Error en la solicitud: ${m.status}`);const U=await m.json();return x(),O(),g.add({severity:"success",summary:"Actualización exitosa",detail:"Documento actualizado correctamente",life:3e3}),U}catch(m){g.add({severity:"error",summary:"Error en la actualización",detail:m.message,life:3e3})}};J(()=>{D.setLoading(!0),D.setLoading(!1),F()}),ye(()=>$.params.site_id,()=>{x(),D.setLoading(!0),D.setLoading(!1)}),J(()=>{const t=localStorage.getItem("currentSiteFiles");t&&(b.value=JSON.parse(t))});const T=d(!1),E=d(!1),oe=(t,e,r)=>{const l={document_name:`${b.value.site_name} ${y.value}`,document_type:y.value,renovation_date:_.value,site_id:$.params.site_id};ee(l).then(u=>{console.log(u),Q(t,u.document_id,y.value),x()}),g.add({severity:"success",summary:"hecho",detail:"",life:3e3}),O()},se=(t,e)=>{console.log(A,y.value),`${p.value.document_name}`,p.value.document_type,_.value,$.params.site_id,console.log(e),te(e),Q(t,e.document_id,e.document_type),g.add({severity:"success",summary:"hecho",detail:"",life:3e3}),O()},ae=t=>{T.value=!0,p.value=t},le=t=>{E.value=!0,p.value=t},O=()=>{T.value=!1,E.value=!1,c.value=null,x()},V=d(null),N=d(!1),h=d({site_name:"",site_address:"",site_phone:"",site_business_hours:""}),R=d(null);d(null);const ne=()=>{N.value=!0,V.value=null},ie=t=>{const e=t.target.files[0];R.value=e,e&&(V.value=URL.createObjectURL(e))},re=async()=>{try{const t=await fetch(`${f}/site`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h.value)});if(!t.ok)throw new Error("Error al crear la sede");const r=(await t.json()).site_id;if(R.value){const l=new FormData;l.append("file",R.value),await fetch(`${f}/upload-product-image/site-${r}`,{method:"POST",body:l})}N.value=!1}catch(t){console.error("Error al crear la sede:",t)}};return(t,e)=>{const r=v("InputText"),l=v("Button"),u=v("Dialog"),m=v("Toast"),U=v("ConfirmPopup"),P=v("Column"),de=v("DataTable"),q=v("Calendar"),ce=v("Dropdown");return M(),H(he,null,[a(u,{visible:S.value,"onUpdate:visible":e[1]||(e[1]=s=>S.value=s),breakpoints:{"960px":"75vw"},style:{width:"30vw",padding:"0px"},modal:!0},{header:n(()=>[Se]),footer:n(()=>[a(l,{label:"Agregar",onClick:X})]),default:n(()=>[o("div",null,[De,a(r,{class:"col-12",id:"type_name",modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s)},null,8,["modelValue"])])]),_:1},8,["visible"]),a(m),o("div",$e,[a(m),a(U),o("div",Te,[a(de,{ref:"dt",value:j.value,dataKey:"id",paginator:!0,rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll",frozenValue:t.lockedCustomers},{header:n(()=>[]),default:n(()=>[o("div",Ee,[o("div",Ve,[a(l,{size:"small ",style:{width:"100%","font-weight":"bold",display:"flex","align-items":"center","justify-content":"center"},rounded:"",class:"p-button-info py-2",onClick:e[2]||(e[2]=s=>le())},{default:n(()=>[Ne,Pe]),_:1}),a(l,{size:"small ",style:{width:"100%","font-weight":"bold",display:"flex","align-items":"center","justify-content":"center"},rounded:"",class:"p-button-warning py-2",onClick:ne},{default:n(()=>[Ie,je]),_:1}),a(l,{size:"small ",style:{width:"100%","font-weight":"bold",display:"flex","align-items":"center","justify-content":"center"},rounded:"",class:"p-button-success py-2",onClick:e[3]||(e[3]=s=>S.value=!0)},{default:n(()=>[Oe,Re]),_:1})])]),a(P,{class:"",field:"name",header:"Tipo",sortable:!0,headerStyle:"width:20rem; min-width:max-content; "},{body:n(s=>[o("p",Ue,C(s.data.document_type),1)]),_:1}),a(P,{class:"py-0",field:"position",header:"Nombre ",sortable:!0,headerStyle:"width:20rem; min-width:10rem;"},{body:n(s=>[Ae,o("p",Le,C(s.data.document_name),1)]),_:1}),a(P,{class:"p-0",field:"birth_date",header:"Renovacion",sortable:!0,headerStyle:"width:5rem; min-width:10rem;"},{body:n(s=>[I(C(s.data.renovation_date),1)]),_:1}),a(P,{style:{},class:"py-0",header:"Acciones",fieldheaderStyle:"width:10rem; min-width:max-content",frozen:"",alignFrozen:"right"},{body:n(s=>[o("div",ze,[a(l,{text:"",size:"large",style:{"aspect-ratio":"1 / 1"},class:"p-button-success mr-2 mb-2 p-0 text-3xl",onClick:B=>ge(ke)(s.data.document_id,s.data.document_type)},{default:n(()=>[Fe]),_:2},1032,["onClick"]),a(l,{text:"",size:"large",style:{},class:"p-button-info mr-2 mb-2 p-0 text-3xl",onClick:B=>ae(s.data)},{default:n(()=>[qe]),_:2},1032,["onClick"]),a(l,{text:"",size:"large",style:{},class:"p-button-danger mr-2 mb-2 p-0 text-3xl",onClick:B=>Y(s.data)},{default:n(()=>[Be]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["value","frozenValue"]),a(u,{class:"p-0",closable:!0,style:_e([{"max-width":"500px"},{width:"30vw",padding:"0px"}]),header:` CARGAR ${p.value?p.value.document_type:""} PARA ${b.value.site_name}`,visible:T.value,"onUpdate:visible":e[7]||(e[7]=s=>T.value=s),breakpoints:{"960px":"75vw"},modal:!0},{default:n(()=>[o("input",{ref:"fileInput",type:"file",onChange:z,style:{display:"none"}},null,544),o("div",Je,[Me,a(q,{id:"entry_date",style:{width:"100%",margin:"20px 0"},modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=s=>_.value=s),required:"true",autofocus:""},null,8,["modelValue"])]),G(o("p",He,[Ge,I(" "+C(c.value?`${c.value.name} : si este no es
                    su documento por
                    favor carguelo`:""),1)],512),[[K,c.value]]),o("div",Ke,[o("div",Qe,[a(l,{label:"Seleccionar documento",class:"col-12",style:{"background-color":"var(--primary-color)"},onClick:e[5]||(e[5]=s=>{t.$refs.fileInput.click()})})]),o("div",We,[a(l,{class:"col-12",label:"Enviar",style:{"background-color":"var(--primary-color)"},onClick:e[6]||(e[6]=s=>se(c.value,p.value))})])])]),_:1},8,["header","visible"]),a(u,{header:` CARGAR ${p.value?p.value:""} PARA ${b.value.site_name}`,visible:E.value,"onUpdate:visible":e[12]||(e[12]=s=>E.value=s),breakpoints:{"960px":"75vw"},style:{width:"50vw",padding:"50p0x"},modal:!0},{default:n(()=>[o("div",Xe,[o("div",Ye,[Ze,a(ce,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=s=>y.value=s),modelModifiers:{trim:!0},options:L.value,placeholder:"",required:"true",class:we({"p-invalid":t.submitted}),style:{width:"100%",margin:"20px 0"}},null,8,["modelValue","options","class"])]),o("div",et,[tt,a(q,{id:"entry_date",style:{width:"100%",margin:"20px 0"},modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=s=>_.value=s),required:"true",autofocus:""},null,8,["modelValue"])])]),o("input",{ref:"fileInput",type:"file",onChange:z,style:{display:"none"}},null,544),G(o("p",ot,[st,I(" "+C(c.value?`${c.value.name} : verifique si
                    este es su documeto
                    antes de envirlo`:""),1)],512),[[K,c.value]]),o("div",at,[a(l,{label:"Seleccionar documento",style:{width:"40%","background-color":"var(--primary-color)"},onClick:e[10]||(e[10]=s=>{t.$refs.fileInput.click()})}),a(l,{label:"Enviar",style:{width:"40%","background-color":"var(--primary-color)"},onClick:e[11]||(e[11]=s=>oe(c.value,y.value,b.value.site_id))})])]),_:1},8,["header","visible"])])]),a(u,{visible:N.value,"onUpdate:visible":e[17]||(e[17]=s=>N.value=s),breakpoints:{"960px":"75vw"},style:{width:"30vw",padding:"0px"},modal:!0},{header:n(()=>[lt]),footer:n(()=>[a(l,{onClick:re},{default:n(()=>[I("Crear Sede")]),_:1})]),default:n(()=>[o("div",nt,[it,a(r,{class:"col-12",modelValue:h.value.site_name,"onUpdate:modelValue":e[13]||(e[13]=s=>h.value.site_name=s)},null,8,["modelValue"])]),o("div",null,[rt,a(r,{class:"col-12",modelValue:h.value.site_address,"onUpdate:modelValue":e[14]||(e[14]=s=>h.value.site_address=s)},null,8,["modelValue"])]),o("div",null,[dt,a(r,{class:"col-12",modelValue:h.value.site_phone,"onUpdate:modelValue":e[15]||(e[15]=s=>h.value.site_phone=s)},null,8,["modelValue"])]),V.value?(M(),H("div",ct,[o("img",{src:V.value,alt:"Vista previa de la imagen",style:{"max-width":"100%","max-height":"300px"}},null,8,ut)])):be("",!0),a(l,{class:"my-5",onClick:e[16]||(e[16]=s=>t.$refs.imageInput.click())},{default:n(()=>[pt]),_:1}),o("input",{type:"file",ref:"imageInput",onChange:ie,style:{display:"none"}},null,544)]),_:1},8,["visible"])],64)}}},ht=ue(mt,[["__scopeId","data-v-8a2840b2"]]);export{ht as default};
