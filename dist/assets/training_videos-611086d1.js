import{l as A,j as w,G as z,r as d,o as S,g as R,f as n,e as t,a as e,u as c,c as M,i as F,h as k,t as f,H as G,k as H,m as Z,U as j,_ as J,aa as Q,w as q,q as W,x as X,A as ee}from"./index-9852904f.js";import{u as I,a as B}from"./dataToInteract-94d7be4b.js";import{v as N}from"./videoTrainingService-923da066.js";import{u as P}from"./urlService-89e3f0c9.js";const te={style:{height:"100%"}},oe=e("h6",null,"Nombre de la nueva Clase",-1),ae=e("h6",{style:{}},[k("Link del video (YouTube) "),e("i",{class:"pi pi-youtube"})],-1),se=["src"],ie=e("h6",null,"Descripcion u objetivo",-1),le={__name:"dialogToAddVideo",emits:["update"],setup(x,{emit:g}){const b=g,_=A(),u=I(),o=w({}),p=z(),l=async()=>{const s={...o.value,created_by:_.rawUserData.id,sequence_id:p.params.sequence_id};await N.createVideo(s),u.addVideo=!1,b("update")};return(s,i)=>{const m=d("InputText"),C=d("Textarea"),y=d("Button"),v=d("Dialog");return S(),R(v,{visible:c(u).addVideo,"onUpdate:visible":i[3]||(i[3]=T=>c(u).addVideo=T),class:"p-0 m-3",header:"Registrar nueva Clase",style:{width:"30rem"},modal:""},{footer:n(()=>[t(y,{class:"m-0",onClick:l,severity:"help",label:"Crear Clase"})]),default:n(()=>[e("div",te,[oe,t(m,{modelValue:o.value.name,"onUpdate:modelValue":i[0]||(i[0]=T=>o.value.name=T),style:{width:"100%"}},null,8,["modelValue"]),ae,t(m,{modelValue:o.value.link,"onUpdate:modelValue":i[1]||(i[1]=T=>o.value.link=T),style:{width:"100%"}},null,8,["modelValue"]),o.value.link&&c(P).getThumbnail(o.value.link)?(S(),M("img",{key:0,class:"my-3",style:{width:"100%","border-radius":".3rem","aspect-ratio":"16 / 9","object-fit":"cover"},src:c(P).getThumbnail(o.value.link),alt:""},null,8,se)):F("",!0),ie,t(C,{modelValue:o.value.description,"onUpdate:modelValue":i[2]||(i[2]=T=>o.value.description=T),style:{width:"100%",resize:"none"},rows:"4"},null,8,["modelValue"])])]),_:1},8,["visible"])}}},ne={style:{height:"100%"}},de=e("br",null,null,-1),re={__name:"dialogToDeleteVideo",emits:["update"],setup(x,{emit:g}){const b=g;A();const _=I(),u=B();w({});const o=async()=>{const p=u.videoToDelete.video_id;await N.deleteVideo(p),_.deleteVideo=!1,b("update")};return(p,l)=>{const s=d("Button"),i=d("Dialog");return S(),R(i,{visible:c(_).deleteVideo,"onUpdate:visible":l[0]||(l[0]=m=>c(_).deleteVideo=m),class:"p-0 m-3",header:"Registrar nueva escuela",style:{width:"30rem"},modal:""},{footer:n(()=>[t(s,{icon:"pi pi-trash",class:"m-0",onClick:o,severity:"danger",label:"Eliminar escuela"})]),default:n(()=>{var m;return[e("div",ne,[e("h6",null,[k("Seguro que desea borrar la clase "),de,k(),e("b",null,f((m=c(u).videoToDelete)==null?void 0:m.video_name),1),k(" ? ")])])]}),_:1},8,["visible"])}}},ce={style:{height:"100%"}},ue=e("h6",null,"Nombre del video",-1),pe=e("h6",{style:{}},[k("Link del video (YouTube) "),e("i",{class:"pi pi-youtube"})],-1),_e=["src"],me=e("h6",null,"Descripcion u objetivo",-1),ve={__name:"dialogToEditVideo",emits:["update"],setup(x,{emit:g}){const b=B(),_=g;A();const u=I(),o=w({...b.videoToUpdate});G(()=>b.videoToUpdate,l=>{o.value={...l}},{deep:!0}),w({});const p=async()=>{if(!P.ValidateThumbnail(o.value.video_link)){alert("url invalida debe ser una url valida de youtube");return}const l=o.value.video_id,s={name:o.value.video_name,link:o.value.video_link,description:o.value.description};await N.updateVideo(l,s),u.updateVideo=!1,_("update")};return(l,s)=>{const i=d("InputText"),m=d("Textarea"),C=d("Button"),y=d("Dialog");return S(),R(y,{visible:c(u).updateVideo,"onUpdate:visible":s[3]||(s[3]=v=>c(u).updateVideo=v),class:"p-0 m-3",header:"Actualizar Curso",style:{width:"30rem"},modal:""},{footer:n(()=>[t(C,{class:"m-0",onClick:p,severity:"warning",label:"Actualizar escuela"})]),default:n(()=>[e("div",ce,[ue,t(i,{modelValue:o.value.video_name,"onUpdate:modelValue":s[0]||(s[0]=v=>o.value.video_name=v),style:{width:"100%"}},null,8,["modelValue"]),pe,t(i,{modelValue:o.value.video_link,"onUpdate:modelValue":s[1]||(s[1]=v=>o.value.video_link=v),style:{width:"100%"}},null,8,["modelValue"]),o.value.video_link&&c(P).getThumbnail(o.value.video_link)?(S(),M("img",{key:0,class:"my-3",style:{width:"100%","border-radius":".3rem","aspect-ratio":"16 / 9","object-fit":"cover"},src:c(P).getThumbnail(o.value.video_link),alt:""},null,8,_e)):F("",!0),me,t(m,{modelValue:o.value.description,"onUpdate:modelValue":s[2]||(s[2]=v=>o.value.description=v),style:{width:"100%",resize:"none"},rows:"4"},null,8,["modelValue"])])]),_:1},8,["visible"])}}},he=e("div",{class:"pt-3",style:{display:"flex",gap:"1rem","align-items":"center"}},[e("h6",{class:"m-0 p-0 text-cende"},[e("b")])],-1),ge={class:"students",style:{display:"flex","align-items":"center",gap:"1rem"}},be=["src","onError"],ye={class:"p-0 my-0"},fe={__name:"dialogStudentsVideo",setup(x){const g=w({}),b=w([{}]),_=B(),u=I(),o=(p,l)=>{var i;const s={masculino:"/images/male-avatar.png",femenino:"/images/female-avatar.png",default:"/images/who.png"};!p||p==""||p=="N/A"?l.target.src=s.default:l.target.src=s[(i=p.trim())==null?void 0:i.toLowerCase()]};return w({}),H(async()=>{}),G(()=>u.showvideoStudents,async p=>{var l;if(p){const s=_.videoUsersId;b.value=await Z.get(`${j}/list-video-mark-by-video-id/${s}`,"cargando asistencia"),(l=b.value)==null||l.forEach(i=>g.value[i.user_id]=i.mark)}},{deep:!0}),(p,l)=>{const s=d("Checkbox"),i=d("column"),m=d("DataTable"),C=d("Dialog");return S(),R(C,{visible:c(u).showvideoStudents,"onUpdate:visible":l[0]||(l[0]=y=>c(u).showvideoStudents=y),class:"p-0 m-3",header:"Vistas",style:{width:"30rem"},modal:""},{default:n(()=>[t(m,{paginator:!1,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} contratos",rowsPerPageOptions:[5,10,25,100],showGridlines:"",stripedRows:"",class:"col-12 m-auto p-0",value:b.value},{header:n(()=>[he]),default:n(()=>[t(i,{class:"p-2",style:{"text-transform":"uppercase"}},{body:n(y=>[e("div",ge,[t(s,{disabled:"",binary:"",modelValue:g.value[y.data.user_id],"onUpdate:modelValue":v=>g.value[y.data.user_id]=v},null,8,["modelValue","onUpdate:modelValue"]),e("img",{src:`${c(j)}/read-product-image/96/employer-${y.data.dni}`,onError:v=>o(y.data.gender,v),class:"shadow-2 img-profile",style:{border:"none",position:"relative",height:"2rem",width:"2rem","object-fit":"cover","border-radius":"50%"}},null,40,be),k(),e("h6",ye,f(y.data.name),1)])]),_:1})]),_:1},8,["value"])]),_:1},8,["visible"])}}};const V=x=>(W("data-v-daebb7ec"),x=x(),X(),x),we={class:"container py-2 px-2"},Ve={class:"page-hero"},ke={class:"page-hero__content"},Te={class:"title-wrap"},xe=V(()=>e("i",{class:"fa fa-book"},null,-1)),Ce={class:"uppercase"},De=V(()=>e("b",null,"Curso",-1)),$e={class:"subtitle"},Se={class:"actions-wrap"},Ue={class:"p-input-icon-left search-input"},Pe=V(()=>e("i",{class:"pi pi-search"},null,-1)),Ie=V(()=>e("div",{class:"hero-accent"},null,-1)),Le={class:"video-frame"},Re=["src"],Be={class:"table-card shadow-2"},Ne={class:"empty-state"},Ee=V(()=>e("i",{class:"fa-solid fa-circle-play bounce"},null,-1)),qe=V(()=>e("p",null,[e("b",null,"Aún no hay clases")],-1)),Ae=V(()=>e("p",{class:"muted"},"Crea la primera clase para empezar.",-1)),Me={class:"name-cell"},je={class:"name-text uppercase"},ze={class:"name-actions"},Fe={class:"desc-cell"},Ge=V(()=>e("i",{class:"fa-regular fa-message"},null,-1)),He={class:"truncate"},Oe=["onClick"],Ye=["src"],Ke=V(()=>e("div",{class:"thumb-overlay"},[e("i",{class:"fa-solid fa-play"})],-1)),Ze={class:"datetime-stack"},Je=V(()=>e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1)),Qe=V(()=>e("i",{class:"fa-regular fa-clock mr-2"},null,-1)),We={class:"creator-cell"},Xe={class:"avatar"},et={__name:"training_videos",setup(x){const g=B(),b=z(),_=I(),u=w([]),o=w(!1),p=w({}),l=w({global:{value:null,matchMode:ee.CONTAINS}}),s=(h="")=>{const r=h.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/shorts\/)([a-zA-Z0-9_-]+)(?:\?.*)?/);return r!=null&&r[1]?`https://www.youtube.com/embed/${r[1]}`:""},i=h=>{p.value=h,o.value=!0},m=async()=>{const h=b.params.sequence_id;u.value=await N.getVideosBySequenceId(h)},C=h=>{g.videoToDelete={...h},_.deleteVideo=!0},y=h=>{g.videoToUpdate={...h},_.updateVideo=!0},v=h=>{g.videoUsersId=h,_.showvideoStudents=!0},T=(h="")=>h.split(" ").filter(Boolean).slice(0,2).map(r=>{var D;return(D=r[0])==null?void 0:D.toUpperCase()}).join("");return H(async()=>{m()}),(h,r)=>{const D=d("Tag"),O=d("InputText"),$=d("Button"),Y=d("Dialog"),U=d("Column"),K=d("DataTable"),E=Q("tooltip");return S(),M("div",we,[t(le,{onUpdate:m}),t(re,{onUpdate:m}),t(ve,{onUpdate:m}),t(fe),e("section",Ve,[e("div",ke,[e("div",Te,[xe,e("h2",Ce,[De,e("span",$e,"/ "+f(c(b).params.sequence_name),1)]),t(D,{class:"ml-2",severity:"success"},{default:n(()=>[k(f(u.value.length)+" clases",1)]),_:1})]),e("div",Se,[e("span",Ue,[Pe,t(O,{modelValue:l.value.global.value,"onUpdate:modelValue":r[0]||(r[0]=a=>l.value.global.value=a),placeholder:"Buscar clase, creador, fecha…"},null,8,["modelValue"])]),t($,{onClick:r[1]||(r[1]=a=>c(_).addVideo=!0),severity:"help",label:"Nueva clase",icon:"fa-solid fa-plus"})])]),Ie]),t(Y,{visible:o.value,"onUpdate:visible":r[2]||(r[2]=a=>o.value=a),class:"p-0 m-3 modern-dialog",header:"Reproductor de video",modal:"",style:{width:"min(90vw, 64rem)"}},{default:n(()=>[e("div",Le,[e("iframe",{class:"p-0",width:"100%",style:{"aspect-ratio":"16 / 9"},src:s(p.value.video_link),title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:""},null,8,Re)])]),_:1},8,["visible"]),e("div",Be,[t(K,{value:u.value,dataKey:"video_id",paginator:!0,rows:15,rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",tableStyle:"min-width: 64rem;",filters:l.value,"onUpdate:filters":r[4]||(r[4]=a=>l.value=a),filterDisplay:"menu",globalFilterFields:["video_name","description","created_date","created_time","creator_name","video_id"],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} clases",class:"col-12 m-auto"},{empty:n(()=>[e("div",Ne,[Ee,qe,Ae,t($,{label:"Crear clase",icon:"fa-solid fa-plus",severity:"success",onClick:r[3]||(r[3]=a=>c(_).addVideo=!0)})])]),default:n(()=>[t(U,{header:"ID",field:"video_id",class:"px-4",style:{"min-width":"8rem"}},{body:n(({data:a})=>[t(D,{severity:"info"},{default:n(()=>[k("#"+f(a.video_id),1)]),_:2},1024)]),_:1}),t(U,{header:"Nombre",field:"video_name",class:"px-4",style:{"min-width":"22rem"}},{body:n(({data:a})=>[e("div",Me,[e("h6",je,f((a.video_name||"").toLowerCase()),1),e("div",ze,[q(t($,{text:"",icon:"fa-solid fa-play",onClick:L=>i(a)},null,8,["onClick"]),[[E,"Reproducir",void 0,{bottom:!0}]]),q(t($,{text:"",icon:"fa-solid fa-pencil",onClick:L=>y(a)},null,8,["onClick"]),[[E,"Editar",void 0,{bottom:!0}]]),q(t($,{text:"",severity:"danger",icon:"fa-solid fa-trash",onClick:L=>C(a)},null,8,["onClick"]),[[E,"Eliminar",void 0,{bottom:!0}]]),t($,{text:"",severity:"success",icon:"fa-solid fa-eye",label:"Visualizaciones",onClick:L=>v(a.video_id)},null,8,["onClick"])])])]),_:1}),t(U,{header:"Descripción",field:"description",class:"px-4",style:{"min-width":"28rem"}},{body:n(({data:a})=>[e("div",Fe,[Ge,e("span",He,f((a.description||"").toLowerCase()),1)])]),_:1}),t(U,{header:"Miniatura",class:"px-4",style:{"min-width":"16rem"}},{body:n(({data:a})=>[e("div",{class:"thumb",onClick:L=>i(a)},[e("img",{class:"thumb-img",src:c(P).getThumbnail(a.video_link),alt:"Miniatura"},null,8,Ye),Ke],8,Oe)]),_:1}),t(U,{header:"Fecha & Hora",class:"px-4",style:{"min-width":"16rem"}},{body:n(({data:a})=>[e("div",Ze,[t(D,{severity:"warning",class:"mb-2"},{default:n(()=>[Je,k(" "+f(a.created_date),1)]),_:2},1024),t(D,{severity:"secondary"},{default:n(()=>[Qe,k(" "+f(a.created_time),1)]),_:2},1024)])]),_:1}),t(U,{header:"Creador",field:"creator_name",class:"px-4",style:{"min-width":"16rem"}},{body:n(({data:a})=>[e("div",We,[e("span",Xe,f(T(a.creator_name)),1),e("h6",null,f(a.creator_name),1)])]),_:1})]),_:1},8,["value","filters"])]),t($,{class:"fab",icon:"fa-solid fa-plus",label:"Nueva",severity:"help",onClick:r[5]||(r[5]=a=>c(_).addVideo=!0)})])}}},it=J(et,[["__scopeId","data-v-daebb7ec"]]);export{it as default};
