import{f as C}from"./formatoPesos-2a38d2e7.js";import{a as B,u as K}from"./site-92898522.js";import{C as z,U as F,v as G,l as Z,_ as ee,r as M,A as te,i as re,D as oe,a as E,o as i,c as h,b as e,F as O,d as T,t as p,m as L,u as s,f as R,k as se,e as S,w as x,g as I,p as ne,h as ae}from"./index-94a9853b.js";import{u as X}from"./user-cdf290b6.js";import{u as ie}from"./ventas-e1b1ee55.js";import"./sass.default-a5b7a582.js";const H={init(){(function(t,o,n,c,d,l,g){t.fbq||(d=t.fbq=function(){d.callMethod?d.callMethod.apply(d,arguments):d.queue.push(arguments)},t._fbq||(t._fbq=d),d.push=d,d.loaded=!0,d.version="2.0",d.queue=[],l=o.createElement(n),l.async=!0,l.src=c,g=o.getElementsByTagName(n)[0],g.parentNode.insertBefore(l,g))})(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),fbq("init","9692941457447887");const r=document.createElement("script");r.async=!0,r.src="https://www.googletagmanager.com/gtag/js?id=G-HGS98CQWJN",r.onload=()=>{window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config","G-HGS98CQWJN")},document.head.appendChild(r)},sendTrackingEvent(r,t){window.fbq&&(r==="Purchase"?fbq("track","Purchase",t):fbq("track",r)),window.gtag&&gtag("event",r,{value:t.total,currency:"COP",items:t.items})}},q=ie(),y=B(),N=K(),m=X(),J=()=>{var w,A,v,k;const t=Z().rawUserData.id;m.user.was_reserva=!1,y.sending_order=!0;const o=y.cart.products.map(a=>{var D,$,U,V;const j=a.product.productogeneral_precio,Y=($=(D=a.product.lista_presentacion)==null?void 0:D[0])==null?void 0:$.producto_precio;return{pedido_productoid:a.product.producto_id,pedido_cantidad:a.quantity,pedido_precio:j!==void 0?j:Y||0,pedido_escombo:a.product.productogeneral_escombo,pedido_nombre_producto:a.product.productogeneral_descripcion,lista_productocombo:(U=a.product.lista_productobase)==null?void 0:U.map(_=>({pedido_productoid:parseInt(_.producto_id),pedido_cantidad:parseInt(_.productocombo_cantidad),pedido_precio:parseInt(_.productocombo_precio),pedido_nombre:_.producto_descripcion})),modificadorseleccionList:(V=y.cart.additions.filter(_=>_.parent_id==a.product.producto_id))==null?void 0:V.map(_=>({modificadorseleccion_cantidad:_.quantity,pedido_precio:_.price,modificador_id:_.group_id,modificadorseleccion_id:_.id,modificador_nombre:_.name,pedido_productoid:_.parent_id}))}});console.log(o);const n=y.cart.additions.map(a=>({aditional_item_instance_id:a.id,quantity:a.quantity})),c=N.location.site.site_id,d=N.location.site.pe_site_id,l=(w=m.user.payment_method_option)==null?void 0:w.id,g=l===7?0:N.location.neigborhood.delivery_price,u=y.cart.order_notes,b={user_name:m.user.name,user_phone:(A=m.user.phone_number)==null?void 0:A.split(" ").join(""),user_address:` ${m.user.address} ${(k=(v=N.location)==null?void 0:v.neigborhood)==null?void 0:k.name}`||""};return{order_products:[],site_id:c,pe_site_id:d,delivery_person_id:4,payment_method_id:l,delivery_price:g,order_notes:u||"SIN NOTAS",user_data:b,order_aditionals:n,pe_json:o,total:y.cart.total_cost,inserted_by:t}},de=()=>{var l,g;m.user.was_reserva=!0,y.sending_order=!0;const r=y.cart.products.map(u=>({product_instance_id:u.product.id,quantity:u.quantity})),t=N.location.siteReservas.site_id,o=(l=m.user.payment_method_option)==null?void 0:l.id,n=y.cart.order_notes,c={user_name:m.user.name,user_phone:(g=m.user.phone_number)==null?void 0:g.split(" ").join(""),user_address:"Debe ir a la sede"};return{order_products:r,site_id:t,delivery_person_id:4,payment_method_id:o,delivery_price:0,order_notes:n||"SIN NOTAS",user_data:c,order_aditionals:[]}},Q={async sendOrder(){const r=J(),t=B();if(!W(r))return t.sending_order=!1,null;try{q.setLoading(!0,`enviando tu pedido ${m.user.name}`);const o=await z.post(`${F}/order`,r);if(o.status===200)t.sending_order=!1,t.last_order=o.data,q.setLoading(!1,"enviando tu pedido"),H.sendTrackingEvent("Purchase",{total:t.cart.total_cost,currency:"COP",items:t.cart.products.map(n=>({id:n.product.id,name:n.product.product_name,quantity:n.quantity,price:n.product.price})),value:t.cart.total_cost}),G.push("/call-center-vender/gracias");else return console.error("An error occurred while sending the order:",o.status),alert("An error occurred while sending the order. Please try again."),q.setLoading(!1,"enviando tu pedido"),t.sending_order=!1,null}catch(o){return console.error("An error occurred while sending the order:",o),q.setLoading(!1,"enviando tu pedido"),t.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),t.sending_order=!1,null}},preparar_orden(){J()},async sendOrderReserva(){const r=de(),t=B();if(m.user.was_reserva=!0,!W(r))return t.sending_order=!1,null;try{q.setLoading(!0,`enviando tu pedido ${m.user.name}`);const o=await z.post(`${F}/order`,r);if(o.status===200)t.sending_order=!1,t.last_order=o.data,q.setLoading(!1,"enviando tu pedido"),H.sendTrackingEvent("Purchase",{total:t.cart.total_cost,currency:"COP",items:t.cart.products.map(n=>({id:n.product.id,name:n.product.product_name,quantity:n.quantity,price:n.product.price})),value:t.cart.total_cost}),G.push("/call-center-vender/gracias");else return console.error("An error occurred while sending the order:",o.status),alert("An error occurred while sending the order. Please try again."),q.setLoading(!1,"enviando tu pedido"),t.sending_order=!1,null}catch(o){return console.error("An error occurred while sending the order:",o),q.setLoading(!1,"enviando tu pedido"),t.sending_order=!1,alert("An error occurred while sending the order. Please check your internet connection and try again."),t.sending_order=!1,null}}};function W(r){return!r.user_data.user_name||r.user_data.user_name.trim()==""||!r.user_data.user_phone||r.user_data.user_phone.trim()==""||!r.user_data.user_address||r.user_data.user_address.trim()==""?(alert("Sus datos estan incompletos por favor reviselos"),y.sending_order=!1,!1):!r.site_id||r.delivery_price==null?(alert("Site information is missing. Please select a valid site."),y.sending_order=!1,!1):!0}const P=r=>(ne("data-v-5e99a032"),r=r(),ae(),r),ce={class:"p-1 my-5 md:my-0 col-12"},le={style:{position:"sticky",top:"5rem","border-radius":"0.5rem","z-index":"1000"},class:"col-12 p-3 p-shadow m-0"},ue=P(()=>e("h5",null,[e("b",null,"Resumen")],-1)),_e=P(()=>e("h5",null,[e("b",null,"productos")],-1)),pe={class:"grid mb-0 pb-0"},he={class:"col-6 py-2 mb-0 m-0"},me={class:"m-0"},ge={style:{"min-width":"3rem",width:"100%1"}},ye={class:"m-0 ml-3",style:{width:"340px"}},fe={style:{"font-weight":"400"}},ve={class:"col-6 my-0 text-right py-2"},be={class:"col-12 p-0 mt-1"},we={class:"mb-0"},ke={class:"mb-1 text-center"},qe={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},Se={class:"text adicion",style:{"text-transform":""}},xe={key:0,class:"pl-2 text-sm"},Pe=P(()=>e("hr",{class:"p-0 mt-2"},null,-1)),Ce={class:"grid"},Le=P(()=>e("div",{class:"col-6 my-0 py-0"},[e("span",null,[e("b",null,"Subtotal")])],-1)),Ie={class:"col-6 my-0 text-right py-0"},Ne={class:"col-6 my-0 py-0"},Ae=P(()=>e("b",null,"Domicilio",-1)),Oe=[Ae],Te={class:"col-6 my-0 text-right py-0"},Re={key:0,style:{color:"var(--primary-color)"}},Be={key:1},Ee=P(()=>e("div",{class:"col-6 my-0 py-0"},[e("span",null,[e("b",null,"Total")])],-1)),je={class:"col-6 my-0 text-right py-0"},De={__name:"resumen",setup(r){const t=M(!1),o=te(),n=B(),c=K(),d=X(),l=M({}),g=()=>{l.value=n.cart.additions.reduce((u,b)=>{let f=b.group;return u[f]||(u[f]=[]),u[f].push(b),u},{})};return re(()=>{var u;g(),((u=d.user.payment_method_option)==null?void 0:u.id)!=7&&!o.path.includes("reservas")?c.setNeighborhoodPrice():c.setNeighborhoodPriceCero()}),oe(()=>n.cart.additions,()=>{g()},{deep:!0}),(u,b)=>{const f=E("Button"),w=E("router-link"),A=E("Tag");return i(),h("div",ce,[e("div",le,[ue,_e,(i(!0),h(O,null,T(s(n).cart.products,v=>(i(),h("div",pe,[e("div",he,[e("h6",me,[e("span",ge,[e("b",null,p(v.quantity),1)]),L(" "+p(v.product.productogeneral_descripcion),1)]),(i(!0),h(O,null,T(v.product.lista_productobase,k=>(i(),h("h6",ye,[L(" -- "),e("b",null,p(parseInt(k.productocombo_cantidad*v.quantity)),1),L(),e("span",fe,p(k.producto_descripcion),1)]))),256))]),e("div",ve,[e("h6",null,p(s(C)(v.total_cost)),1)])]))),256)),e("div",be,[(i(!0),h(O,null,T(l.value,(v,k)=>(i(),h("div",{class:"p-0 mb-2",key:k,style:{position:"relative","border-radius":"0.3rem"}},[e("div",we,[e("span",ke,[e("b",null,p(k),1)]),(i(!0),h(O,null,T(v,a=>(i(),h("div",{key:a.aditional_item_instance_id,style:{display:"flex",gap:"1rem","align-items":"center"}},[e("div",qe,[e("span",Se,[e("span",null,[e("b",null,p(a.quantity),1)]),L(" "+p(a.name),1)]),a.price>0?(i(),h("span",xe,[e("b",null,p(s(C)(a.price*a.quantity)),1)])):R("",!0)])]))),128))])]))),128))]),Pe,e("div",Ce,[Le,e("div",Ie,[e("span",null,[e("b",null,p(s(C)(s(n).cart.total_cost)),1)])]),e("div",Ne,[e("span",{style:se(s(c).location.neigborhood.delivery_price==0?"text-decoration: line-through;":"")},Oe,4)]),e("div",Te,[s(c).location.neigborhood.delivery_price==0?(i(),h("span",Re,[e("b",null,p(s(o).path.includes("reservas")?"Ir a la sede":"Recoger en local"),1)])):(i(),h("span",Be,[e("b",null,p(s(C)(s(c).location.neigborhood.delivery_price)),1)]))]),Ee,e("div",je,[e("span",null,[e("b",null,p(s(C)(s(n).cart.total_cost+s(c).location.neigborhood.delivery_price)),1)])])]),s(o).path.includes("cart")?(i(),S(w,{key:0,to:"/call-center-vender/cart"},{default:x(()=>[I(f,{outlined:"",icon:"pi pi-shopping-cart",label:"Seguir comprando",class:"mt-4",severity:"danger",style:{outline:"none",width:"100%","font-weight":"bold","background-color":"rgba(0, 0, 0, 0)"}})]),_:1})):s(o).path!="/reservas"?(i(),S(w,{key:1,to:"/cart"},{default:x(()=>[I(f,{outlined:"",icon:"pi pi-arrow-left",label:"Volver al carrito",class:"mt-4",severity:"danger",style:{outline:"none",width:"100%","font-weight":"bold","background-color":"rgba(0, 0, 0, 0)"}})]),_:1})):R("",!0),s(c).status=="cerrado"&&s(o).path!="/reservas"?(i(),S(A,{key:2,style:{width:"100%",height:"2.5rem"},class:"mt-2",severity:"danger"},{default:x(()=>[L(" Este Restaurante esta cerrado")]),_:1})):R("",!0),s(o).path.includes("cart")&&s(c).status!="cerrado"?(i(),S(w,{key:3,to:"/call-center-vender/pay"},{default:x(()=>[I(f,{iconPos:"right",icon:"pi pi-arrow-right",label:"Pedir",class:"mt-2",severity:"help",style:{outline:"none",width:"100%",border:"none","font-weight":"bold","background-color":"black"}})]),_:1})):s(o).path.includes("reservas")?(i(),S(w,{key:4,to:"/call-center-vender/pay"},{default:x(()=>[I(f,{onClick:b[0]||(b[0]=()=>{s(Q).sendOrderReserva(),t.value=!0}),iconPos:"right",icon:"pi pi-arrow-right",label:"Finalizar pedido",class:"mt-2",severity:"help",style:{outline:"none",width:"100%",border:"none","font-weight":"bold","background-color":"black"}})]),_:1})):s(c).status!="cerrado"?(i(),S(w,{key:5,to:"/call-center-vender/pay"},{default:x(()=>[I(f,{onClick:b[1]||(b[1]=()=>{s(Q).sendOrder(),t.value=!0}),iconPos:"right",icon:"pi pi-arrow-right",label:"Finalizar pedido",class:"mt-2",severity:"help",style:{outline:"none",width:"100%",border:"none","font-weight":"bold","background-color":"black"}})]),_:1})):R("",!0)])])}}},Me=ee(De,[["__scopeId","data-v-5e99a032"]]);export{Me as r};
