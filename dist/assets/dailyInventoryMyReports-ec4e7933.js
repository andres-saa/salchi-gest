import{_ as T,l as A,r as n,i as N,a as c,o as E,c as P,d as a,w as p,b as s,F as H,B as q,s as V,t as O,p as W,g as Y}from"./index-cb2baabe.js";import{s as z}from"./siteService-7f1f71e7.js";import{d as k}from"./dailyInventoryService-1e62f987.js";import{u as C,w as G}from"./xlsx-4f9172c7.js";import"./sass.default-b8072c4d.js";const b=D=>(W("data-v-05164398"),D=D(),Y(),D),J={class:"grid"},K={class:"col-12 px-0 mx-0"},L={class:"col-12",style:{display:"flex","flex-direction":"column"}},Q=b(()=>s("span",{class:"text-l",style:{"font-weight":"bold"}},"Desde ",-1)),X={class:"col-12",style:{display:"flex","flex-direction":"column"}},Z=b(()=>s("span",{style:{"font-weight":"bold"},class:"text-l"},"Hasta ",-1)),ee={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},te={class:"col-12",style:{display:"flex","justify-content":"center"}},ae={class:"m-auto",style:{"max-width":"1024px"}},le={class:"grid mx-0 mt-4"},se={class:"col-12 p-0",style:{display:"flex",gap:"1rem","justify-content":"center","align-items":"center"}},oe=b(()=>s("span",{class:"text-xl"},[s("b",null,"Periodo")],-1)),ne={class:"col-12 px-3",style:{display:"flex","justify-content":"end"}},ie={class:"mt-3 mx-auto",style:{"min-height":"20vh","max-width":"1024px",display:"flex","justify-content":"center","align-items":"center"}},de={class:"grid",style:{"align-items":"center"}},re=b(()=>s("div",{class:"col-12 md:col-6 p-3"},[s("span",{class:"text-xl",style:{width:"100%"}}," Mis reportes de inventario")],-1)),ce={class:"col-12 md:col-6 p-3"},pe={style:{display:"flex",gap:"0.5rem"}},ue={__name:"dailyInventoryMyReports",setup(D){const I=A(),R=n([]);n([]);const u=n(!1),v=n(new Date(new Date().setDate(new Date().getDate()-7))),r=n(new Date),m=n(new Date(new Date().setDate(new Date().getDate()-7))),_=n(new Date),f=n(),h=n(),F=(o,e)=>{m.value=o,_.value=e},x=o=>{const e=new Date,l=new Date(e);l.setDate(l.getDate()+1);const i=new Date(e);i.setDate(e.getDate()-o),v.value=i,o==1?(r.value=e,_.value=r.value,m.value=v.value,u.value=!1):(r.value=l,m.value=v.value,_.value=r.value,u.value=!1),S()};N(async()=>{R.value=await z.getSites();const o=I.rawUserData.id;f.value=await k.getAllMyDailyInventoryReports(o)}),(()=>{h.value={global:{value:null,matchMode:q.CONTAINS}}})();function g(o){const e=new Date(o),l=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),y=e.getDate().toString().padStart(2,"0");return`${l}-${i}-${y}`}const S=async()=>{const o=I.rawUserData.id,e=g(m.value),l=g(_.value);f.value=await k.getAllMyDailyInventoryReportsFiltered(o,e,l)},$=n([]),M=async(o,e,l)=>{$.value=await k.getDailyInventoryEntriesByDailyInventoryID(o);const i=$.value.map(d=>({Producto:d.item_name,Cantidad:d.quantity,"Unidad de medida":d.unit_measure})),y=C.json_to_sheet(i);y["!cols"]=[{wch:Math.max(20,8)},{wch:Math.max(0,8)},{wch:Math.max(0,16)}];const w=C.book_new();C.book_append_sheet(w,y,"Usuarios"),G(w,`Inventario_${e}_${l.split("-").reverse().join("-")} .xlsx`)},U=async()=>{f.value.forEach(e=>{M(e.daily_inventory_id,e.site_name,e.date)})};return(o,e)=>{const l=c("Button"),i=c("Calendar"),y=c("Dialog"),w=c("InputText"),d=c("Column"),j=c("router-link"),B=c("DataTable");return E(),P(H,null,[a(y,{class:"mx-2",visible:u.value,"onUpdate:visible":e[8]||(e[8]=t=>u.value=t),modal:"",header:"Periodo",style:{width:"25rem"}},{default:p(()=>[s("div",J,[s("div",K,[a(l,{text:"",label:"Hoy",onClick:e[0]||(e[0]=t=>x(0)),class:"p-button-text col-12 p-1 m-0"}),a(l,{text:"",label:"Ayer",onClick:e[1]||(e[1]=t=>x(1)),class:"p-button-text col-12 p-1 m-0"}),a(l,{text:"",label:"Últimos 7 días",onClick:e[2]||(e[2]=t=>x(7)),class:"p-button-text col-12 p-1 m-0"}),a(l,{text:"",label:"Últimos 14 días",onClick:e[3]||(e[3]=t=>x(14)),class:"p-button-text col-12 p-1"}),a(l,{text:"",label:"Últimos 28 días",onClick:e[4]||(e[4]=t=>x(28)),class:"p-button-text col-12 p-0"})]),s("div",L,[Q,a(i,{style:{"min-width":"max-content"},modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=t=>v.value=t)},null,8,["modelValue"])]),s("div",X,[Z,a(i,{style:{"min-width":"max-content"},modelValue:r.value,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value=t),showWeek:""},null,8,["modelValue"])]),s("div",ee,[s("div",te,[a(l,{onClick:e[7]||(e[7]=()=>{F(v.value,r.value),u.value=!1})},{default:p(()=>[V("Aplicar")]),_:1})])])])]),_:1},8,["visible"]),s("div",ae,[s("div",le,[s("div",se,[oe,a(w,{class:"",onClick:e[9]||(e[9]=t=>u.value=!0),style:{height:"2.7rem",width:"16rem"},value:`${g(m.value)}  |  ${g(_.value)}`,placeholder:"periodo"},null,8,["value"]),a(l,{onClick:S,icon:"pi pi-search",severity:"help",class:"text-center p-0 col-12 md:p-0",style:{height:"2.5rem",width:"min-content","aspect-ratio":"1 / 1","font-weight":"bold","border-radius":"50%",display:"flex","justify-content":"center"}})]),s("div",ne,[a(l,{severity:"help",icon:"pi pi-download",label:"Descargar todo",onClick:U})])])]),s("div",ie,[a(B,{stripedRows:"",style:{"max-width":"1024px"},filters:h.value,"onUpdate:filters":e[11]||(e[11]=t=>h.value=t),class:"col-12 m-auto",value:f.value,tableStyle:"min-width: 50rem;"},{header:p(()=>[s("div",de,[re,s("div",ce,[a(w,{style:{width:"100%"},class:"",modelValue:h.value.global.value,"onUpdate:modelValue":e[10]||(e[10]=t=>h.value.global.value=t),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:p(()=>[a(d,{class:"py-1",field:"daily_inventory_id",header:"ID"}),a(d,{class:"py-1",field:"employer_name",header:"Responsable"}),a(d,{class:"py-1",field:"site_name",header:"Sede"}),a(d,{class:"py-1",field:"date",header:"Fecha"},{body:p(t=>[V(O(t.data.date.split("-").reverse().join("-")),1)]),_:1}),a(d,{style:{"max-width":"5rem"},class:"py-1 px-0 m-0",field:"date",header:"Action"},{body:p(t=>[s("div",pe,[a(j,{to:`/daily-inventory/daily-inventory-view/${t.data.daily_inventory_id}`},{default:p(()=>[a(l,{style:{height:"2rem"},severity:"help",class:"p-1",icon:"pi pi-eye"})]),_:2},1032,["to"]),a(l,{onClick:ye=>M(t.data.daily_inventory_id,t.data.site_name,t.data.date),style:{height:"2rem",color:"white",background:"var(--primary-color)",border:"none"},class:"p-1",icon:"pi pi-download"},null,8,["onClick"])])]),_:1})]),_:1},8,["filters","value"])])],64)}}},De=T(ue,[["__scopeId","data-v-05164398"]]);export{De as default};
