import{f as n,h as I,r as g,o as a,c as i,I as M,n as U,a as t,d as l,w as c,F as _,b as R,U as f,k as u,t as p}from"./index-d8b3cdc0.js";import{_ as z}from"./Loading-c46e4c44.js";const F={key:1,class:"col-12",style:{display:"flex","flex-direction":"column","pointer-events":"none","align-items":"center","justify-content":"center",position:"fixed","z-index":"1000",left:"0",top:"0",height:"100%","background-color":"rgba(0, 0, 0, 0.5)"}},J=t("p",{class:"text-3xl",style:{"font-weight":"bold",color:"white","text-shadow":"0 0 10px rgba(0, 0, 0, 0.551)"}},"BUSCANDO CARGOS",-1),H={style:{display:"flex"}},L={style:{display:"flex"},class:"grid pt-6"},W={style:{display:"flex"},class:"col-12 p-0"},q={class:"col-12 p-1",style:{display:"flex",gap:"1rem"}},K=t("p",null," Nombre",-1),Q=t("p",null," Descripcion",-1),X=t("p",null,"Seleccionar Grupo(s)",-1),Y={class:"grid"},Z={class:"col-12 p-0 m-auto",style:{"max-width":"900px",display:"flex",gap:"1rem","align-items":"center"}},ee={class:"p-5",style:{display:"flex",gap:"1rem","align-items":"center"}},oe={class:"text-2xl p-0 m-0",style:{"font-weight":"bold","text-transform":"capitalize"}},te={class:"mx-5 my-0 p-5",style:{"border-radius":"0.5rem","background-color":"rgba(0, 0, 0, 0.061)",display:"1rem","align-items":"center"}},se=t("p",{class:"text-xl p-0 m-0",style:{"font-weight":"bold"}},"Description de las funciones del Grupo: ",-1),le={class:"text-xl p-0 m-0"},ae={class:"grid col-12 p-6"},re={class:"col-12 p-0 mb-6",style:{display:"flex",gap:"1rem","align-items":"center"}},ne=t("p",{style:{"font-weight":"bold"},class:"text-xl px-1 m-0"},"Cargos ",-1),ie={style:{display:"flex",gap:"0.5rem","align-items":"center"}},ce={class:"p-0 m-0",style:{"text-transform":"capitalize"}},me={__name:"gestionCargos",setup(de){const x=n(!1),V=n([]),D=n([]),w=n(!1),m=n(!1),b=n([]),O=n(null),C=n(["todos"]),T=n(!0),S=async()=>{try{const e=await(await fetch(f+"/rolegroups")).json();for(const d of e){const r=await(await fetch(`${f}/rolegroup/${d.id}/roles`)).json();d.roles=r}V.value=e,T.value=!1}catch(s){console.error(s)}},N=async()=>{try{const e=await(await fetch(f+"/roles")).json();D.value=e}catch(s){console.error(s)}},$=async()=>{m.value=!0;const s=`${f}/assign-roles-to-group-delete-olds/${O.value}`;try{if(!(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b.value)})).ok)throw new Error("Hubo un problema al asignar los roles al grupo");x.value=!1,m.value=!1,await S()}catch(e){console.error("Error al asignar roles al grupo:",e)}},v=n({}),j=async()=>{m.value=!0;const s=`${f}/role`;try{const e={title:v.value.title,description:v.value.description},d=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!d.ok)throw new Error("Hubo un problema al crear el nuevo cargo.");const{role_id:y}=await d.json();for(const r of C.value){const k=`${f}/assign-roles-to-group/${r}`;await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([y])})}m.value=!1,w.value=!1,await S(),await N(),C.value=["todos"]}catch(e){console.error("Error al crear y asignar el nuevo rol:",e),m.value=!1}},E=s=>{O.value=s.id,b.value=s.roles.map(e=>e.id),x.value=!0};return I(S),I(N),(s,e)=>{const d=g("ProgressSpinner"),y=g("Checkbox"),r=g("Button"),k=g("Dialog"),B=g("InputText"),P=g("Textarea");return a(),i(_,null,[m.value?(a(),M(z,{key:0,tittle:"MODIFICANDO GRUPO DE CARGOS"})):U("",!0),T.value?(a(),i("div",F,[J,t("div",H,[l(d,{style:{width:"100px",height:"100px"},strokeWidth:"4",fill:"var(--surface-ground)",animationDuration:".5s","aria-label":"Custom ProgressSpinner"})])])):U("",!0),l(k,{visible:x.value,"onUpdate:visible":e[1]||(e[1]=o=>x.value=o),modal:"",header:"Seleccion de Cargos para el grupo",style:{width:"50rem",height:"80vh"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{footer:c(()=>[l(r,{onClick:$},{default:c(()=>[u("Guardar cambios")]),_:1})]),default:c(()=>[t("div",L,[(a(!0),i(_,null,R(D.value,o=>(a(),i("div",W,[t("div",q,[l(y,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=h=>b.value=h),value:o.id},null,8,["modelValue","value"]),t("p",null,p(o.title),1)])]))),256))])]),_:1},8,["visible"]),l(k,{visible:w.value,"onUpdate:visible":e[5]||(e[5]=o=>w.value=o),modal:"",header:"Crear nuevo Cargo",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:c(()=>[K,l(B,{modelValue:v.value.title,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value.title=o),class:"col-12"},null,8,["modelValue"]),Q,l(P,{modelValue:v.value.description,"onUpdate:modelValue":e[3]||(e[3]=o=>v.value.description=o),class:"col-12",style:{"max-width":"100%","min-width":"100%",height:"20vh"}},null,8,["modelValue"]),X,t("div",Y,[(a(!0),i(_,null,R(V.value,o=>(a(),i("div",{class:"col-12 py-1",key:o.id},[l(y,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=h=>C.value=h),value:o.id},null,8,["modelValue","value"]),u(" "+p(o.group_name),1)]))),128))]),l(r,{onClick:j,class:"mt-4"},{default:c(()=>[u("Crear nuevo cargo")]),_:1})]),_:1},8,["visible"]),t("div",Z,[l(r,{severity:"success",style:{"font-weight":"bold"},onClick:e[6]||(e[6]=o=>w.value=!0)},{default:c(()=>[u("Crear nuevo cargo")]),_:1})]),t("div",null,[(a(!0),i(_,null,R(V.value,(o,h)=>(a(),i("div",{key:o.id,class:"my-6 m-auto",style:{"max-width":"900px","border-radius":"1rem","box-shadow":"0 0 20px rgba(0, 0, 0, 0.2)"}},[t("div",ee,[t("p",oe,p(h+1)+". Grupo "+p(o.group_name),1)]),t("div",te,[se,t("p",le,p(o.description),1)]),t("div",ae,[t("div",re,[ne,l(r,{severity:"warning",style:{"font-weight":"bold"},onClick:G=>E(o)},{default:c(()=>[u("Modificar")]),_:2},1032,["onClick"])]),(a(!0),i(_,null,R(o.roles,(G,A)=>(a(),i("div",{key:G.id,class:"col-12 md:col-6 p-1"},[t("div",ie,[t("p",ce,p(A+1)+". "+p(G.title),1),l(r,{text:"",style:{"font-weight":"bold"},class:"p-0 m-0"},{default:c(()=>[u("Editar")]),_:1}),l(r,{severity:"danger",text:"",style:{"font-weight":"bold"},class:"p-0 m-0"},{default:c(()=>[u("Eliminar")]),_:1})])]))),128))])]))),128))])],64)}}};export{me as default};
