import{h as v,U as y,_ as U,r as p,l as B,k as M,i as T,m as O,a as m,o as x,c as j,d as a,w as i,B as P,b as r,X as k,s as F,t as q,u as C,f as D,D as V,p as E,g as Q}from"./index-fdef0c85.js";const f={async getPendientsCancellationRequest(){try{const e=await v.get(`${y}/get_all_cancellation_request_pendients`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async getaceptedCancellationAcepted(){try{const e=await v.get(`${y}/get_all_cancellation_request_acepted`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async getPendientsCancellationRejected(){try{const e=await v.get(`${y}/get_all_cancellation_request_rejected`);return e.status===200?e.data:(console.error("An error occurred while fetching the ingredients:",e.status),null)}catch(e){return console.error("An error occurred while fetching the ingredients:",e),null}},async resolveCancellationRequest(e,d){try{const l=await v.put(`${y}/resolve-cancellation/${e}`,d);return l.status===200?l.data:(console.error("An error occurred while fetching the ingredients:",l.status),null)}catch(l){return console.error("An error occurred while fetching the ingredients:",l),null}}};const z=e=>(E("data-v-aa260ed3"),e=e(),Q(),e),X={class:"container"},G=z(()=>r("h3",null,[r("b",null,"Rechazar esta solicitud")],-1)),H=z(()=>r("h3",null,[r("b",null,"Aprobar esta solicitud")],-1)),J={class:"grid",style:{"align-items":"center"}},K={class:"col-12 md:col-6 p-3"},L={class:"text-xl",style:{width:"100%"}},W={style:{"text-transform":"capitalize"}},Y={style:{"min-width":"max-content"}},Z={style:{"min-width":"max-content"}},ee={style:{display:"flex",gap:"0.5rem"}},te={__name:"cancellationOrderRequestSesion",setup(e){const d=p(!1),l=p([]),h=p(!1),$=B(),n=p({}),g={revisar:f.getPendientsCancellationRequest,aprobadas:f.getaceptedCancellationAcepted,rechazadas:f.getPendientsCancellationRejected},S=(_,t)=>{n.value.id=t,_?h.value=!0:d.value=!0},R=async(_,t,w)=>{const u={authorized:_,responsible_id:$.rawUserData.id,responsible_observation:n.value.reason||"sin observaciones"};await f.resolveCancellationRequest(t,u),h.value=!1,d.value=!1,l.value=await g[c.params.request_status]()},c=M(),b=p();return(()=>{b.value={global:{value:null,matchMode:P.CONTAINS}}})(),T(async()=>{l.value=await g[c.params.request_status]()}),O(()=>c.params.request_status,async()=>{l.value=await g[c.params.request_status]()},{deep:!0}),(_,t)=>{const w=m("Textarea"),u=m("Button"),A=m("Dialog"),o=m("Column"),I=m("DataTable");return x(),j("div",X,[a(A,{visible:d.value,"onUpdate:visible":t[2]||(t[2]=s=>d.value=s),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:i(()=>[G]),default:i(()=>[r("form",{onSubmit:t[1]||(t[1]=k(s=>R(!1,n.value.id,n.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[a(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:n.value.reason,"onUpdate:modelValue":t[0]||(t[0]=s=>n.value.reason=s),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),a(u,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),a(A,{visible:h.value,"onUpdate:visible":t[5]||(t[5]=s=>h.value=s),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:i(()=>[H]),default:i(()=>[r("form",{onSubmit:t[4]||(t[4]=k(s=>R(!0,n.value.id,n.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[a(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:n.value.reason,"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.reason=s),rows:"5",placeholder:"Notas para el solicitante"},null,8,["modelValue"]),a(u,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),a(I,{stripedRows:"",style:{"max-width":"1024px"},filters:b.value,"onUpdate:filters":t[6]||(t[6]=s=>b.value=s),class:"col-12 m-auto",value:l.value,tableStyle:"min-width: 50rem;"},{header:i(()=>[r("div",J,[r("div",K,[r("span",L,[F(" Solicitudes de cancelacion - "),r("span",W,q(C(c).params.request_status.split("-").join(" ")),1)])])])]),default:i(()=>[a(o,{class:"py-1",field:"id",header:"ID"}),a(o,{class:"py-1",field:"site_name",header:"Sede"}),a(o,{class:"py-1",field:"site_name",header:"Fecha"},{body:i(s=>[r("p",Y,q(s.data.timestamp.split("T")[0].split("-").reverse().join("-")),1)]),_:1}),a(o,{style:{},class:"py-1",field:"order_id",header:"ID orden"},{body:i(s=>[r("p",Z,q(s.data.order_id),1)]),_:1}),a(o,{style:{"min-width":"30rem"},class:"py-1",field:"reason",header:"Motivo"}),a(o,{style:{"min-width":"10rem"},class:"py-1",field:"responsible",header:"Quien solicita?"}),a(o,{style:{"min-width":"20em"},class:"py-1",field:"user_name",header:"Nombre del cliente"}),a(o,{style:{"min-width":"10rem"},class:"py-1",field:"user_phone",header:"Cel. cliente"}),a(o,{style:{},class:"py-1 px-0",field:"date",header:"Action"},{body:i(s=>[r("div",ee,[C(c).params.request_status!="aprobadas"?(x(),D(u,{key:0,onClick:N=>S(!0,s.data.id),style:{height:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):V("",!0),C(c).params.request_status!="rechazadas"?(x(),D(u,{key:1,onClick:N=>S(!1,s.data.id),style:{height:"2rem",background:"var(--primary-color)",border:"none"},severity:"danger",class:"p-1",icon:"pi pi-times"},null,8,["onClick"])):V("",!0)])]),_:1})]),_:1},8,["filters","value"])])}}},re=U(te,[["__scopeId","data-v-aa260ed3"]]);export{re as default};
