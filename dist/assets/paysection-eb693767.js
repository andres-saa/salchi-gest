import{_ as ce,j as o,I as pe,y as F,k as I,m as me,U as ve,l as _e,z as ye,H as j,G as fe,A as be,av as f,C as ge,r as i,o as w,c as H,e as s,f as l,a as t,n as G,N as X,h as u,t as b,u as m,p as W,g as U,i as J,F as he,b as we,q as xe,x as Pe}from"./index-3fffce46.js";/* empty css                                                                  */import{D as Ce}from"./DialogoPedido-8a25abcc.js";import"./index-558f534d.js";import{e as Te}from"./formatDate-262296cf.js";import{f as Se}from"./formatoPesos-e824e30b.js";import"./formatoPesos-2293ab52.js";import"./_commonjsHelpers-23102255.js";const g=x=>(xe("data-v-87740f8d"),x=x(),Pe(),x),Ve={class:"container",style:{"margin-top":"7rem"}},ke=g(()=>t("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"6rem"}},[t("i",{class:"fa-solid fa-money-bill"}),u(" Pedidos de pasarela sin pagar o abandonados ")],-1)),De=g(()=>t("h3",null,[t("b",null,"Rechazar orden")],-1)),Re=g(()=>t("h3",null,[t("b",null,"Aprobar esta orden")],-1)),Ie={style:{"max-width":"1280px"},class:"mx-auto"},Ue={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},ze={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},Le={style:{display:"flex",gap:"2rem",padding:"0 2rem"}},Ae={class:"md:mt-0 p-input-icon-right m-3"},Me=g(()=>t("i",{class:"pi pi-search"},null,-1)),Oe=g(()=>t("template",null,null,-1)),qe={style:{display:"flex",gap:"0.5rem"}},Be={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"start",display:"flex",gap:"1rem"}},Ee={class:"px-2 m-0"},Ne=g(()=>t("i",{class:"fa-regular fa-bars-progress"},null,-1)),$e={style:{"text-transform":"uppercase"}},Fe={class:"m-0"},je={__name:"paysection",setup(x){const K=[33,35,36],Q=[1,2,3,7,8,9,10,11,29,30],Y=[32],c=o({usa:!0,colombia:!0,distri:!1}),z=o([]),Z=pe(()=>{const n=new Set([...c.value.usa?K:[],...c.value.colombia?Q:[],...c.value.distri?Y:[]]);return console.log(n),z.value.filter(a=>n.has(a.site_id))}),L=o([]);o([{columnName:"SEDE",columnValue:"sede",columnType:"other",size:"1rem",vif:!0},{columnName:"ASESOR",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);const v=o({start_date:new Date,end_date:new Date,sites:[]}),ee=o([]),S=F(),ae=n=>{S.setVisible("currentOrder",!0),S.setOrder(n)},te=async n=>{const a=M.rawUserData.id;await f.aproveOrder(n,a),P.value=!1,T()},se=o([]),V=o(!1);I(async()=>{L.value=await me.get(`${ve}/sites/`)});const k=o(!1),A=o([]),P=o(!1),M=_e(),_=o({});o([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]);const O=o({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),F(),o(null);const q={revisar:f.getPendientsCancellationRequest,aprobadas:f.getaceptedCancellationAcepted,rechazadas:f.getPendientsCancellationRejected};ye(()=>{B()}),j(()=>S.numberOders,()=>{T()});const oe=async(n,a,D)=>{const r={authorized:n,responsible_id:M.rawUserData.id,responsible_observation:_.value.reason||"sin observaciones"};await f.resolveCancellationRequest(a,r),P.value=!1,k.value=!1,A.value=await q.revisar()},C=fe(),y=o(),B=()=>{y.value={global:{value:null,matchMode:be.CONTAINS}}};B(),I(()=>{T()}),I(async()=>{T()});const T=async()=>{V.value=!0,z.value=await f.getOrdersPay(),V.value=!1};j(()=>C.params.request_status,async()=>{A.value=await q.revisar()},{deep:!0});const E=ge();async function le(n){const a=`https://salchimonster.com/pagar/${n.order_id}`;try{await navigator.clipboard.writeText(a),E.add({severity:"success",summary:"¡Copiado!",detail:"El enlace se copió al portapapeles",life:2500})}catch{const r=document.createElement("input");r.value=a,document.body.appendChild(r),r.select(),document.execCommand("copy"),r.remove(),E.add({severity:"info",summary:"Copiado con método alternativo",detail:"Tu navegador no soporta la API moderna de portapapeles",life:3e3})}}return(n,a)=>{const D=i("Textarea"),r=i("Button"),N=i("Dialog"),R=i("Checkbox"),ne=i("InputText"),re=i("ProgressSpinner"),d=i("Column"),$=i("DataTable"),ie=i("Calendar"),de=i("calendar"),ue=i("MultiSelect");return w(),H("div",Ve,[ke,s(N,{visible:k.value,"onUpdate:visible":a[2]||(a[2]=e=>k.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[De]),default:l(()=>[t("form",{onSubmit:a[1]||(a[1]=X(e=>oe(!1,_.value.id,_.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(D,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:_.value.reason,"onUpdate:modelValue":a[0]||(a[0]=e=>_.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),s(r,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),s(N,{visible:P.value,"onUpdate:visible":a[4]||(a[4]=e=>P.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:l(()=>[Re]),default:l(()=>[t("form",{onSubmit:a[3]||(a[3]=X(e=>te(_.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[s(r,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (usuario contactado)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),t("div",Ie,[t("div",Ue,[t("div",{style:G(`transform:translateX(${O.value.slide}%)`),class:"slider-item"},[s($,{loading:V.value,paginator:!0,rows:15,filters:y.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":a[9]||(a[9]=e=>y.value=e),class:"col-12 m-auto",value:Z.value,tableStyle:"min-width: 50rem;"},{header:l(()=>[t("div",ze,[t("div",Le,[t("div",null,[s(R,{modelValue:c.value.colombia,"onUpdate:modelValue":a[5]||(a[5]=e=>c.value.colombia=e),binary:!0},null,8,["modelValue"]),u(" Tiendas Colombia ")]),t("div",null,[s(R,{modelValue:c.value.usa,"onUpdate:modelValue":a[6]||(a[6]=e=>c.value.usa=e),binary:!0},null,8,["modelValue"]),u(" Tiendas Usa ")]),t("div",null,[s(R,{modelValue:c.value.distri,"onUpdate:modelValue":a[7]||(a[7]=e=>c.value.distri=e),binary:!0},null,8,["modelValue"]),u(" Distrimonster ")])]),t("span",Ae,[Me,s(ne,{class:"",modelValue:y.value.global.value,"onUpdate:modelValue":a[8]||(a[8]=e=>y.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),loading:l(()=>[s(re,{style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"transparent",animationDuration:".2s","aria-label":"Custom ProgressSpinner"})]),default:l(()=>[s(d,{style:{"min-width":"max-content"},class:"py-1",field:"order_id",header:"ID orden",frozen:""}),s(d,{style:{},class:"py-1",field:"total_order_price",header:"Monto de la orden"},{body:l(e=>[u(b(m(Se)(e.data.total_order_price)||"$ 0"),1)]),_:1}),s(d,{style:{},class:"py-1",field:"total_order_price",header:"Hora"},{body:l(e=>[u(b(m(Te)(e.data.latest_status_timestamp)),1)]),_:1}),s(d,{style:{},class:"py-1",field:"delivery_price",header:"Domicilio"},{body:l(e=>{var p,h;return[u(b(m(W)((h=(p=e.data.pe_json)==null?void 0:p.delivery)==null?void 0:h.delivery_costoenvio)),1)]}),_:1}),s(d,{style:{},class:"py-1",field:"Total",header:"Total"},{body:l(e=>{var p,h;return[u(b(m(W)(((h=(p=e.data.pe_json)==null?void 0:p.delivery)==null?void 0:h.delivery_costoenvio)+e.data.total_order_price)),1)]}),_:1}),s(d,{style:{},class:"py-1",field:"user_name",header:"Cliente"}),s(d,{style:{},class:"py-1",field:"user_phone",header:"Telefono cliente"}),s(d,{style:{"max-width":"10rem"},class:"py-1"},{default:l(()=>[Oe]),_:1}),s(d,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:l(e=>[t("div",qe,[m(C).params.request_status!="aprobadas"?(w(),U(r,{key:0,size:"",onClick:p=>ae(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):J("",!0),m(C).params.request_status!="aprobadas"?(w(),U(r,{key:1,size:"",onClick:p=>le(e.data),style:{height:"1.8rem","min-width":"max-content"},label:"Copiar link",severity:"help",class:"py-1",icon:"pi pi-copy"},null,8,["onClick"])):J("",!0)])]),_:1})]),_:1},8,["loading","filters","value"])],4),t("div",{style:G(`transform:translateX(${O.value.slide}%)`),class:"slider-item"},[s($,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:se.value,tableStyle:"min-width: 50rem;",filters:y.value},{header:l(()=>[t("div",Be,[t("h4",Ee,[Ne,u(),t("b",$e,[u("Pedidos pendientes "),t("b",null,b(m(C).params.section),1)])]),s(ie,{modelValue:v.value.start_date,"onUpdate:modelValue":a[10]||(a[10]=e=>v.value.start_date=e)},null,8,["modelValue"]),s(de,{modelValue:v.value.end_date,"onUpdate:modelValue":a[11]||(a[11]=e=>v.value.end_date=e)},null,8,["modelValue"]),s(ue,{style:{"max-width":"30rem"},modelValue:v.value.sites,"onUpdate:modelValue":a[12]||(a[12]=e=>v.value.sites=e),optionLabel:"site_name",options:L.value.filter(e=>e.show_on_web)},null,8,["modelValue","options"]),s(r,{severity:"help",onClick:n.update,label:"Buscar",icon:"pi pi-search"},null,8,["onClick"])])]),default:l(()=>[(w(!0),H(he,null,we(ee.value,e=>(w(),U(d,{class:"py-1",style:{"text-transform":"uppercase"},header:e},{body:l(p=>[t("h6",Fe,b(p.data[e]),1)]),_:2},1032,["header"]))),256))]),_:1},8,["value","filters"])],4)])]),s(Ce)])}}},Ze=ce(je,[["__scopeId","data-v-87740f8d"]]);export{Ze as default};
