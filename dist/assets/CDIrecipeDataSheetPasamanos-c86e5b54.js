import{r as u,v as ce,y as J,k as pe,E as Q,a as g,o as i,c,d as n,w as p,b as a,t as m,u as v,s as f,f as b,m as w,F as q,e as O,q as T,K as V,U as k,I as me,J as U,n as _e}from"./index-c5ed3781.js";import{f as W,a as ve}from"./formatoPesos-8aa989a0.js";const ye={style:{"max-width":"900px"},class:"m-auto px-3 my-8"},he={class:"m-0 my-3"},ge={key:0},fe={style:{display:"flex","justify-content":"end"}},be=a("h6",null," Ingrediente",-1),we=a("h6",null," Unidad de medida",-1),xe=a("h6",null," Cantidad",-1),Ve={style:{display:"flex","justify-content":"end"}},ke=a("h6",null," Unidad de medida",-1),Ue=a("h6",null," Cantidad",-1),Ce={style:{display:"flex","justify-content":"end"}},Ie={class:"text-center",style:{"margin-top":"3rem"}},Pe=a("i",{class:"fa-solid fa-bowl-rice mr-2"},null,-1),Te={style:{"text-transform":"uppercase"}},De={class:"grid mx-0 md:mx-0",style:{"margin-top":"3rem"}},Se={class:"col-12 lg:col-6 p-0 md:p-4 shadow-2",style:{"border-radius":".5rem","background-color":"white"}},$e=a("div",{class:"col-12 py-4 md:p-0 p-0"},[a("h4",{style:{},class:"px-0"},[a("b",null," Informacion Basica "),T(),a("h6",{class:"m-0",style:{color:"var(--primary-color)"}},"(Al tratar como ingrediente)")])],-1),Ee={class:"mx-0 p-0",style:{}},Me=a("h5",{style:{},class:"py-2 m-0"}," Nombre ",-1),qe=a("h5",{style:{},class:"py-2 m-0"}," Iva",-1),Ne=a("h5",{style:{},class:"py-2 m-0"}," Unidad de medida",-1),Ae=a("h5",{style:{},class:"py-2 m-0"}," Presentacion convertir a gramdos",-1),ze={class:"col-12 my-4 px-0",style:{display:"flex","justify-content":"end","flex-direction":"column","align-items":"end",gap:"1rem"}},Le={class:"col-12 lg:col-6 md:pl-6",style:{}},Re=a("div",{class:"col-12 p-0 lg:py-2"},[a("div",{class:"col-12 py-4 md:p-0 p-0"},[a("h4",{style:{},class:"px-0"},[a("b",null," Informacion Principal")])])],-1),Oe={class:"m-0 p-2",style:{"background-color":"var(--primary-color)",width:"100%",color:"white","font-weight":"bold"}},Be={key:0,class:"m-0 text-right p-2",style:{width:"100%"}},je={key:1,class:"m-0 text-right p-2",style:{width:"100%"}},Fe={style:{"margin-top":"3rem"}},Ke={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},Ge=a("h4",{class:"px-2"},[a("i",{class:"fa fa-carrot"}),T(),a("b",null,"Ingredientes para su preparacion")],-1),He={style:{display:"flex",width:"100%","justify-content":"end","flex-wrap":"wrap",gap:"1rem","align-items":"center"}},Je={style:{display:"flex","justify-content":"end",gap:".5rem"}},Qe={style:{border:"1px solid","border-radius":".3rem"},class:"p-3 mt-4"},We=a("h4",null,[a("b",null," Elaboracion ")],-1),Xe={style:{border:"1px solid","border-radius":".3rem"},class:"p-3 my-4"},Ye=a("h4",null,[a("b",null," Presentacion ")],-1),Ze={style:{border:"1px solid","border-radius":".3rem"},class:"p-3"},et=a("h4",null,[a("b",null," Equipo de preparacion ")],-1),nt={__name:"CDIrecipeDataSheetPasamanos",setup(tt){const D=u(!1),r=u({}),N=u({}),X=async()=>{const l={...r.value},t={ingredient_id:l.ingredient.id,cdi_recipe_data_sheet_id:d.value.recipe_data_sheet.id,unit_measure_id:l.unitMeasure.id,quantity:l.quantity};await V.post(`${k}/create-cdi-recipe-data-ingredient/`,t,"Agregando ingrediente"),P(),S.value=!1},B=ce(),S=u(!1),A=u({}),z=u(!1),o=u({id:1,name:"SALSA TUSSI SM",iva:19,purchase_price:15267.07,convert_value:1e3,unit_cost:15.267,pasamanos:null,unit_measure:"Kilogramos"}),L=u([{}]),C=u([]),x=u(!1),I=u(!1),Y=u([{label:"Costo con MP, Mano Obra y CIF",field:"labour_cost"},{label:"Cantidad total del bache en Kilogramos",field:"quantity_bache_total_cost",type:"number"},{label:"Costo total del bache",field:"bache_total_cost"},{label:"Costo total por kilo",field:"total_cost_per_kilo"},{label:"Precio de venta kilo con 15%",field:"cost_whit_percent_gain"},{label:"Precio de venta con margen error 5%",field:"purchasing_price_whit_error"},{label:"Precio de venta kilo con 19% IVA",field:"purchasing_price_whit_error_and_iva"}]),Z=l=>{I.value=!0,A.value=l},ee=()=>{r.value={},S.value=!0},te=J(()=>d.value.recipe.pasamanos&&d.value.ingredients.length<1||!d.value.recipe.pasamanos),ae=async()=>{const l=A.value.recipe_ingredient_id;await V.delete(`${k}/delete-cdi-recipe-data-ingredient/${l}`,"Borrando ingrediente"),I.value=!1,P()},le=l=>{r.value={};const t={...l};t.ingredient=L.value.find(_=>_.ingredient_name=l.ingredient_name),t.unitMeasure=C.value.find(_=>_.name=l.unit_measure),console.log(r.value),D.value=!0,r.value={...t}},ne=async()=>{const l={...r.value},t={ingredient_id:l.ingredient_id,cdi_recipe_data_sheet_id:d.value.recipe_data_sheet.id,unit_measure_id:l.unitMeasure.id,quantity:l.quantity};console.log(t),await V.put(`${k}/update-cdi-recipe-data-ingredient/${r.value.recipe_ingredient_id}`,t,"modificando ingrediente"),P(),D.value=!1},j=[{header:"Nombre",value:"ingredient_name",type:"max-content",width:""},{header:"Unidad de medida",value:"unit_measure",width:"10",type:"max-content"},{header:"Cantidad",value:"quantity",width:"number",type:"number"},{header:"Costo",value:"purchasing_price",width:"number",type:"money"},{header:"Costo total",value:"total_cost",width:"number",type:"money"}],ie=u([...j]);J(()=>{var l;return(l=ie.value)==null?void 0:l.map(t=>t.value)});const oe=u([{name:"Tamano de la porcion",fiel:"portion_size",type:"number"},{name:"Numero de porciones",fiel:"portion_number",type:"number"},{name:"Tiempo de preparacion",fiel:"preparation_time",type:"time"},{name:"Tiempo de coccion",fiel:"cooking_time",type:"time"},{name:"Temperatura de servicio",fiel:"service_temperature",type:"number"},{name:"Precio de venta",fiel:"selling_price",type:"money"},{name:"Impuestos",fiel:"taxes",type:"percent"},{name:"presentacion",fiel:"presentation",type:"textArea"},{name:"Equipo de preparacion",fiel:"preparation_equipment",type:"textArea"},{name:"Elaboracion",fiel:"elaboration",type:"textArea"}]);pe(o,async(l,t)=>{var _;o.value.purchasing_unit_measure_id=((_=l.purchasing_unit_measure)==null?void 0:_.id)||null},{deep:!0});const se=async l=>{const t={...l},_=y=>{if(typeof y=="string")return/^\d{2}:\d{2}:\d{2}$/.test(y)?y.slice(0,5):y;if(y instanceof Date&&!isNaN(y.getTime())){const R=y.getHours().toString().padStart(2,"0"),h=y.getMinutes().toString().padStart(2,"0");return`${R}:${h}`}else return console.error("El tiempo proporcionado no es una fecha vÃ¡lida"),""};t.preparation_time=_(t.preparation_time),t.cooking_time=_(t.cooking_time),console.log(t),await V.put(`${k}/update-recipe-data-sheet/${t.id}`,t,"Modificando receta"),z.value=!1,await P()},d=u({recipe_data_sheet:{id:53,labour_cost:921,bache_total_cost:null,quantity_bache_total_cost:null,total_cost_per_kilo:null,cost_whit_labour:null,cost_whit_percent_gain:null,purchasing_price_whit_error:null,purchasing_price_whit_error_and_iva:null},ingredients:[],recipe:{id:53,name:"salsa tussi",iva:19,purchase_price:null,convert_value:120,unit_cost:null,pasamanos:!0,unit_measure:"Kilogramos",unit_measure_id:4}}),P=async()=>{const l=B.params.product_id;d.value=await V.get(`${k}/list-cdi-recipe-by-recipe-id/${l}`,"cargando receta"),L.value=await V.get(`${k}/list-ingredients`,"cargando ingredientes"),C.value=await V.get(`${k}/daily_inventory_unit_measures`),o.value=d.value.recipe,N.value=C.value.filter(t=>t.id==o.value.unit_measure_id)[0]};Q(async()=>{await P()});const $=u(null),re=()=>{$.value={global:{value:null,matchMode:me.CONTAINS}}};return Q(()=>{re()}),(l,t)=>{var G;const _=g("inputText"),y=g("Textarea"),R=g("Calendar"),h=g("Button"),E=g("Dialog"),M=g("Dropdown"),F=g("InputText"),de=g("Tag"),K=g("column"),ue=g("DataTable");return i(),c("div",ye,[n(E,{style:{width:"40rem"},header:"Actualizar receta",class:"mx-2",visible:z.value,"onUpdate:visible":t[1]||(t[1]=e=>z.value=e),modal:""},{footer:p(()=>[n(h,{onClick:t[0]||(t[0]=e=>se(o.value)),severity:"danger",class:"mt-4",label:"Modificar Receta"})]),default:p(()=>[(i(!0),c(q,null,O(oe.value,e=>(i(),c("div",null,[a("h6",he,m(e.name),1),x.value?(i(),c(q,{key:1},[e.type=="text"?(i(),b(_,{key:0,modelValue:d.value[e.fiel],"onUpdate:modelValue":s=>d.value[e.fiel]=s,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):w("",!0)],64)):(i(),c("h6",ge,"algo")),e.type=="textArea"?(i(),b(y,{key:2,modelValue:o.value[e.fiel],"onUpdate:modelValue":s=>o.value[e.fiel]=s,rows:"6",style:{width:"100%","min-width":"100%",resize:"none"}},null,8,["modelValue","onUpdate:modelValue"])):w("",!0),e.type=="time"?(i(),b(R,{key:3,timeOnly:"",modelValue:o.value[e.fiel],"onUpdate:modelValue":s=>o.value[e.fiel]=s,rows:"6",style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):w("",!0),e.type=="money"?(i(),b(v(U),{key:4,modelValue:o.value[e.fiel],"onUpdate:modelValue":s=>o.value[e.fiel]=s,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",prefix:"$"},null,8,["modelValue","onUpdate:modelValue"])):w("",!0),e.type=="number"?(i(),b(v(U),{key:5,locale:"es-ES","max-fraction-digits":"3",modelValue:o.value[e.fiel],"onUpdate:modelValue":s=>o.value[e.fiel]=s,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):w("",!0),e.type=="percent"?(i(),b(v(U),{key:6,locale:"es-ES","max-fraction-digits":"3",modelValue:o.value[e.fiel],"onUpdate:modelValue":s=>o.value[e.fiel]=s,style:{width:"100%"},suffix:"%"},null,8,["modelValue","onUpdate:modelValue"])):w("",!0)]))),256))]),_:1},8,["visible"]),n(E,{class:"mx-2",header:"Eliminar ingrediente",visible:I.value,"onUpdate:visible":t[4]||(t[4]=e=>I.value=e),modal:""},{footer:p(()=>[a("div",fe,[n(h,{size:"small",label:"cancelar",onClick:t[2]||(t[2]=e=>I.value=!1),severity:"help"}),n(h,{size:"small",onClick:t[3]||(t[3]=e=>ae()),label:"Eliminar ingrediente",severity:"danger",text:""})])]),default:p(()=>{var e;return[a("h6",null,[T("seguro que desea eliminar el Ingrediente "),a("b",null,m((e=A.value)==null?void 0:e.ingredient_name),1),T(" ?")])]}),_:1},8,["visible"]),n(E,{style:{width:"30rem"},header:"Nuevo Ingrediente",class:"mx-2",visible:S.value,"onUpdate:visible":t[8]||(t[8]=e=>S.value=e),modal:""},{footer:p(()=>[a("div",Ve,[n(h,{class:"m-0",size:"small",label:"Agregar",onClick:X,severity:"help"})])]),default:p(()=>[be,n(M,{modelValue:r.value.ingredient,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value.ingredient=e),options:L.value,filter:"",optionLabel:"ingredient_name",style:{width:"100%"}},null,8,["modelValue","options"]),we,n(M,{modelValue:r.value.unitMeasure,"onUpdate:modelValue":t[6]||(t[6]=e=>r.value.unitMeasure=e),options:C.value,optionLabel:"name",style:{width:"100%"}},null,8,["modelValue","options"]),xe,n(v(U),{modelValue:r.value.quantity,"onUpdate:modelValue":t[7]||(t[7]=e=>r.value.quantity=e),locale:"es-ES","max-fraction-digits":"3",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["visible"]),n(E,{style:{width:"30rem"},header:"Editar Ingrediente",class:"mx-2",visible:D.value,"onUpdate:visible":t[11]||(t[11]=e=>D.value=e),modal:""},{footer:p(()=>[a("div",Ce,[n(h,{class:"m-0",size:"small",label:"Guardar",onClick:ne,severity:"help"})])]),default:p(()=>[ke,n(M,{modelValue:r.value.unitMeasure,"onUpdate:modelValue":t[9]||(t[9]=e=>r.value.unitMeasure=e),options:C.value,optionLabel:"name",style:{width:"100%"}},null,8,["modelValue","options"]),Ue,n(v(U),{modelValue:r.value.quantity,"onUpdate:modelValue":t[10]||(t[10]=e=>r.value.quantity=e),locale:"es-ES","max-fraction-digits":"3",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["visible"]),a("h2",Ie,[Pe,a("b",Te," Pasamanos - "+m((G=v(B).params)==null?void 0:G.recipe_name),1)]),a("div",De,[a("div",Se,[$e,a("div",Ee,[Me,n(F,{style:f([x.value?"oulined:1px solid var(--primary-color)":"",{width:"100%"}]),readOnly:"",modelValue:o.value.name,"onUpdate:modelValue":t[12]||(t[12]=e=>o.value.name=e),placeholder:"Escriba el nombre de la receta"},null,8,["style","modelValue"])]),qe,n(v(U),{suffix:"%",style:f([x.value?"oulined:1px solid var(--primary-color)":"",{width:"100%"}]),readOnly:"",modelValue:o.value.iva,"onUpdate:modelValue":t[13]||(t[13]=e=>o.value.iva=e),placeholder:"Escriba el nombre de la receta"},null,8,["style","modelValue"]),Ne,n(M,{options:C.value,optionLabel:"name",style:f([x.value?"oulined:1px solid var(--primary-color)":"",{width:"100%"}]),disabled:!0,readidOnly:!x.value,modelValue:N.value,"onUpdate:modelValue":t[14]||(t[14]=e=>N.value=e),placeholder:"Escriba el nombre de la receta"},null,8,["options","style","readidOnly","modelValue"]),Ae,n(v(U),{style:f([x.value?"oulined:1px solid var(--primary-color)":"",{width:"100%"}]),readOnly:l.readOnly,modelValue:o.value.convert_value,"onUpdate:modelValue":t[15]||(t[15]=e=>o.value.convert_value=e),placeholder:"Escriba el nombre de la receta"},null,8,["style","readOnly","modelValue"]),a("div",ze,[x.value?(i(),b(de,{key:0,class:"m-0 tag"},{default:p(()=>[T("Editando...")]),_:1})):w("",!0)])]),a("div",Le,[Re,(i(!0),c(q,null,O(Y.value,e=>(i(),c("div",{class:_e([e.separe?"mt-4 ":"","justify-content-start"]),style:{display:"flex","background-color":"white",gap:"1rem",border:"1px solid black","align-items":"center","justify-content":"space-between"}},[a("h6",Oe,m(e.label),1),e.type=="number"?(i(),c("h6",Be,m(d.value.recipe_data_sheet[e.field]),1)):(i(),c("h6",je,m(v(W)(d.value.recipe_data_sheet[e.field])),1))],2))),256))])]),a("div",Fe,[n(ue,{direction:"vertical",paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} recetas",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto p-0",value:d.value.ingredients,tableStyle:"min-width: 50rem;",filters:$.value},{header:p(()=>[a("div",Ke,[Ge,n(F,{class:"",modelValue:$.value.global.value,"onUpdate:modelValue":t[16]||(t[16]=e=>$.value.global.value=e),placeholder:"Buscar ingrediente ..."},null,8,["modelValue"])]),a("div",He,[te.value?(i(),b(h,{key:0,size:"small",severity:"help",onClick:ee,label:d.value.recipe.pasamanos?"Asignar pasamanos":"Nuevo ingrediente"},null,8,["label"])):w("",!0)])]),default:p(()=>[(i(),c(q,null,O(j,e=>n(K,{header:e.header,style:f(`min-width:${e.width}rem`),field:e.value,class:"py-2"},{body:p(s=>{var H;return[e.type=="money"?(i(),c("h6",{key:0,style:f([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},m(v(W)(s.data[e.value])||"-----------"),5)):e.type=="calc_percent"?(i(),c("h6",{key:1,style:f([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},m(`${(H=(s.data[e.value]/d.value.recipe_data_sheet.recipe_total*100).toFixed(2))==null?void 0:H.replace(".",",")}%`||"-----------"),5)):e.type=="number"?(i(),c("h6",{key:2,style:f([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},m(v(ve)(s.data[e.value])||"-----------"),5)):(i(),c("h6",{key:3,style:f([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},m(s.data[e.value]||"-----------"),5))]}),_:2},1032,["header","style","field"])),64)),n(K,{header:"Accion",style:{width:"min-content"},field:"name",class:"py-1",frozen:"",alignFrozen:"right"},{body:p(e=>[a("div",Je,[n(h,{text:"",onClick:s=>le(e.data),class:"m-0 p-0",severity:"warning",style:{height:"2rem",width:"2rem"},icon:"pi pi-pencil"},null,8,["onClick"]),n(h,{text:"",onClick:s=>Z(e.data),class:"m-0 p-0",severity:"danger",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash"},null,8,["onClick"])])]),_:1})]),_:1},8,["value","filters"]),a("div",Qe,[We,a("h6",null,m(d.value.recipe_data_sheet.elaboration),1)]),a("div",Xe,[Ye,a("h6",null,m(d.value.recipe_data_sheet.presentation),1)]),a("div",Ze,[et,a("h6",null,m(d.value.recipe_data_sheet.preparation_equipment),1)])])])}}};export{nt as default};
