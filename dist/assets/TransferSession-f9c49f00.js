import{_ as J,X as q,g as n,l as K,q as Q,D as M,C as W,s as Y,h as B,ad as u,d,o as D,c as Z,e as t,f as o,a as s,m as c,n as A,a0 as O,t as w,u as m,E as k,x as I,j as U,p as ee,k as se}from"./index-eb2a5b3d.js";import{D as ae}from"./OrderItem.vue_vue_type_style_index_0_scoped_bbba8067_lang-73c1213e.js";import"./index-558f534d.js";import{e as te}from"./formatDate-262296cf.js";import"./formatoPesos-8aa989a0.js";import"./_commonjsHelpers-23102255.js";const v=y=>(ee("data-v-401e9ad7"),y=y(),se(),y),oe={class:"container",style:{"margin-top":"7rem"}},le=v(()=>s("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"6rem"}},[s("i",{class:"fa-solid fa-truck-arrow-right"}),c(" Transferencias ")],-1)),re=v(()=>s("h3",null,[s("b",null,"Rechazar orden")],-1)),ne=v(()=>s("h3",null,[s("b",null,"Aprobar esta orden")],-1)),ie={style:{"max-width":"1280px"},class:"mx-auto"},de={style:{display:"flex","align-items":"center",gap:"1rem"}},ce=v(()=>s("h3",{style:{width:"min-content",padding:"0"}},[s("b",null,"Modos")],-1)),pe={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},ue={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},me=v(()=>s("div",{class:"col-12 md:col-6 p-3"},[s("span",{class:"text-xl",style:{width:"100%"}},[c(" Transferencias pendientes "),s("span",{style:{"text-transform":"capitalize"}})])],-1)),ve={class:"md:mt-0 p-input-icon-right m-3"},_e=v(()=>s("i",{class:"pi pi-search"},null,-1)),fe={style:{display:"flex",gap:"0.5rem"}},ye={__name:"TransferSession",setup(y){const x=q(),L=l=>{x.setVisible("currentOrder",!0),x.setOrder(l)},N=async l=>{const a=P.rawUserData.id;await u.authorizeOrder(l,a),_.value=!1,g()},T=n(!1),h=n([]),_=n(!1),P=K(),i=n({}),$=n([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]),b=n({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),q(),n(null);const S={revisar:u.getPendientsCancellationRequest,aprobadas:u.getaceptedCancellationAcepted,rechazadas:u.getPendientsCancellationRejected};Q(()=>{V()}),M(()=>x.numberTransferRequests,()=>{g()});const E=l=>{_.value=!0,i.value.order_id=l},F=async(l,a,z)=>{const p={authorized:l,responsible_id:P.rawUserData.id,responsible_observation:i.value.reason||"sin observaciones"};await u.resolveCancellationRequest(a,p),_.value=!1,T.value=!1,h.value=await S.revisar()},C=W(),f=n(),V=()=>{f.value={global:{value:null,matchMode:Y.CONTAINS}}};V(),B(()=>{g()}),B(async()=>{g()});const g=async()=>{h.value=await u.getOrdersTransfer()};return M(()=>C.params.request_status,async()=>{h.value=await S.revisar()},{deep:!0}),(l,a)=>{const z=d("Textarea"),p=d("Button"),R=d("Dialog"),j=d("Dropdown"),H=d("InputText"),r=d("Column"),X=d("DataTable");return D(),Z("div",oe,[le,t(R,{visible:T.value,"onUpdate:visible":a[2]||(a[2]=e=>T.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[re]),default:o(()=>[s("form",{onSubmit:a[1]||(a[1]=O(e=>F(!1,i.value.id,i.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[t(z,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:i.value.reason,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value.reason=e),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),t(p,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),t(R,{visible:_.value,"onUpdate:visible":a[4]||(a[4]=e=>_.value=e),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:o(()=>[ne]),default:o(()=>[s("form",{onSubmit:a[3]||(a[3]=O(e=>N(i.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[t(p,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (Transferencia confirmada)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),s("div",ie,[s("div",de,[ce,c(),t(j,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=e=>b.value=e),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])]),s("div",pe,[s("div",{style:A(`transform:translateX(${b.value.slide}%)`),class:"slider-item"},[t(X,{paginator:!0,rows:15,filters:f.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":a[7]||(a[7]=e=>f.value=e),class:"col-12 m-auto",value:h.value,tableStyle:"min-width: 50rem;"},{header:o(()=>[s("div",ue,[me,s("span",ve,[_e,t(H,{class:"",modelValue:f.value.global.value,"onUpdate:modelValue":a[6]||(a[6]=e=>f.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:o(()=>[t(r,{style:{},class:"py-1 pl-0",field:"order_id",header:"ID orden",frozen:""}),t(r,{style:{},class:"py-1 pl-0",field:"total_order_price",header:"Monto de la orden"},{body:o(e=>[c(w(m(k)(e.data.total_order_price)),1)]),_:1}),t(r,{style:{},class:"py-1 pl-0",field:"total_order_price",header:"Hora"},{body:o(e=>[c(w(m(te)(e.data.latest_status_timestamp)),1)]),_:1}),t(r,{style:{},class:"py-1 pl-0",field:"delivery_price",header:"Domicilio"},{body:o(e=>[c(w(m(k)(e.data.delivery_price)),1)]),_:1}),t(r,{style:{},class:"py-1 pl-0",field:"Total",header:"Total"},{body:o(e=>[c(w(m(k)(e.data.delivery_price+e.data.total_order_price)),1)]),_:1}),t(r,{style:{},class:"py-1 pl-0",field:"user_name",header:"Cliente"}),t(r,{style:{},class:"py-1 pl-0",field:"user_phone",header:"Telefono cliente"}),t(r,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:o(e=>[s("div",fe,[m(C).params.request_status!="aprobadas"?(D(),I(p,{key:0,size:"",onClick:G=>L(e.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):U("",!0),m(C).params.request_status!="aprobadas"?(D(),I(p,{key:1,size:"",onClick:G=>E(e.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):U("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),s("div",{style:A(`transform:translateX(${b.value.slide}%)`),class:"slider-item"},"1",4)])]),t(ae)])}}},Ce=J(ye,[["__scopeId","data-v-401e9ad7"]]);export{Ce as default};
