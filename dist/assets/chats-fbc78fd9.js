import{H as xe,h,i as se,I as oe,j as D,J as R,D as ue,g as N,o as d,c as E,a as e,n as l,u as n,F as le,r as ce,d as j,e as m,t as b,f as p,k as W,b as pe,p as we,m as ke,_ as me,C as Te,l as Le,G as De,U as Ue,q as de,K as Ne,L as je}from"./index-2fc8df2c.js";import{c as fe,u as $e,P as Re}from"./Messages.vue_vue_type_style_index_0_scoped_09e7a26a_lang-6ab58006.js";/* empty css                                                             */import Oe from"./Messages-7ddadbfa.js";const Se=O=>(we("data-v-f13ee285"),O=O(),ke(),O),Ae={class:"sidebar-container",style:{position:"relative"}},Ie={class:"header"},ze=Se(()=>e("strong",null," Notificaciones ",-1)),Me=[ze],Ve=["onClick"],Fe={class:"avatar",style:{"grid-area":"imagen",height:"100%",width:"100%",display:"flex","align-items":"center"}},Pe={class:"flex align-items-center"},Be=["src"],We={class:"flex align-items-center"},Je=["src"],Ke={style:{display:"flex",gap:"1rem"}},qe={style:{position:"relative"}},Ge={style:{height:"1.5rem",width:"1.5rem","border-radius":"50%","background-color":"rgb(156,39,176)",position:"absolute",top:"-1rem",right:"-.7rem",display:"flex","align-items":"center","justify-content":"center","font-weight":"bold"}},He={style:{color:"white"}},Xe={class:"statuses"},Ye=["onClick"],Ze={class:"avatar",style:{"grid-area":"imagen",height:"100%",width:"100%",display:"flex","align-items":"center"}},Qe={style:{"grid-area":"check",display:"flex","justify-content":"end",gap:".5rem"}},et={key:0,style:{height:"1.5rem",width:"1.5rem","border-radius":"50%","background-color":"rgb(156,39,176)",display:"flex","align-items":"center","justify-content":"center","font-weight":"bold"}},tt={style:{color:"white"}},at=Se(()=>e("i",{style:{color:"greenyellow"},class:"fa-solid fa-check-double"},null,-1)),st={key:0,style:{bottom:"0","padding-bottom":"1rem",background:"linear-gradient(to bottom , transparent 3%, black)",display:"flex",position:"absolute","z-index":"100",width:"100%",color:"white"}},ot={key:1,style:{"text-align":"center",padding:".5rem",color:"#ffffff80"}},ye=1e3,it=xe({__name:"Sidebar",props:{restaurant:Object},setup(O){const f=h(!1),Z=s=>{s.target.closest(".notifications")||(f.value=!1)};se(()=>{document.addEventListener("click",Z)}),oe(()=>{document.removeEventListener("click",Z)});const v=fe(),re=O,y=$e(),Q=[{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"},{id:7,name:"Distrimoster",img:"https://backend.salchimonster.com/read-photo-product/iX6UiE6e"}],c=h(re.restaurant||Q[0]);h([{label:"Todos",textColor:"#4CAF50"},{label:"Sin leer",textColor:"#2196F3"},{label:"Favoritos",textColor:"#FFC107"},{label:"Preocupantes",textColor:"#F44336"},{label:"Top",textColor:"#9C27B0"}]);const _=async s=>{y.current_user=s,f.value=!1;try{await D.post(`${R}/read-message/${s.user_id}/${c.value.id}`,!1)}catch(r){console.error("No se pudo marcar como leído",r)}s.unreaded=0},G=async s=>{y.current_user=s.user_info,f.value=!1;try{await D.post(`${R}/read-message/${s.user_info.user_id}/${c.value.id}`,!1),await D.post(`${R}/view_notification/${s.id}`,!1),y.notifications[c.value.id]=await D.get(`${R}/notifications/${c.value.id}`)}catch(r){console.error("No se pudo marcar como leído",r)}s.unreaded=0},J=h([{label:"TODO",bg:"#8e44ad",icon:"fa-star"},{label:"SIN DATOS",bg:"#7f8c8d",icon:"fa-circle-question"},{label:"PREOCUPANTE",bg:"#e74c3c",icon:"fa-triangle-exclamation"},{label:"CASUAL",bg:"#e67e22",icon:"fa-person-walking"},{label:"FRECUENTE",bg:"#27ae60",icon:"fa-repeat"},{label:"TOP",bg:"#2980b9",icon:"fa-ranking-star"},{label:"ESTRELLA",bg:"#8e44ad",icon:"fa-star"}]),C=h({label:"TODO",bg:"#8e44ad",icon:"fa-star"}),P=h(0);let $=0;const z=h(!1),B=h(!1),M=h(null),ie=s=>{var u;if(!s)return"";const r=s.split(" ");return(r[0][0]||"")+(((u=r[1])==null?void 0:u[0])||"")};se(async()=>{y.notifications[c.value.id]=await D.get(`${R}/notifications/${c.value.id}`)});const H=s=>s==="9+"?10:Number(s??0),T=(s,r)=>{const u=y.sidebars[s]||[];r.forEach(S=>{const x=u.findIndex(t=>t.wa_id===S.wa_id);if(x===-1)u.push(S);else{const t=u[x],o=t.ultimo_mensaje_id!==S.ultimo_mensaje_id,i=H(S.unreaded)<H(t.unreaded);(o||i)&&(u[x]=S)}}),y.sidebars[s]=u,P.value=u.reduce((S,x)=>S+H(x.unreaded),0)},ee=async()=>{if(z.value||B.value)return;z.value=!0;const s=`${R}/last-contact-messages/${c.value.id}?limit=${ye}&offset=${$}`,r=await D.get(s,!1);r.length<ye&&(B.value=!0),$+=r.length,T(c.value.id,r),z.value=!1},te=()=>{const s=M.value;if(!s||z.value||B.value)return;s.scrollTop+s.clientHeight>=s.scrollHeight-120&&ee()},V=s=>{const r=c.value.id,u=y.sidebars[r]||[],S=u.findIndex(x=>x.wa_id===s.wa_id);S!==-1?(u.splice(S,1),y.sidebars[r]=[s,...u]):y.sidebars[r]=[s,...u],P.value=y.sidebars[r].reduce((x,t)=>x+Number(t.unreaded||0),0)};let L=null;const A=()=>{const s=`wss://sockets-service.salchimonster.com/ws/salchimonster-${c.value.id}`;L=new WebSocket(s),L.onopen=()=>console.log("WebSocket conectado a",s),L.onerror=r=>console.error("WebSocket error",r),L.onclose=()=>setTimeout(A,5e3),L.onmessage=async r=>{const u=JSON.parse(r.data);u!=null&&u.user_id&&V(u)}};let K=null;const X=()=>{const s=`wss://sockets-service.salchimonster.com/ws/salchimonster-notifications-${c.value.id}`;K=new WebSocket(s),K.onopen=()=>console.log("WebSocket conectado a",s),K.onerror=r=>console.error("WebSocket error",r),K.onclose=()=>setTimeout(X,5e3),K.onmessage=async r=>{y.notifications[c.value.id]=await D.get(`${R}/notifications/${c.value.id}`)}};ue(c,async s=>{$=0,B.value=!1,y.sidebars[s.id]=[],L&&L.close(),A(),X(),await ee(),q.value=!1,setTimeout(()=>{q.value=!0},0)}),se(async()=>{var s;await ee(),(s=M.value)==null||s.addEventListener("scroll",te),A(),X()}),oe(()=>{var s;(s=M.value)==null||s.removeEventListener("scroll",te),L&&L.close()});const q=h(!0),ae=s=>{C.value=s,q.value=!1,setTimeout(()=>{q.value=!0},0)};return(s,r)=>{var o,i,g,U,w,I;const u=N("RouterLink"),S=N("Dropdown"),x=N("Button"),t=N("ProgressSpinner");return d(),E("div",Ae,[e("div",Ie,[e("div",{class:"notifications",style:l([f.value?{height:"80vh",top:"4rem",boxShadow:"0 1rem 1rem #00000040"}:{height:0,overflow:"hidden",top:"-2rem"},{width:"100%","max-width":"20rem","background-color":"#ffffff90","max-height":"80vh",overflow:"auto",padding:"1rem",position:"absolute","z-index":"9",transition:"all linear .2s","border-radius":".5rem",right:"0","backdrop-filter":"blur(5px)",display:"flex","flex-direction":"column",gap:".3rem"}])},[e("h4",{class:"my-3",style:l(n(v).current_chat_theme.text)},Me,4),(d(!0),E(le,null,ce((i=(o=n(y))==null?void 0:o.notifications)==null?void 0:i[c.value.id],(a,F)=>(d(),j(u,{"active-class":n(v).current_chat_theme.name==="dark"?"active":"active-light",key:F,to:`/chat/chats/messages/${c.value.id}/${a.user_info.wa_id}/${(a.user_info.nombre||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^A-Za-z0-9_-]/g,"")||"n"}/${a.user_info.color}?expirado=${a.user_info.expirado}&expira-en=${a.user_info.tiempo_para_expirar}`},{default:m(()=>[e("div",{class:"chat2",onClick:()=>G(a),style:l(a.resolved?"background-color: #fff":"background-color: #b6f8ff59")},[e("div",Fe,[e("div",{style:l([{height:"3rem",width:"3rem","aspect-ratio":"1/1","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase","font-size":"1.3rem"},`background-color:${a.color||"black"}`])},b(ie(a.user_info.nombre)),5)]),e("div",{style:l([{"grid-area":"nombre"},`${n(v).current_chat_theme.text} ; ${a.resolved?"":"font-weight: bold;"}`])},b(a.description),5),e("span",{style:l([{"grid-area":"mensaje",color:"#ffffff80",opacity:".5"},n(v).current_chat_theme.text])},b(a.user_info.nombre),5)],12,Ve)]),_:2},1032,["active-class","to"]))),128))],4),p(S,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=a=>c.value=a),options:Q,optionLabel:"name",style:l([{"background-color":"#ffffff20",outline:"none","box-shadow":"none"},n(v).current_chat_theme.border])},{option:m(a=>[e("div",Pe,[e("img",{src:a.option.img,alt:"Logo",style:{width:"24px",height:"24px","margin-right":"8px","object-fit":"contain"}},null,8,Be),e("span",null,[e("b",null,b(a.option.name),1)])])]),value:m(a=>[e("div",We,[a.value?(d(),E("img",{key:0,src:a.value.img,alt:"Logo",style:{width:"24px",height:"24px","margin-right":"8px","object-fit":"contain"}},null,8,Je)):W("",!0),e("span",{style:l(n(v).current_chat_theme.text)},b(a.value?a.value.name:"Selecciona"),5)])]),_:1},8,["modelValue","style"]),e("div",Ke,[p(x,{class:"options",text:""},{default:m(()=>[e("i",{class:"pi pi-search text-2xl",style:l(n(v).current_chat_theme.text)},null,4)]),_:1}),e("div",qe,[p(x,{class:"options",text:"",style:{opacity:".5"}},{default:m(()=>[e("i",{class:"pi pi-bell text-2xl notifications",onClick:r[1]||(r[1]=a=>f.value=!f.value),style:l(n(v).current_chat_theme.text)},null,4)]),_:1}),e("div",Ge,[e("span",He,b(((w=(U=(g=n(y))==null?void 0:g.notifications)==null?void 0:U[c.value.id])==null?void 0:w.length)||0),1)])]),p(x,{class:"options",text:""},{default:m(()=>[e("i",{class:"pi pi-bars text-2xl",style:l(n(v).current_chat_theme.text)},null,4)]),_:1})])]),e("div",Xe,[(d(!0),E(le,null,ce(J.value,(a,F)=>(d(),j(x,{style:l([{"border-radius":".3rem",padding:"0.3rem"},a.label===C.value.label?{backgroundColor:a.bg,color:"#fff"}:{backgroundColor:"#ffffff20",color:a.bg}]),text:"",key:F,onClick:()=>ae(a),class:"status",label:a.label},null,8,["onClick","label","style"]))),128))]),e("div",{class:pe(["",q.value?"chats active-new":"chats"]),ref_key:"chatsContainer",ref:M,onScroll:te},[(d(!0),E(le,null,ce(((I=n(y).sidebars[c.value.id])==null?void 0:I.filter(a=>a.clasification==C.value.label||C.value.label=="TODO"))||[],(a,F)=>(d(),j(u,{"active-class":n(v).current_chat_theme.name=="dark"?"active":"active-light",key:F,to:`/chat/chats/messages/${c.value.id}/${a.wa_id}/${a.nombre}/${a.color}?expirado=${a.expirado}&?expira-en?=${a.tiempo_para_expirar}`},{default:m(()=>[e("div",{class:"chat",onClick:()=>_(a)},[e("div",Ze,[e("div",{style:l([{height:"3rem",width:"3rem","aspect-ratio":"1/1","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase","font-size":"1.3rem"},`background-color:${a.color||"black"}`])},b(ie(a.nombre)),5)]),e("div",{style:l([{"grid-area":"nombre","text-transform":"capitalize"},n(v).current_chat_theme.text])},b(a.nombre),5),a.tiempo_para_expirar||!a.expirado?(d(),E("div",{key:0,style:l([{"grid-area":"expiration","text-align":"end","text-transform":"capitalize",opacity:".5"},n(v).current_chat_theme.text])}," Expira en "+b(a.tiempo_para_expirar),5)):(d(),E("div",{key:1,style:l([{"grid-area":"expiration","text-align":"end","text-transform":"capitalize",opacity:".5"},n(v).current_chat_theme.text])}," Expirado ",4)),e("span",{style:l([{"grid-area":"mensaje",color:"#ffffff80",opacity:".5"},n(v).current_chat_theme.text])},b(a.mensaje_truncado),5),e("span",{style:l([{"grid-area":"fecha","text-align":"end"},n(v).current_chat_theme.text])},b(a.abreviatura||a.fecha_ultimo_mensaje),5),e("div",Qe,[a.unreaded>0?(d(),E("div",et,[e("span",tt,b(a.unreaded),1)])):W("",!0),at])],8,Ye)]),_:2},1032,["active-class","to"]))),128)),z.value?(d(),E("div",st,[(d(),j(t,{key:0,style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"transparent",animationDuration:".3s","aria-label":"Custom ProgressSpinner"}))])):W("",!0),B.value?(d(),E("div",ot,"No hay más chats.")):W("",!0)],34)])}}}),be=me(it,[["__scopeId","data-v-f13ee285"]]),Ee=O=>(we("data-v-5ca3d81f"),O=O(),ke(),O),nt={class:"top-bar-left"},rt={style:{height:"3rem",width:"3rem",display:"flex","align-items":"center"}},lt={class:"top-bar-info"},ct={style:{display:"flex","align-items":"center",gap:"1rem"}},dt={style:{height:"100%",overflow:"auto"}},ut={key:1,style:{display:"flex","justify-content":"center","align-items":"center",height:"100%"}},pt={class:"message-area"},mt=Ee(()=>e("i",{class:"fas fa-laugh-wink emoji-picker"},null,-1)),ft=["onKeydown"],_t=["src"],ht={style:{position:"relative",transition:".2s"}},gt=Ee(()=>e("i",{class:"pi pi-send text-2xl"},null,-1)),vt={style:{display:"flex",gap:"1rem"}},yt={class:"flex gap-2"},bt={style:{width:"100%",display:"flex","justify-content":"end"}},xt=xe({__name:"Main",setup(O){const f=fe();function Z(t){return{APPROVED:"success",PENDING:"warning",REJECTED:"danger"}[t]||"info"}const v=t=>{re(t),c.value=!1};async function re(t){const o=t,i=new FormData;i.append("messaging_product","whatsapp"),i.append("employer_id",G.rawUserData.id.toString()),i.append("context_message_id",""),i.append("restaurant_id",_.params.restaurant_id),i.append("to",_.params.user_id),i.append("type","template"),i.append("template",JSON.stringify(o));try{T.sending=!0,await D.post(`${R}/webhook/send/template/`,i,!1),console.log(`✅ Template enviado a ${to}`)}catch(g){console.error(`✗ Error al enviar template a ${to}`,g)}finally{T.sending=!1}}const y=h([{}]),Q=t=>{t.target.closest(".emoji-picker")||(J.value=!1)};se(()=>{document.addEventListener("click",Q),x()}),oe(()=>{document.removeEventListener("click",Q)});const c=h(!1);h([]);const _=Te(),G=Le(),J=h(!1),C=h(""),P=h(!1),$=h(null),z=h(!1),B=h(!0),M=De(()=>{var t,o;return B.value&&(((t=_.query)==null?void 0:t.expirado)==="true"||((o=_.query)==null?void 0:o.expirado)===!0)}),ie=t=>{B.value=t};ue(()=>{var t;return(t=_.params)==null?void 0:t.restaurant_id},()=>{x()}),ue(M,t=>{C.value=t?"Conversación expirada":""},{immediate:!0});const H={"SIN DATOS":{bg:"#7f8c8d",icon:"fa-circle-question"},PREOCUPANTE:{bg:"#e74c3c",icon:"fa-triangle-exclamation"},CASUAL:{bg:"#e67e22",icon:"fa-person-walking"},FRECUENTE:{bg:"#27ae60",icon:"fa-repeat"},TOP:{bg:"#2980b9",icon:"fa-ranking-star"},ESTRELLA:{bg:"#8e44ad",icon:"fa-star"}},T=$e();h([{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"},{id:7,name:"Distrimoster",img:"https://backend.salchimonster.com/read-photo-product/iX6UiE6e"}]);const ee=(t="")=>{const o=t.trim().split(" ");return(Array.from(o[0]||"")[0]||"")+(o[1]?Array.from(o[1])[0]:"")},te=t=>{C.value+=t.i,J.value=!1};let V=null,L=[],A=null;const K=async()=>{if(P.value&&V){V.stop();return}try{A=await navigator.mediaDevices.getUserMedia({audio:!0});const t=MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")?"audio/ogg;codecs=opus":"audio/webm;codecs=opus";V=new MediaRecorder(A,{mimeType:t}),V.ondataavailable=o=>o.data.size&&L.push(o.data),V.onstop=()=>{const o=new Blob(L,{type:t.split(";")[0]});L=[],A.getTracks().forEach(g=>g.stop());const i=t.startsWith("audio/ogg")?"ogg":"webm";$.value={file:new File([o],`audio_${Date.now()}.${i}`,{type:o.type}),url:URL.createObjectURL(o)},P.value=!1},V.start(),P.value=!0}catch(t){console.error("No se pudo abrir el micrófono:",t.name,t.message),P.value=!1,A&&A.getTracks().forEach(o=>o.stop())}},X=()=>{$.value&&URL.revokeObjectURL($.value.url),$.value=null};oe(()=>{V&&P.value&&V.stop(),A&&A.getTracks().forEach(t=>t.stop())});const q={messaging_product:"whatsapp",employer_id:G.rawUserData.id,context_message_id:null},ae=async(t,o=null)=>{var g,U;if(M.value||!t.trim())return;const i=new FormData;i.append("messaging_product","whatsapp"),i.append("employer_id",G.rawUserData.id),i.append("context_message_id",((g=o==null?void 0:o.message_data)==null?void 0:g.wa_id)||null),i.append("restaurant_id",(U=_.params.restaurant_id)==null?void 0:U.toString()),i.append("to",_.params.user_id),i.append("type","text"),i.append("text",JSON.stringify({body:t})),C.value="";try{T.sending=!0,await D.post(`${R}/webhook/send/text/`,i,!1)}catch(w){console.error("Error al enviar texto",w)}T.sending=!1},s=async()=>{var g;if(M.value||!$.value||z.value)return;const t=$.value;X(),z.value=!0;const o=new FormData;o.append("files",t.file);const i={...q,restaurant_id:(g=_.params.restaurant_id)==null?void 0:g.toString(),to:_.params.user_id,type:"audio",text:{body:""},file_index:0};o.append("payloads",JSON.stringify(i));try{await D.post(`${R}/webhook/send`,o,!1)}catch(U){console.error("Error al enviar audio",U)}z.value=!1},r=async t=>{var U;if(M.value||!(t!=null&&t.length))return;const o=new FormData,i={restaurant_id:(U=_.params.restaurant_id)==null?void 0:U.toString(),to:_.params.user_id,messaging_product:"whatsapp",employer_id:G.rawUserData.id,context_message_id:null},g=w=>{var ne;const{type:I,name:a}=w;if(I.startsWith("image/"))return"image";if(I.startsWith("audio/"))return"audio";if(I.startsWith("video/"))return"video";if(I==="application/pdf")return"document";const F=(ne=a.split(".").pop())==null?void 0:ne.toLowerCase();return["jpg","jpeg","png","webp"].includes(F)?"image":["mp3","wav","ogg","opus"].includes(F)?"audio":"document"};t.forEach((w,I)=>{o.append("files",w.file),o.append("payloads",JSON.stringify({...i,type:g(w.file),text:{body:w.caption||""},file_index:I}))}),T.sending=!0;try{await D.post(`${R}/webhook/send`,o,!1)}catch(w){console.error("Error al enviar archivos",w)}T.sending=!1},u=t=>{t.key==="Enter"&&(t.preventDefault(),C.value.trim()&&ae(C.value))},S=t=>{t.key==="Enter"&&$.value&&(t.preventDefault(),s())};se(()=>window.addEventListener("keydown",S)),oe(()=>window.removeEventListener("keydown",S));async function x(){if(_.params.restaurant_id){const o=(await D.get(`${Ue}/restaurants`)||[]).find(i=>{var g;return i.id==((g=_.params)==null?void 0:g.restaurant_id)})||null;o&&(y.value=await D.get(`${R}/wabas/${o.waba_id}/templates/`))}}return(t,o)=>{var _e,he,ge;const i=N("Button"),g=N("RouterView"),U=N("Textarea"),w=N("Column"),I=N("Tag"),a=N("DataTable"),F=N("RouterLink"),ne=N("Dialog");return d(),E("div",{class:"main-container",style:l([n(f).current_chat_theme.bg_image,{}])},[e("div",{class:"top-bar",style:l([{"border-radius":".5rem",gap:"1rem"},n(f).current_chat_theme.bg_bars])},[e("div",nt,[e("div",rt,[e("div",{class:"cliente-img",style:l([`background-color:${n(_).params.color}`,{height:"100%",color:"white",width:"3rem","aspect-ratio":"1/1","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase","font-size":"1.3rem"}])},b(ee(n(_).params.user_name)),5)]),e("div",lt,[e("strong",null,[e("h5",{style:l([{"text-transform":"capitalize",margin:"0"},n(f).current_chat_theme.text])},b((_e=n(_).params.user_name)==null?void 0:_e.substring(0,20)),5)]),e("div",null,[n(T).current_user.clasification?(d(),j(i,{key:0,style:l({height:"2.3rem",display:"flex",alignItems:"center",textTransform:"capitalize",gap:"0.35rem",backgroundColor:((he=H[n(T).current_user.clasification])==null?void 0:he.bg)||"#7f8c8d",color:"#fff"})},{default:m(()=>{var k,Y;return[e("i",{class:pe(["fa-solid",(k=H[n(T).current_user.clasification])==null?void 0:k.icon]),"aria-hidden":"true",style:{"font-size":"0.9rem"}},null,2),de(" "+b((Y=n(T).current_user.clasification)==null?void 0:Y.toLowerCase())+" "+b(n(T).current_user.times_purchased)+" compras ",1)]}),_:1},8,["style"])):W("",!0)])])]),e("div",ct,[p(i,{icon:"pi pi-shopping-cart",class:"p-2",style:{color:"white","min-width":"max-content"},severity:"warning",label:"Ing. Ped"}),p(i,{text:"",class:"p-2"},{default:m(()=>[e("i",{style:l(n(f).current_chat_theme.text),class:"pi pi-search text-2xl"},null,4)]),_:1}),p(i,{text:"",class:"p-2"},{default:m(()=>[e("i",{style:l(n(f).current_chat_theme.text),class:"pi pi-bars text-2xl"},null,4)]),_:1})])],4),e("div",dt,[p(g,null,{default:m(()=>[n(_).params.user_id?(d(),j(Oe,{key:0,send_function:r,send_text:ae,change_expiration:ie,ref:"Messages_element"},null,512)):(d(),E("div",ut,[e("h2",{style:l([{color:"white","font-size":"3rem",opacity:".5"},n(f).current_chat_theme.text])},"Selecciona un chat...",4)]))]),_:1})]),(ge=n(_).params)!=null&&ge.user_id?(d(),E("div",{key:0,class:"chat-bar",tabindex:"0",style:l(n(f).current_chat_theme.bg_bars)},[J.value?(d(),j(n(Re),{key:0,native:!0,style:{position:"absolute",bottom:"4rem","z-index":"1000"},onSelect:te,class:"emoji-picker"})):W("",!0),e("div",pt,[p(i,{text:"",style:{"font-size":"2rem"},onClick:o[0]||(o[0]=k=>J.value=!J.value)},{default:m(()=>[mt]),_:1}),$.value?(d(),E("div",{key:1,class:"audio-chip",onKeydown:Ne(je(s,["prevent"]),["enter"])},[e("audio",{style:{width:"100%","min-width":"28rem","max-width":"42rem"},src:$.value.url,controls:""},null,8,_t),p(i,{text:"",class:"btn-audio-trash p-2",onClick:X},{default:m(()=>[e("i",{style:l(n(f).current_chat_theme.text),class:"pi pi-trash text-2xl p-0"},null,4)]),_:1})],40,ft)):(d(),j(U,{key:0,modelValue:C.value,"onUpdate:modelValue":o[1]||(o[1]=k=>C.value=k),autoResize:"",class:"message",disabled:M.value,onKeydown:u,style:l(`${n(f).current_chat_theme.text} ; ${n(f).current_chat_theme.border} `)},null,8,["modelValue","disabled","style"]))]),e("div",ht,[!$.value&&C.value.trim()===""?(d(),j(i,{key:0,text:"",style:{height:"100%"},onClick:K},{default:m(()=>[e("i",{style:l(n(f).current_chat_theme.text),class:pe(P.value?"pi pi-stop text-2xl text-red-500":"pi pi-microphone text-2xl ")},null,6)]),_:1})):$.value?(d(),j(i,{key:1,disabled:z.value,text:"",onClick:s},{default:m(()=>[e("i",{style:l(n(f).current_chat_theme.text),class:"pi pi-send text-2xl"},null,4)]),_:1},8,["disabled"])):(d(),j(i,{key:2,style:l(n(f).current_chat_theme.text),text:"",onClick:o[2]||(o[2]=k=>ae(C.value))},{default:m(()=>[gt]),_:1},8,["style"]))]),e("div",vt,[p(i,{severity:"danger",style:{},icon:"pi pi-clock",class:"p-2",onClick:o[3]||(o[3]=()=>c.value=!0)}),n(_).query.expirado?(d(),j(i,{key:0,icon:"pi pi-bolt",severity:"warning",style:{},class:"p-2",onClick:o[4]||(o[4]=()=>c.value=!0)})):W("",!0)])],4)):W("",!0),p(ne,{visible:c.value,"onUpdate:visible":o[5]||(o[5]=k=>c.value=k),header:"Envio de plantilla",style:{width:"50rem"}},{default:m(()=>[p(a,{value:y.value,dataKey:"id",paginator:"",rows:10,responsiveLayout:"scroll",class:"shadow-md rounded-xl overflow-hidden"},{default:m(()=>[p(w,{class:"my-1 py-1",field:"name",header:"Nombre",bodyClass:"font-medium"}),p(w,{class:"my-1 py-1",header:"Estado"},{body:m(({data:k})=>[p(I,{severity:Z(k.status)},{default:m(()=>[de(b(k.status),1)]),_:2},1032,["severity"])]),_:1}),p(w,{class:"my-1 py-1",header:"Estado"},{body:m(({data:k})=>{var Y,ve;return[de(b((ve=(Y=k==null?void 0:k.components)==null?void 0:Y.find(Ce=>Ce.type=="BODY"))==null?void 0:ve.text),1)]}),_:1}),p(w,{class:"my-1 py-1",headerStyle:"width:8rem",header:"Acciones"},{body:m(({data:k})=>[e("div",yt,[p(i,{icon:"pi pi-send",label:"Enviar",severity:"help",onClick:Y=>v(k)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"]),e("div",bt,[p(F,{to:"/chat/templates"},{default:m(()=>[p(i,{severity:"help",icon:"pi pi-plus",label:"Agregar otro"})]),_:1})])]),_:1},8,["visible"])],4)}}}),wt=me(xt,[["__scopeId","data-v-5ca3d81f"]]);const kt={__name:"chats",setup(O){const f=fe();return(Z,v)=>(d(),E("div",{class:"chat-container",style:l(n(f).current_chat_theme.bg)},[p(be,{style:{"box-shadow":".5rem 0 1rem #00000010"},class:"sidebar-left",restaurant:{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"}}),p(wt),p(be,{style:{"box-shadow":"-.5rem 0 1rem #00000010"},class:"sidebar-right",restaurant:{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"}})],4))}},Tt=me(kt,[["__scopeId","data-v-5877f5bf"]]);export{Tt as default};
