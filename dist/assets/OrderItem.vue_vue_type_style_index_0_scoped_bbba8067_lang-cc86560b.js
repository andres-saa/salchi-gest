import{_ as Z,r as m,Y as G,J as A,j as K,k as M,U as q,a as C,o as b,c as v,b as e,g as r,w as p,a1 as U,u as s,a0 as z,q as y,t as i,F as E,d as N,f as F,p as Q,h as W}from"./index-670442b0.js";import{f as O}from"./formatoPesos-8aa989a0.js";const n=k=>(Q("data-v-c910f2fa"),k=k(),W(),k),X=n(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),ee=n(()=>e("span",{for:"responsible"},"Responsable",-1)),te=n(()=>e("span",{for:"reason"},"Razón",-1)),le=n(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),oe=n(()=>e("span",{class:"advert",style:{"text-transform":"lowercase",color:"red","font-weight":"bold"}}," Desde el 16 de mayo de 2024, la cancelación de órdenes requerirá autorización.",-1)),se=n(()=>e("span",{for:"responsible"},"Responsable",-1)),ne=n(()=>e("span",{for:"reason"},"Razón",-1)),ie={style:{"text-transform":"capitalize"}},re={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},ae={class:"",style:{width:"auto"}},de={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},ce={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},ue={style:{padding:"0",color:"black","text-align":"center",margin:"auto","margin-bottom":"1rem",width:"max-content","min-width":"max-content",display:"flex","justify-content":"center","flex-direction":"column"}},pe=n(()=>e("div",{class:"",style:{"font-weight":"bold",color:"white",margin:"0","background-color":"black","align-items":"center",display:"grid","grid-template-columns":"auto auto"}},[e("div",{style:{width:"100%"}},[e("b",null," productos")]),e("div",null,[e("p",{style:{"text-align":"end","font-weight":"bold"}},[e("b",null," total ")])])],-1)),_e={style:{display:"grid","grid-template-columns":"auto auto"}},me={class:"p-0 m-0"},be=n(()=>e("br",null,null,-1)),ve={style:{"text-align":"end",color:"black"}},ye={key:0,class:"p-0 m-0"},fe=n(()=>e("b",null,"COMBO INCLUYE",-1)),he=[fe],ge={class:"p-0 m-0 ml-5",style:{}},we={style:{display:"flex",width:"","justify-content":"space-between"},class:"p-0 m-0"},xe={class:"p-0 m-0 ml-5",style:{}},Oe={class:"p-0 m-0",style:{"text-align":"end"}},ke=n(()=>e("div",{style:{"background-color":"rgba(0, 0, 0, 0.286)",height:"1px"}},null,-1)),De={class:"",style:{display:"grid",color:"","margin-top":"0.5rem","grid-template-columns":"auto auto"}},Ve=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Subtotal")])],-1)),Ce={class:""},Ee={style:{"text-align":"end","font-weight":"bold",color:"black"}},Se=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Domicilio")])],-1)),Le={class:""},Ue={style:{"text-align":"end","font-weight":"bold",color:"black"}},ze=n(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold",color:"black"}},[e("b",null,"Total")])],-1)),Ne={class:""},Te={style:{"text-align":"end",color:"black","font-weight":"bold"}},$e=n(()=>e("div",{class:""},null,-1)),je=n(()=>e("p",{style:{"font-weight":"bold","background-color":"black",color:"white",padding:"0",margin:"0","margin-top":"0.5rem"}},[e("b",null,"Notas")],-1)),Ie={class:"notas",style:{border:"1px solid",margin:"0",color:"black",padding:"0.5rem"}},Re=n(()=>e("p",{style:{"background-color":"black","font-weight":"bold","margin-top":"1rem",color:"white"}},[e("b",null,"cliente")],-1)),Be={style:{display:"grid","grid-template-columns":"auto auto"}},Pe=n(()=>e("div",{class:"",style:{}},[e("span",null,[e("b",null,"NOMBRE")])],-1)),Ae={class:""},Me={style:{"text-align":"end",color:"black"}},qe=n(()=>e("div",{style:{}},[e("span",null,[e("b",null,"telefono")])],-1)),Fe={style:{"text-align":"end",color:"black"}},Ye=n(()=>e("div",{style:{}},[e("span",null,[e("b",null,"direccion ")])],-1)),He={style:{"text-align":"end",color:"black"}},Je=n(()=>e("div",null,[e("span",null,[e("b",null,"metodo de pago")])],-1)),Ze={style:{"text-align":"end",color:"black"}},Ge={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},Ke=n(()=>e("h3",null,[e("b",null,"TRASLADO DE SEDE")],-1)),Qe=n(()=>e("span",{for:"responsible"},"SELECCIONE LA SEDE DESTINO",-1)),We={__name:"DialogoPedido",setup(k){const S=m(0),D=m(!1),o=G(),Y=A(()=>o.currentOrder.pe_json.listaPedidos.reduce((d,t)=>{var w;let h=t.pedido_cantidad*t.pedido_precio;if(t.modificadorseleccionList&&t.modificadorseleccionList.length>0){const f=((w=t.modificadorseleccionList)==null?void 0:w.filter(l=>l.pedido_productoid==t.pedido_productoid)).reduce((l,x)=>l+x.modificadorseleccion_cantidad*x.pedido_precio,0);h+=f}return d+h},0));A(()=>Y.value+o.currentOrder.delivery_price);const H=async()=>{var t;const d={order_id:o.currentOrder.order_id,responsible:(t=a.value.responsible)==null?void 0:t.name,reason:a.value.reason};await z.create_cancellling_request(d),D.value=!1,o.Notification.pause(),o.Notification.currentTime=0},g=m(!1),T=m([]);K(async()=>{o.currentOrder.value=o.currentOrder,T.value=await M.get(`${q}/sites`)});const L=m(!1),V=m(!1),a=m({responsible:null,reason:"Sin razon"}),$=m([{name:"Restaurante",value:"restaurant"},{name:"Cliente",value:"client"}]),j=()=>{a.value.responsible&&z.cancelOrder(o.currentOrder.order_id,a.value.reason,a.value.responsible.name).then(d=>{d&&(L.value=!1,console.log("Order canceled successfully"))}).catch(d=>{console.error("Failed to cancel order:",d)})},J=async()=>{const d=o.currentOrder.order_id,t=S.value;await M.put(`${q}/traslate-order`,{site_id:t,order_id:d},`trasladando orden ${d}`),o.visibles.currentOrder=!1,V.value=!1};return(d,t)=>{const h=C("Dropdown"),w=C("Textarea"),c=C("Button"),f=C("Dialog");return b(),v(E,null,[e("div",null,[r(f,{visible:L.value,"onUpdate:visible":t[2]||(t[2]=l=>L.value=l),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:p(()=>[X]),default:p(()=>[e("form",{onSubmit:U(j,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[ee,r(h,{style:{width:"100%"},id:"responsible",modelValue:a.value.responsible,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.responsible=l),options:$.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),te,r(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:a.value.reason,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.reason=l),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),r(c,{style:{width:"100%","border-radius":"0.5rem"},label:"cancelar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),r(f,{visible:D.value,"onUpdate:visible":t[5]||(t[5]=l=>D.value=l),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:p(()=>[le]),default:p(()=>[e("form",{onSubmit:U(H,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[oe,se,r(h,{style:{width:"100%"},id:"responsible",modelValue:a.value.responsible,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.responsible=l),options:$.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),ne,r(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:a.value.reason,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.reason=l),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),r(c,{style:{width:"100%","border-radius":"0.5rem"},label:"solicitar cancelacion",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),r(f,{closable:!1,style:{width:"30rem"},modal:"",visible:g.value,"onUpdate:visible":t[8]||(t[8]=l=>g.value=l)},{footer:p(()=>[e("div",re,[r(c,{text:"",size:"small",onClick:t[6]||(t[6]=()=>{s(z).deliveryZero(s(o).currentOrder.order_id),g.value=!1}),style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"si"}),r(c,{onClick:t[7]||(t[7]=l=>g.value=!1),size:"small",style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"no"})])]),default:p(()=>[e("span",ie,[y(" Esta seguro de llevar a $0.00 el valor del domicilio para la orden "),e("b",null,i(s(o).currentOrder.order_id),1),y(" del cliente "),e("b",null,i(s(o).currentOrder.user_name),1),y("? ")])]),_:1},8,["visible"]),r(f,{class:"mx-3",closeOnEscape:"",closable:!1,visible:s(o).visibles.currentOrder,"onUpdate:visible":t[13]||(t[13]=l=>s(o).visibles.currentOrder=l),modal:"",style:{"max-height":"95vh",width:"35rem",position:"relative"}},{footer:p(()=>[e("div",Ge,[r(c,{severity:"help",onClick:t[9]||(t[9]=l=>g.value=!0),style:{width:"100%"},label:"domi $0.00"}),r(c,{size:"small",style:{"border-radius":"0.3rem",width:"100%"},onClick:t[10]||(t[10]=l=>D.value=!0),severity:"danger",label:"CANCELAR "}),r(c,{severity:"warning",onClick:t[11]||(t[11]=l=>V.value=!0),style:{width:"100%","background-color":"black",border:"none"},icon:"pi pi-airplane",label:"traslado"})])]),default:p(()=>{var l,x,I,R,B;return[e("div",ae,[e("p",de," ID:"+i(s(o).currentOrder.order_id),1),e("p",ce,i(s(o).currentOrder.user_name),1),e("p",ue,[e("b",null," fecha: "+i((l=s(o).currentOrder.latest_status_timestamp)==null?void 0:l.split("T")[0]),1),e("b",null," Hora: "+i((B=(R=(I=(x=s(o).currentOrder.latest_status_timestamp)==null?void 0:x.split("T")[1])==null?void 0:I.split(":"))==null?void 0:R.slice(0,2))==null?void 0:B.join(":")),1)]),pe,(b(!0),v(E,null,N(s(o).currentOrder.pe_json.listaPedidos,u=>{var P;return b(),v("div",null,[e("div",_e,[e("p",me,[y(i(u.pedido_cantidad)+" "+i(u.pedido_nombre_producto)+" ",1),be]),e("div",null,[e("p",ve,i(s(O)(u.pedido_precio*u.pedido_cantidad)),1)])]),u.lista_productocombo?(b(),v("p",ye,he)):F("",!0),u.lista_productocombo?(b(!0),v(E,{key:1},N(u.lista_productocombo,_=>(b(),v("p",ge,[y(" -- "),e("b",null,i(_.pedido_cantidad),1),y(" "+i(_.pedido_nombre),1)]))),256)):F("",!0),(b(!0),v(E,null,N((P=u.modificadorseleccionList)==null?void 0:P.filter(_=>_.pedido_productoid==u.pedido_productoid),_=>(b(),v("div",we,[e("p",xe,[y(" -- "),e("b",null,i(_.modificadorseleccion_cantidad),1),y(" "+i(_.modificador_nombre),1)]),e("p",Oe,i(s(O)(_.pedido_precio*_.modificadorseleccion_cantidad)),1)]))),256)),ke])}),256)),e("div",De,[Ve,e("div",Ce,[e("p",Ee,[e("b",null,i(s(O)(s(o).currentOrder.pe_json.delivery.delivery_pagocon-s(o).currentOrder.delivery_price)),1)])]),Se,e("div",Le,[e("p",Ue,[e("b",null,i(s(O)(s(o).currentOrder.delivery_price)),1)])]),ze,e("div",Ne,[e("p",Te,[e("b",null,i(s(O)(s(o).currentOrder.pe_json.delivery.delivery_pagocon)),1)])]),$e]),je,e("p",Ie,i(s(o).currentOrder.order_notes),1),Re,e("div",Be,[Pe,e("div",Ae,[e("p",Me,i(s(o).currentOrder.user_name),1)]),qe,e("div",null,[e("p",Fe,i(s(o).currentOrder.user_phone),1)]),Ye,e("div",null,[e("p",He,i(s(o).currentOrder.user_address),1)]),Je,e("div",null,[e("p",Ze,i(s(o).currentOrder.payment_method),1)])])]),r(c,{class:"shadow-4",onClick:t[12]||(t[12]=u=>s(o).setVisible("currentOrder",!1)),icon:"pi pi-times",rounded:"",severity:"danger",style:{position:"absolute",top:"-1rem","border-radius":"50%",right:"-1rem"}})]}),_:1},8,["visible"])]),r(f,{visible:V.value,"onUpdate:visible":t[16]||(t[16]=l=>V.value=l),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:p(()=>[Ke]),default:p(()=>[e("form",{onSubmit:U(j,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[Qe,r(h,{style:{width:"100%"},id:"responsible",modelValue:S.value,"onUpdate:modelValue":t[14]||(t[14]=l=>S.value=l),optionValue:"site_id",options:T.value.filter(l=>l.show_on_web),optionLabel:"site_name",placeholder:"Seleccione la sede destino"},null,8,["modelValue","options"]),r(c,{onClick:t[15]||(t[15]=l=>J()),style:{width:"100%","border-radius":"0.5rem"},label:"Trasladar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"])],64)}}},tt=Z(We,[["__scopeId","data-v-c910f2fa"]]);export{tt as D};
