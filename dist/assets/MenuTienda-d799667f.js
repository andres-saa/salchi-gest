import{z as X,U as N,_ as ae,r as _,i as Y,A as M,y as W,o as x,c as $,b as e,F as q,d as H,n as F,t as A,B as re,a as c,e as Z,w as h,g as a,u as i,m as G,D as ie,f as ne,H as te,I as oe}from"./index-e163c2a5.js";import{u as ee}from"./site-5cab4be5.js";import{s as de}from"./siteService-d4866bae.js";import{u as J,p as j}from"./ProductService-01dfbc78.js";import{a as O}from"./aditionalService-96c9dd44.js";import{f as se}from"./formatoPesos-8aa989a0.js";const ce=ee(),le={async getCategories(){const d=ce.restaurant;try{const o=await X.get(`${N}/categories/1/${d}`);return o.status===200?o.data:(console.error("An error occurred while fetching the ingredients:",o.status),null)}catch(o){return console.error("An error occurred while fetching the ingredients:",o),null}},async getCategoriesByRestaurantId(V){try{const d=await X.get(`${N}/categories-add-product/${V}`);return d.status===200?d.data:(console.error("An error occurred while fetching the ingredients:",d.status),null)}catch(d){return console.error("An error occurred while fetching the ingredients:",d),null}}};const ue={class:"barra align-items-center p-0 md:p-1",style:{"overflow-x":"auto",display:"flex","background-color":"rgba(255, 255, 255, 0.913)"}},pe=["onClick"],me={class:"text-lg",style:{"min-width":"max-content"}},_e={__name:"BarraCategorias",setup(V){const d=ee(),o=_([]),n=(b,f)=>{f>=1e3?W.push("/tienda-menu/productos/adicionales"):W.push({name:"sesion",params:{menu_name:b,category_id:f}})},s=async()=>{o.value=await le.getCategories()};Y(async()=>{s()});const v=b=>re().params.category_id==b.category_id;return M(()=>d.restaurant,b=>{s(),W.push("/tienda-menu/")},{depth:!0}),(b,f)=>(x(),$("div",{class:F([o.value.length>0?"apear":"hide","shadow-3 d-flex p lg:justify-content-center align-items-center mb-5 p-0 md:p-0 m-0"]),style:{position:"sticky",top:"3rem","min-height":"3rem","min-width":"100%","z-index":"99"}},[e("div",ue,[(x(!0),$(q,null,H(o.value,P=>(x(),$("div",{key:P.id,class:"p-1"},[e("button",{onClick:D=>n(P.category_name,P.category_id),class:F([v(P)?"selected menu-button":"menu-button","p-2 text-lg titulo"]),style:{"font-weight":"400","text-transform":"uppercase","min-width":"max-content"}},[e("span",me,A(P.category_name),1)],10,pe)]))),128))])],2))}},ve=ae(_e,[["__scopeId","data-v-ae4a7a6c"]]),ge={class:"image",style:{display:"flex","flex-direction":"column","justify-content":"end","align-items":"end"}},fe=["src"],ye=["src"],he={style:{display:"flex","flex-direction":"column",gap:"1rem"}},be=e("span",null,"Nombre:",-1),we=e("span",null,"descripcion:",-1),xe=e("span",null,"Precio anterior:",-1),Pe=e("span",null,"Precio actual:",-1),Ve={class:"text-center text-2xl py-4",style:{"font-weight":"bold","text-transform":"capitalize",display:"flex","align-items":"center","justify-content":"center",gap:"1rem"}},Ee={style:{"text-transform":"uppercase"}},$e={style:{"font-weight":"bold"}},Te={class:"col-12 px-0 pb-0"},De={__name:"dialogEditProduct",setup(V){const d=_([]),o=J(),n=_([]),s=_(null),v=_(null),b=async u=>{const l=u.target.files[0];if(!l)return;s.value=URL.createObjectURL(l);const p=new FormData;p.append("file",l);try{const t=(await j.uploadPhoto(p)).image_identifier;o.currentProductToEdit.img_identifier=t,URL.revokeObjectURL(s.value)}catch(r){console.error("Error al subir la imagen:",r)}},f=()=>{!n.value||n.value.length===0||Object.entries(n.value).forEach(([u,l])=>{l.forEach(p=>{const r=d.value.some(t=>t.items.some(m=>m.aditional_item_name.toLowerCase()===p.item_name.toLowerCase()&&m.aditional_item_price===p.item_price&&m.aditional_item_type_name===p.type_name));p.status=r})})},P=u=>n.value[u].every(l=>l.status),D=(u,l)=>{n.value[u].forEach(p=>{p.status=l,E(p.item_id,u,l)})},E=(u,l,p)=>{const r=n.value[l].findIndex(t=>t.item_id===u);r!==-1&&(n.value[l][r].status=p)};M(()=>o.currentProductToEdit.id,async()=>{d.value=await O.getAditional(o.currentProductToEdit.id),n.value=await O.getAllAditionsRegistered(),f()});const g=_([]),U=()=>{let u=[];for(const l in n.value)n.value.hasOwnProperty(l)&&n.value[l].forEach(p=>{p.status&&u.push(p.item_id)});g.value=u,C()},C=()=>{const u={product_id:o.currentProductToEdit.id,name:o.currentProductToEdit.product_name,price:o.currentProductToEdit.price,last_price:o.currentProductToEdit.last_price||0,description:o.currentProductToEdit.product_description,category_id:o.currentProductToEdit.category_id,status:!0,img_identifier:o.currentProductToEdit.img_identifier,parent_id:o.currentProductToEdit.product_id},l=g.value;j.updateProductInstance(u,l)};return(u,l)=>{const p=c("Button"),r=c("InputText"),t=c("Textarea"),m=c("InputNumber"),T=c("InputSwitch"),L=c("Column"),K=c("DataTable"),z=c("Dialog");return x(),Z(z,{closeOnEscape:"",visible:i(o).visibles.dialogEditProduct,"onUpdate:visible":l[6]||(l[6]=w=>i(o).visibles.dialogEditProduct=w),modal:"",style:{width:"40rem"}},{footer:h(()=>[e("div",Te,[a(p,{class:"",onClick:U,severity:"success",label:"Guardar"})])]),default:h(()=>[a(p,{onClick:l[0]||(l[0]=w=>i(o).visibles.dialogEditProduct=!1),severity:"danger",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",icon:"pi pi-times"}),e("div",ge,[s.value?(x(),$("img",{key:0,src:s.value,alt:"Preview",style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"}},null,8,fe)):(x(),$("img",{key:1,class:"",style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"},src:`${i(N)}/read-photo-product/${i(o).currentProductToEdit.img_identifier}/600`,alt:""},null,8,ye)),a(p,{style:{},class:"my-3",severity:"help",onClick:l[1]||(l[1]=w=>v.value.click())},{default:h(()=>[G("Cambiar foto")]),_:1}),e("input",{type:"file",ref_key:"fileInput",ref:v,onChange:b,style:{display:"none"}},null,544)]),e("div",he,[e("div",null,[be,a(r,{modelValue:i(o).currentProductToEdit.product_name,"onUpdate:modelValue":l[2]||(l[2]=w=>i(o).currentProductToEdit.product_name=w),style:{width:"100%"}},null,8,["modelValue"])]),e("div",null,[we,a(t,{modelValue:i(o).currentProductToEdit.product_description,"onUpdate:modelValue":l[3]||(l[3]=w=>i(o).currentProductToEdit.product_description=w),rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])]),e("div",null,[xe,a(m,{modelValue:i(o).currentProductToEdit.last_price,"onUpdate:modelValue":l[4]||(l[4]=w=>i(o).currentProductToEdit.last_price=w),prefix:"$",maxFractionDigits:"0",rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])]),e("div",null,[Pe,a(m,{modelValue:i(o).currentProductToEdit.price,"onUpdate:modelValue":l[5]||(l[5]=w=>i(o).currentProductToEdit.price=w),prefix:"$",maxFractionDigits:"0",rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])])]),(x(!0),$(q,null,H(n.value,(w,S)=>(x(),$("div",{class:"m-auto col-12 p-0",style:{"max-width":"600px"},key:S},[e("p",Ve,[e("span",null,A(S),1),a(T,{modelValue:P(S),"onUpdate:modelValue":k=>D(S,k)},null,8,["modelValue","onUpdate:modelValue"])]),a(K,{stripedRows:"",value:w,class:"p-0"},{default:h(()=>[a(L,{style:{"text-transform":"capitalize"},class:"p-0",field:"aditional_item_name",header:"Nombre"},{body:h(k=>[e("span",Ee,A(k.data.item_name),1)]),_:1}),a(L,{class:"p-0",field:"aditional_item_price",header:"Precio"},{body:h(k=>[e("span",$e,A(i(se)(k.data.item_price)),1)]),_:1}),a(L,{class:"py-0 pl-4 p-0",header:"Estado",headerStyle:"width:1rem"},{body:h(k=>[a(T,{modelValue:k.data.status,"onUpdate:modelValue":[B=>k.data.status=B,B=>E(k.data.item_id,S,B)]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["value"])]))),128))]),_:1},8,["visible"])}}},ke={async getAllRestaurants(){try{const V=await X.get(`${N}/restaurants`);return V.status===200?V.data:(console.error("Error al obtener los restaurantes:",V.status),[])}catch(V){return console.error("Error al obtener los restaurantes:",V),[]}}},Ce={class:"image",style:{display:"flex","flex-direction":"column","justify-content":"end","align-items":"end"}},Ue=["src"],Se={style:{display:"flex","flex-direction":"column",gap:"1rem"}},Ie=e("span",null,"ID de Restaurante:",-1),Ae=e("span",null,"ID de Categoría:",-1),Le=e("span",null,"Nombre:",-1),Be=e("span",null,"Descripción:",-1),Re=e("span",null,"Anterior Precio:",-1),je=e("span",null,"Precio Actual:",-1),Oe={class:"text-center text-2xl py-4",style:{"font-weight":"bold","text-transform":"capitalize",display:"flex","align-items":"center","justify-content":"center",gap:"1rem"}},ze={style:{"text-transform":"uppercase"}},Ne={style:{"font-weight":"bold"}},Fe={class:"col-12 px-0 pb-0"},Ge={__name:"dialogAddProduct",setup(V){const d=_([]),o=J(),n=_([]),s=_({product_name:"",product_description:"",price:0,last_price:0,category_id:null,restaurant_id:null,img_identifier:null}),v=_([]),b=_([]),f=_(null),P=_(null);Y(async()=>{try{b.value=await ke.getAllRestaurants(),n.value=await O.getAllAditionsRegistered()}catch(r){console.error("Error loading data:",r)}});const D=ie(()=>s.value.restaurant_id);M(D,async(r,t)=>{r!==t&&(v.value=await le.getCategoriesByRestaurantId(r),s.value.category_id=null)},{deep:!0});const E=async r=>{const t=r.target.files[0];if(!t)return;f.value=URL.createObjectURL(t);const m=new FormData;m.append("file",t);try{const T=await j.uploadPhoto(m);s.value.img_identifier=T.image_identifier,URL.revokeObjectURL(f.value)}catch(T){console.error("Error uploading image:",T)}},g=r=>n.value[r].every(t=>t.status),U=(r,t)=>{n.value[r].forEach(m=>{m.status=t,C(m.item_id,r,t)})},C=(r,t,m)=>{const T=n.value[t].findIndex(L=>L.item_id===r);T!==-1&&(n.value[t][T].status=m)},u=()=>{if(typeof n.value!="object"||n.value===null){console.error("adicionales.value no es un objeto",n.value);return}let r=[];for(const t in n.value)n.value.hasOwnProperty(t)&&n.value[t].forEach(m=>{m.status&&r.push(m.item_id)});d.value=r,l()},l=()=>{const r={name:s.value.product_name,price:s.value.price||0,last_price:s.value.last_price||0,description:s.value.product_description,category_id:s.value.category_id,restaurant_id:s.value.restaurant_id,status:!0,img_identifier:s.value.img_identifier||"",parent_id:null},t=d.value;j.createProductInstance(r,t),p()},p=()=>{s.value={product_name:"",product_description:"",price:0,last_price:0,category_id:null,restaurant_id:null,img_identifier:null},f.value=null,n.value.forEach(r=>{r.forEach(t=>{t.status=!1})})};return(r,t)=>{const m=c("Button"),T=c("Dropdown"),L=c("InputText"),K=c("Textarea"),z=c("InputNumber"),w=c("InputSwitch"),S=c("Column"),k=c("DataTable"),B=c("Dialog");return x(),Z(B,{closeOnEscape:"",visible:i(o).visibles.dialogAddProduct,"onUpdate:visible":t[8]||(t[8]=y=>i(o).visibles.dialogAddProduct=y),modal:"",style:{width:"40rem"}},{footer:h(()=>[e("div",Fe,[a(m,{onClick:u,severity:"success",label:"Guardar"})])]),default:h(()=>[a(m,{onClick:t[0]||(t[0]=y=>i(o).visibles.dialogAddProduct=!1),severity:"danger",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",icon:"pi pi-times"}),e("div",Ce,[f.value?(x(),$("img",{key:0,src:f.value,alt:"Preview",style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"}},null,8,Ue)):ne("",!0),a(m,{class:"my-3",severity:"help",onClick:t[1]||(t[1]=y=>P.value.click())},{default:h(()=>[G("Agregar foto")]),_:1}),e("input",{type:"file",ref_key:"fileInput",ref:P,onChange:E,style:{display:"none"}},null,544)]),e("div",Se,[e("div",null,[Ie,a(T,{modelValue:s.value.restaurant_id,"onUpdate:modelValue":t[2]||(t[2]=y=>s.value.restaurant_id=y),options:b.value,optionLabel:"name",optionValue:"id",placeholder:"Selecciona un restaurante",style:{width:"100%"}},null,8,["modelValue","options"])]),e("div",null,[Ae,a(T,{modelValue:s.value.category_id,"onUpdate:modelValue":t[3]||(t[3]=y=>s.value.category_id=y),options:v.value,optionLabel:"name",optionValue:"id",placeholder:"Selecciona una categoría",style:{width:"100%"}},null,8,["modelValue","options"])]),e("div",null,[Le,a(L,{modelValue:s.value.product_name,"onUpdate:modelValue":t[4]||(t[4]=y=>s.value.product_name=y),style:{width:"100%"}},null,8,["modelValue"])]),e("div",null,[Be,a(K,{modelValue:s.value.product_description,"onUpdate:modelValue":t[5]||(t[5]=y=>s.value.product_description=y),rows:"3",style:{width:"100%",resize:"none"}},null,8,["modelValue"])]),e("div",null,[Re,a(z,{modelValue:s.value.last_price,"onUpdate:modelValue":t[6]||(t[6]=y=>s.value.last_price=y),prefix:"$",maxFractionDigits:"0",style:{width:"100%"}},null,8,["modelValue"])]),e("div",null,[je,a(z,{modelValue:s.value.price,"onUpdate:modelValue":t[7]||(t[7]=y=>s.value.price=y),prefix:"$",maxFractionDigits:"0",style:{width:"100%"}},null,8,["modelValue"])])]),(x(!0),$(q,null,H(n.value,(y,R)=>(x(),$("div",{class:"m-auto col-12 p-0",style:{"max-width":"600px"},key:R},[e("p",Oe,[e("span",null,A(R),1),a(w,{modelValue:g(R),"onUpdate:modelValue":I=>U(R,I)},null,8,["modelValue","onUpdate:modelValue"])]),a(k,{stripedRows:"",value:y,class:"p-0"},{default:h(()=>[a(S,{style:{"text-transform":"capitalize"},class:"p-0",field:"aditional_item_name",header:"Nombre"},{body:h(I=>[e("span",ze,A(I.data.item_name),1)]),_:1}),a(S,{class:"p-0",field:"aditional_item_price",header:"Precio"},{body:h(I=>[e("span",Ne,A(i(se)(I.data.item_price)),1)]),_:1}),a(S,{class:"py-0 pl-4 p-0",header:"Estado",headerStyle:"width:1rem"},{body:h(I=>[a(w,{modelValue:I.data.status,"onUpdate:modelValue":[Q=>I.data.status=Q,Q=>C(I.data.item_id,R,Q)]},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["value"])]))),128))]),_:1},8,["visible"])}}};const Me={class:"py-3",style:{overflow:"hidden"}},qe=["src"],He={class:"col-12 p-0"},Je={__name:"dialogDeleteProduct",setup(V){const d=_(!1),o=()=>{d.value=!0,n.value=!n.value},n=_(!1),s=_([]),v=J(),b=_([]);_(v.currentProductToDelete);const f=()=>{!b.value||b.value.length===0||Object.entries(b.value).forEach(([D,E])=>{E.forEach(g=>{const U=s.value.some(C=>C.items.some(u=>u.aditional_item_name.toLowerCase()===g.item_name.toLowerCase()&&u.aditional_item_price===g.item_price&&u.aditional_item_type_name===g.type_name));g.status=U})})},P=async D=>{await j.deleteProduct(D),v.visibles.dialogDeleteProduct=!1,location.reload()};return M(()=>v.currentProductToEdit.id,async()=>{s.value=await O.getAditional(v.currentProductToEdit.id),b.value=await O.getAllAditionsRegistered(),f()}),_([]),(D,E)=>{const g=c("Button"),U=c("Dialog");return x(),Z(U,{close:d.value=!1,closeOnEscape:"",visible:i(v).visibles.dialogDeleteProduct,"onUpdate:visible":E[1]||(E[1]=C=>i(v).visibles.dialogDeleteProduct=C),modal:"",style:{width:"20rem"}},{footer:h(()=>[e("div",He,[a(g,{style:{width:"100%"},onClick:E[0]||(E[0]=C=>P(i(v).currentProductToDelete.product_id)),severity:"danger",label:"Eliminar producto"})])]),default:h(()=>[G(" Esta seguro de eliminar "),e("b",null,A(i(v).currentProductToDelete.product_name),1),G(" ? "),e("div",Me,[te(e("img",{onLoad:o,class:F([d.value&&n.value?"cargado1":d.value&&!n.value?"cargado2":"nada",""]),style:{width:"100%",height:"100%","background-color":"rgb(255, 255, 255)","object-fit":"contain","border-radius":"0.2rem"},src:`https://backend.salchimonster.com/read-product-image/300/${i(v).currentProductToDelete.product_name}`,alt:""},null,42,qe),[[oe,d.value]]),te(e("div",{onLoad:o,class:F([d.value?"cargado":"sin-cargar","p-0"]),style:{width:"100%","aspect-ratio":"1 / 1","background-color":"rgb(255, 255, 255)",height:"100%","object-fit":"contain","border-radius":"0.2rem"},alt:""},null,34),[[oe,!d.value]])])]),_:1},8,["close","visible"])}}},Ke=ae(Je,[["__scopeId","data-v-ab78fcc4"]]),Qe={style:{"border-radius":"1rem",position:"relative"},class:"mx-auto mx-0 p-0 mt-6 mb-8"},We={class:"mx-3 my-4 mx-auto px-4",style:{"min-width":"max-content","max-width":"1024px",display:"flex","align-items":"center"}},Xe=e("span",{class:"mr-4"},[e("b",null,"SEDE")],-1),Ye={style:{position:"fixed",overflow:"hidden","background-color":"white","border-radius":"0 1rem 1rem 0",left:"0",top:"12rem",display:"flex","flex-direction":"column"}},Ze={style:{display:"flex","align-items":"center",width:"2rem","flex-direction":"column"}},et=["src"],tt={key:0,style:{"border-top":".1rem solid white"}},it={__name:"MenuTienda",setup(V){const d=J(),o=ee(),n=_([]),s=()=>{d.visibles.dialogAddProduct=!0},v=async()=>{n.value=await de.getSites()};return Y(async()=>{v()}),(b,f)=>{const P=c("Dropdown"),D=c("Button"),E=c("router-view");return x(),$("div",Qe,[a(ve,{class:"m-0"}),e("div",We,[Xe,a(P,{modelValue:i(o).site,"onUpdate:modelValue":f[0]||(f[0]=g=>i(o).site=g),options:n.value.filter(g=>g.show_on_web),optionLabel:"site_name",class:"",style:{width:"100%"}},null,8,["modelValue","options"]),a(D,{onClick:s,class:"ml-3",style:{"min-width":"max-content"},severity:"help",label:"Nuevo producto"})]),a(E,{class:""}),a(De,{class:"m-3"}),a(Ke),a(Ge),e("div",Ye,[(x(),$(q,null,H([{name:"S",id:1,imagen:"https://www.salchimonster.com/images/logo.png"},{name:"B",id:2,imagen:"https://burgermonsterr.com/images/LOGO.png"},{name:"P",id:4,imagen:"https://papasmonster.com/images/LOGO.png"}],(g,U)=>e("div",Ze,[a(D,{size:"small",text:"",label:g.name,class:"text-white",onClick:C=>i(o).restaurant=g.id},{default:h(()=>[e("img",{style:{width:"2rem"},src:g.imagen,alt:""},null,8,et)]),_:2},1032,["label","onClick"]),U!=2?(x(),$("span",tt)):ne("",!0)])),64))])])}}};export{it as default};
