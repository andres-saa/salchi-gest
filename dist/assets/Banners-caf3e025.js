import{_ as M,j as i,k as T,W as ie,m as ce,U as D,G as N,r as A,o as c,c as v,g as O,f as C,i as U,a as r,F,b as P,u as V,n as ue,p as q,q as X,a9 as E,e as _,d as j,L as B}from"./index-282fd2e4.js";import{p as de}from"./ProductService-07f82edb.js";import"./site-9d8d5749.js";const G=p=>(q("data-v-2d2c8e62"),p=p(),X(),p),ve={class:"container",style:{"background-color":"red","min-width":"100%"}},pe=G(()=>r("i",{class:"pi pi-angle-left"},null,-1)),fe=["src","alt"],ge=G(()=>r("i",{class:"pi pi-angle-right"},null,-1)),_e=3e3,me={__name:"Banner",setup(p){const a=i([]),u=i(0);let d=null;T(async()=>{await w(),h()}),ie(()=>{x()});async function w(){try{const m=await ce.get(`${D}/banners`);a.value=m.sort((y,b)=>y.index-b.index),u.value=0}catch(m){console.error("Error al cargar banners:",m)}}function h(){!d&&a.value.length>1&&(d=setInterval(()=>{I()},_e))}function x(){d&&(clearInterval(d),d=null)}function I(){a.value.length!==0&&(u.value=(u.value+1)%a.value.length)}function f(){a.value.length!==0&&(u.value=(u.value-1+a.value.length)%a.value.length)}const g=N(()=>`transform: translateX(${-u.value*100}%); transition: all 0.3s ease;`);return(m,y)=>{const b=A("Button");return c(),v("div",ve,[a.value.length>1?(c(),O(b,{key:0,class:"button-left",onClick:f},{default:C(()=>[pe]),_:1})):U("",!0),r("div",{class:"slider",style:ue(g.value)},[(c(!0),v(F,null,P(a.value,($,S)=>(c(),v("img",{key:$.id??S,src:`${V(D)}/read-photo-product/${$.img_identifier}`,alt:$.title??`Banner ${S}`},null,8,fe))),128))],4),a.value.length>1?(c(),O(b,{key:1,class:"button-right",onClick:I},{default:C(()=>[ge]),_:1})):U("",!0)])}}},he=M(me,[["__scopeId","data-v-2d2c8e62"]]);const R=p=>(q("data-v-bb5329de"),p=p(),X(),p),ye={style:{padding:"3rem"}},be=R(()=>r("h2",null,[r("b",null,"Arrastra y Reordena las Imágenes")],-1)),De=R(()=>r("p",null," Arrastra y suelta tus imágenes aquí o haz clic para seleccionarlas. ",-1)),we={key:0,class:"preview-container"},xe=["src"],Ie={key:1,style:{position:"absolute",left:"0",top:"0",width:"100%",display:"flex","justify-content":"center","align-items":"center",height:"100%","background-color":"#ffffff80"}},ke={class:"col-12 px-0 pb-0"},Be={class:"draggable-container"},$e=["onDragstart","onDragenter","onDrop"],Ce=["src","alt"],Se=R(()=>r("div",{class:"confirmation-content"},[r("i",{class:"pi pi-exclamation-triangle",style:{"font-size":"2rem",color:"#ff9800"}}),r("span",{class:"message"}," ¿Estás seguro de que deseas eliminar esta imagen? ")],-1)),Ee={class:"dialog-footer"},Ae={__name:"Banners",setup(p){const a=i([]),u=i(-1),d=i(-1),w=i(!1),h=i(null),x=i(!1),I=i(!1),f=i([]),g=i([]),m=i(null),y=i(!1),b=N(()=>a.value.slice().sort((e,n)=>e.index-n.index));T(async()=>{await $()});async function $(){try{const e=await E.get(`${D}/banners/`);a.value=e.data.map((n,t)=>({...n,id:n.id??Date.now()+Math.random(),index:n.index??t,src:n.img_identifier,title:n.title??"Sin título"}))}catch(e){console.error("Error al obtener banners:",e)}}async function S(e){return(await E.post(`${D}/banners/`,e)).data}async function W(e){return(await E.post(`${D}/banners/reorder`,e)).data}async function H(e){return(await E.delete(`${D}/banners/${e}`)).data}function J(e){u.value=e}function K(e){d.value=e}function Q(){d.value=-1}async function Y(e){if(e===u.value)return;const n=b.value[u.value],t=a.value.findIndex(o=>o.id===n.id);a.value.splice(t,1),a.value.splice(e,0,n),a.value.forEach((o,s)=>{o.index=s}),u.value=-1,d.value=-1;try{const o=a.value.map(s=>({id:s.id,index:s.index,img_identifier:s.src}));await W(o)}catch(o){console.error("Error al reordenar banners:",o)}}function Z(e){h.value=e,w.value=!0}function z(){w.value=!1,h.value=null}async function ee(){if(h.value){try{await H(h.value.id);const e=a.value.findIndex(n=>n.id===h.value.id);e!==-1&&(a.value.splice(e,1),a.value.forEach((n,t)=>{n.index=t}))}catch(e){console.error("Error al eliminar banner:",e)}z()}}function ne(){x.value=!0}function ae(){m.value.click()}function te(e){const n=e.target.files;if(!n||n.length===0)return;const t=Array.from(n);f.value=f.value.concat(t);const o=t.map(s=>URL.createObjectURL(s));g.value=g.value.concat(o),e.target.value=""}function re(){y.value=!0}function oe(){y.value=!1}function se(e){y.value=!1;const n=e.dataTransfer.files;if(!n||n.length===0)return;const t=Array.from(n);f.value=f.value.concat(t);const o=t.map(s=>URL.createObjectURL(s));g.value=g.value.concat(o)}async function le(){if(f.value.length===0){alert("Por favor selecciona al menos una imagen.");return}I.value=!0;try{for(const e of f.value){const n=new FormData;n.append("file",e);const t=await de.uploadPhoto(n),{image_identifier:o}=t,s={index:a.value.length,img_identifier:o},l=await S(s);a.value.push({id:l.id??Date.now()+Math.random(),index:l.index??a.value.length-1,src:l.img_identifier,title:e.name})}f.value=[],g.value=[],x.value=!1}catch(e){console.error("Error al subir las imágenes o crear banners:",e),alert("Hubo un error al subir las imágenes.")}finally{I.value=!1,location.reload()}}return(e,n)=>{const t=A("Button"),o=A("ProgressSpinner"),s=A("Dialog");return c(),v(F,null,[_(he),r("div",ye,[be,_(t,{style:{margin:"1rem 0"},severity:"help",label:"Agregar Imágenes",icon:"pi pi-upload",onClick:ne}),_(s,{header:"Agregar Imágenes",visible:x.value,"onUpdate:visible":n[0]||(n[0]=l=>x.value=l),modal:"",style:{width:"40rem"}},{footer:C(()=>[r("div",ke,[_(t,{onClick:le,severity:"success",label:"Guardar"})])]),default:C(()=>[r("div",{class:j(["drop-zone",{"drag-over-zone":y.value}]),onDragover:B(re,["prevent"]),onDragleave:B(oe,["prevent"]),onDrop:B(se,["prevent"]),onClick:ae},[De,g.value.length>0?(c(),v("div",we,[(c(!0),v(F,null,P(g.value,(l,k)=>(c(),v("div",{key:k,class:"preview-item"},[r("img",{src:l,alt:"Preview",style:{width:"100%","object-fit":"cover","border-radius":"0.2rem"}},null,8,xe)]))),128))])):U("",!0),r("input",{type:"file",ref_key:"fileInput",ref:m,onChange:te,style:{display:"none"},multiple:"",accept:"image/*"},null,544),I.value?(c(),v("div",Ie,[_(o,{strokeWidth:"8",style:{color:"white"}})])):U("",!0)],34)]),_:1},8,["visible"]),r("div",Be,[(c(!0),v(F,null,P(b.value,(l,k)=>(c(),v("div",{key:l.id,class:j(["draggable-item",{"drag-over":d.value===k}]),draggable:"true",onDragstart:L=>J(k),onDragenter:B(L=>K(k),["prevent"]),onDragover:n[1]||(n[1]=B(()=>{},["prevent"])),onDragleave:Q,onDrop:L=>Y(k)},[r("img",{src:`${V(D)}/read-photo-product/${l.src}`,alt:l.title},null,8,Ce),_(t,{style:{"border-radius":"50%",position:"absolute","background-color":"var(--primary-color)",border:"3px solid","aspect-ratio":"1 / 1",right:"-1.5rem",top:"-1.5rem"},icon:"pi pi-times",severity:"info",class:"delete-button",onClick:B(L=>Z(l),["stop"])},null,8,["onClick"])],42,$e))),128)),_(s,{header:"Confirmar Eliminación",visible:w.value,"onUpdate:visible":n[2]||(n[2]=l=>w.value=l),modal:"",closable:!1,style:{width:"350px"}},{default:C(()=>[Se,r("div",Ee,[_(t,{label:"Sí, eliminar",icon:"pi pi-check",class:"p-button-danger",onClick:ee}),_(t,{label:"Cancelar",icon:"pi pi-times",class:"p-button-secondary",onClick:z})])]),_:1},8,["visible"])])])],64)}}},Pe=M(Ae,[["__scopeId","data-v-bb5329de"]]);export{Pe as default};
