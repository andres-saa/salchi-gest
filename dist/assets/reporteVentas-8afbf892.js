import{_ as J,x as O,G as q,r as l,k as W,i as Y,m as x,U as j,H as K,a as u,o as k,c as S,b as s,d as n,u as r,F as Q,e as X,n as I,w as g,T as Z,E as ee,s as V,t as R,p as te,g as oe,I as se}from"./index-a303b041.js";const ae=b=>(te("data-v-0dbc0a8f"),b=b(),oe(),b),le={class:"col-12 px-3 md:px-4 mx-auto",style:{position:"relative","max-width":"1366px","margin-top":"6rem"}},ne={class:"grid",style:{"background-color":"rgba(250, 250, 250, 0)"}},ie={class:"text-sm col-12 md:col-3 p-2 xl:col-2"},re={class:"text-sm col-12 p-2 md:col-4 xl:col-6"},ce={class:"text-center col-12 p-2 md:col-3"},de={class:"col-12 md:col-1 md:p-0",style:{display:"flex","align-items":"center","justify-content":"start"}},pe=ae(()=>s("p",{class:"text-3xl px-0 mx-0 my-6 pb-0",style:{"font-weight":"bold"}},[s("i",{class:"fa-solid fa-chart-simple"}),V(" Vision General")],-1)),ue={class:"contenedor mt-5",style:{position:"sticky",top:"3rem","z-index":"99"}},me={class:"col-12 px-0 py-0 my-0 p-0",style:{"overflow-x":"auto","background-color":"#fafafa"}},fe={class:"px-0 mx-0",style:{width:"max-content","background-color":"#fafafa",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},ve={style:{"background-color":""}},_e={class:"grid p-0 m-0"},ye={class:"grid"},xe={class:"col-12 px-0 mx-0"},ge={class:"col-12",style:{display:"flex","flex-direction":"column"}},be={class:"text-l",style:{"font-weight":"bold"}},he={class:"col-12",style:{display:"flex","flex-direction":"column"}},we={style:{"font-weight":"bold"},class:"text-l"},De={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},ke={class:"col-12",style:{display:"flex","justify-content":"center"}},Se={__name:"reporteVentas",setup(b){const a=O(),{isDarkTheme:E}=q(),L=l(["enviada","cancelada","en preparacion"]),N=l("enviada"),U=W(),C=l([]),F=l([]),f=l(!1),h=l(new Date(new Date().setDate(new Date().getDate()-7))),w=l(new Date),m=l(new Date),c=l(new Date);l("");function _(t){const e=new Date,d=new Date(e);d.setDate(d.getDate()+1);const p=new Date(e);p.setDate(e.getDate()-t),m.value=p,t==1?(c.value=e,a.setDateRange(m.value,c.value),f.value=!1):(c.value=d,a.setDateRange(m.value,c.value),f.value=!1),a.fetchSalesReport()}Y(()=>{B().then(t=>{C.value=t}),a.fetchSalesReport()});const M=async()=>{const t=v(h.value),e=v(w.value),d=F.value.map(i=>i.site_id).join(","),p=new URLSearchParams({site_ids:d,status:N.value,start_date:t,end_date:e}),y=`${j}/sales_report?${p.toString()}`;try{const i=await fetch(y,{method:"GET",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const D=await i.json();se.value=D,console.log(D)}catch(i){console.error("Fetch error:",i)}};x([h,w],()=>{M()},{deep:!0}),x(()=>a.order_status,(t,e)=>{console.log(`El estado de orden ha cambiado de ${e} a ${t}`),a.fetchSalesReport()}),x(a.selectedSites,t=>{a.setSelectedSites(t)},{deep:!0});const B=async()=>{try{const t=await fetch(`${j}/sites`);if(!t.ok)throw"paila";return await t.json()}catch(t){console.log(t)}},P=l([{name:"Valor ventas",to:"/reporte-ventas/valor-ventas",icon:"fa-solid fa-dollar-sign"},{name:"No. Ordenes",to:"/reporte-ventas/no-ordenes",icon:"fa-solid fa-sort"},{name:"Ticket promedio",to:"/reporte-ventas/ticket",icon:"fa-solid fa-money-bill"},{name:"Ordenes",to:"/reporte-ventas/ordenes",icon:"fa-solid fa-table"}]);l(null),K({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const $=l(null),z=()=>{$.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},A=()=>{$.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};x(E,t=>{t?A():z()},{immediate:!0}),l(`${h.value} - ${w.value}`);function v(t){const e=new Date(t),d=e.getFullYear(),p=(e.getMonth()+1).toString().padStart(2,"0"),y=e.getDate().toString().padStart(2,"0");return`${d}-${p}-${y}`}return l({}),l(),x([m,c],([t,e])=>{t>e&&(alert("La fecha de inicio debe ser anterior o igual a la fecha final."),c.value=t)}),(t,e)=>{const d=u("Dropdown"),p=u("MultiSelect"),y=u("InputText"),i=u("Button"),D=u("RouterLink"),H=u("RouterView"),T=u("Calendar"),G=u("Dialog");return k(),S("div",le,[s("div",ne,[s("div",ie,[n(d,{class:"text-sm col-12 p-0",modelValue:r(a).order_status,"onUpdate:modelValue":e[0]||(e[0]=o=>r(a).order_status=o),options:L.value,placeholder:"Estado"},null,8,["modelValue","options"])]),s("div",re,[n(p,{style:{},display:"chip",multiple:"",modelValue:r(a).selectedSites,"onUpdate:modelValue":e[1]||(e[1]=o=>r(a).selectedSites=o),optionLabel:"site_name",options:C.value.filter(o=>o.site_id!=12&o.site_id!=13),class:"text-sm col-12 p-0",placeholder:"Sedes"},null,8,["modelValue","options"])]),s("div",ce,[n(y,{class:"col-12 p-3",onClick:e[2]||(e[2]=o=>f.value=!0),style:{height:"2.7rem"},value:r(a).dateRangeDifference.rangeName||`${v(r(a).dateRange.startDate)}  |  ${v(r(a).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"])]),s("div",de,[n(i,{icon:"pi pi-search",severity:"help",class:"text-center p-0 col-12 md:p-0",style:{height:"2.5rem",width:"min-content","aspect-ratio":"1 / 1","font-weight":"bold","border-radius":"50%",display:"flex","justify-content":"center"},onClick:r(a).fetchSalesReport},null,8,["onClick"])])]),pe,s("div",ue,[s("div",me,[s("div",fe,[(k(!0),S(Q,null,X(P.value,o=>(k(),S("div",ve,[n(D,{to:o.to},{default:g(()=>[n(i,{size:"medium",style:ee([r(U).fullPath==o.to?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0"}]),class:"text-md px-0 pt-2 pb-4 my-0 mx-0",text:"",severity:"secondary"},{default:g(()=>[s("i",{class:I(["mr-2",o.icon])},null,2),V(" "+R(o.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256))])])]),s("div",_e,[s("div",{class:I(["p-0",r(a).visibleNotifications?"col-9":"col-12"])},[n(Z,{name:"fade"},{default:g(()=>[n(H)]),_:1})],2)]),n(G,{visible:f.value,"onUpdate:visible":e[11]||(e[11]=o=>f.value=o),modal:"",header:"Periodo",style:{width:"25rem"}},{default:g(()=>[s("div",ye,[s("div",xe,[n(i,{text:"",label:"Hoy",onClick:e[3]||(e[3]=o=>_(0)),class:"p-button-text col-12 p-1 m-0"}),n(i,{text:"",label:"Ayer",onClick:e[4]||(e[4]=o=>_(1)),class:"p-button-text col-12 p-1 m-0"}),n(i,{text:"",label:"Últimos 7 días",onClick:e[5]||(e[5]=o=>_(7)),class:"p-button-text col-12 p-1 m-0"}),n(i,{text:"",label:"Últimos 14 días",onClick:e[6]||(e[6]=o=>_(14)),class:"p-button-text col-12 p-1"}),n(i,{text:"",label:"Últimos 28 días",onClick:e[7]||(e[7]=o=>_(28)),class:"p-button-text col-12 p-0"})]),s("div",ge,[s("span",be,"Desde - "+R(v(h.value)),1),n(T,{style:{"min-width":"max-content"},modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=o=>m.value=o)},null,8,["modelValue"])]),s("div",he,[s("span",we,"Hasta - "+R(v(w.value)),1),n(T,{style:{"min-width":"max-content"},modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=o=>c.value=o),showWeek:""},null,8,["modelValue"])]),s("div",De,[s("div",ke,[n(i,{onClick:e[10]||(e[10]=()=>{r(a).setDateRange(m.value,c.value),f.value=!1,r(a).fetchSalesReport()})},{default:g(()=>[V("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},Ve=J(Se,[["__scopeId","data-v-0dbc0a8f"]]);export{Ve as default};
