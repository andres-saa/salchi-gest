import{s as M}from"./siteService-407aa805.js";import{a5 as z,_ as B,f as y,h as U,g as E,U as $,r as f,o as d,c,a as e,d as i,w as n,t as b,y as O,k as u,J as q,n as N,V as A,F as V,p as R,e as j,x as J,l as _,b as I}from"./index-7972d487.js";const F=z("directory",{persist:{key:"directory",storage:localStorage,paths:["currentSite"]},state:()=>({currentSite:{}}),getters:{},actions:{setSite(r){this.currentSite=r}}});const T=r=>(R("data-v-39dd0b30"),r=r(),j(),r),H={class:"p-0",style:{"border-radius":"1rem"}},G={class:"p-1"},K=T(()=>e("span",{class:"p-column-title"},"Code",-1)),W=T(()=>e("span",{class:"p-column-title"},"Code",-1)),Q={class:"col-12 px-1",style:{display:"flex",position:"relative","align-items":"center",gap:"0.5rem","justify-content":"end"}},X={key:0,class:"fa-solid fa-pen-to-square mr-2"},Y={key:1,class:"fa-solid fa-rotate-right mr-2"},Z=T(()=>e("i",{class:"fa-solid fa-floppy-disk mr-2"},null,-1)),ee={__name:"horarios",setup(r){const a=y(!1),x=()=>{a.value&&v().then(s=>m.value=s),a.value=!a.value},k=y(!1),m=y([]),l=y(!1),p=F();U(()=>{v().then(s=>m.value=s)}),E(()=>p.currentSite,s=>{v().then(o=>m.value=o)});const v=async()=>{l.value=!0,localStorage.getItem("siteId");try{const s=await fetch(`${$}/site-schedule/${p.currentSite.site_id}/`);if(!s.ok)throw"paila";const o=await s.json();return o.forEach(t=>{t.opening_time=new Date(`1970-01-01T${t.opening_time}`),t.closing_time=new Date(`1970-01-01T${t.closing_time}`)}),l.value=!1,o}catch(s){l.value=!1,console.log(s)}},C=async()=>{k.value=!0;try{const s=m.value.map(t=>{const D=t.opening_time instanceof Date?t.opening_time.toLocaleTimeString():t.opening_time,L=t.closing_time instanceof Date?t.closing_time.toLocaleTimeString():t.closing_time;return{...t,opening_time:D.split(" ")[0],closing_time:L.split(" ")[0]}});if(!(await fetch(`${$}/site-schedule/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw"Error al enviar los datos";a.value=!1,k.value=!1}catch(s){console.log(s),k.value=!1}},S=y(["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"]);return(s,o)=>{const t=f("Column"),D=f("Calendar"),L=f("DataTable"),P=f("Button");return d(),c(V,null,[e("div",H,[i(L,{ref:"dt",class:"",value:m.value,dataKey:"id",style:{border:"1rem",overflow:"hidden"},rows:7,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} scheldules",responsiveLayout:"scroll",scrollable:""},{default:n(()=>[i(t,{class:"p-0",field:"day_of_week",header:"Dia",headerStyle:"width:1rem; min-width:1rem;"},{body:n(h=>{var g;return[e("span",G,b((g=S.value[h.data.day_of_week-1])==null?void 0:g.slice(0,3)),1)]}),_:1}),i(t,{class:"p-0",field:"opening_time",header:"Abre",headerStyle:"width:2rem; min-width:2rem;"},{body:n(h=>[K,i(D,{class:"p-0",disabled:!a.value,hourFormat:"12",timeOnly:"",modelValue:h.data.opening_time,"onUpdate:modelValue":g=>h.data.opening_time=g},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1}),i(t,{class:"p-1",field:"closing_time",header:"Cierra",headerStyle:"width:2rem; min-width:2rem;"},{body:n(h=>[W,i(D,{disabled:!a.value,hourFormat:"12",timeOnly:"",modelValue:h.data.closing_time,"onUpdate:modelValue":g=>h.data.closing_time=g},null,8,["disabled","modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"])]),e("div",Q,[e("div",{style:O([a.value?"background-color:#a855f7":"background-color: #3b82f6;",{height:"0.4rem","border-radius":"0 1rem 1rem 0",width:"300%","max-width":"540px",position:"absolute"}])},null,4),i(P,{severity:a.value?"help":"info",onClick:x,size:"small",class:"",style:{transition:"all  .5s","min-width":"max-content","align-items":"","font-weight":"bold","border-radius":"0.5rem"}},{default:n(()=>[a.value?(d(),c("i",Y)):(d(),c("i",X)),u(" "+b(a.value?"Restablecer":"Modificar horario"),1)]),_:1},8,["severity","onClick"]),i(A,{name:"fade"},{default:n(()=>[a.value?(d(),q(P,{key:0,size:"small",severity:"success",onClick:C,style:{"font-weight":"bold","min-height":"max-content","border-radius":"0.5rem"},class:""},{default:n(()=>[Z,u(" Guardar")]),_:1})):N("",!0)]),_:1})])],64)}}},te=B(ee,[["__scopeId","data-v-39dd0b30"]]);const w=r=>(R("data-v-0ffcb432"),r=r(),j(),r),se={class:"col-12 mx-auto md:shadow-3 my-4 md:p-3",style:{"max-width":"600px","border-radius":"1rem"}},oe=w(()=>e("p",{class:"p-3 text-2xl text-center",style:{"font-weight":"bold"}},[e("i",{class:"fa-solid fa-folder-open"}),u(" Directorio")],-1)),ae={class:"p-0",style:{overflow:"hidden"}},ie={class:"grid p-0 m-0",style:{}},le={style:{"overflow-x":"auto"},class:"py-3 md:py-0"},ne={class:"p-0"},re={style:{"font-weight":"bold","min-width":"10rem"}},de={key:0,class:"",style:{"min-width":"max-content"}},ce=["href"],_e={class:"col-12 p-0 m-0",style:{display:"flex","justify-content":"start","align-items":"center"}},ue=w(()=>e("i",{class:"fa-solid fa-pen-to-square mr-2"},null,-1)),me=w(()=>e("div",{style:{"background-color":"#A855F7",height:"0.3rem","border-radius":"0 1rem 1rem 0",width:"100%"}},null,-1)),pe={class:""},he={style:{"font-weight":"bold","min-width":"10rem"}},ye=w(()=>e("div",{class:""}," ************ ",-1)),fe={class:"col-12 p-0 m-0",style:{display:"flex","justify-content":"start","align-items":"center"}},ve=w(()=>e("i",{class:"fa-solid fa-pen-to-square mr-2"},null,-1)),ge=w(()=>e("div",{style:{"background-color":"#ef4444",height:"0.3rem","border-radius":"0 1rem 1rem 0",width:"100%"}},null,-1)),be={class:"col-12 md:col-6 p-0"},we={class:"col-12"},ke=["src"],Se={class:"col-12 md:col-6 px-3"},xe={__name:"Directory",setup(r){const a=y(),x=J(),k=[{label:"Nombre",value:"site_name"},{label:"Direccion",value:"site_address"},{label:"Telefono",value:"site_phone"},{label:"Link de WhatsApp",value:"wsp_link",isLink:!0},{label:"Link de Maps",value:"maps",isLink:!0}],m=[{label:"Clave cocina",value:"kitchen_key"},{label:"Clave rappi",value:"rappi_key"},{label:"Clave pirpos",value:"pirpos_key"},{label:"Clave Didi",value:"pirpos_key"}],l=F();return y(l.currentSite),U(async()=>{await M.getSites().then(p=>a.value=p),l.setSite(a.value[0])}),E(()=>l.currentSite,p=>{x.setLoading(!0,`cargando informaciÃ³n de ${p.site_name}`),x.setLoading(!1)}),(p,v)=>{const C=f("Dropdown"),S=f("Divider"),s=f("Button");return d(),c("div",se,[oe,e("div",ae,[i(C,{modelValue:_(l).currentSite,"onUpdate:modelValue":v[0]||(v[0]=o=>_(l).currentSite=o),options:a.value,optionLabel:"site_name",style:{"max-width":"30rem"},class:"col-12 p-0 md:col-4 md:m-3",placeholder:"Sede"},null,8,["modelValue","options"]),i(S,null,{default:n(()=>[u(" Informacion")]),_:1}),e("div",ie,[e("div",le,[(d(),c(V,null,I(k,(o,t)=>e("div",{key:t,class:"my-0 p-3 py-0",style:{display:"flex","align-items":"center",gap:"1rem"}},[e("div",ne,[e("p",re,b(o.label)+":",1)]),o.isLink?(d(),c("a",{key:1,class:"",style:{"min-width":"max-content"},href:_(l).currentSite[o.value]},b(_(l).currentSite[o.value]),9,ce)):(d(),c("div",de,b(_(l).currentSite[o.value]),1))])),64))]),e("div",_e,[i(s,{style:{"min-width":"max-content"},severity:"help",class:"m-3 py-2",size:"small"},{default:n(()=>[ue,u(" Editar inform")]),_:1}),me]),i(S,null,{default:n(()=>[u(" Seguridad ")]),_:1}),(d(),c(V,null,I(m,(o,t)=>e("div",{key:t,class:"my-0 col-12 py-0",style:{display:"flex","align-items":"center",gap:"1rem"}},[e("div",pe,[e("p",he,b(o.label)+":",1)]),ye])),64)),e("div",fe,[i(s,{style:{"min-width":"max-content"},severity:"danger",class:"m-3 py-2",size:"small"},{default:n(()=>[ve,u(" Editar claves")]),_:1}),ge]),i(S,null,{default:n(()=>[u(" Horario")]),_:1}),e("div",be,[e("div",we,[_(l).currentSite.site_id?(d(),c("img",{key:"store.currentSite.site_id",style:{width:"100%","border-radius":"1rem","object-fit":"cover"},src:`${_($)}/read-product-image/600/site-${_(l).currentSite.site_id}`,alt:""},null,8,ke)):N("",!0)])]),e("div",Se,[i(te)])])])])}}},Le=B(xe,[["__scopeId","data-v-0ffcb432"]]);export{Le as default};
