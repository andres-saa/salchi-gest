import{_ as se,f as d,u as oe,Q as ae,g as $,h as A,a1 as le,z as ne,r as b,o as V,c as B,a as e,d as n,w as i,v as ie,F as re,R as de,U as C,a2 as D,k as c,t as l,q as H,l as ce,P as ue,n as pe,p as me,e as he}from"./index-d9aef6d8.js";const a=P=>(me("data-v-d1c91dd3"),P=P(),he(),P),_e={class:"col-12 m-auto p-0"},fe={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ve=a(()=>e("p",{class:"m-0 text-2xl my-4"},"Mis permisos ",-1)),ye={class:"block mt-2 md:mt-0 p-input-icon-left"},be=a(()=>e("i",{class:"pi pi-search"},null,-1)),ge=a(()=>e("span",{class:"p-column-title"},"Code",-1)),we=a(()=>e("span",{class:"p-column-title"},"Code",-1)),xe=a(()=>e("span",{class:"p-column-title"},"Code",-1)),ke=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Se=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Ce=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Pe=a(()=>e("span",{class:"p-column-title"},"Code",-1)),ze={style:{display:"flex",gap:"1rem","justify-content":"center"}},Ie=a(()=>e("div",null,null,-1)),Re={class:"a4-size p-0 lg:p-6 mi-clase mt-4"},Ee=a(()=>e("img",{class:"m-auto",src:"https://salchimonster.com/images/logo.png",style:{width:"10%"},alt:""},null,-1)),Ne={style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"}},Te=a(()=>e("h6",{class:"text-center",style:{"font-size":"11pt","font-weight":"bold",color:"black","font-family":"Arial, Helvetica, sans-serif"}}," INVERSIONES SALCHIMONSTER SAS ",-1)),je=a(()=>e("h6",{style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"},class:"text-center"},"NIT: 901.420.874-0",-1)),Le={class:"text-center py-4",style:{"font-weight":"bold","text-transform":"uppercase"}},Ue=a(()=>e("span",{style:{"text-transform":"capitalize"}},null,-1)),$e={class:"text-l",style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"}},De={class:"p-0 m-0"},Fe=a(()=>e("span",{style:{"font-weight":"bold"}},"Fecha de la solicitud: ",-1)),Me={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Oe={class:"p-0 m-0",style:{width:"100%"}},Ae=a(()=>e("span",{style:{"font-weight":"bold"}},"Nombre: ",-1)),Ve={style:{width:"100%","border-bottom":"1px solid","padding-bottom":"0","padding-right":"3rem"}},Be={class:"p-0 m-0"},He=a(()=>e("span",{style:{"font-weight":"bold"}},"Cargo: ",-1)),qe={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Je={class:"p-0 m-0"},Ke=a(()=>e("span",{style:{"font-weight":"bold"}},"IdentificaciÃ³n No: ",-1)),Qe={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Ye={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},Ge={style:{display:"flex","flex-direction":"column"},class:""},We=a(()=>e("div",{style:{"font-weight":"bold"}}," Desde ",-1)),Xe={style:{display:"flex","flex-direction":"column"}},Ze=a(()=>e("div",{style:{"font-weight":"bold"}}," Hasta ",-1)),et={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},tt={style:{display:"flex","flex-direction":"column"},class:""},st={style:{display:"flex","flex-direction":"column"}},ot=a(()=>e("div",{style:{"font-weight":"bold"}}," Observaciones ",-1)),at={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},lt={style:{display:"flex","flex-direction":"column"},class:""},nt={style:{display:"flex","flex-direction":"column"}},it=a(()=>e("div",{class:"mb-2",style:{"font-weight":"bold"}}," Estado actual ",-1)),rt={class:"mb-1"},dt=a(()=>e("span",{style:{"font-weight":"bold"}},"Resumen:",-1)),ct={class:"mb-1"},ut=a(()=>e("span",{style:{"font-weight":"bold"}},"Fecha:",-1)),pt={class:"mb-1"},mt=a(()=>e("span",{style:{"font-weight":"bold"}}," Responsable:",-1)),ht={key:0},_t=a(()=>e("span",{style:{"font-weight":"bold"}},"Motivos del rechazo:",-1)),ft={class:"col-12 md:col-6 m-auto p-0 botonera",style:{"z-index":"999",display:"flex",gap:"1rem",overflow:"hidden","justify-content":"space-around",position:"absolute",top:"4rem",right:"0","background-color":"rgba(255, 255, 255, 0)te"}},vt=a(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),yt=a(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),bt=a(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),gt=a(()=>e("h6",null,"Razones para rechazar este permiso ",-1)),wt=a(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),xt=a(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),kt=a(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),St={__name:"misPermisos",setup(P){const q=d(null),f=oe(),J=d(f.params.status),v=d(f.params.tipo),g=d(f.params.status),R=d(""),K=()=>{z.value={global:{value:null,matchMode:de.CONTAINS}}},Q=()=>{window.print()},w=d(!1),E=d("2029-12-21 16:19"),u=d(),z=d(null),_=d([]),y=d({}),N=d(!1),T=d(!1),F=d([]),Y=d(!0);ae(()=>{K()}),$(()=>f.params.status,s=>{J.value=s}),$(()=>f.params.tipo,s=>{v.value=s,console.log(v),x(s,g.value).then(t=>_.value=t)}),$(()=>f.params.status,s=>{g.value=s,x(v.value).then(t=>_.value=t)});const G=async s=>{w.value=!0,u.value=s,ee(s.employer_id)};function W(s){s.status={status:"aprobado",timestamp:E.value,responsable:D()},s.history.push({...s.status}),fetch(`${C}/permission/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(t=>{t.json(),w.value=!1,N.value=!1,x(v.value,g.value).then(r=>_.value=r)}).then(t=>console.log("Permiso aprobado:",t)).catch(t=>console.error("Error:",t))}function X(s){s.status={status:"rechazado",timestamp:E.value,razones:R.value,responsable:D()},s.history.push({...s.status}),fetch(`${C}/permission/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(t=>{t.json(),T.value=!1,w.value=!1,x(v.value,g.value).then(r=>_.value=r)}).then(t=>console.log("Permiso rechazado:",t)).catch(t=>console.error("Error:",t))}function j(s){var t=new Date(s),r={day:"numeric",month:"long",year:"numeric"};return t.toLocaleDateString("es-ES",r)}const Z=async()=>{fetch(`${C}/server_time`).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>{console.log("Employer data:",s),E.value=s}).catch(s=>{console.error("There has been a problem with your fetch operation:",s),mensaje.value="error"})};function M(s){s||(s="2029-12-21 16:19");const t=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];let[r,p]=s.split(" "),[h,L,k]=r.split("-").map(Number),U=t[L-1];return`${k} de ${U} de ${h}`}const ee=async s=>{fetch(`${C}/employer/${s}`).then(t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()}).then(t=>{console.log("Employer data:",t),y.value=t}).catch(t=>{console.error("There has been a problem with your fetch operation:",t)})},O=d([]);A(()=>{le().then(s=>O.value=s)});const I=ne();async function x(){I.setLoading(!0,"Cargando permisos");const s=await D(),t=`${C}/permissions/user/${s}  `;try{const r=await fetch(t);if(!r.ok)throw I.setLoading(!1,"Cargando permisos"),new Error(`Error al obtener los permisos: ${r.status}`);Y.value=!1;const p=await r.json();return I.setLoading(!1,"Cargando permisos"),p}catch(r){throw console.error("Error en getPermissions:",r),I.setLoading(!1,"Cargando permisos"),[r]}}return A(()=>{x(v.value,g.value).then(s=>_.value=s).catch(()=>_.value=[]),Z()}),(s,t)=>{const r=b("InputText"),p=b("Column"),h=b("Button"),L=b("DataTable"),k=b("Dialog"),U=b("Textarea");return V(),B(re,null,[e("div",_e,[n(L,{ref_key:"dt",ref:q,value:_.value,selection:F.value,"onUpdate:selection":t[1]||(t[1]=o=>F.value=o),dataKey:"id",paginator:!0,rows:10,filters:z.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} permisoes",responsiveLayout:"scroll",scrollable:"","scroll-height":"62vh"},{header:i(()=>[e("div",fe,[ve,e("span",ye,[be,n(r,{class:"",modelValue:z.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=o=>z.value.global.value=o),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:i(()=>[n(p,{class:"p-2",selectionMode:"multiple",headerStyle:"width: 3rem; ",frozen:""}),n(p,{class:"p-2",field:"id",header:"Id",sortable:!0,headerStyle:"width:3rem; min-width:min-content; "},{body:i(o=>[ge,c(l(o.data.id),1)]),_:1}),n(p,{class:"p-2",field:"tipo",header:"Tipo",sortable:!0,headerStyle:"width:10rem; min-width:min-content; "},{body:i(o=>[we,c(l(o.data.tipo),1)]),_:1}),n(p,{class:"p-2",field:"fecha",header:"Fecha de solicitud",sortable:!0,headerStyle:"width:10rem; min-width:min-content; "},{body:i(o=>{var m,S;return[xe,c(l((S=(m=o.data.history)==null?void 0:m.filter(te=>te.status=="generado")[0].timestamp)==null?void 0:S.split(" ")[0]),1)]}),_:1}),n(p,{class:"p-2",field:"start_date",header:"Fecha de inicio",sortable:!0,headerStyle:"width:15rem; min-width:10rem; "},{body:i(o=>[ke,c(l(o.data.start_date),1)]),_:1}),n(p,{class:"p-2",field:"end_date",header:"Fecha finalizacion",sortable:!0,headerStyle:"width:15rem; min-width:max-content; "},{body:i(o=>[Se,c(l(o.data.end_date),1)]),_:1}),n(p,{class:"p-2",field:"observations",header:"Observaciones del empleado",sortable:!0,headerStyle:"width:30rem; min-width:max-content; "},{body:i(o=>[Ce,c(l(o.data.observations),1)]),_:1}),n(p,{class:"p-2",field:"status.status",header:"Estado",sortable:!0,headerStyle:"width:10rem; min-width:max-content; "},{body:i(o=>[Pe,e("div",{class:H(["p-2",o.data.status.status]),style:{"border-radius":"10rem"}},l(o.data.status.status),3)]),_:1}),n(p,{class:"p-2",field:"location",header:"Acciones",sortable:!0,frozen:"",alignFrozen:"right",headerStyle:"width:1rem; min-width:min-content; "},{body:i(o=>[e("div",ze,[n(h,{class:"p-0",outlined:"",severity:"info",label:"Small",onClick:m=>G(o.data),text:""},{default:i(()=>[e("i",{class:H(["text-xl",ce(ue).EYE]),style:{"font-weight":"bold"}},null,2)]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["value","selection","filters"]),Ie]),n(k,{style:ie([{border:"none","box-shadow":"none"},{width:"700px"}]),visible:w.value,"onUpdate:visible":t[2]||(t[2]=o=>w.value=o),header:"Revizar permiso",modal:!0,class:"p-fluid m-2 pt-8"},{default:i(()=>{var o;return[e("div",Re,[Ee,e("h6",Ne,l(M(u.value.history.filter(m=>m.status=="generado")[0].timestamp)),1),Te,je,e("h6",Le,[c("FORMATO SOLICITUD DE PERMISO "+l(u.value.tipo)+" ",1),Ue]),e("h5",$e,[e("p",De,[Fe,c(),e("span",Me,l(M(u.value.history.filter(m=>m.status=="generado")[0].timestamp)),1)]),e("p",Oe,[Ae,c(),e("span",Ve,l(y.value.name),1)]),e("p",Be,[He,c(),e("span",qe,l(y.value.position),1)]),e("p",Je,[Ke,c(),e("span",Qe,l(y.value.dni),1)]),e("div",Ye,[e("div",Ge,[We,e("div",null,l(j(u.value.start_date)),1)]),e("div",Xe,[Ze,e("div",null,l(j(u.value.end_date)),1)])]),e("div",et,[e("div",tt,[e("div",st,[ot,e("div",null,l(u.value.observations),1)])])]),e("div",at,[e("div",lt,[e("div",nt,[it,e("div",rt,[dt,c(" "+l(u.value.status.status),1)]),e("div",ct,[ut,c(" "+l(j(u.value.status.timestamp)),1)]),e("div",pt,[mt,c(" "+l(O.value.filter(m=>{var S;return m.id==((S=u.value.status)==null?void 0:S.responsable)})[0].name),1)]),u.value.status.status=="rechazado"?(V(),B("div",ht,[_t,c(" "+l((o=u.value.status)==null?void 0:o.razones),1)])):pe("",!0)]),e("div",ft,[n(h,{onClick:Q,severity:"warning",style:{border:"none",display:"flex","border-radius":"10rem 3rem 0 0","justify-content":"center"}},{default:i(()=>[c(" IMPRIMIR")]),_:1})])])])])])]}),_:1},8,["visible"]),n(k,{header:"Confirmacion",visible:N.value,"onUpdate:visible":t[4]||(t[4]=o=>N.value=o),style:{width:"350px"},modal:!0},{default:i(()=>[e("h5",null,"Seguro que desea aceptar el permiso de "+l(y.value.name),1),vt,n(h,{onClick:t[3]||(t[3]=o=>W(u.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:i(()=>[yt]),_:1}),n(h,{style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:i(()=>[bt]),_:1})]),_:1},8,["visible"]),n(k,{header:"Confirmacion",visible:T.value,"onUpdate:visible":t[7]||(t[7]=o=>T.value=o),style:{width:"350px"},modal:!0},{default:i(()=>[e("h5",null,"Seguro que desea Rechazar el permiso de "+l(y.value.name)+"?",1),gt,n(U,{modelValue:R.value,"onUpdate:modelValue":t[5]||(t[5]=o=>R.value=o),style:{"max-width":"100%","min-width":"100%","min-height":"100px"},class:"col-12"},null,8,["modelValue"]),wt,n(h,{onClick:t[6]||(t[6]=o=>X(u.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:i(()=>[xt]),_:1}),n(h,{style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:i(()=>[kt]),_:1})]),_:1},8,["visible"])],64)}}},Pt=se(St,[["__scopeId","data-v-d1c91dd3"]]);export{Pt as default};
