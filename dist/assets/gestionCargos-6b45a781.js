import{_ as F,h as r,l as N,s as j,x as G,i as O,g as c,o as p,c as u,f as i,e as _,a as l,j as y,U as f,t as w,F as T,r as U,n as x,p as z,m as H}from"./index-36b32a58.js";const A=g=>(z("data-v-5a9a3b36"),g=g(),H(),g),q={class:"text-center my-3"},J={style:{display:"flex","flex-direction":"column",gap:".2rem"}},K={style:{display:"flex","flex-direction":"column",gap:".5rem",padding:"0"}},Q={class:"pl-2",style:{display:"flex",gap:"1rem","align-items":"center","min-height":"max-content","max-height":"max-content"}},W={class:"m-0",style:{"text-transform":"uppercase"}},X={class:"mx-auto mb-4",style:{"margin-top":"6rem","max-width":"50rem"}},Y=A(()=>l("h2",{class:"my-6 text-center"},[l("b",null," Gestion de cargos y accesos")],-1)),Z={style:{"margin-top":"3rem"}},ee={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},le=A(()=>l("h3",{class:"px-2"},[l("b",null,"Cargos")],-1)),te=A(()=>l("div",{style:{display:"flex",width:"100%","justify-content":"end","flex-wrap":"wrap",gap:"1rem","align-items":"center"}},null,-1)),oe={class:"m-0 p-0",style:{"text-transform":"uppercase","min-width":"max-content"}},se={__name:"gestionCargos",setup(g){const b=r({}),P=r([{}]);r([]),N();const $=r([]),C=r(!1),k=r(null);j(()=>{B()});const h=r(null),B=()=>{h.value={global:{value:null,matchMode:G.CONTAINS}}},L=async()=>{P.value=await y.get(`${f}/get-all-rol`)},S=r(""),D=async(a,t)=>{S.value=t,C.value=!0;const o=await y.get(`${f}/get_all-permission-group-by-group`,"Cargando"),m=await y.get(`${f}/get-all-rol-by-rol-id/${a}`,"Cargando"),V=m.map(d=>d.permission_id);o.forEach(d=>{d.permissions.forEach(n=>{var v;n.enrolled=V.includes(n.id),n.permission_rol_id=(v=m.find(e=>e.permission_id===n.id))==null?void 0:v.id}),d.enrolledAll=d.permissions.every(n=>n.enrolled)}),$.value=o},M=async a=>{const t=a.enrolledAll;for(const o of a.permissions)o.enrolled!==t&&(o.enrolled=t,await I(o,t))};O(async()=>{await L()});const I=async(a,t)=>{const o={rol_id:S.value.id,permission_id:a.id,status:t,permission_rol_id:a.permission_rol_id};console.log(o),await y.put(`${f}/toggle_permision/${a.permission_rol_id||1}/${t}`,o,"Cargando")};return(a,t)=>{const o=c("InputSwitch"),m=c("Button"),V=c("Dialog"),d=c("InputText"),n=c("column"),v=c("DataTable");return p(),u("div",null,[i(V,{visible:C.value,"onUpdate:visible":t[1]||(t[1]=e=>C.value=e),style:{width:"50rem"},modal:"",header:"gestion de permisos"},{default:_(()=>[l("h5",q,[l("b",null," ACCESOS - "+w(S.value.name),1)]),(p(!0),u(T,null,U($.value,(e,E)=>(p(),u("div",J,[l("div",{class:"px-2",style:x([{display:"flex",margin:".5rem 0","box-shadow":"0 0 2rem #00000040",cursor:"pointer","border-radius":"5rem","justify-content":"space-between","align-items":"center",gap:"1rem"},e.enrolledAll?"background-color:var(--primary-color) ;color: white":""]),onClick:t[0]||(t[0]=(...s)=>k.value.value.click&&k.value.value.click(...s))},[i(o,{ref_for:!0,ref_key:"toggle",ref:k,modelValue:e.enrolledAll,"onUpdate:modelValue":s=>e.enrolledAll=s,onChange:s=>M(e),style:{"min-width":"3rem"}},null,8,["modelValue","onUpdate:modelValue","onChange"]),l("h6",{class:"m-0 p-0",style:x(e.enrolledAll?"color: white":"")},[l("b",null,w(e.name),1)],4),i(m,{style:x([{padding:".3rem"},e.enrolledAll?"color:white":""]),rounded:"",onClick:s=>b.value[e.name]=!b.value[e.name],text:"",icon:"pi pi-angle-down"},null,8,["style","onClick"])],4),l("div",{style:x(b.value[e.name]?"height:max-content;":"height:0rem; overflow:hidden;")},[l("div",K,[(p(!0),u(T,null,U(e.permissions,s=>(p(),u("div",Q,[i(o,{onChange:R=>I(s,s.enrolled),modelValue:s.enrolled,"onUpdate:modelValue":R=>s.enrolled=R,style:{"min-width":"3rem"}},null,8,["onChange","modelValue","onUpdate:modelValue"]),l("h6",W,w(s.name),1)]))),256))])],4)]))),256))]),_:1},8,["visible"]),l("div",X,[Y,l("div",Z,[i(v,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Roles",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"60vh",stripedRows:"",class:"col-12 m-auto",value:P.value,tableStyle:"",filters:h.value},{header:_(()=>[l("div",ee,[le,i(d,{class:"",modelValue:h.value.global.value,"onUpdate:modelValue":t[2]||(t[2]=e=>h.value.global.value=e),placeholder:"Buscar Cargo ..."},null,8,["modelValue"])]),te]),default:_(()=>[i(n,{class:"py-2",style:{width:"80%"},header:"CARGO",field:"name"},{body:_(e=>[l("h6",oe,w(e.data.name),1)]),_:1}),i(n,{class:"py-2",style:{width:"20%"},header:"Accion",field:"name"},{body:_(e=>[i(m,{onClick:E=>D(e.data.id,e.data),icon:"pi pi-eye",text:"",class:"p-0",label:"Accesos"},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters"])])])])}}},ne=F(se,[["__scopeId","data-v-5a9a3b36"]]);export{ne as default};
