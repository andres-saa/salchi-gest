import{_ as z,x as H,h as O,r as d,l as n,o as v,c as y,a as t,d as o,F as L,b as U,U as I,t as x,y as G,n as oe,p as J,e as q,S as ae,f as c,u as le,g as k,T as ne,w as _,q as j,V as A,P as F,k as T,W as ie}from"./index-a549dd16.js";const M=u=>(J("data-v-7786c266"),u=u(),q(),u),ce={class:""},re={class:"flex align-items-center justify-content-between mb-4"},de=M(()=>t("h5",null,"Notificaciones",-1)),ue=M(()=>t("span",{class:"block text-600 font-medium mb-3"},"Sedes en linea",-1)),pe={style:{height:"100%","overflow-y":"auto"},class:"p-0 mx-0 mt-0 mb-4 list-none"},me={style:{display:"flex","align-items":"center","justify-content":"space-between"},class:"flex align-items-center py-2 border-bottom-1 surface-border"},fe={style:{display:"flex","align-items":"center"},class:"p-0"},_e={class:"w-2rem h-2rem flex align-items-center justify-content-center bg-blue-100 border-circle mr-3 flex-shrink-0"},ve=["src"],ye={class:"text-900 line-height-3"},be=M(()=>t("span",{class:"block text-600 font-medium mb-3"},"Sedes desconectadas",-1)),ge={style:{height:"100% overflow-y: auto"},class:"p-0 mx-0 mt-0 mb-4 list-none"},he={style:{display:"flex","align-items":"center","justify-content":"space-between"},class:"flex align-items-center py-2 border-bottom-1 surface-border"},xe={style:{display:"flex","align-items":"center"},class:"p-0"},we={class:"w-2rem h-2rem flex align-items-center justify-content-center bg-blue-100 border-circle mr-3 flex-shrink-0"},De=["src"],$e={class:"text-900 line-height-3"},ke={__name:"RepNotificaciones",setup(u){const s=H();return O(()=>{s.startSitesStatusUpdate()}),(S,R)=>{const w=d("Button"),E=d("Menu");return n(s).visibleNotifications?(v(),y("div",{key:0,class:"card col-12 xl:col-3 mt-3 m-0 notificaciones",style:G(n(s).visibleNotifications?"transform:scaleX(100%)":"transform:scaleX(100%);")},[t("div",ce,[t("div",re,[de,t("div",null,[o(w,{icon:"pi pi-ellipsis-v",class:"p-button-text p-button-plain p-button-rounded",onClick:R[0]||(R[0]=r=>S.$refs.menu1.toggle(r))}),o(E,{ref:"menu1",popup:!0,model:S.items},null,8,["model"])])]),ue,t("ul",pe,[(v(!0),y(L,null,U(n(s).sitesStatus.filter(r=>r.online_status),r=>(v(),y("li",me,[t("div",fe,[t("div",_e,[t("img",{style:{width:"100%","border-radius":"0.5rem","object-fit":"cover","aspect-ratio":"1 / 1"},src:`${n(I)}/read-product-image/96/site-${r.id}`,alt:""},null,8,ve)]),t("span",ye,x(r.site_name),1)]),o(w,{style:{width:"0.5rem","aspect-ratio":"1 / 1"},rounded:"",class:"p-0 mr-3 indicador",severity:"success"})]))),256))]),be,t("ul",ge,[(v(!0),y(L,null,U(n(s).sitesStatus.filter(r=>!r.online_status),r=>(v(),y("li",he,[t("div",xe,[t("div",we,[t("img",{style:{width:"100%","border-radius":"0.5rem","object-fit":"cover","aspect-ratio":"1 / 1"},src:`${n(I)}/read-product-image/96/site-${r.id}`,alt:""},null,8,De)]),t("span",$e,x(r.site_name),1)]),o(w,{style:{width:"0.5rem","aspect-ratio":"1 / 1"},rounded:"",class:"p-0 mr-3 indicador",severity:"danger"})]))),256))])])],4)):oe("",!0)}}},Se=z(ke,[["__scopeId","data-v-7786c266"]]);const W=u=>(J("data-v-d2bdf3ef"),u=u(),q(),u),Re={class:"col-12 p-0 m-0",style:{position:"relative","max-width":"1366px"},cls:""},Ve={class:"col-12 px-3 py-0 mb-3",style:{"overflow-x":"auto"}},Ce={class:"px-0 mx-0 pb-4",style:{width:"max-content","background-color":"rgba(250, 250, 250, 0)",display:"flex",color:"","justify-content":"start","align-items":"center",gap:"2rem"}},Ne={class:"contenedor mt-5",style:{position:"sticky",top:"0.8rem","z-index":"99"}},je=W(()=>t("span",{class:"text-3xl mt-8 ml-3",style:{"font-weight":"bold"}},[t("i",{class:"fa-solid fa-chart-simple"}),T(" Vision General")],-1)),Te={class:"col-12 px-3 py-0 my-3 p-2",style:{"overflow-x":"auto","background-color":"#fafafa"}},Ie={class:"px-0 mx-0",style:{width:"max-content","background-color":"#fafafa",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},Ee={class:"p-0",style:{display:"flex","align-items":"center","background-color":"rgba(245, 222, 179, 0)"}},Le=W(()=>t("div",{class:"app",style:{position:""}},null,-1)),Ue={class:"grid p-0 m-0"},Me={class:"grid"},Be={class:"col-12 px-0 mx-0"},Pe={class:"col-12",style:{display:"flex","flex-direction":"column"}},Ae={class:"text-l",style:{"font-weight":"bold"}},Fe={class:"col-12",style:{display:"flex","flex-direction":"column"}},ze={style:{"font-weight":"bold"},class:"text-l"},He={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},Oe={class:"col-12",style:{display:"flex","justify-content":"center"}},Ge={__name:"reporteVentas",setup(u){const s=H(),{isDarkTheme:S}=ae(),R=c(["enviada","cancelada","en preparacion"]),w=c("enviada"),E=le(),r=c([]),X=c([]),g=c(!1),V=c(new Date(new Date().setDate(new Date().getDate()-7))),C=c(new Date),b=c(new Date),p=c(new Date);c("");function D(a){const e=new Date,m=new Date(e);m.setDate(m.getDate()+1);const f=new Date(e);f.setDate(e.getDate()-a),b.value=f,a==1?(p.value=e,s.setDateRange(b.value,p.value),g.value=!1):(p.value=m,s.setDateRange(b.value,p.value),g.value=!1),s.fetchSalesReport()}O(()=>{K().then(a=>{r.value=a}),s.fetchSalesReport()});const Y=async()=>{const a=h(V.value),e=h(C.value),m=X.value.map(i=>i.site_id).join(","),f=new URLSearchParams({site_ids:m,status:w.value,start_date:a,end_date:e}),$=`${I}/sales_report?${f.toString()}`;try{const i=await fetch($,{method:"GET",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const N=await i.json();ie.value=N,console.log(N)}catch(i){console.error("Fetch error:",i)}};k([V,C],()=>{Y()},{deep:!0}),k(()=>s.order_status,(a,e)=>{console.log(`El estado de orden ha cambiado de ${e} a ${a}`),s.fetchSalesReport()}),k(s.selectedSites,a=>{s.setSelectedSites(a)},{deep:!0});const K=async()=>{try{const a=await fetch(`${I}/sites`);if(!a.ok)throw"paila";return await a.json()}catch(a){console.log(a)}},Q=c([{name:"Valor ventas",to:"/reporte-ventas/valor-ventas",icon:"fa-solid fa-dollar-sign"},{name:"No. Ordenes",to:"/reporte-ventas/no-ordenes",icon:"fa-solid fa-sort"},{name:"Ticket promedio",to:"/reporte-ventas/ticket",icon:"fa-solid fa-money-bill"},{name:"Ordenes",to:"/reporte-ventas/ordenes",icon:"fa-solid fa-table"}]);c(null),ne({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),c([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const B=c(null),Z=()=>{B.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},ee=()=>{B.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};k(S,a=>{a?ee():Z()},{immediate:!0}),c(`${V.value} - ${C.value}`);function h(a){const e=new Date(a),m=e.getFullYear(),f=(e.getMonth()+1).toString().padStart(2,"0"),$=e.getDate().toString().padStart(2,"0");return`${m}-${f}-${$}`}return c({}),c(),k([b,p],([a,e])=>{a>e&&(alert("La fecha de inicio debe ser anterior o igual a la fecha final."),p.value=a)}),(a,e)=>{const m=d("Dropdown"),f=d("MultiSelect"),$=d("InputText"),i=d("Button"),N=d("RouterLink"),te=d("RouterView"),P=d("Calendar"),se=d("Dialog");return v(),y("div",Re,[t("div",Ve,[t("div",Ce,[o(m,{class:"text-sm",modelValue:n(s).order_status,"onUpdate:modelValue":e[0]||(e[0]=l=>n(s).order_status=l),options:R.value,placeholder:"Estado"},null,8,["modelValue","options"]),o(f,{style:{width:"30rem"},display:"chip",multiple:"",modelValue:n(s).selectedSites,"onUpdate:modelValue":e[1]||(e[1]=l=>n(s).selectedSites=l),optionLabel:"site_name",options:r.value.filter(l=>l.site_id!=12&l.site_id!=13),class:"text-sm",placeholder:"Sedes"},null,8,["modelValue","options"]),o($,{class:"text-center",onClick:e[2]||(e[2]=l=>g.value=!0),style:{},value:n(s).dateRangeDifference.rangeName||`${h(n(s).dateRange.startDate)}  |  ${h(n(s).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"]),o(i,{severity:"info",class:"text-center p-2",style:{height:"100%",width:"min-content","aspect-ratio":"1 / 1","border-radius":"50%",display:"flex","justify-content":"center"},onClick:n(s).fetchSalesReport},{default:_(()=>[t("i",{class:j(n(F).SEARCH),style:{padding:"0.2rem"}},null,2)]),_:1},8,["onClick"])])]),t("div",Ne,[je,t("div",Te,[t("div",Ie,[(v(!0),y(L,null,U(Q.value,l=>(v(),y("div",null,[o(N,{to:l.to},{default:_(()=>[o(i,{size:"medium",style:G([n(E).fullPath==l.to?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0"}]),class:"text-md px-0 py-2 my-3 mx-0",text:"",severity:"secondary"},{default:_(()=>[t("i",{class:j(["mr-2",l.icon])},null,2),T(" "+x(l.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256)),t("div",Ee,[o(i,{size:"medium",class:"text-md px-0 py-0 mx-0 text-l btn-ocultar",text:"",onClick:n(s).toogleVisibleNotifications,severity:n(s).visibleNotifications?"danger":"success",rounded:"",style:{"font-weight":"bold"}},{default:_(()=>[t("span",null,[t("span",null,x(n(s).visibleNotifications?"Ocultar notificaciones":"Mostrar notificaciones"),1),T(),t("i",{class:j(n(F).ANGLE_DOUBLE_RIGHT)},null,2)])]),_:1},8,["onClick","severity"])])])])]),Le,t("div",Ue,[t("div",{class:j(["",n(s).visibleNotifications?"col-9":"col-12"])},[o(A,{name:"fade"},{default:_(()=>[o(te)]),_:1})],2),o(A,{name:"noti"},{default:_(()=>[o(Se)]),_:1})]),o(se,{visible:g.value,"onUpdate:visible":e[11]||(e[11]=l=>g.value=l),modal:"",header:"Periodo",style:{width:"25rem"}},{default:_(()=>[t("div",Me,[t("div",Be,[o(i,{text:"",label:"Hoy",onClick:e[3]||(e[3]=l=>D(0)),class:"p-button-text col-12 p-1 m-0"}),o(i,{text:"",label:"Ayer",onClick:e[4]||(e[4]=l=>D(1)),class:"p-button-text col-12 p-1 m-0"}),o(i,{text:"",label:"Últimos 7 días",onClick:e[5]||(e[5]=l=>D(7)),class:"p-button-text col-12 p-1 m-0"}),o(i,{text:"",label:"Últimos 14 días",onClick:e[6]||(e[6]=l=>D(14)),class:"p-button-text col-12 p-1"}),o(i,{text:"",label:"Últimos 28 días",onClick:e[7]||(e[7]=l=>D(28)),class:"p-button-text col-12 p-0"})]),t("div",Pe,[t("span",Ae,"Desde - "+x(h(V.value)),1),o(P,{style:{"min-width":"max-content"},modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=l=>b.value=l)},null,8,["modelValue"])]),t("div",Fe,[t("span",ze,"Hasta - "+x(h(C.value)),1),o(P,{style:{"min-width":"max-content"},modelValue:p.value,"onUpdate:modelValue":e[9]||(e[9]=l=>p.value=l),showWeek:""},null,8,["modelValue"])]),t("div",He,[t("div",Oe,[o(i,{onClick:e[10]||(e[10]=()=>{n(s).setDateRange(b.value,p.value),g.value=!1,n(s).fetchSalesReport()})},{default:_(()=>[T("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},qe=z(Ge,[["__scopeId","data-v-d2bdf3ef"]]);export{qe as default};
