import{r as i,G as H,D as K,i as J,q as Q,a as d,o as s,c as g,g as r,w as u,b as l,j as y,U as c,s as W,e as m,F as S,d as M,t as x,f as _,m as $,u as R,k as I}from"./index-1d3bdf93.js";import{f as X}from"./formatoPesos-8aa989a0.js";const Y={style:{"max-width":"900px"},class:"m-auto"},Z=l("h3",{style:{"margin-top":"6rem"},class:"text-center p-0 mx-0"},[l("i",{class:"fa fa-gear"}),l("b",null," ConfiguraciÃ³n del recetario ")],-1),ee={class:"m-0 my-3"},te={style:{display:"flex","justify-content":"end"}},ae={style:{"margin-top":"3rem"}},ne={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},le=l("h4",{class:"p-0"},[l("i",{class:"fa fa-bowl-rice"}),$(),l("b",null,"Productos que tienen receta")],-1),oe={style:{display:"flex","justify-content":"center"}},se=["src"],ie={style:{display:"flex",gap:".5rem","justify-content":"center"}},ce={__name:"configuracionRecetas",setup(re){const C=i({}),b=i(!1),o=i({}),D=i([{}]),T=i([]),V=i(!1),h=i(!1),E=async()=>{const t=C.value.id;await y.delete(`${c}/delete-ingredient/${t}`,"Borrando ingrediente"),h.value=!1,k()},F=async(t,a)=>{const p={status:a};let v="";a?v="Activando":v="desactivando",await y.put(`${c}/toggle_product_to_recipe/${t}`,p,v)},N=[{header:"Id",value:"id",width:"1"},{header:"Producto",value:"recipe_name",type:"max-content",width:""},{header:"Categoria",value:"category_name",width:"10"}],z=i([...N]);H(()=>{var t;return(t=z.value)==null?void 0:t.map(a=>a.value)});const j=i([{name:"Producto",fiel:"namerecipe_name",type:"text"},{name:"Unidad de medida de compra",fiel:"purchasing_unit_measure",type:"drop",Options:i(T),optionLable:"name"},{name:"precio de compra",fiel:"purchasing_price",type:"money"},{name:"Peso Bruto (Kg/Litros)",fiel:"net_gross_weight",type:"number"}]);K(o,async(t,a)=>{var p;o.value.purchasing_unit_measure_id=((p=t.purchasing_unit_measure)==null?void 0:p.id)||null},{deep:!0});const B=async()=>{const t=o.value;if(!t.name||!t.purchasing_unit_measure_id||!t.purchasing_price||!t.net_gross_weight){alert("Por favor llene todos los campos");return}V.value?await y.post(`${c}/update-ingredient/${o.value.id}`,t,"Editando ingrediente"):await y.post(`${c}/create-ingredient`,t,"creando un nuevo ingrediente"),k(),b.value=!1},k=async()=>{D.value=await y.get(`${c}/list-recipes`,"cargando ingredientes"),T.value=await y.get(`${c}/daily_inventory_unit_measures`)};J(async()=>{k()});const f=i(null),O=()=>{f.value={global:{value:null,matchMode:W.CONTAINS}}};return Q(()=>{O()}),(t,a)=>{const p=d("inputText"),v=d("Dropdown"),P=d("InputNumber"),w=d("Button"),L=d("Dialog"),q=d("InputText"),U=d("column"),A=d("InputSwitch"),G=d("DataTable");return s(),g("div",Y,[Z,r(L,{style:{width:"30rem"},header:V.value?"Actualizar Ingrediente":"Nuevo Ingrediente",class:"mx-2",visible:b.value,"onUpdate:visible":a[0]||(a[0]=e=>b.value=e),modal:""},{footer:u(()=>[V.value?(s(),m(w,{key:1,onClick:B,severity:"help",label:"Modificar ingrediente"})):(s(),m(w,{key:0,onClick:B,severity:"help",label:"Guardar ingrediente"}))]),default:u(()=>[(s(!0),g(S,null,M(j.value,e=>(s(),g("div",null,[l("h6",ee,x(e.name),1),e.type=="text"?(s(),m(p,{key:0,modelValue:o.value[e.fiel],"onUpdate:modelValue":n=>o.value[e.fiel]=n,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):_("",!0),e.type=="drop"?(s(),m(v,{key:1,options:e.Options,optionLabel:"name",modelValue:o.value[e.fiel],"onUpdate:modelValue":n=>o.value[e.fiel]=n,style:{width:"100%"}},null,8,["options","modelValue","onUpdate:modelValue"])):_("",!0),e.type=="money"?(s(),m(P,{key:2,modelValue:o.value[e.fiel],"onUpdate:modelValue":n=>o.value[e.fiel]=n,style:{width:"100%"},prefix:"$",locale:"es-ES","max-fraction-digits":"3"},null,8,["modelValue","onUpdate:modelValue"])):_("",!0),e.type=="number"?(s(),m(P,{key:3,modelValue:o.value[e.fiel],"onUpdate:modelValue":n=>o.value[e.fiel]=n,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3"},null,8,["modelValue","onUpdate:modelValue"])):_("",!0),e.type=="persent"?(s(),m(P,{key:4,modelValue:o.value[e.fiel],"onUpdate:modelValue":n=>o.value[e.fiel]=n,style:{width:"100%"},suffix:"%",locale:"es-ES","max-fraction-digits":"3"},null,8,["modelValue","onUpdate:modelValue"])):_("",!0)]))),256))]),_:1},8,["header","visible"]),r(L,{class:"mx-2",header:"Eliminar ingrediente",visible:h.value,"onUpdate:visible":a[3]||(a[3]=e=>h.value=e),modal:""},{footer:u(()=>[l("div",te,[r(w,{size:"small",label:"cancelar",onClick:a[1]||(a[1]=e=>h.value=!1),severity:"help"}),r(w,{size:"small",onClick:a[2]||(a[2]=e=>E()),label:"Eliminar ingrediente",severity:"danger",text:""})])]),default:u(()=>[l("h6",null,[$("seguro que desea eliminar el Ingrediente "),l("b",null,x(C.value.ingredient_name),1),$(" ?")])]),_:1},8,["visible"]),l("div",ae,[r(G,{paginator:!0,rows:10,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} recetas",rowsPerPageOptions:[5,10,15,25,100],scrollable:"",showGridlines:"",scrollHeight:"67vh",stripedRows:"",class:"col-12 m-auto",value:D.value,tableStyle:"min-width: 50rem;",filters:f.value},{header:u(()=>[l("div",ne,[le,r(q,{class:"",modelValue:f.value.global.value,"onUpdate:modelValue":a[4]||(a[4]=e=>f.value.global.value=e),placeholder:"Buscar receta ..."},null,8,["modelValue"])])]),default:u(()=>[r(U,{header:"foto",class:"py-1 px-0",style:{"max-width":"2.2rem"}},{body:u(e=>[l("div",oe,[l("img",{class:"p-0 shadow-2",style:{width:"2rem","border-radius":".3rem","background-color":"white"},src:`${R(c)}/read-product-image/96/${e.data.recipe_name}`,alt:""},null,8,se)])]),_:1}),(s(),g(S,null,M(N,e=>r(U,{header:e.header,style:I([{},`min-width:${e.width}rem`]),field:e.value,class:"py-2"},{body:u(n=>[e.type=="money"?(s(),g("h6",{key:0,style:I([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},x(R(X)(n.data[e.value])||"-----------"),5)):(s(),g("h6",{key:1,style:I([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},x(n.data[e.value]||"-----------"),5))]),_:2},1032,["header","style","field"])),64)),r(U,{header:"Tiene receta?",style:{"max-width":"4rem"},field:"name",class:"py-0 px-0 m-0",frozen:"",alignFrozen:"right"},{body:u(e=>[l("div",ie,[r(A,{onChange:n=>F(e.data.id,e.data.has_recipe),modelValue:e.data.has_recipe,"onUpdate:modelValue":n=>e.data.has_recipe=n},null,8,["onChange","modelValue","onUpdate:modelValue"])])]),_:1})]),_:1},8,["value","filters"])])])}}};export{ce as default};
