import{_ as de,j as p,y as ee,ai as ye,I as H,k as L,K as ce,H as K,r as h,o as l,c,a as e,F as U,b as M,g as V,d as ae,u as _,i as q,e as o,M as oe,h as b,t as w,f as d,aj as Q,ad as le,q as ue,x as pe,m as ie,U as Y,l as be,z as fe,G as ge,A as we,av as E,n as ne,N as re,p as Z}from"./index-9852904f.js";/* empty css                                                                  */import{D as xe}from"./DialogoPedido-cf57faa7.js";import"./index-558f534d.js";import{O as W}from"./OrderItem-015bdef8.js";import{s as ke}from"./siteService-85c66ecb.js";import{e as Pe}from"./formatDate-262296cf.js";import"./formatoPesos-2293ab52.js";import"./_commonjsHelpers-23102255.js";const v=x=>(ue("data-v-be1bba1f"),x=x(),pe(),x),Se={class:"kitchen-layout xl:mx-0 mx-0 py-0 mt-6 px-0",style:{"background-color":"white",width:"100%"}},Oe={key:0,class:"aside-static"},De={class:"aside-card shadow-2"},Ve=v(()=>e("div",{class:"aside-header"},[e("i",{class:"pi pi-map-marker"}),e("b",null,"SEDES")],-1)),$e={class:"sites-scroll"},Ce={class:"main-area"},Te={class:"topbar shadow-1"},Ie={class:"left-wrap"},Re={class:"search-wrap"},Be={key:0,class:"col-12 p-3"},ze=v(()=>e("div",{class:"empty-state"},[e("i",{class:"pi pi-inbox empty-icon","aria-hidden":"true"}),e("p",{class:"empty-text"},"hoy no tenemos pedidos para esta sede aun.")],-1)),Ue=[ze],Me={class:"sections-row"},Ne={class:"section-col"},Ae={class:"panel-wrap"},Ee={class:"shadow-4 contenedor panel",style:{overflow:"hidden","background-color":"#ffad53"}},Le={style:{height:"100%",width:"100%"}},qe={class:"col-12 text-center shadow-4 panel-header"},je={class:"text-center text-2xl",style:{color:"black","font-weight":"bold"}},Fe=v(()=>e("i",{class:"pi pi-envelope text-2xl","aria-hidden":"true"},null,-1)),He={class:"badge-count"},Ke={class:"lg:pb-8 panel-body",style:{height:"100%","overflow-y":"auto"}},Ge={key:0,class:"sub-empty-state"},Xe=v(()=>e("i",{class:"pi pi-inbox","aria-hidden":"true"},null,-1)),Je=v(()=>e("span",null,'sin pedidos "recibidos"',-1)),Qe=[Xe,Je],We={class:"section-col"},Ye={class:"panel-wrap"},Ze={class:"shadow-4 contenedor panel",style:{overflow:"hidden","background-color":"#8e3693"}},et={style:{height:"100%",width:"100%"}},tt={class:"col-12 text-center shadow-4 panel-header"},st={class:"text-center text-2xl",style:{color:"black","font-weight":"bold"}},at=v(()=>e("i",{class:"pi pi-clock text-2xl","aria-hidden":"true"},null,-1)),ot={class:"badge-count"},lt={class:"lg:pb-8 panel-body",style:{height:"100%","overflow-y":"auto"}},it={key:0,class:"sub-empty-state"},nt=v(()=>e("i",{class:"pi pi-inbox","aria-hidden":"true"},null,-1)),rt=v(()=>e("span",null,'sin pedidos "en preparación"',-1)),dt=[nt,rt],ct={class:"section-col"},ut={class:"panel-wrap"},pt={class:"shadow-4 contenedor panel",style:{overflow:"hidden","background-color":"#00bf7a"}},_t={class:"lg:pb-8 panel-body",style:{height:"100%",width:"100%"}},ht={class:"col-12 text-center shadow-4 panel-header"},vt={class:"text-center text-2xl",style:{color:"black","font-weight":"bold"}},mt=v(()=>e("i",{class:"pi pi-send text-2xl","aria-hidden":"true"},null,-1)),yt={class:"badge-count"},bt={style:{height:"100%","overflow-y":"auto"}},ft={key:0,class:"sub-empty-state"},gt=v(()=>e("i",{class:"pi pi-inbox","aria-hidden":"true"},null,-1)),wt=v(()=>e("span",null,'sin pedidos "enviados"',-1)),xt=[gt,wt],kt={key:0,class:"section-col"},Pt={class:"panel-wrap"},St={class:"shadow-4 contenedor panel",style:{overflow:"hidden","background-color":"red"}},Ot={class:"lg:pb-8 panel-body",style:{height:"100%",width:"100%"}},Dt={class:"col-12 text-center shadow-4 panel-header"},Vt={class:"text-center text-2xl",style:{color:"black","font-weight":"bold"}},$t=v(()=>e("i",{class:"pi pi-times text-2xl","aria-hidden":"true"},null,-1)),Ct={class:"badge-count"},Tt={style:{height:"100%","overflow-y":"auto"}},It=v(()=>e("div",{class:"aside-header"},[e("i",{class:"pi pi-map-marker"}),e("b",null,"SEDES")],-1)),Rt={class:"sites-scroll"},Bt={__name:"DialogoPedidoDistri",setup(x){const k=p([]),i=ee(),m=ye(),y=p(""),P=p(""),N=p(!1),I=H(()=>i.TodayOrders.filter(u=>u.current_status==="generada")),R=H(()=>i.TodayOrders.filter(u=>u.current_status==="en preparacion")),$=H(()=>i.TodayOrders.filter(u=>u.current_status==="enviada")),S=H(()=>i.TodayOrders.filter(u=>u.current_status==="cancelada")),B=H(()=>I.value.length+R.value.length+$.value.length+S.value.length);L(()=>{i.startOrderUpdates()}),ce(()=>{i.stopOrderUpdates()}),L(async()=>{k.value=await ke.getSites(),i.getTodayOrders()}),K(()=>m.site,()=>{i.getTodayOrders()}),K(y,()=>{P.value=""}),K(P,()=>{y.value=""});const f=()=>{var u;y.value!==""?O(y.value):P.value!==""&&G((u=P.value)==null?void 0:u.split(" ").join(""))},O=async u=>{const n=await le.getOrderById(u);n!=null&&n.order_id?(i.setVisible("currentOrder",!0),i.setOrder(n),i.currentSearchingOrder=n):alert("Orden no encontrada")},G=async u=>{const n=await le.getOrderByPhone(u);n!=null&&n.order_id?(i.setVisible("currentOrder",!0),i.setOrder(n),m.site=k.value.filter(C=>C.site_id==n.site_id)[0],i.currentSearchingOrder=n):alert("Orden no encontrada")};return(u,n)=>{const C=h("Button"),A=h("InputText"),T=h("InputMask"),X=h("Sidebar");return l(),c("div",Se,[k.value.length?(l(),c("aside",Oe,[e("div",De,[Ve,e("div",$e,[(l(!0),c(U,null,M(k.value.filter(t=>t.show_on_web),t=>{var r,a;return l(),V(C,{key:t.site_id,class:ae(["site-item",{active:((r=_(m).site)==null?void 0:r.site_id)===t.site_id}]),text:"",label:t.site_name,"aria-pressed":((a=_(m).site)==null?void 0:a.site_id)===t.site_id,onClick:J=>_(m).site=t},null,8,["class","label","aria-pressed","onClick"])}),128))])])])):q("",!0),e("main",Ce,[e("div",Te,[e("div",Ie,[k.value.length?(l(),V(C,{key:0,class:"toggle-aside",icon:"pi pi-bars",label:"Sedes",onClick:n[0]||(n[0]=t=>N.value=!0)})):q("",!0)]),e("div",Re,[o(A,{modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=t=>y.value=t),modelModifiers:{trim:!0},placeholder:"Buscar por id (sin #)",inputmode:"numeric",autocomplete:"off","aria-label":"Buscar por ID de orden",onKeyup:oe(f,["enter"])},null,8,["modelValue"]),o(T,{modelValue:P.value,"onUpdate:modelValue":n[2]||(n[2]=t=>P.value=t),prefix:"+57",id:"basic",mask:"999 999 9999",placeholder:"Buscar por teléfono",autocomplete:"tel","aria-label":"Buscar por número de teléfono",onKeyup:oe(f,["enter"])},null,8,["modelValue"]),o(C,{onClick:f,severity:"help",icon:"pi pi-search",label:"Buscar",disabled:!y.value&&!P.value},null,8,["disabled"])])]),o(xe),B.value===0?(l(),c("div",Be,Ue)):q("",!0),e("div",Me,[e("section",Ne,[e("div",Ae,[e("div",Ee,[e("div",Le,[e("p",qe,[e("span",je,[Fe,b(" RECIBIDOS "),e("small",He,w(I.value.length),1)])]),e("div",Ke,[I.value.length?(l(),V(Q,{key:1,name:"fade",tag:"div"},{default:d(()=>[(l(!0),c(U,null,M(I.value,t=>(l(),c("div",{class:"px-3 py-2",key:`recibida-${t.order_id}`},[o(W,{order:t},null,8,["order"])]))),128))]),_:1})):(l(),c("div",Ge,Qe))])])])])]),e("section",We,[e("div",Ye,[e("div",Ze,[e("div",et,[e("p",tt,[e("span",st,[at,b(" EN PREPARACIÓN "),e("small",ot,w(R.value.length),1)])]),e("div",lt,[R.value.length?(l(),V(Q,{key:1,name:"fade",tag:"div"},{default:d(()=>[(l(!0),c(U,null,M(R.value,t=>(l(),c("div",{class:"px-3 py-2",key:`prep-${t.order_id}`},[o(W,{order:t},null,8,["order"])]))),128))]),_:1})):(l(),c("div",it,dt))])])])])]),e("section",ct,[e("div",ut,[e("div",pt,[e("div",_t,[e("p",ht,[e("span",vt,[mt,b(" ENVIADOS "),e("small",yt,w($.value.length),1)])]),e("div",bt,[$.value.length?(l(),V(Q,{key:1,name:"fade",tag:"div"},{default:d(()=>[(l(!0),c(U,null,M($.value,t=>(l(),c("div",{class:"px-3 py-2",key:`env-${t.order_id}`},[o(W,{id:t.order_id,order:t},null,8,["id","order"])]))),128))]),_:1})):(l(),c("div",ft,xt))])])])])]),S.value.length?(l(),c("section",kt,[e("div",Pt,[e("div",St,[e("div",Ot,[e("p",Dt,[e("span",Vt,[$t,b(" CANCELADOS "),e("small",Ct,w(S.value.length),1)])]),e("div",Tt,[o(Q,{name:"fade",tag:"div"},{default:d(()=>[(l(!0),c(U,null,M(S.value,t=>(l(),c("div",{class:"px-3 py-2",key:`canc-${t.order_id}`},[o(W,{order:t},null,8,["order"])]))),128))]),_:1})])])])])])):q("",!0)])]),o(X,{visible:N.value,"onUpdate:visible":n[3]||(n[3]=t=>N.value=t),position:"left",modal:"",class:"aside-mobile",dismissable:!0},{header:d(()=>[It]),default:d(()=>[e("div",Rt,[(l(!0),c(U,null,M(k.value.filter(t=>t.show_on_web),t=>{var r,a;return l(),V(C,{key:t.site_id,class:ae(["site-item",{active:((r=_(m).site)==null?void 0:r.site_id)===t.site_id}]),text:"",label:t.site_name,"aria-pressed":((a=_(m).site)==null?void 0:a.site_id)===t.site_id,onClick:J=>{_(m).site=t,N.value=!1}},null,8,["class","label","aria-pressed","onClick"])}),128))])]),_:1},8,["visible"])])}}},zt=de(Bt,[["__scopeId","data-v-be1bba1f"]]);const j=x=>(ue("data-v-d15397ac"),x=x(),pe(),x),Ut={class:"container",style:{"margin-top":"7rem",display:"flex","flex-direction":"column"}},Mt=["src"],Nt=j(()=>e("p",{class:"text-4xl text-center px-4",style:{"font-weight":"bold","margin-top":"0rem"}}," Pedidos Pendidentes Distrimonster ",-1)),At=j(()=>e("h3",null,[e("b",null,"Rechazar orden")],-1)),Et=j(()=>e("h3",null,[e("b",null,"Aprobar esta orden")],-1)),Lt={style:{"max-width":"1280px"},class:"mx-auto"},qt={class:"slider mx-auto",style:{display:"flex",overflow:"hidden"}},jt={class:"grid",style:{"align-items":"center","justify-content":"space-between"}},Ft=j(()=>e("div",{class:"col-12 md:col-6 p-3"},[e("span",{class:"text-xl",style:{width:"100%"}},[b(" Pedidos pendientes de validacion"),e("span",{style:{"text-transform":"capitalize"}})])],-1)),Ht={class:"md:mt-0 p-input-icon-right m-3"},Kt=j(()=>e("i",{class:"pi pi-search"},null,-1)),Gt={style:{display:"flex",gap:"0.5rem"}},Xt={class:"grid p-3 mt-4",style:{"align-items":"center","justify-content":"start",display:"flex",gap:"1rem"}},Jt={class:"px-2 m-0"},Qt=j(()=>e("i",{class:"fa-regular fa-bars-progress"},null,-1)),Wt={style:{"text-transform":"uppercase"}},Yt={class:"m-0"},Zt={__name:"ValidateSectionDistri",setup(x){const k=p([]);p([{columnName:"SEDE",columnValue:"sede",columnType:"other",size:"1rem",vif:!0},{columnName:"ASESOR",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);const i=p({start_date:new Date,end_date:new Date,sites:[]}),m=p([]),y=ee();L(()=>{f.bar_color="#FF0042",f.colorized=!1}),ce(()=>{f.bar_color="rgba(0, 1, 22, 1)",f.colorized=!0});const P=r=>{y.setVisible("currentOrderDistri",!0),y.setOrder(r)},N=async r=>{const a=f.rawUserData.id;await E.aproveOrder(r,a),B.value=!1,t()},I=async()=>{const r=await ie.post(`${Y}/transaction_report/`,{start_date:i.value.start_date,end_date:i.value.end_date,sites:i.value.sites.map(a=>a.site_id)});R.value=r,r!=null&&r[0]&&(m.value=Object.keys(r[0]))},R=p([]);L(async()=>{k.value=await ie.get(`${Y}/sites/`),await I()});const $=p(!1),S=p([]),B=p(!1),f=be(),O=p({});p([{index:1,slide:0,name:"Basico"},{index:2,slide:-100,name:"reportes"}]);const G=p({index:1,slide:0,name:"Basico"});new Audio("/sound/pip1.wav"),new Audio("/sound/pip2.wav"),new Audio("/sound/pip3.wav"),new Audio("/sound/pip4.wav"),ee(),p(null);const u={revisar:E.getPendientsCancellationRequest,aprobadas:E.getaceptedCancellationAcepted,rechazadas:E.getPendientsCancellationRejected};fe(()=>{X()}),K(()=>y.numberOders,()=>{t()});const n=r=>{B.value=!0,O.value.order_id=r},C=async(r,a,J)=>{const z={authorized:r,responsible_id:f.rawUserData.id,responsible_observation:O.value.reason||"sin observaciones"};await E.resolveCancellationRequest(a,z),B.value=!1,$.value=!1,S.value=await u.revisar()},A=ge(),T=p(),X=()=>{T.value={global:{value:null,matchMode:we.CONTAINS}}};X(),L(()=>{t()}),L(async()=>{t()});const t=async()=>{S.value=await E.getOrdersValidateDistri()};return K(()=>A.params.request_status,async()=>{S.value=await u.revisar()},{deep:!0}),(r,a)=>{const J=h("Textarea"),z=h("Button"),te=h("Dialog"),_e=h("InputText"),g=h("Column"),se=h("DataTable"),he=h("Calendar"),ve=h("calendar"),me=h("MultiSelect");return l(),c("div",Ut,[e("img",{src:`${_(Y)}/read-photo-product/iX6UiE6e`,alt:"",style:{height:"5rem",width:"min-content",margin:"auto"}},null,8,Mt),Nt,o(te,{visible:$.value,"onUpdate:visible":a[2]||(a[2]=s=>$.value=s),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:d(()=>[At]),default:d(()=>[e("form",{onSubmit:a[1]||(a[1]=re(s=>C(!1,O.value.id,O.value.reason),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[o(J,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:O.value.reason,"onUpdate:modelValue":a[0]||(a[0]=s=>O.value.reason=s),rows:"5",placeholder:"Porque desea rechazar esta solicitud?"},null,8,["modelValue"]),o(z,{style:{width:"100%","border-radius":"0.5rem"},label:"Rechazar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),o(te,{visible:B.value,"onUpdate:visible":a[4]||(a[4]=s=>B.value=s),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:d(()=>[Et]),default:d(()=>[e("form",{onSubmit:a[3]||(a[3]=re(s=>N(O.value.order_id),["prevent"])),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[o(z,{style:{width:"100%","border-radius":"0.5rem"},label:"Aprobar (usuario contactado)",type:"submit",class:"p-button-success"})],32)]),_:1},8,["visible"]),e("div",Lt,[e("div",qt,[e("div",{style:ne(`transform:translateX(${G.value.slide}%)`),class:"slider-item"},[o(se,{paginator:!0,rows:15,filters:T.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",scrollHeight:"65vh",stripedRows:"",style:{},"onUpdate:filters":a[6]||(a[6]=s=>T.value=s),class:"col-12 m-auto",value:S.value,tableStyle:"min-width: 50rem;"},{header:d(()=>[e("div",jt,[Ft,e("span",Ht,[Kt,o(_e,{class:"",modelValue:T.value.global.value,"onUpdate:modelValue":a[5]||(a[5]=s=>T.value.global.value=s),placeholder:"Buscar Solicitud..."},null,8,["modelValue"])])])]),default:d(()=>[o(g,{style:{},class:"py-1",field:"order_id",header:"ID orden",frozen:""}),o(g,{style:{},class:"py-1",field:"total_order_price",header:"Monto de la orden"},{body:d(s=>[b(w(_(Z)(s.data.total_order_price)),1)]),_:1}),o(g,{style:{},class:"py-1",field:"total_order_price",header:"Hora"},{body:d(s=>[b(w(_(Pe)(s.data.latest_status_timestamp)),1)]),_:1}),o(g,{style:{},class:"py-1",field:"delivery_price",header:"Domicilio"},{body:d(s=>{var D,F;return[b(w(_(Z)((F=(D=s.data.pe_json)==null?void 0:D.delivery)==null?void 0:F.delivery_costoenvio)),1)]}),_:1}),o(g,{style:{},class:"py-1",field:"Total",header:"Total"},{body:d(s=>{var D,F;return[b(w(_(Z)(((F=(D=s.data.pe_json)==null?void 0:D.delivery)==null?void 0:F.delivery_costoenvio)+s.data.total_order_price)),1)]}),_:1}),o(g,{style:{},class:"py-1",field:"user_name",header:"Cliente"}),o(g,{style:{},class:"py-1",field:"user_phone",header:"Telefono cliente"}),o(g,{style:{"max-width":"10rem"},class:"py-1",field:"order_notes",header:"Notas"}),o(g,{style:{},class:"py-1 px-0",field:"date",header:"Action",frozen:"",alignFrozen:"right"},{body:d(s=>[e("div",Gt,[_(A).params.request_status!="aprobadas"?(l(),V(z,{key:0,size:"",onClick:D=>P(s.data),style:{height:"1.8rem",width:"2rem"},severity:"info",class:"p-1",icon:"pi pi-eye"},null,8,["onClick"])):q("",!0),_(A).params.request_status!="aprobadas"?(l(),V(z,{key:1,size:"",onClick:D=>n(s.data.order_id),style:{height:"1.8rem",width:"2rem"},severity:"success",class:"p-1",icon:"pi pi-check"},null,8,["onClick"])):q("",!0)])]),_:1})]),_:1},8,["filters","value"])],4),e("div",{style:ne(`transform:translateX(${G.value.slide}%)`),class:"slider-item"},[o(se,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Transferencias",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",stripedRows:"",class:"col-12 p-2",value:R.value,tableStyle:"min-width: 50rem;",filters:T.value},{header:d(()=>[e("div",Xt,[e("h4",Jt,[Qt,b(),e("b",Wt,[b("Pedidos pendientes "),e("b",null,w(_(A).params.section),1)])]),o(he,{modelValue:i.value.start_date,"onUpdate:modelValue":a[7]||(a[7]=s=>i.value.start_date=s)},null,8,["modelValue"]),o(ve,{modelValue:i.value.end_date,"onUpdate:modelValue":a[8]||(a[8]=s=>i.value.end_date=s)},null,8,["modelValue"]),o(me,{style:{"max-width":"30rem"},modelValue:i.value.sites,"onUpdate:modelValue":a[9]||(a[9]=s=>i.value.sites=s),optionLabel:"site_name",options:k.value.filter(s=>s.show_on_web)},null,8,["modelValue","options"]),o(z,{severity:"help",onClick:I,label:"Buscar",icon:"pi pi-search"})])]),default:d(()=>[(l(!0),c(U,null,M(m.value,s=>(l(),V(g,{class:"py-1",style:{"text-transform":"uppercase"},header:s},{body:d(D=>[e("h6",Yt,w(D.data[s]),1)]),_:2},1032,["header"]))),256))]),_:1},8,["value","filters"])],4)])]),o(zt)])}}},ds=de(Zt,[["__scopeId","data-v-d15397ac"]]);export{ds as default};
