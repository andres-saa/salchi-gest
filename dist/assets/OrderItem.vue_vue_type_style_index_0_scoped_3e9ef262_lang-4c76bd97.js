import{_ as Z,r as b,Z as G,i as J,j as U,U as B,a as O,o as n,c as d,g as i,w as p,b as e,a2 as P,u as s,a1 as $,m,t as r,e as F,f as v,n as x,F as N,d as R,p as K,h as Q}from"./index-1d3bdf93.js";import{f as k}from"./formatoPesos-8aa989a0.js";const o=D=>(K("data-v-9caee8a8"),D=D(),Q(),D),W=o(()=>e("h3",null,[e("b",null,"TRASLADO DE SEDE")],-1)),X=o(()=>e("span",{for:"responsible"},"SELECCIONE LA SEDE DESTINO",-1)),Y=o(()=>e("h3",null,[e("b",null,"Cancelar Orden")],-1)),ee=o(()=>e("span",{class:"advert",style:{"text-transform":"lowercase",color:"red","font-weight":"bold"}}," Desde el 16 de mayo de 2024, la cancelación de órdenes requerirá autorización.",-1)),te=o(()=>e("span",{for:"responsible"},"Responsable",-1)),se=o(()=>e("span",{for:"reason"},"Razón",-1)),le={style:{"text-transform":"capitalize"}},re={class:"col-12 mb-0 pb-0 px-0 m-0",style:{display:"flex","justify-content":"space-between",gap:"1rem"}},oe={id:"factura",style:{width:"100%"}},ae=o(()=>e("i",{class:"pi pi-whatsapp mr-2"},null,-1)),ne=o(()=>e("br",null,null,-1)),ie={class:"",style:{width:"auto",color:"black"}},de=o(()=>e("br",null,null,-1)),ce=o(()=>e("b",null,"responsable",-1)),ue=o(()=>e("br",null,null,-1)),pe=o(()=>e("b",null,"Razon",-1)),_e={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},me={class:"",id:"id",style:{"font-weight":"bold","min-width":"100%",width:"max-content","text-align":"center",color:"black",margin:"0rem"}},be={style:{padding:"0",color:"black",margin:"auto","margin-bottom":"1rem",width:"max-content","min-width":"max-content"}},ve=o(()=>e("div",{class:"",style:{"font-weight":"bold",color:"white",margin:"0","background-color":"black","align-items":"center",display:"grid","grid-template-columns":"auto auto"}},[e("div",{style:{width:"100%"}},[e("b",null," productos")]),e("div",null,[e("p",{style:{"text-align":"end","font-weight":"bold"}},[e("b",null," total ")])])],-1)),ye={style:{display:"grid","grid-template-columns":"auto auto"}},he={style:{"text-align":"end",color:"black"}},ge=o(()=>e("div",{style:{"background-color":"rgba(0, 0, 0, 0.286)",height:"1px"}},null,-1)),fe={style:{"background-color":"black","font-weight":"bold",color:"white",width:"100%",margin:"0"}},we={style:{display:"grid","grid-template-columns":"auto 20%","align-items":"center"}},Oe={style:{"text-align":"end",color:"black"}},xe=o(()=>e("div",{style:{"background-color":"rgba(0, 0, 0, 0.286)",height:"1px"}},null,-1)),ke={class:"",style:{display:"grid",color:"","margin-top":"0.5rem","grid-template-columns":"auto auto"}},De=o(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Subtotal")])],-1)),Ee={class:""},Se={style:{"text-align":"end","font-weight":"bold",color:"black"}},Ce=o(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold"}},[e("b",null,"Domicilio")])],-1)),Ve={class:""},ze={style:{"text-align":"end","font-weight":"bold",color:"black"}},Te=o(()=>e("div",{class:""},[e("span",{style:{"font-weight":"bold",color:"black"}},[e("b",null,"Total")])],-1)),$e={class:""},Ne={style:{"text-align":"end",color:"black","font-weight":"bold"}},Re=o(()=>e("div",{class:""},null,-1)),Ae=o(()=>e("p",{style:{"font-weight":"bold","background-color":"black",color:"white",padding:"0",margin:"0","margin-top":"0.5rem"}},[e("b",null,"Notas")],-1)),Ie={class:"notas",style:{border:"1px solid",margin:"0",color:"black",padding:"0.5rem"}},Ue=o(()=>e("p",{style:{"background-color":"black","font-weight":"bold","margin-top":"1rem",color:"white"}},[e("b",null,"cliente")],-1)),Be={style:{display:"grid","grid-template-columns":"auto auto"}},Pe=o(()=>e("div",{class:"",style:{}},[e("span",null,[e("b",null,"NOMBRE")])],-1)),Fe={class:""},Me={style:{"text-align":"end",color:"black"}},Le=o(()=>e("div",{style:{}},[e("span",null,[e("b",null,"telefono")])],-1)),qe={style:{"text-align":"end",color:"black"}},He=o(()=>e("div",{style:{}},[e("span",null,[e("b",null,"direccion ")])],-1)),je={style:{"text-align":"end",color:"black"}},Ze=o(()=>e("div",null,[e("span",null,[e("b",null,"metodo de pago")])],-1)),Ge={style:{"text-align":"end",color:"black"}},Je={class:"col-12 px-0",style:{display:"flex",gap:"1rem"}},Ke={__name:"DialogoPedido",setup(D){const V=b(0),z=b(!1),t=G(),E=c=>{const l=new Date(c),f=l.getHours(),u=l.getMinutes(),y=f>=12?"pm":"am",w=f%12||12,C=w<10?"0"+w:w,a=u<10?"0"+u:u;return`${C}:${a} ${y}`},M=async()=>{var l;const c={order_id:t.currentOrder.order_id,responsible:(l=_.value.responsible)==null?void 0:l.name,reason:_.value.reason};await $.create_cancellling_request(c),z.value=!1,t.Notification.pause(),t.Notification.currentTime=0},g=b(!1),A=b([]);J(async()=>{t.currentOrder.value=t.currentOrder,A.value=await U.get(`${B}/sites`)});const L=b(!1),S=b(!1),_=b({responsible:null,reason:"Sin razon"}),q=b([{name:"Restaurante",value:"restaurant"},{name:"Cliente",value:"client"}]),H=()=>{_.value.responsible&&$.cancelOrder(t.currentOrder.order_id,_.value.reason,_.value.responsible.name).then(c=>{c&&(L.value=!1,console.log("Order canceled successfully"))}).catch(c=>{console.error("Failed to cancel order:",c)})},j=async()=>{const c=t.currentOrder.order_id,l=V.value;await U.put(`${B}/traslate-order`,{site_id:l,order_id:c},`trasladando orden ${c}`),t.visibles.currentOrder=!1,S.value=!1};return(c,l)=>{const f=O("Dropdown"),u=O("Button"),y=O("Dialog"),w=O("Textarea"),C=O("Tag");return n(),d("div",null,[i(y,{visible:S.value,"onUpdate:visible":l[2]||(l[2]=a=>S.value=a),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:p(()=>[W]),default:p(()=>[e("form",{onSubmit:P(H,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[X,i(f,{style:{width:"100%"},id:"responsible",modelValue:V.value,"onUpdate:modelValue":l[0]||(l[0]=a=>V.value=a),optionValue:"site_id",options:A.value.filter(a=>a.show_on_web),optionLabel:"site_name",placeholder:"Seleccione la sede destino"},null,8,["modelValue","options"]),i(u,{onClick:l[1]||(l[1]=a=>j()),style:{width:"100%","border-radius":"0.5rem"},label:"Trasladar",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),i(y,{visible:z.value,"onUpdate:visible":l[5]||(l[5]=a=>z.value=a),closeOnEscape:"",closable:!0,modal:"",style:{width:"30rem"}},{header:p(()=>[Y]),default:p(()=>[e("form",{onSubmit:P(M,["prevent"]),style:{display:"flex",gap:"1rem","flex-direction":"column","align-items":"start"}},[ee,te,i(f,{style:{width:"100%"},id:"responsible",modelValue:_.value.responsible,"onUpdate:modelValue":l[3]||(l[3]=a=>_.value.responsible=a),options:q.value,optionLabel:"name",placeholder:"Selecciona un responsable"},null,8,["modelValue","options"]),se,i(w,{style:{resize:"none","text-transform":"lowercase",width:"100%"},id:"reason",modelValue:_.value.reason,"onUpdate:modelValue":l[4]||(l[4]=a=>_.value.reason=a),rows:"5",placeholder:"Escribe la razón de la cancelación"},null,8,["modelValue"]),i(u,{style:{width:"100%","border-radius":"0.5rem"},label:"solicitar cancelacion",type:"submit",class:"p-button-danger"})],32)]),_:1},8,["visible"]),i(y,{closable:!1,style:{width:"30rem"},modal:"",visible:g.value,"onUpdate:visible":l[8]||(l[8]=a=>g.value=a)},{footer:p(()=>[e("div",re,[i(u,{text:"",size:"small",onClick:l[6]||(l[6]=()=>{s($).deliveryZero(s(t).currentOrder.order_id),g.value=!1}),style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"si"}),i(u,{onClick:l[7]||(l[7]=a=>g.value=!1),size:"small",style:{"border-radius":"0.3rem",width:"100%"},severity:"danger",label:"no"})])]),default:p(()=>[e("span",le,[m(" Esta seguro de llevar a $0.00 el valor del domicilio para la orden "),e("b",null,r(s(t).currentOrder.order_id),1),m(" del cliente "),e("b",null,r(s(t).currentOrder.user_name),1),m("? ")])]),_:1},8,["visible"]),i(y,{class:"mx-3",closeOnEscape:"",closable:!1,visible:s(t).visibles.currentOrder,"onUpdate:visible":l[12]||(l[12]=a=>s(t).visibles.currentOrder=a),modal:"",style:{"max-height":"95vh",width:"35rem",position:"relative"}},{footer:p(()=>[e("div",Je,[i(u,{severity:"help",onClick:l[9]||(l[9]=a=>g.value=!0),style:{width:"50%"},label:"domicilio $0.00"}),i(u,{severity:"warning",onClick:l[10]||(l[10]=a=>S.value=!0),style:{width:"50%"},icon:"pi pi-airplane",label:"traslado"})])]),default:p(()=>{var a;return[e("div",oe,[s(t).currentOrder.responsible_id?(n(),F(C,{key:0,style:{},class:"tag mb-2",severity:"success"},{default:p(()=>[ae,m(" TRANSFERENCIA APROBADA")]),_:1})):v("",!0),m(),ne,s(t).currentOrder.responsible_id?(n(),F(C,{key:1,class:"tag mb-2",severity:"success"},{default:p(()=>[m(r(s(t).currentOrder.name),1)]),_:1})):v("",!0),e("div",ie,[s(t).currentOrder.current_status=="enviada"?(n(),d("p",{key:0,class:x(["text-2xl estado",s(t).currentOrder.current_status]),style:{"text-transform":"lowercase"}}," El pedido fue enviado al domicilio del cliente a las "+r(E(s(t).currentOrder.latest_status_timestamp)),3)):v("",!0),s(t).currentOrder.current_status=="cancelada"?(n(),d("p",{key:1,class:x(["text-2xl estado",s(t).currentOrder.current_status]),style:{"text-transform":"lowercase"}},[m(" El pedido fue cancelado a las "+r(E(s(t).currentOrder.latest_status_timestamp))+" ",1),de,ce,m(": "+r(s(t).currentOrder.responsible)+" ",1),ue,pe,m(": "+r(s(t).currentOrder.reason),1)],2)):v("",!0),s(t).currentOrder.current_status=="en preparacion"?(n(),d("p",{key:2,class:x(["text-2xl estado",s(t).currentOrder.current_status]),style:{"text-transform":"lowercase"}}," El pedido esta en preparacion desde las "+r(E(s(t).currentOrder.latest_status_timestamp))+" y ser'a enviada en breve ",3)):v("",!0),s(t).currentOrder.current_status=="generada"?(n(),d("p",{key:3,class:x(["text-2xl estado",s(t).currentOrder.current_status]),style:{"text-transform":"lowercase"}}," Hemos recibido su pedido a las "+r(E(s(t).currentOrder.latest_status_timestamp))+" "+r(s(t).currentOrder.authorized?"  y empezaremos a prepararlo en breve, gracias por su espera":"y empezaremos a prepararlo Cuando se confirme su Transferencia, Muchas gracias."),3)):v("",!0),s(t).currentOrder.current_status?v("",!0):(n(),d("p",{key:4,class:x(["text-2xl estado",s(t).currentOrder.current_status]),style:{"text-transform":"lowercase"}}," Este pedido no existe en nuestra base de datos ",2)),e("p",_e," ID:"+r(s(t).currentOrder.order_id),1),e("p",me,r(s(t).currentOrder.user_name),1),e("p",be,[e("b",null," fecha: "+r((a=s(t).currentOrder.latest_status_timestamp)==null?void 0:a.split("T")[0]),1)]),ve,(n(!0),d(N,null,R(s(t).currentOrder.products,h=>(n(),d("div",null,[e("div",ye,[e("p",null,r(h.quantity)+" "+r(h.name),1),e("div",null,[e("p",he,r(s(k)(h.total_price)),1)])]),ge]))),256)),(n(!0),d(N,null,R(s(t).currentOrder.additional_items,(h,I)=>(n(),d("div",{s:"",key:I,style:{position:"relative","margin-top":"0.5rem"}},[e("p",fe,[e("b",null,r(I),1)]),(n(!0),d(N,null,R(h,T=>(n(),d("div",null,[e("div",we,[e("div",null,[e("p",null,r(T.aditional_quantity)+" "+r(T.aditional_name),1)]),e("div",null,[e("p",Oe,r(s(k)(T.total_aditional_price)),1)])]),xe]))),256))]))),128)),e("div",ke,[De,e("div",Ee,[e("p",Se,[e("b",null,r(s(k)(s(t).currentOrder.total_order_price)),1)])]),Ce,e("div",Ve,[e("p",ze,[e("b",null,r(s(k)(s(t).currentOrder.delivery_price)),1)])]),Te,e("div",$e,[e("p",Ne,[e("b",null,r(s(k)(s(t).currentOrder.delivery_price+s(t).currentOrder.total_order_price)),1)])]),Re]),Ae,e("p",Ie,r(s(t).currentOrder.order_notes),1),Ue,e("div",Be,[Pe,e("div",Fe,[e("p",Me,r(s(t).currentOrder.user_name),1)]),Le,e("div",null,[e("p",qe,r(s(t).currentOrder.user_phone),1)]),He,e("div",null,[e("p",je,r(s(t).currentOrder.user_address),1)]),Ze,e("div",null,[e("p",Ge,r(s(t).currentOrder.payment_method),1)])])])]),i(u,{class:"shadow-4",onClick:l[11]||(l[11]=h=>s(t).setVisible("currentOrder",!1)),icon:"pi pi-times",rounded:"",severity:"danger",style:{position:"absolute",top:"-1rem","border-radius":"50%",right:"-1rem"}})]}),_:1},8,["visible"])])}}},Xe=Z(Ke,[["__scopeId","data-v-9caee8a8"]]);export{Xe as D};
