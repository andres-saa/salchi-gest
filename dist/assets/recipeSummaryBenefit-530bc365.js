import{h as s,J as A,D as G,i as H,s as J,g as r,o as n,c,f as d,e as u,a as i,F as I,j as g,U as y,x as K,d as p,r as M,t as v,k as m,q as U,u as S,n as x}from"./index-fd0d121a.js";import{f as Q}from"./formatoPesos-2293ab52.js";const W={class:"m-0 my-3"},X={style:{display:"flex","justify-content":"end"}},Y={style:{"margin-top":"3rem"}},Z={class:"grid pt-8 px-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},ee=i("h3",{class:"px-0"},[i("i",{class:"fa fa-chart-column"}),U(),i("b",null,"Resumen de Beneficios")],-1),te=i("div",{style:{display:"flex",width:"100%","justify-content":"end","flex-wrap":"wrap",gap:"1rem","align-items":"center"}},null,-1),ae={style:{display:"flex","justify-content":"center"}},ne=["src"],se={__name:"recipeSummaryBenefit",setup(le){const C=s({}),b=s(!1),t=s({}),D=s([{}]),$=s([]),V=s(!1),_=s(!1),R=async()=>{const a=C.value.id;await g.delete(`${y}/delete-ingredient/${a}`,"Borrando ingrediente"),_.value=!1,k()},B=[{header:"Producto",value:"name",type:"max-content",fixed:!0,width:""},{header:"Categoria",value:"category_name",type:"max-content",width:""},{header:"Precio de venta al publico",value:"selling_price",width:"10",type:"money"},{header:"Impuestos",value:"taxes",width:"10",type:"percent"},{header:"Precio de venta neto",value:"net_selling_price",width:"10",type:"money"},{header:"Costo total de la receta",value:"recipe_total_cost",width:"10",type:"money"},{header:"% Costo total de la receta",value:"percent_recipe_total_cost",width:"10",type:"percent"},{header:"Margen de beneficio neto",value:"net_benefit_margin",width:"10",type:"money"},{header:"Margen de beneficio",value:"benefit_margin",width:"10",type:"percent"}],z=s([...B]);A(()=>{var a;return(a=z.value)==null?void 0:a.map(l=>l.value)});const E=s([{name:"Nombre del ingrediente",fiel:"name",type:"text"},{name:"Unidad de medida de compra",fiel:"purchasing_unit_measure",type:"drop",Options:s($),optionLable:"name"},{name:"precio de compra",fiel:"purchasing_price",type:"money"},{name:"Peso Bruto (Kg/Litros)",fiel:"net_gross_weight",type:"number"}]);G(t,async(a,l)=>{var f;t.value.purchasing_unit_measure_id=((f=a.purchasing_unit_measure)==null?void 0:f.id)||null},{deep:!0});const N=async()=>{const a=t.value;if(!a.name||!a.purchasing_unit_measure_id||!a.purchasing_price||!a.net_gross_weight){alert("Por favor llene todos los campos");return}V.value?await g.post(`${y}/update-ingredient/${t.value.id}`,a,"Editando ingrediente"):await g.post(`${y}/create-ingredient`,a,"creando un nuevo ingrediente"),k(),b.value=!1},k=async()=>{D.value=await g.get(`${y}/get-recipe-summary-benefit`,"cargando ingredientes"),$.value=await g.get(`${y}/daily_inventory_unit_measures`)};H(async()=>{k()});const h=s(null),F=()=>{h.value={global:{value:null,matchMode:K.CONTAINS}}};return J(()=>{F()}),(a,l)=>{const f=r("inputText"),j=r("Dropdown"),P=r("InputNumber"),w=r("Button"),T=r("Dialog"),O=r("InputText"),L=r("column"),q=r("DataTable");return n(),c(I,null,[d(T,{style:{width:"30rem"},header:V.value?"Actualizar Ingrediente":"Nuevo Ingrediente",class:"mx-2",visible:b.value,"onUpdate:visible":l[0]||(l[0]=e=>b.value=e),modal:""},{footer:u(()=>[V.value?(n(),p(w,{key:1,onClick:N,severity:"help",label:"Modificar ingrediente"})):(n(),p(w,{key:0,onClick:N,severity:"help",label:"Guardar ingrediente"}))]),default:u(()=>[(n(!0),c(I,null,M(E.value,e=>(n(),c("div",null,[i("h6",W,v(e.name),1),e.type=="text"?(n(),p(f,{key:0,modelValue:t.value[e.fiel],"onUpdate:modelValue":o=>t.value[e.fiel]=o,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])):m("",!0),e.type=="drop"?(n(),p(j,{key:1,options:e.Options,optionLabel:"name",modelValue:t.value[e.fiel],"onUpdate:modelValue":o=>t.value[e.fiel]=o,style:{width:"100%"}},null,8,["options","modelValue","onUpdate:modelValue"])):m("",!0),e.type=="money"?(n(),p(P,{key:2,modelValue:t.value[e.fiel],"onUpdate:modelValue":o=>t.value[e.fiel]=o,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",prefix:"$"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0),e.type=="number"?(n(),p(P,{key:3,modelValue:t.value[e.fiel],"onUpdate:modelValue":o=>t.value[e.fiel]=o,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0),e.type=="persent"?(n(),p(P,{key:4,modelValue:t.value[e.fiel],"onUpdate:modelValue":o=>t.value[e.fiel]=o,style:{width:"100%"},locale:"es-ES","max-fraction-digits":"3",suffix:"%"},null,8,["modelValue","onUpdate:modelValue"])):m("",!0)]))),256))]),_:1},8,["header","visible"]),d(T,{class:"mx-2",header:"Eliminar ingrediente",visible:_.value,"onUpdate:visible":l[3]||(l[3]=e=>_.value=e),modal:""},{footer:u(()=>[i("div",X,[d(w,{size:"small",label:"cancelar",onClick:l[1]||(l[1]=e=>_.value=!1),severity:"help"}),d(w,{size:"small",onClick:l[2]||(l[2]=e=>R()),label:"Eliminar ingrediente",severity:"danger",text:""})])]),default:u(()=>[i("h6",null,[U("seguro que desea eliminar el Ingrediente "),i("b",null,v(C.value.ingredient_name),1),U(" ?")])]),_:1},8,["visible"]),i("div",Y,[d(q,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} recetas",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:D.value,tableStyle:"min-width: 50rem;",filters:h.value},{header:u(()=>[i("div",Z,[ee,d(O,{class:"",modelValue:h.value.global.value,"onUpdate:modelValue":l[4]||(l[4]=e=>h.value.global.value=e),placeholder:"Buscar Receta ..."},null,8,["modelValue"])]),te]),default:u(()=>[d(L,{frozen:"",header:"Foto",class:"py-1 px-0",style:{"max-width":"4rem"}},{body:u(e=>[i("div",ae,[i("img",{class:"p-0 shadow-2",style:{width:"2rem","border-radius":".3rem","background-color":"white"},src:`${S(y)}/read-product-image/96/${e.data.name}`,alt:""},null,8,ne)])]),_:1}),(n(),c(I,null,M(B,e=>d(L,{frozen:e.fixed,header:e.header,style:x(`min-width:${e.width}rem`),field:e.value,class:"py-2"},{body:u(o=>[e.type=="money"?(n(),c("h6",{key:0,style:x([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},v(S(Q)(o.data[e.value])||"-----------"),5)):e.type!="percent"?(n(),c("h6",{key:1,style:x([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},v(o.data[e.value]||"-----------"),5)):m("",!0),e.type=="percent"?(n(),c("h6",{key:2,style:x([{"text-transform":"lowercase"},e.type=="max-content"?"min-width:max-content":""]),class:"my-0 p-0"},v(`${o.data[e.value]}%`||"-----------"),5)):m("",!0)]),_:2},1032,["frozen","header","style","field"])),64))]),_:1},8,["value","filters"])])],64)}}};export{se as default};
