import{_ as E,h as m,l as F,s as N,x as j,i as G,g as p,o as u,c as _,f as d,e as g,a as l,j as f,U as w,t as x,F as T,r as U,n as b,p as z,m as H}from"./index-ef218aca.js";const P=v=>(z("data-v-1764c32c"),v=v(),H(),v),q={class:"text-center my-3"},J={style:{display:"flex","flex-direction":"column",gap:".2rem"}},K={style:{display:"flex","flex-direction":"column",gap:".5rem",padding:"0"}},Q={class:"pl-2",style:{display:"flex",gap:"1rem","align-items":"center","min-height":"max-content","max-height":"max-content"}},W={class:"m-0",style:{"text-transform":"uppercase"}},X={class:"mx-auto mb-4",style:{"margin-top":"6rem","max-width":"50rem"}},Y=P(()=>l("h2",{class:"my-6 text-center"},[l("b",null," Gestion de cargos y accesos")],-1)),Z={style:{"margin-top":"3rem"}},ee={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},le=P(()=>l("h3",{class:"px-2"},[l("b",null,"Cargos")],-1)),te=P(()=>l("div",{style:{display:"flex",width:"100%","justify-content":"end","flex-wrap":"wrap",gap:"1rem","align-items":"center"}},null,-1)),oe={class:"m-0 p-0",style:{"text-transform":"uppercase","min-width":"max-content"}},se={__name:"gestionCargos",setup(v){const C=m({}),$=m([{}]);m([]),F();const k=m([]),A=m(!1),S=m(null);N(()=>{B()});const h=m(null),B=()=>{h.value={global:{value:null,matchMode:j.CONTAINS}}},L=async()=>{$.value=await f.get(`${w}/get-all-rol`)},V=m(""),D=async(r,t)=>{V.value=t,A.value=!0;const s=await f.get(`${w}/get_all-permission-group-by-group`,"Cargando"),n=await f.get(`${w}/get-all-rol-by-rol-id/${r}`,"Cargando"),c=n.map(a=>a.permission_id);s.forEach(a=>{a.permissions.forEach(o=>{var y;o.enrolled=c.includes(o.id),o.permission_rol_id=(y=n.find(e=>e.permission_id===o.id))==null?void 0:y.id}),a.enrolledAll=a.permissions.every(o=>o.enrolled)}),k.value=s},M=async r=>{const t=r.enrolledAll;for(const s of r.permissions)s.enrolled!==t&&(s.enrolled=t,await I(s,t))};G(async()=>{await L()});const I=async(r,t)=>{const s={rol_id:V.value.id,permission_id:r.id,status:t,permission_rol_id:r.permission_rol_id};await f.put(`${w}/toggle_permision/${r.permission_rol_id||1}/${t}`,s,"Cargando");const n=k.value.find(c=>c.permissions.some(a=>a.id===r.id));if(n){const c=n.permissions.every(o=>o.enrolled),a=n.permissions.every(o=>!o.enrolled);n.enrolledAll=c,n.disabledAll=c||a}};return(r,t)=>{const s=p("InputSwitch"),n=p("Button"),c=p("Dialog"),a=p("InputText"),o=p("column"),y=p("DataTable");return u(),_("div",null,[d(c,{visible:A.value,"onUpdate:visible":t[1]||(t[1]=e=>A.value=e),style:{width:"50rem"},modal:"",header:"gestion de permisos"},{default:g(()=>[l("h5",q,[l("b",null," ACCESOS - "+x(V.value.name),1)]),(u(!0),_(T,null,U(k.value,(e,O)=>(u(),_("div",J,[l("div",{class:"px-2",style:b([{display:"flex",margin:".5rem 0","box-shadow":"0 0 2rem #00000040",cursor:"pointer","border-radius":"5rem","justify-content":"space-between","align-items":"center",gap:"1rem"},e.enrolledAll?"background-color:var(--primary-color) ;color: white":""]),onClick:t[0]||(t[0]=(...i)=>S.value.value.click&&S.value.value.click(...i))},[d(s,{ref_for:!0,ref_key:"toggle",ref:S,modelValue:e.enrolledAll,"onUpdate:modelValue":i=>e.enrolledAll=i,onChange:i=>M(e),style:{"min-width":"3rem"}},null,8,["modelValue","onUpdate:modelValue","onChange"]),l("h6",{class:"m-0 p-0",style:b(e.enrolledAll?"color: white":"")},[l("b",null,x(e.name),1)],4),d(n,{style:b([{padding:".3rem"},e.enrolledAll?"color:white":""]),rounded:"",onClick:i=>C.value[e.name]=!C.value[e.name],text:"",icon:"pi pi-angle-down"},null,8,["style","onClick"])],4),l("div",{style:b(C.value[e.name]?"height:max-content;":"height:0rem; overflow:hidden;")},[l("div",K,[(u(!0),_(T,null,U(e.permissions,i=>(u(),_("div",Q,[d(s,{onChange:R=>I(i,i.enrolled),modelValue:i.enrolled,"onUpdate:modelValue":R=>i.enrolled=R,style:{"min-width":"3rem"}},null,8,["onChange","modelValue","onUpdate:modelValue"]),l("h6",W,x(i.name),1)]))),256))])],4)]))),256))]),_:1},8,["visible"]),l("div",X,[Y,l("div",Z,[d(y,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} Roles",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"60vh",stripedRows:"",class:"col-12 m-auto",value:$.value,tableStyle:"",filters:h.value},{header:g(()=>[l("div",ee,[le,d(a,{class:"",modelValue:h.value.global.value,"onUpdate:modelValue":t[2]||(t[2]=e=>h.value.global.value=e),placeholder:"Buscar Cargo ..."},null,8,["modelValue"])]),te]),default:g(()=>[d(o,{class:"py-2",style:{width:"80%"},header:"CARGO",field:"name"},{body:g(e=>[l("h6",oe,x(e.data.name),1)]),_:1}),d(o,{class:"py-2",style:{width:"20%"},header:"Accion",field:"name"},{body:g(e=>[d(n,{onClick:O=>D(e.data.id,e.data),icon:"pi pi-eye",text:"",class:"p-0",label:"Accesos"},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters"])])])])}}},ae=E(se,[["__scopeId","data-v-1764c32c"]]);export{ae as default};
