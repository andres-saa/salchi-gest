import{A as T}from"./auditService-9b04ba51.js";import{f as k,h as F,r as u,o as s,c as o,a as e,d as a,w as r,F as p,k as _,t as n,n as g,b as A,U as N}from"./index-13dbe25d.js";const S={class:"m-0 p-0 md:p-4"},M=e("div",{class:"flex flex-wrap align-items-center justify-content-between gap-2"},[e("span",{class:"text-xl text-900 font-bold"},"Auditorias")],-1),j={style:{display:"flex"}},z=e("i",{class:"fa-solid fa-eye text-2xl"},null,-1),G={style:{"text-transform":"capitalize"}},H={class:"text-xl"},K=e("b",null,"Fecha de auditoría:",-1),O={key:0},W=e("b",null,"Pendientes",-1),q=[W],J={class:"p-0"},Q={style:{"list-style":"none"},class:"my-2 p-0"},X={key:0},Y={style:{"list-style":"none"},class:"text-danger"},Z={class:"py-0 my-0",style:{"font-weight":"bold"}},ee={style:{color:"red"}},te={key:0},se={class:"p-0"},oe={key:0},ae={key:1},de={__name:"listAudit",setup(le){const V=i=>{w.value=!0,v.value=i,T.getAuditCheckGroupsWithItems(i.id).then(h=>m.value=h)},w=k(!1),y=k(),v=k({}),m=k({});F(()=>{T.getAudits().then(i=>y.value=i)});const I=i=>{if(confirm(`Are you sure you want to delete the audit with ID: ${i.id}?`)){const h=`${N}/audits/${i.id}`;fetch(h,{method:"DELETE"}).then(d=>{if(d.ok){const f=y.value.findIndex(b=>b.id===i.id);f!==-1&&y.value.splice(f,1),console.log(`Audit with ID: ${i.id} has been successfully deleted.`)}else throw new Error(`HTTP error! status: ${d.status}`)}).catch(d=>{console.error("Error deleting audit:",d)})}};return(i,h)=>{const d=u("Column"),f=u("Rating"),b=u("Button"),R=u("DataTable"),P=u("Checkbox"),$=u("Tag"),E=u("Dialog");return s(),o(p,null,[e("div",S,[a(R,{value:y.value,tableStyle:"min-width: 50rem",class:"p-0",dataKey:"id",paginator:!0,rows:10,filters:i.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} to {last} de {totalRecords} Auditorias",responsiveLayout:"scroll",scrollable:""},{header:r(()=>[M]),default:r(()=>[a(d,{header:"Coordinador"},{body:r(t=>[_(n(t.data.coordinator_name),1)]),_:1}),a(d,{header:"Sede",class:"p-0 m-0"},{body:r(t=>[_(n(t.data.site_name),1)]),_:1}),a(d,{header:"Fecha",class:"p-0 m-0"},{body:r(t=>[_(n(t.data.audit_date),1)]),_:1}),a(d,{class:"p-0 m-0",field:"rating",header:"Calificacion",sortable:"",style:{"min-width":"12rem"}},{body:r(t=>[a(f,{modelValue:t.data.score},null,8,["modelValue"])]),_:1}),a(d,{class:"p-0 m-0",field:"inventoryStatus",header:"Acciones",sortable:"",style:{}},{body:r(t=>[e("div",j,[a(b,{onClick:x=>V(t.data),text:"",severity:"help"},{default:r(()=>[z]),_:2},1032,["onClick"]),a(b,{onClick:x=>I(t.data),text:"",icon:"fa-solid fa-trash text-2xl",class:"p-button-danger"},null,8,["onClick"])])]),_:1})]),_:1},8,["value","filters"])]),a(E,{visible:w.value,"onUpdate:visible":h[0]||(h[0]=t=>w.value=t),modal:"",header:"Detalles de la Auditoría",style:{width:"30rem"}},{default:r(()=>{var t,x,L;return[m.value?(s(),o(p,{key:0},[e("h4",G,[e("b",null,n((t=v.value.site_name)==null?void 0:t.toLowerCase())+" - "+n((x=v.value.coordinator_name)==null?void 0:x.toLowerCase()),1)]),e("p",H,[K,_(" "+n(v.value.audit_date),1)]),((L=m.value[1])==null?void 0:L.length)>[0]?(s(),o("h5",O,q)):g("",!0),(s(!0),o(p,null,A(m.value[1],(l,C)=>(s(),o("div",{key:C},[e("ul",J,[e("li",Q,[a(P,{class:"mr-3",binary:!0}),_(" "+n(l.item_description)+" ",1),a($,{severity:l.resolved?"succes":"danger"},{default:r(()=>[_(n(l.resolved?"resuelto":"pendiente"),1)]),_:2},1032,["severity"]),l.warning_text?(s(),o("ul",X,[e("li",Y,[e("p",Z," ("+n(l.warning_date)+")",1),e("span",ee,n(l.warning_text),1)])])):g("",!0)])])]))),128)),(s(!0),o(p,null,A(m.value[0],(l,C)=>{var D;return s(),o("div",{key:C},[(D=l==null?void 0:l.items)!=null&&D.some(c=>c==null?void 0:c.status)?(s(),o("h5",te,[e("b",null,n(l.group_name),1)])):g("",!0),e("ul",se,[(s(!0),o(p,null,A(l.items,(c,U)=>(s(),o("li",{style:{"list-style":"none"},class:"my-2 p-0",key:U},[c.status?(s(),o("div",oe,[a(P,{class:"mr-3",readonly:"",modelValue:c.status,"onUpdate:modelValue":B=>c.status=B,binary:!0},null,8,["modelValue","onUpdate:modelValue"]),_(" "+n(c.description)+" ",1)])):g("",!0)]))),128))])])}),128))],64)):(s(),o("p",ae,"Información de la auditoría no disponible."))]}),_:1},8,["visible"])],64)}}};export{de as default};
