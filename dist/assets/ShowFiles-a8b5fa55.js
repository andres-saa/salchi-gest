import{_ as H,x as Y,f as u,u as K,B as Q,h as P,g as W,r as y,o as X,c as Z,d as a,a as t,w as i,F as ee,U as R,k as f,t as w,l as te,y as oe,c1 as V,bV as T,q as se,p as ae,e as le}from"./index-7972d487.js";import{b as ne}from"./dropDownAux-9e8ad17a.js";import{u as N}from"./sendFileService-e84c945e.js";/* empty css                                                                  */const n=b=>(ae("data-v-e565ce9d"),b=b(),le(),b),ie={class:"col-12 p-0 m-auto",style:{"max-width":"800px"}},de={class:""},re={style:{display:"flex","justify-content":"end"}},ce=n(()=>t("i",{class:"fa-solid fa-upload mr-3"},null,-1)),ue=n(()=>t("span",{class:"p-column-title"},"Image",-1)),pe=n(()=>t("i",{class:"fa-solid fa-file-invoice"},null,-1)),me=n(()=>t("div",null,null,-1)),ve=n(()=>t("span",{class:"p-column-title"},"name",-1)),_e=n(()=>t("span",{class:"p-column-title"},"Category",-1)),ye={style:{display:"flex"}},fe=n(()=>t("i",{class:"fa-solid fa-file-arrow-down"},null,-1)),he=n(()=>t("i",{class:"fa-solid fa-pen-to-square"},null,-1)),ge={class:"col-12 p-0",style:{"max-width":""}},we=n(()=>t("label",{for:"position"},"FECHA DE RENOVACION",-1)),be={class:"p-3",style:{"background-color":"rgba(115, 255, 76, 0.306)"}},Ce=n(()=>t("i",{class:"pi pi-check",style:{color:"slateblue"}},null,-1)),xe={class:"grid",style:{display:"flex","justify-content":"space-between"}},Se={class:"col-12 xl:col-6"},ke={class:"col-12 xl:col-6"},Oe={class:"grid",style:{display:"flex",padding:"0",margin:"0"}},De={class:"col-12 xl:col-6"},Ae=n(()=>t("label",{for:"position"},"TIPO DE DOCUMENTO",-1)),Ie={class:"col-12 xl:col-6"},Re=n(()=>t("label",{for:"position"},"FECHA DE RENOVACION",-1)),$e={class:"p-3",style:{"background-color":"rgba(19, 164, 0, 0.306)"}},Ee=n(()=>t("i",{class:"pi pi-check",style:{color:"slateblue"}},null,-1)),Pe={style:{display:"flex","justify-content":"space-between"}},Ve={__name:"ShowFiles",setup(b){const C=Y(),$=u([]),r=u(),p=u(),U=u(["CÁMARA DE COMERCIO","USO DE SUELOS","RUT","BOMBEROS","CONCEPTO SANITARIO","SAYCO Y ACIMPRO","CAMION","CARTA POLICÍA"]),A=u(),v=u(""),_=u(""),x=K(),h=u({}),S=Q();$.value=A.value;const E=o=>{const e=o.target.files[0];e&&(console.log("Archivo seleccionado:",e),r.value=e)},F=async o=>{let e="post";const c=`${R}/site-document/`,l={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(o)};return(await fetch(c,l)).json()},g=async()=>{try{const o=`${R}/get-site-documents-info/${x.params.site_id}`,e=await fetch(o);if(console.log(e),!e.ok)return;const c=await e.json();A.value=c}catch(o){console.error("Error al enviar la solicitud:",o)}},L=async o=>{let e="put";const c={...o},l=`${R}/site-document/${c.document_id}`;c.renovation_date=_.value;const d={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)};try{const m=await fetch(l,d);if(!m.ok)throw new Error(`Error en la solicitud: ${m.status}`);const D=await m.json();return g(),I(),S.add({severity:"success",summary:"Actualización exitosa",detail:"Documento actualizado correctamente",life:3e3}),D}catch(m){S.add({severity:"error",summary:"Error en la actualización",detail:m.message,life:3e3})}};P(()=>{g(),C.setLoading(!0),C.setLoading(!1)}),W(()=>x.params.site_id,()=>{g(),C.setLoading(!0),C.setLoading(!1)}),P(()=>{const o=localStorage.getItem("currentSiteFiles");o&&(h.value=JSON.parse(o))});const k=u(!1),O=u(!1),z=(o,e,c)=>{const l={document_name:`${h.value.site_name} ${v.value}`,document_type:v.value,renovation_date:_.value,site_id:x.params.site_id};F(l).then(d=>{console.log(d),N(o,d.document_id,v.value),g()}),S.add({severity:"success",summary:"hecho",detail:"",life:3e3}),I()},q=(o,e)=>{console.log($,v.value),`${p.value.document_name}`,p.value.document_type,_.value,x.params.site_id,console.log(e),L(e),N(o,e.document_id,e.document_type),S.add({severity:"success",summary:"hecho",detail:"",life:3e3}),I()},M=o=>{k.value=!0,p.value=o},B=o=>{O.value=!0,p.value=o},I=()=>{k.value=!1,O.value=!1,r.value=null,g()};return(o,e)=>{const c=y("Toast"),l=y("Button"),d=y("Column"),m=y("Calendar"),D=y("Dialog"),j=y("Dropdown"),J=y("DataTable");return X(),Z(ee,null,[a(c),t("div",ie,[t("div",de,[a(J,{ref:"dt",value:A.value,dataKey:"id",paginator:!0,rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll",frozenValue:o.lockedCustomers},{header:i(()=>[t("div",re,[a(l,{size:"small",style:{width:"max-content","font-weight":"bold"},class:"p-button-success m-0 my",onClick:e[0]||(e[0]=s=>B())},{default:i(()=>[ce,f(" SUBIR NUEVO ")]),_:1})])]),default:i(()=>[a(d,{class:"p-0",header:"Icon",headerStyle:"width:0%; min-width:3rem;"},{body:i(s=>[ue,pe,me]),_:1}),a(d,{class:"p-0 p",field:"name",header:"Tipo",sortable:!0,headerStyle:"width:30%; min-width:5rem; "},{body:i(s=>[ve,f(" "+w(s.data.document_type),1)]),_:1}),a(d,{class:"p-0",field:"position",header:"Nombre ",sortable:!0,headerStyle:"width:30%; min-width:10rem;"},{body:i(s=>[_e,f(" "+w(s.data.document_name),1)]),_:1}),a(d,{class:"p-0",field:"birth_date",header:"Renovacion",sortable:!0,headerStyle:"width:12%; min-width:10rem;"},{body:i(s=>[f(w(s.data.renovation_date),1)]),_:1}),a(d,{class:"p-2",header:"Acciones",fieldheaderStyle:"width:10%; min-width:5rem;",frozen:"",alignFrozen:"right"},{body:i(s=>[t("div",ye,[a(l,{text:"",size:"large",style:{"min-width":"max-content","aspect-ratio":"1 / 1"},class:"p-button-success mr-2 mb-2 p-0 text-3xl",onClick:G=>te(ne)(s.data.document_id,s.data.document_type)},{default:i(()=>[fe]),_:2},1032,["onClick"]),a(l,{text:"",size:"large",style:{width:"max-content"},class:"p-button-info mr-2 mb-2 p-0 text-3xl",onClick:G=>M(s.data)},{default:i(()=>[he]),_:2},1032,["onClick"])])]),_:1}),a(D,{class:"p-0",closable:!0,style:oe([{"max-width":"500px"},{width:"30vw",padding:"0px"}]),header:` CARGAR ${p.value?p.value.document_type:""} PARA ${h.value.site_name}`,visible:k.value,"onUpdate:visible":e[4]||(e[4]=s=>k.value=s),breakpoints:{"960px":"75vw"},modal:!0},{default:i(()=>[t("input",{ref:"fileInput",type:"file",onChange:E,style:{display:"none"}},null,544),t("div",ge,[we,a(m,{id:"entry_date",style:{width:"100%",margin:"20px 0"},modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),required:"true",autofocus:""},null,8,["modelValue"])]),V(t("p",be,[Ce,f(" "+w(r.value?`${r.value.name} : si este no es
                            su documento por
                            favor carguelo`:""),1)],512),[[T,r.value]]),t("div",xe,[t("div",Se,[a(l,{label:"Seleccionar documento",class:"col-12",style:{"background-color":"var(--primary-color)"},onClick:e[2]||(e[2]=s=>{o.$refs.fileInput.click()})})]),t("div",ke,[a(l,{class:"col-12",label:"Enviar",style:{"background-color":"var(--primary-color)"},onClick:e[3]||(e[3]=s=>q(r.value,p.value))})])])]),_:1},8,["header","visible"]),a(D,{header:` CARGAR ${p.value?p.value:""} PARA ${h.value.site_name}`,visible:O.value,"onUpdate:visible":e[9]||(e[9]=s=>O.value=s),breakpoints:{"960px":"75vw"},style:{width:"50vw",padding:"50p0x"},modal:!0},{default:i(()=>[t("div",Oe,[t("div",De,[Ae,a(j,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=s=>v.value=s),modelModifiers:{trim:!0},options:U.value,placeholder:"",required:"true",class:se({"p-invalid":o.submitted}),style:{width:"100%",margin:"20px 0"}},null,8,["modelValue","options","class"])]),t("div",Ie,[Re,a(m,{id:"entry_date",style:{width:"100%",margin:"20px 0"},modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=s=>_.value=s),required:"true",autofocus:""},null,8,["modelValue"])])]),t("input",{ref:"fileInput",type:"file",onChange:E,style:{display:"none"}},null,544),V(t("p",$e,[Ee,f(" "+w(r.value?`${r.value.name} : verifique si
                            este es su documeto
                            antes de envirlo`:""),1)],512),[[T,r.value]]),t("div",Pe,[a(l,{label:"Seleccionar documento",style:{width:"40%","background-color":"var(--primary-color)"},onClick:e[7]||(e[7]=s=>{o.$refs.fileInput.click()})}),a(l,{label:"Enviar",style:{width:"40%","background-color":"var(--primary-color)"},onClick:e[8]||(e[8]=s=>z(r.value,v.value,h.value.site_id))})])]),_:1},8,["header","visible"])]),_:1},8,["value","frozenValue"])])])],64)}}},Le=H(Ve,[["__scopeId","data-v-e565ce9d"]]);export{Le as default};
