import{_ as fe,z as Se,f as n,g as Q,A as l,B as Ve,u as $e,C as Ae,j as ne,U as _,D as O,E as B,G as R,H as F,I as q,h as be,r as h,o as g,c as C,d as i,w as ae,a,n as z,l as c,m as U,J as ee,t as W,F as pe,b as we,K as se,v as Te,p as xe,e as Ee,L as le,M as ye,N as Z,s as me,k as ke,q as Ue,P as Ce,O as te}from"./index-f8c3ae22.js";import"./dialogoEditarProducto.vue_vue_type_style_index_0_scoped_886cb754_lang-305a0651.js";import{f as De}from"./formatoPesos-2a38d2e7.js";const G=b=>(xe("data-v-886cb754"),b=b(),Ee(),b),Pe={key:0,style:{}},Ie=["src"],Le=G(()=>a("h5",null,"Nombre",-1)),ze={class:"p-input-icon-left mb-0"},Ge=G(()=>a("i",{class:"pi pi-pencil"},null,-1)),Ne=G(()=>a("h5",null,"Description",-1)),Oe=G(()=>a("h5",null,"Precio",-1)),Be={class:"p-input-icon-left"},Re={style:{display:"flex","align-items":"center"}},Fe=G(()=>a("span",{class:"ml-5"},"Conjunto de salsas",-1)),qe={key:1,class:"p-input-icon-left"},He={style:{display:"flex","align-items":"center"}},Je=G(()=>a("span",{class:"ml-5"},"Conjunto de adiciones",-1)),Me={class:"p-input-icon-left"},Ke={style:{display:"flex","align-items":"center"}},Qe=G(()=>a("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),We={class:"p-input-icon-left"},Xe={style:{display:"flex","align-items":"center"}},Ye=G(()=>a("span",{class:"ml-5"},"Conjunto de toppings",-1)),Ze={class:"p-input-icon-left"},eo={style:{display:"flex","align-items":"center"}},oo=G(()=>a("span",{class:"ml-5"},"Conjunto de cambios",-1)),ao={class:"p-input-icon-left"},to=G(()=>a("h5",{style:{display:"flex","align-items":"center"}},[a("span",{class:""},"Estado")],-1)),so={class:"p-input-icon-left"},lo={style:{display:"flex","align-items":"center"}},no={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},io={class:"mt-6"},ro={style:{display:"flex","align-items":"center"}},uo=G(()=>a("span",{class:"ml-5"},"Todas",-1)),co={style:{display:"flex","align-items":"center"}},po={class:"ml-5"},mo=G(()=>a("span",{class:"text-center col-12 p-0"},"Guardar",-1)),vo={__name:"dialogoEditarProducto",setup(b){const N=Se(),w=e=>{const o=new Date().getTime();return`${_}/read-product-image/300/${e}?timestamp=${o}`},X=n({}),H=n({});Q(l,async e=>{if(e&&e.name)try{(await ie(e.name)).forEach(u=>{H.value[u.site_id]={seleccionada:!0,product_id:u.product_id}})}catch(o){console.error("Error al obtener sedes para el producto:",o)}},{immediate:!0}),Q(l,async e=>{Object.keys(X.value).forEach(u=>{X.value[u]=!1}),(await ie(l.value.name)).forEach(u=>{X.value[u.site_id]=!0})});const x=n(null),oe=n(null),J=e=>{const o=e.target.files[0];o&&(x.value=URL.createObjectURL(o),oe.value=o)},E=Ve(),M=$e(),Y=Ae(()=>M.query.category),t=n([]),m=n(!1);Q(m,e=>{ne.value.forEach(o=>{t.value[o.site_id]=e})}),console.log(Y.value),n("producto sin nombre"),n("producto sin descripcion"),n(0),n("inactive");const f=n(["active","inactive"]),k=n([]),A=n([]),$=n([]),v=n([]),V=n([]),T=n(),j=n(),D=n(),P=n(),I=n(),ve=async()=>{await _e(l.value.name);for(const[e,o]of Object.entries(t.value))if(o&&H.value[e]&&H.value[e].product_id){const u={product_id:H.value[e].product_id,name:l.value.name,price:l.value.price,description:l.value.description,category_id:Y.value,porcion:"1",state:l.value.state,grupo_salsa_id:T.value?O.value.grupo_salsa_id:null,grupo_topping_id:D.value?F.value.grupo_topping_id:null,grupo_acompanante_id:I.value?q.value.grupo_acompanante_id:null,grupo_cambio_id:P.value?B.value.grupo_cambio_id:null,grupo_adicional_id:j.value?R.value.grupo_id:null,site_id:e};try{se.value=!1,N.setLoading(!0,`guardando ${l.value.name} para la sede ${e}`);const y=await fetch(`${_}/products/${u.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!y.ok)throw new Error(`Error: ${y.status}`);E.add({severity:"success",summary:`Producto actualizado en la sede ${e}`,detail:"Actualización completada",life:3e3})}catch(y){console.error("Error al actualizar el producto:",y)}}location.reload()};Q(l,async e=>{if(Object.keys(t.value).forEach(o=>{t.value[o]=!1}),e&&e.name)try{(await ie(l.value.name)).forEach(u=>{t.value[u.site_id]=!0})}catch(o){console.error("Error al obtener sedes para el producto:",o)}},{immediate:!0});const ie=async e=>{try{const o=await fetch(`${_}/products/name/${e}/sites`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){console.error("Error fetching sites:",o),E.add({severity:"error",summary:"Error",detail:"Error fetching sites data",life:3e3})}},_e=async e=>{const o=new FormData;o.append("file",oe.value);try{if(!(await fetch(`${_}/upload-product-image/${e}`,{method:"POST",body:o})).ok)throw new Error("Error al subir la imagen");x.value=w(l.value.name)}catch(u){console.error("Error al subir la imagen:",u)}},re=async()=>{try{return await(await fetch(`${_}/grupo-salsas`)).json()}catch(e){console.error("Error fetching data: ",e)}},ue=async()=>{try{return await(await fetch(`${_}/grupo-cambios`)).json()}catch(e){console.error("Error fetching data: ",e)}},ce=async()=>{try{return await(await fetch(`${_}/grupo-adicionales`)).json()}catch(e){console.error("Error fetching data: ",e)}},de=async()=>{try{return await(await fetch(`${_}/grupo-toppings`)).json()}catch(e){console.error("Error fetching data: ",e)}},d=async()=>{try{return await(await fetch(`${_}/grupo-acompanantes`)).json()}catch(e){console.error("Error fetching data: ",e)}};return Q(l,async()=>{x.value=w(l.value.name),l.value.grupo_salsa_id?T.value=!0:T.value=!1,l.value.grupo_adicional_id?j.value=!0:j.value=!1,l.value.grupo_acompanante_id?I.value=!0:I.value=!1,l.value.grupo_topping_id?D.value=!0:D.value=!1,l.value.grupo_cambio_id?P.value=!0:P.value=!1,re().then(p=>{k.value=p}),ce().then(p=>{A.value=p}),ue().then(p=>{$.value=p}),d().then(p=>{v.value=p}),de().then(p=>{V.value=p});const e=await re();k.value=e;const o=await ue();$.value=o;const u=await ce();A.value=u;const y=await de();V.value=y;const L=await d();v.value=L,O.value=e.find(p=>p.grupo_salsa_id===l.value.grupo_salsa_id),B.value=o.find(p=>p.grupo_cambio_id===l.value.grupo_cambio_id),R.value=u.find(p=>p.grupo_id===l.value.grupo_adicional_id),F.value=y.find(p=>p.grupo_topping_id===l.value.grupo_topping_id),q.value=L.find(p=>p.grupo_acompanante_id===l.value.grupo_acompanante_id)}),be(async()=>{var e,o;x.value=w(l.value.name),l.value.grupo_salsa_id?T.value=!0:T.value=!1,l.value.grupo_adicional_id?j.value=!0:j.value=!1,l.value.grupo_acompanante_id?I.value=!0:I.value=!1,l.value.grupo_topping_id?D.value=!0:D.value=!1,l.value.grupo_cambio_id?P.value=!0:P.value=!1,re().then(u=>{k.value=u}),ce().then(u=>{A.value=u}),ue().then(u=>{$.value=u}),d().then(u=>{v.value=u}),de().then(u=>{V.value=u}),(o=(e=ne)==null?void 0:e.value)==null||o.forEach(u=>{t.value[u.site_id]=!1})}),(e,o)=>{const u=h("Input"),y=h("Button"),L=h("InputText"),p=h("Textarea"),ge=h("InputNumber"),K=h("InputSwitch"),s=h("Dropdown"),he=h("Dialog");return g(),C(pe,null,[i(he,{visible:c(se),"onUpdate:visible":o[16]||(o[16]=r=>U(se)?se.value=r:null),style:Te([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:`Editar ${c(l).name}`,modal:!0,class:"p-fluid p-2 m-3"},{default:ae(()=>[x.value?(g(),C("div",Pe,[a("img",{src:x.value,style:{width:"100%",height:"auto"}},null,8,Ie)])):z("",!0),i(u,{type:"file",onChange:J,accept:"image/*"}),i(y,{text:"",style:{width:"auto"},class:"p-0",label:"Reset image",size:"small",onClick:o[0]||(o[0]=r=>x.value=`${c(_)}/read-product-image/300/${c(l).name}`)}),Le,a("span",ze,[Ge,i(L,{disabled:"",modelValue:c(l).name,"onUpdate:modelValue":o[1]||(o[1]=r=>c(l).name=r),type:"text"},null,8,["modelValue"])]),Ne,i(p,{modelValue:c(l).description,"onUpdate:modelValue":o[2]||(o[2]=r=>c(l).description=r),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),Oe,a("span",Be,[i(ge,{class:"",modelValue:c(l).price,"onUpdate:modelValue":o[3]||(o[3]=r=>c(l).price=r),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),a("h5",Re,[i(K,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":o[4]||(o[4]=r=>T.value=r)},null,8,["modelValue"]),Fe]),T.value?(g(),C("span",qe,[i(s,{style:{outline:"none"},class:"p-0",primary:"",modelValue:c(O),"onUpdate:modelValue":o[5]||(o[5]=r=>U(O)?O.value=r:null),options:k.value,optionLabel:"name"},null,8,["modelValue","options"])])):z("",!0),a("h5",He,[i(K,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":o[6]||(o[6]=r=>j.value=r)},null,8,["modelValue"]),Je]),a("span",Me,[j.value?(g(),ee(s,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(R),"onUpdate:modelValue":o[7]||(o[7]=r=>U(R)?R.value=r:null),options:A.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Ke,[i(K,{class:"p-0 m-0",modelValue:I.value,"onUpdate:modelValue":o[8]||(o[8]=r=>I.value=r)},null,8,["modelValue"]),Qe]),a("span",We,[I.value?(g(),ee(s,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(q),"onUpdate:modelValue":o[9]||(o[9]=r=>U(q)?q.value=r:null),options:v.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Xe,[i(K,{class:"p-0 m-0",modelValue:D.value,"onUpdate:modelValue":o[10]||(o[10]=r=>D.value=r)},null,8,["modelValue"]),Ye]),a("span",Ze,[D.value?(g(),ee(s,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(F),"onUpdate:modelValue":o[11]||(o[11]=r=>U(F)?F.value=r:null),options:V.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",eo,[i(K,{class:"p-0 m-0",modelValue:P.value,"onUpdate:modelValue":o[12]||(o[12]=r=>P.value=r)},null,8,["modelValue"]),oo]),a("span",ao,[P.value?(g(),ee(s,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(B),"onUpdate:modelValue":o[13]||(o[13]=r=>U(B)?B.value=r:null),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),to,a("span",so,[i(s,{style:{outline:"none"},class:"p-0",primary:"",modelValue:c(l).state,"onUpdate:modelValue":o[14]||(o[14]=r=>c(l).state=r),options:f.value},null,8,["modelValue","options"])]),a("h5",lo,[a("span",no,"En que sedes quiere modificar "+W(c(l).name),1)]),a("div",io,[a("h5",ro,[i(K,{class:"p-0 m-0",modelValue:m.value,"onUpdate:modelValue":o[15]||(o[15]=r=>m.value=r)},null,8,["modelValue"]),uo]),(g(!0),C(pe,null,we(c(ne),r=>(g(),C("div",{key:r.site_id},[a("h5",co,[i(K,{class:"p-0 m-0",modelValue:t.value[r.site_id],"onUpdate:modelValue":je=>t.value[r.site_id]=je,disabled:!X.value[r.site_id]},null,8,["modelValue","onUpdate:modelValue","disabled"]),a("span",po,W(r.site_name),1)])]))),128))]),i(y,{onClick:ve,class:"m-auto my-4 text-center"},{default:ae(()=>[mo]),_:1})]),_:1},8,["visible","header"]),i(c(E))],64)}}},_o=fe(vo,[["__scopeId","data-v-886cb754"]]);const S=b=>(xe("data-v-a8a20a02"),b=b(),Ee(),b),go={key:0},ho=["src"],yo=S(()=>a("h5",null,"Nombre",-1)),fo={class:"p-input-icon-left mb-4"},Vo=S(()=>a("i",{class:"pi pi-pencil"},null,-1)),$o=S(()=>a("h5",null,"Description",-1)),bo=S(()=>a("h5",null,"Precio",-1)),wo={class:"p-input-icon-left"},xo=S(()=>a("i",{class:"pi pi-pencil"},null,-1)),Eo={style:{display:"flex","align-items":"center"}},ko=S(()=>a("span",{class:"ml-5"},"Conjunto de salsas",-1)),Uo={key:1,class:"p-input-icon-left"},Co={style:{display:"flex","align-items":"center"}},So=S(()=>a("span",{class:"ml-5"},"Conjunto de adiciones",-1)),Ao={class:"p-input-icon-left"},To={style:{display:"flex","align-items":"center"}},jo=S(()=>a("span",{class:"ml-5"},"Conjunto de acompanantes",-1)),Do={class:"p-input-icon-left"},Po={style:{display:"flex","align-items":"center"}},Io=S(()=>a("span",{class:"ml-5"},"Conjunto de toppings",-1)),Lo={class:"p-input-icon-left"},zo={style:{display:"flex","align-items":"center"}},Go=S(()=>a("span",{class:"ml-5"},"Conjunto de cambios",-1)),No={class:"p-input-icon-left"},Oo=S(()=>a("h5",{style:{display:"flex","align-items":"center"}},[a("span",{class:""},"Estado")],-1)),Bo={class:"p-input-icon-left"},Ro={style:{display:"flex","align-items":"center"}},Fo={class:"ml-0 mt-6",style:{"text-transform":"capitalize"}},qo={class:"mt-6"},Ho={style:{display:"flex","align-items":"center"}},Jo=S(()=>a("span",{class:"ml-5"},"Todas",-1)),Mo={style:{display:"flex","align-items":"center"}},Ko={class:"ml-5"},Qo=S(()=>a("span",{class:"text-center col-12 p-0"},"Agregar",-1)),Wo={__name:"dialogoAgregarProducto",setup(b){const N=n(null),w=n(null),X=d=>{const e=d.target.files[0];e&&(N.value=URL.createObjectURL(e),w.value=e)},H=Ve(),x=$e(),oe=Ae(()=>x.query.category),J=n([]),E=n(!1);Q(E,d=>{ne.value.forEach(e=>{J.value[e.site_id]=d})}),console.log(oe.value);const M=n("producto sin nombre"),Y=n("producto sin descripcion"),t=n(0),m=n("inactive"),f=n(["active","inactive"]),k=n([]),A=n([]),$=n([]),v=n([]),V=n([]),T=n(),j=n(),D=n(),P=n(),I=n(),ve=async()=>{const d=`${_}/products`;ie(M.value);for(const[e,o]of Object.entries(J.value))if(o){const u={name:M.value,price:t.value,description:Y.value,category_id:oe.value,porcion:"1",state:m.value,grupo_salsa_id:O.value?O.value.grupo_salsa_id:null,grupo_topping_id:F.value?F.value.grupo_topping_id:null,grupo_acompanante_id:q.value?q.value.grupo_acompanante_id:null,grupo_cambio_id:B.value?B.value.grupo_cambio_id:null,grupo_adicional_id:R.value?R.value.grupo_adicional_id:null,site_id:e};try{const y=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!y.ok)throw new Error(`Error: ${y.status}`);H.add({severity:"success",summary:`agregado a la sede ${e}`,detail:"espaerando las otras sedes",life:3e3}),ye.value=ye.value+1}catch(y){console.error("Error al enviar producto:",y)}}le.value=!1},ie=async d=>{const e=new FormData;e.append("file",w.value);try{if(!(await fetch(`${_}/upload-product-image/${d}`,{method:"POST",body:e})).ok)throw new Error("Error al subir la imagen")}catch(o){console.error("Error al subir la imagen:",o)}},_e=async()=>{try{return await(await fetch(`${_}/grupo-salsas`)).json()}catch(d){console.error("Error fetching data: ",d)}},re=async()=>{try{return await(await fetch(`${_}/grupo-cambios`)).json()}catch(d){console.error("Error fetching data: ",d)}},ue=async()=>{try{return await(await fetch(`${_}/grupo-adicionales`)).json()}catch(d){console.error("Error fetching data: ",d)}},ce=async()=>{try{return await(await fetch(`${_}/grupo-toppings`)).json()}catch(d){console.error("Error fetching data: ",d)}},de=async()=>{try{return await(await fetch(`${_}/grupo-acompanantes`)).json()}catch(d){console.error("Error fetching data: ",d)}};return be(async()=>{var d,e;_e().then(o=>{k.value=o}),ue().then(o=>{A.value=o}),re().then(o=>{$.value=o}),de().then(o=>{v.value=o}),ce().then(o=>{V.value=o}),(e=(d=ne)==null?void 0:d.value)==null||e.forEach(o=>{J.value[o.site_id]=!1})}),(d,e)=>{const o=h("Input"),u=h("InputText"),y=h("Textarea"),L=h("InputSwitch"),p=h("Dropdown"),ge=h("Button"),K=h("Dialog");return g(),C(pe,null,[i(K,{visible:c(le),"onUpdate:visible":e[15]||(e[15]=s=>U(le)?le.value=s:null),style:Te([{width:"500px",height:"max-content"},{"background-color":"white","border-radius":"1rem",overflow:"hidden"}]),header:"Agregar producto",modal:!0,class:"p-fluid p-2 m-3"},{default:ae(()=>[N.value?(g(),C("div",go,[a("img",{src:N.value,alt:"Previsualización del Producto",style:{"max-width":"100%",height:"auto"}},null,8,ho)])):z("",!0),i(o,{type:"file",onChange:X,accept:"image/*"}),yo,a("span",fo,[Vo,i(u,{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=s=>M.value=s),type:"text"},null,8,["modelValue"])]),$o,i(y,{modelValue:Y.value,"onUpdate:modelValue":e[1]||(e[1]=s=>Y.value=s),autoResize:!0,rows:"3",cols:"30"},null,8,["modelValue"]),bo,a("span",wo,[xo,i(u,{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value=s),type:"number",placeholder:"Precio"},null,8,["modelValue"])]),a("h5",Eo,[i(L,{class:"p-0 m-0",modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=s=>T.value=s)},null,8,["modelValue"]),ko]),T.value?(g(),C("span",Uo,[i(p,{style:{outline:"none"},class:"p-0",primary:"",modelValue:c(O),"onUpdate:modelValue":e[4]||(e[4]=s=>U(O)?O.value=s:null),options:k.value,optionLabel:"name"},null,8,["modelValue","options"])])):z("",!0),a("h5",Co,[i(L,{class:"p-0 m-0",modelValue:j.value,"onUpdate:modelValue":e[5]||(e[5]=s=>j.value=s)},null,8,["modelValue"]),So]),a("span",Ao,[j.value?(g(),ee(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(R),"onUpdate:modelValue":e[6]||(e[6]=s=>U(R)?R.value=s:null),options:A.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",To,[i(L,{class:"p-0 m-0",modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=s=>I.value=s)},null,8,["modelValue"]),jo]),a("span",Do,[I.value?(g(),ee(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(q),"onUpdate:modelValue":e[8]||(e[8]=s=>U(q)?q.value=s:null),options:v.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",Po,[i(L,{class:"p-0 m-0",modelValue:D.value,"onUpdate:modelValue":e[9]||(e[9]=s=>D.value=s)},null,8,["modelValue"]),Io]),a("span",Lo,[D.value?(g(),ee(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(F),"onUpdate:modelValue":e[10]||(e[10]=s=>U(F)?F.value=s:null),options:V.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),a("h5",zo,[i(L,{class:"p-0 m-0",modelValue:P.value,"onUpdate:modelValue":e[11]||(e[11]=s=>P.value=s)},null,8,["modelValue"]),Go]),a("span",No,[P.value?(g(),ee(p,{key:0,style:{outline:"none"},class:"p-0",primary:"",modelValue:c(B),"onUpdate:modelValue":e[12]||(e[12]=s=>U(B)?B.value=s:null),options:$.value,optionLabel:"name"},null,8,["modelValue","options"])):z("",!0)]),Oo,a("span",Bo,[i(p,{style:{outline:"none"},class:"p-0",primary:"",modelValue:m.value,"onUpdate:modelValue":e[13]||(e[13]=s=>m.value=s),options:f.value},null,8,["modelValue","options"])]),a("h5",Ro,[a("span",Fo,"Sedes en las que estara disponible el producto "+W(M.value),1)]),a("div",qo,[a("h5",Ho,[i(L,{class:"p-0 m-0",modelValue:E.value,"onUpdate:modelValue":e[14]||(e[14]=s=>E.value=s)},null,8,["modelValue"]),Jo]),(g(!0),C(pe,null,we(c(ne),s=>(g(),C("div",null,[a("h5",Mo,[i(L,{class:"p-0 m-0",modelValue:J.value[s.site_id],"onUpdate:modelValue":he=>J.value[s.site_id]=he},null,8,["modelValue","onUpdate:modelValue"]),a("span",Ko,W(s.site_name),1)])]))),256))]),i(ge,{onClick:ve,class:"m-auto my-4 text-center"},{default:ae(()=>[Qo]),_:1})]),_:1},8,["visible"]),i(c(H))],64)}}},Xo=fe(Wo,[["__scopeId","data-v-a8a20a02"]]);const Yo=b=>(xe("data-v-daaf12e1"),b=b(),Ee(),b),Zo={class:"col-12"},ea={class:"text-2xl titulo my-6 px-2",style:{"text-transform":"capitalize","font-weight":"bold"}},oa={class:"grid p-5 md:p-0 m-0 col-12 m-auto"},aa={class:"cont p-2",style:{"background-color":"white",height:"100%",position:"relative"}},ta=["onClick"],sa=["onClick"],la={class:"imagen-cont",style:{position:""}},na=["src"],ia={style:{display:""}},ra={class:"nombre-producto mt-4",style:{"font-weight":"bold"}},ua={class:"descripcion-producto mt-2 text-sm mb-4"},ca={class:"info"},da={class:"text-l",style:{"font-weight":"bold","border-radius":"100px"}},pa={class:"flex align-items-center justify-content-center"},ma=Yo(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),va={__name:"sesion",setup(b){const N=n([]),w=$e(),X=n([]),H=Ve(),x=Se(),oe=t=>{console.log("hola"),se.value=!se.value,l.value=t},J=t=>{Z.value=!Z.value,te.value=t},E=async t=>{var m,f,k,A;if(console.log(localStorage),!((f=(m=me)==null?void 0:m.value)!=null&&f.site_id)){console.log("Site ID is not available. Exiting function.");return}try{x.setLoading(!0,`cargando ${t} de ${me.value.site_name}`);let $=await fetch(`${_}/products/category/name/${t}/site/${(A=(k=me)==null?void 0:k.value)==null?void 0:A.site_id}`);if(!$.ok)throw N.value=[],new Error(`HTTP error! status: ${$.status}`);let v=await $.json();x.setLoading(!1,`cargando ${t}s`),N.value=v.map(V=>({...V,isActive:V.state=="active"}))}catch($){N.value=[],console.error("Error fetching data: ",$),x.setLoading(!1,`cargando ${t}s`)}},M=t=>{const m={...t};m.state=t.isActive?"active":"inactive",fetch(`${_}/products/${t.product_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(f=>{if(!f.ok)throw new Error("Network response was not ok");return H.add({severity:`${t.isActive?"success":"error"}`,summary:`${t.isActive?"Activado":"Desactivado"}`,detail:t.name,life:3e3}),X.value=t.state=="active",f.json()}).then(f=>{}).catch(f=>{console.error("Error al actualizar el producto:",f)})};Q(me,(t,m)=>{t!==m&&E(w.params.sesion)}),Q(ye,(t,m)=>{t!==m&&E(w.params.sesion)}),be(async()=>{E(w.params.sesion)}),Q(()=>w.params.sesion,t=>{E(t)});const Y=async()=>{if(!te.value||!te.value.product_id){console.error("No se ha seleccionado ningún producto para eliminar");return}try{const t=await fetch(`${_}/products/${te.value.product_id}`,{method:"DELETE"});if(!t.ok)throw new Error(`Error al eliminar el producto: ${t.status}`);await E(w.params.sesion),Z.value=!1,console.log(`Producto eliminado: ${te.value.name}`)}catch(t){console.error("Error al eliminar el producto:",t)}};return(t,m)=>{const f=h("Button"),k=h("Toast"),A=h("InputSwitch"),$=h("Dialog");return g(),C("div",Zo,[a("p",ea,W(c(w).params.sesion),1),a("span",null,[i(f,{onClick:m[0]||(m[0]=v=>le.value=!c(le)),class:"ml-2 mb-4"},{default:ae(()=>[ke(" Agregar ")]),_:1})]),a("div",oa,[(g(!0),C(pe,null,we(N.value,v=>(g(),C("div",{key:v.id,class:"xl:col-3 lg:col-4 md:p-3 p-2 col-12 md:col-6 mb-4"},[a("div",aa,[a("button",{style:{position:"absolute",top:"-1rem",right:"-1rem","background-color":"var(--primary-color)",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center",color:"white","z-index":"99"},onClick:V=>oe(v),class:"add-cart-btn text-xl"},[a("i",{class:Ue(["icono text-2xl p-0 m-0",c(Ce).PENCIL])},null,2)],8,ta),a("button",{style:{position:"absolute",top:"-1rem",right:"2rem","background-color":"var(--red-500)",width:"2.5rem",height:"2.5rem","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center",color:"white","z-index":"99"},onClick:V=>J(v),class:"add-cart-btn text-xl"},[a("i",{class:Ue(["icono text-2xl p-0 m-0",c(Ce).TRASH])},null,2)],8,sa),a("div",la,[a("img",{class:"imagen",onError:m[1]||(m[1]=(...V)=>t.imagenError&&t.imagenError(...V)),style:{height:"50"},src:`${c(_)}/read-product-image/300/${v.name}`,alt:""},null,40,na)]),a("div",ia,[a("p",ra,W(v.name),1),a("p",ua,W(v.description),1)]),i(k,{style:{"box-shadow":"none"}}),a("div",ca,[a("div",da,W(c(De)(v.price)),1),i(A,{modelValue:v.isActive,"onUpdate:modelValue":V=>v.isActive=V,onChange:()=>M(v)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]))),128))]),i(k),i(Xo),i(_o),i($,{header:"Confirmation",visible:c(Z),"onUpdate:visible":m[3]||(m[3]=v=>U(Z)?Z.value=v:null),style:{width:"350px"},modal:!0},{footer:ae(()=>[i(f,{label:"No",icon:"pi pi-times",onClick:m[2]||(m[2]=v=>Z.value=!c(Z)),class:"p-button-text"}),i(f,{label:"Si",icon:"pi pi-check",onClick:Y,class:"p-button-text",autofocus:""})]),default:ae(()=>[a("div",pa,[ma,a("span",null,[ke("Seguro que desea eliminar "),a("b",null,W(c(te).name),1)])])]),_:1},8,["visible"])])}}},ya=fe(va,[["__scopeId","data-v-daaf12e1"]]);export{ya as default};
