import{r as z}from"./resumen-1fd57c57.js";import{u as E,a as G}from"./site-4b599247.js";import{f as V}from"./formatoPesos-2a38d2e7.js";import{u as L}from"./resumen.vue_vue_type_style_index_0_scoped_87f7cd7e_lang-dc6774f8.js";import{K as D,U as F,g as k,D as j,h as R,e as w,o as r,x as O,f as N,a as e,b as u,c as l,F as A,r as $,t as b,u as m,j as S,n as M,_ as H,p as K,k as J}from"./index-a97ea6dc.js";import"./ventas-9f09b372.js";import"./sass.default-a5b7a582.js";const Q="/images/empty-cart.jpg",B={async getAditional(g){try{const t=await D.get(`${F}/adicionales-new-active/${g}`);return t.status===200?t.data:(console.error("An error occurred while fetching the ingredients:",t.status),null)}catch(t){return console.error("An error occurred while fetching the ingredients:",t),null}},async getAditionalGroup(g,t){const f={instance_product_ids:g,site_id:t};try{const d=await D.post(`${F}/adicionales-new-group-active/`,f);return d.status===200?d.data:(console.error("An error occurred while fetching the ingredients:",d.status),null)}catch(d){return console.error("An error occurred while fetching the ingredients:",d),null}}},W={style:{color:"black"},class:"grid"},X={class:"mb-2"},Y={class:"mb-2 text-center"},Z={class:"mt-2"},ee={key:0,class:"p-0",style:{display:"flex",width:"100%",gap:"1rem"}},te={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},oe={class:"text-sm adicion",style:{"text-transform":"capitalize"}},ie={key:0,style:{display:"flex","align-items":"center"}},se={key:0,class:"pl-2 py-1 text-sm"},ne={key:1,class:"pl-2 py-1 text-sm"},re=e("hr",null,null,-1),ae={class:"col-12 p-0",style:{display:"flex","justify-content":"center","font-weight":"bold"}},le={__name:"dialogAddAditions",setup(g){const t=k({}),f=E(),d=G(),C=(i,a)=>{if(i.checked){const h={id:i.aditional_item_instance_id,name:i.aditional_item_name,price:i.aditional_item_price,group:a};t.value[h.id]={...h,quantity:i.quantity||1}}else delete t.value[i.aditional_item_instance_id]},q=i=>{if(i.checked){const a={id:i.aditional_item_instance_id,name:i.aditional_item_name,price:i.aditional_item_price};t.value[a.id].quantity++}},T=i=>{t.value[i.aditional_item_instance_id].quantity>1&&t.value[i.aditional_item_instance_id]&&t.value[i.aditional_item_instance_id].quantity--};j(()=>d.visibles.addAdditionToCart,async i=>{var a,h;if(!i)t.value={},x.value=[];else{const y=d.cart.products.map(s=>s.product.id);y.length>0&&(x.value=await B.getAditionalGroup(y,(h=(a=f.location)==null?void 0:a.site)==null?void 0:h.site_id))}},{deep:!0});const I=()=>{Object.values(t.value).forEach(a=>{d.addAdditionToCart(a),console.log(a)}),t.value={},d.setVisible("addAdditionToCart",!1)},x=k([]);return k(!0),R(async()=>{var a,h;const i=d.cart.products.map(y=>y.product.id);i.length>0&&(x.value=await B.getAditionalGroup(i,(h=(a=f.location)==null?void 0:a.site)==null?void 0:h.site_id))}),(i,a)=>{const h=w("Checkbox"),y=w("Button"),s=w("InputText"),_=w("Dialog");return r(),O(_,{class:"mx-3",closable:!0,style:M([{"background-color":"white"},{width:"30rem","border-radius":"0.5rem"}]),visible:m(d).visibles.addAdditionToCart,"onUpdate:visible":a[1]||(a[1]=o=>m(d).visibles.addAdditionToCart=o),modal:"",header:"Header"},{footer:N(()=>[e("div",ae,[u(y,{onClick:I,style:{width:"auto"},severity:"danger",label:"Agregar al carrito"})])]),default:N(()=>[e("div",W,[(r(!0),l(A,null,$(x.value,o=>(r(),l("div",{class:"col-12",style:{},key:o.category},[e("div",X,[e("span",Y,[e("b",null,b(o.category),1)]),e("div",Z,[(r(!0),l(A,null,$(o.items,n=>{var c,v;return r(),l("div",{key:n.aditional_item_instance_id,style:{display:"flex",gap:"1rem"}},[m(d).cart.products.some(p=>p.product.category_name==n.product_category_name)?(r(),l("div",ee,[u(h,{class:"my-1",binary:!0,modelValue:n.checked,"onUpdate:modelValue":p=>n.checked=p,onChange:()=>C(n,o.category)},null,8,["modelValue","onUpdate:modelValue","onChange"]),e("div",te,[e("span",oe,b(n.aditional_item_name),1),n.checked&&o.category!="SALSAS"?(r(),l("span",ie,[n.aditional_item_price>0?(r(),l("span",se,[e("b",null,b(m(V)(n.aditional_item_price*((c=t.value[n.aditional_item_instance_id])==null?void 0:c.quantity))),1)])):S("",!0),u(y,{onClick:p=>T(n),class:"ml-2",severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none"},icon:"pi pi-minus"},null,8,["onClick"]),u(s,{modelValue:(v=t.value[n.aditional_item_instance_id])==null?void 0:v.quantity,readonly:"",style:{width:"2rem",border:"none",height:"1.5rem"},class:"p-0 text-center"},null,8,["modelValue"]),u(y,{onClick:p=>q(n),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none"},icon:"pi pi-plus"},null,8,["onClick"])])):n.aditional_item_price>0?(r(),l("span",ne,[e("b",null,b(m(V)(n.aditional_item_price)),1)])):S("",!0)])])):S("",!0)])}),128)),re])])]))),128))]),u(y,{onClick:a[0]||(a[0]=o=>m(d).setVisible("addAdditionToCart",!1)),icon:"pi pi-times",style:{position:"absolute",right:"-1rem",top:"-1rem"},rounded:"",severity:"danger"})]),_:1},8,["visible"])}}};const P=g=>(K("data-v-9e198dd9"),g=g(),J(),g),de={key:0,class:"col-12 my-8 md:my-8 p-0"},ce=P(()=>e("p",{class:"text-center text-2xl my-8"},[e("b",null,"CARRITO DE COMPRAS")],-1)),ue={class:"grid mx-auto",style:{"max-width":"800px"}},pe={class:"col-12 text-sm md:col-6 p-3 md:px-4",style:{display:"flex","flex-direction":"column",gap:"1rem","justify-content":"center"}},_e={class:"col-12 py-3 p-shadow",style:{display:"flex","align-items":"end",position:"relative",gap:"1rem","border-radius":"0.3rem"}},me=["src"],he={style:{display:"flex","flex-direction":"column",gap:"0.4rem",width:"100%"}},ye={style:{display:"flex","flex-direction":"column",gap:"0.3rem",width:"100%"}},ge={style:{display:"flex","justify-content":"space-between","align-items":"center",width:"100%",gap:"1rem"}},ve={class:"p-0 m-0"},be={style:{display:"flex"}},fe=P(()=>e("div",null,null,-1)),xe={class:"p-0",style:{"box-shadow":"0 0 0.5rem rgba(0, 0, 0, 0.2)","background-color":"#ff620000","border-radius":"5rem",display:"flex"}},we={class:"p-0 m-0"},ke={class:"col-12 p-0 mt-1"},Ce={class:"mb-2"},Ae={class:"mb-2 text-center"},$e={class:"mt-2"},Se={style:{display:"flex",width:"100%",gap:"1rem","justify-content":"space-between"}},Te={class:"text adicion",style:{"text-transform":"capitalize"}},Ve={style:{display:"flex","align-items":"center"}},qe={key:0,class:"pl-2 py-1 text-sm"},Ie={key:1,style:{"box-shadow":"0 0 5px rgba(0, 0, 0, 0.411)",display:"flex","border-radius":"0.3rem"},class:"ml-2"},je={key:1,class:"col-12",style:{display:"flex","justify-content":"center",height:"90vh","align-items":"center"}},Be=P(()=>e("img",{style:{"border-radius":"0",width:"100%","max-width":"500px"},src:Q,alt:""},null,-1)),Pe=[Be],Ue={__name:"cart",setup(g){const t=G(),f=E(),d=k({}),C=k({}),q=L(),T=()=>{C.value=t.cart.additions.reduce((s,_)=>{let o=_.group;return s[o]||(s[o]=[]),s[o].push(_),s},{})};j(()=>t.cart.additions,()=>{T()},{deep:!0});const I=s=>{const _={...s};_.quantity=1,t.addAdditionToCart(_)},x=s=>{s.quantity>1&&t.removeAdditionFromCart(s.id)},i=s=>{t.removeAdditionCompletelyFromCart(s.id),T()},a=s=>{s.forEach(_=>{i(_)})};j(()=>t.visibles.addAdditionToCart,s=>{s&&(d.value={})},{deep:!0});const h=k([]);return R(async()=>{var _;((_=q.user.payment_method_option)==null?void 0:_.productogeneral_id)!=7?f.setNeighborhoodPrice():f.setNeighborhoodPriceCero();const s=53;h.value=await B.getAditional(s),C.value=t.cart.additions.reduce((o,n)=>{let c=n.group;return o[c]||(o[c]=[]),o[c].push(n),o},{})}),(()=>{const s=t.cart.products.map(o=>o.product.producto_id);console.log(s);const _=t.menu.data.map(o=>o.lista_agrupadores);console.log(_)})(),(s,_)=>{const o=w("Button"),n=w("InputText");return r(),l("div",null,[m(t).cart.products.length>0?(r(),l("div",de,[ce,e("div",ue,[e("div",pe,[(r(!0),l(A,null,$(m(t).cart.products,c=>(r(),l("div",_e,[e("img",{class:"p-1",style:{width:"5rem","object-fit":"cover",height:"5remh","aspect-ratio":"1 / 1",border:"3px solid var(--primary-color)"},src:`https://img.restpe.com/${c.product.productogeneral_urlimagen}`,alt:""},null,8,me),u(o,{class:"ml-2",onClick:v=>m(t).removeProductFromCart(c.product.productogeneral_id),icon:"pi pi-trash",severity:"danger",rounded:"",style:{border:"none",right:"-.5rem",top:"-.5rem",position:"absolute",outline:"none",width:"2rem",height:"2rem"}},null,8,["onClick"]),e("div",he,[e("div",ye,[e("div",ge,[e("span",ve,b(c.product.productogeneral_descripcion),1)]),e("div",be,[fe,e("div",xe,[u(o,{onClick:v=>m(t).removeProductInstance(c.product.productogeneral_id),icon:"pi pi-minus",severity:"danger",style:{border:"none",outline:"none",width:"2rem",height:"1.5rem","border-radius":"0.4rem 0 0 0.4rem"}},null,8,["onClick"]),u(n,{class:"text-center",style:{"background-color":"transparent","font-weight":"bold",width:"3rem",height:"1.5rem",color:"black",border:"none"},modelValue:c.quantity,readonly:""},null,8,["modelValue"]),u(o,{onClick:v=>m(t).addProductToCart(c.product),icon:"pi pi-plus ",severity:"danger",style:{"font-weight":"bold",border:"none",outline:"none",width:"2rem",height:"1.5rem","border-radius":"0 0.4rem   0.4rem 0"}},null,8,["onClick"])])])])]),e("h5",we,[e("b",null,b(m(V)(c.total_cost)),1)])]))),256)),e("div",ke,[(r(!0),l(A,null,$(C.value,(c,v)=>(r(),l("div",{class:"p-shadow p-3 mb-4",key:v,style:{position:"relative","border-radius":"0.3rem"}},[u(o,{class:"ml-2",onClick:p=>a(c),icon:"pi pi-trash",severity:"danger",rounded:"",style:{border:"none",right:"-.5rem",top:"-.5rem",position:"absolute",outline:"none",width:"2rem",height:"2rem"}},null,8,["onClick"]),e("div",Ce,[e("span",Ae,[e("b",null,b(v),1)]),e("div",$e,[(r(!0),l(A,null,$(c,p=>(r(),l("div",{key:p.aditional_item_instance_id,style:{display:"flex",gap:"1rem","align-items":"center"}},[u(o,{text:"",rounded:"",onClick:U=>i(p),class:"p-0 m-0",severity:"danger",style:{width:"2rem",height:"2rem",border:"none"},icon:"pi pi-trash m-0"},null,8,["onClick"]),e("div",Se,[e("span",Te,b(p.name),1),e("span",Ve,[p.price>0?(r(),l("span",qe,[e("b",null,b(m(V)(p.price*p.quantity)),1)])):S("",!0),v!="SALSAS"?(r(),l("div",Ie,[u(o,{onClick:U=>x(p),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none","border-radius":"0.3rem 0 0 0.3rem"},icon:"pi pi-minus"},null,8,["onClick"]),u(n,{modelValue:p.quantity,readonly:"",style:{width:"2rem",border:"none",height:"1.5rem"},class:"p-0 text-center"},null,8,["modelValue"]),u(o,{onClick:U=>I(p),severity:"danger",style:{width:"2rem",height:"1.5rem",border:"none","border-radius":"0 0.3rem 0.3rem 0"},icon:"pi pi-plus"},null,8,["onClick"])])):S("",!0)])])]))),128))])])]))),128))])]),u(z,{class:"md:col-6"})])])):(r(),l("div",je,Pe)),u(le)])}}},Le=H(Ue,[["__scopeId","data-v-9e198dd9"]]);export{Le as default};
