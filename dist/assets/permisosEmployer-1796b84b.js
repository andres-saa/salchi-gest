import{_ as de,E as ce,j as c,G as ue,z as pe,H as V,k as K,ap as me,r as C,o as G,c as Y,e as l,f as n,n as he,A as fe,U as S,a as e,h as d,t as i,d as E,u as D,af as L,i as _e,q as ve,x as ye,aq as Z}from"./index-bc571c19.js";const a=j=>(ve("data-v-f53db35e"),j=j(),ye(),j),be={class:"col-12 m-auto p-0"},ge=a(()=>e("p",{class:"mb-2 text-4xl text-center px-4",style:{"font-weight":"bold","text-transform":"capitalize"}},[e("i",{class:"fa-solid fa-person-walking-luggage"}),d(" Atender Permisos ")],-1)),xe={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},we={class:"block mt-2 md:mt-0 p-input-icon-left"},ke=a(()=>e("i",{class:"pi pi-search"},null,-1)),Ce=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Se=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Ee=a(()=>e("span",{class:"p-column-title"},"Code",-1)),ze=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Pe=a(()=>e("span",{class:"p-column-title"},"Code",-1)),$e=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Re=a(()=>e("span",{class:"p-column-title"},"Code",-1)),je=a(()=>e("span",{class:"p-column-title"},"Code",-1)),Ie={class:"text-center",style:{width:"100%"}},Te={style:{display:"flex",gap:"1rem"}},Ne=a(()=>e("div",null,null,-1)),Ae={class:"a4-size p-0 lg:p-6 mi-clase mt-4"},De=a(()=>e("img",{class:"m-auto",src:"https://salchimonster.com/images/logo.png",style:{width:"10%"},alt:""},null,-1)),Le={style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"}},Ue=a(()=>e("h6",{class:"text-center",style:{"font-size":"11pt","font-weight":"bold",color:"black","font-family":"Arial, Helvetica, sans-serif"}}," INVERSIONES SALCHIMONSTER SAS ",-1)),Me=a(()=>e("h6",{style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"},class:"text-center"},"NIT: 901.420.874-0",-1)),Oe={class:"text-center py-4",style:{"font-weight":"bold","text-transform":"uppercase"}},Be=a(()=>e("span",{style:{"text-transform":"capitalize"}},null,-1)),Fe={class:"text-l",style:{"font-size":"11pt","font-weight":"normal",color:"black","font-family":"Arial, Helvetica, sans-serif"}},Ve={class:"p-0 m-0"},He=a(()=>e("span",{style:{"font-weight":"bold"}},"Fecha de la solicitud: ",-1)),qe={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},Je={class:"p-0 m-0",style:{width:"100%"}},Ke=a(()=>e("span",{style:{"font-weight":"bold"}},"Nombre: ",-1)),Ge={style:{width:"100%","border-bottom":"1px solid","padding-bottom":"0","padding-right":"3rem"}},Ye={class:"p-0 m-0"},Ze=a(()=>e("span",{style:{"font-weight":"bold"}},"Cargo: ",-1)),Qe={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},We={class:"p-0 m-0"},Xe=a(()=>e("span",{style:{"font-weight":"bold"}},"IdentificaciÃ³n No: ",-1)),et={style:{"border-bottom":"1px solid","padding-bottom":"0","padding-right":"2rem"}},tt={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},st={style:{display:"flex","flex-direction":"column"},class:""},ot=a(()=>e("div",{style:{"font-weight":"bold"}}," Desde ",-1)),at={style:{display:"flex","flex-direction":"column"}},lt=a(()=>e("div",{style:{"font-weight":"bold"}}," Hasta ",-1)),nt={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},it={style:{display:"flex","flex-direction":"column"},class:""},rt={style:{display:"flex","flex-direction":"column"}},dt=a(()=>e("div",{style:{"font-weight":"bold"}}," Observaciones ",-1)),ct={style:{display:"flex","justify-content":"start",gap:"2rem",border:"1px solid","margin-top":"2rem"},class:"p-2"},ut={style:{display:"flex","flex-direction":"column"},class:""},pt={style:{display:"flex","flex-direction":"column"}},mt=a(()=>e("div",{class:"mb-2",style:{"font-weight":"bold"}}," Estado actual ",-1)),ht={class:"mb-1"},ft=a(()=>e("span",{style:{"font-weight":"bold"}},"Resumen:",-1)),_t={class:"mb-1"},vt=a(()=>e("span",{style:{"font-weight":"bold"}},"Fecha:",-1)),yt={class:"mb-1"},bt=a(()=>e("span",{style:{"font-weight":"bold"}}," Responsable :",-1)),gt={key:0},xt=a(()=>e("span",{style:{"font-weight":"bold"}},"Motivos del rechazo:",-1)),wt={class:"col-12 md:col-6 m-auto p-0 botonera",style:{display:"flex",gap:"1rem",overflow:"hidden","justify-content":"space-around",position:"absolute",top:"4rem",right:"0rem","background-color":"rgba(255, 255, 255, 0)te"}},kt=a(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),Ct=a(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),St=a(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),Et=a(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),zt=a(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),Pt=a(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),$t=a(()=>e("h6",null,"Razones para rechazar este permiso ",-1)),Rt=a(()=>e("span",{class:"p-input-icon-left",style:{width:"100%"}},[e("i",{class:"pi pi-pencil"})],-1)),jt=a(()=>e("span",{class:"text-center col-12 p-0"},"Si, continuar",-1)),It=a(()=>e("span",{class:"text-center col-12 p-0"},"No, talvez luego",-1)),Tt={__name:"permisosEmployer",setup(j){const z=ce(),Q=c(null),b=ue(),W=c(b.params.status),_=c(b.params.tipo),g=c(b.params.status),U=c(""),X=()=>{I.value={global:{value:null,matchMode:fe.CONTAINS}}},x=c(!1),M=c("2029-12-21 16:19"),r=c(),I=c(null),v=c([]),y=c({}),P=c(!1),$=c(!1),R=c(!1),H=c([]),ee=c(!0);pe(()=>{X()}),V(()=>b.params.status,s=>{W.value=s}),V(()=>b.params.tipo,s=>{_.value=s,console.log(_),w(s,g.value).then(t=>v.value=t)}),V(()=>b.params.status,s=>{g.value=s,w(_.value).then(t=>v.value=t)});const te=async s=>{x.value=!0,r.value=s,N(s.employer_id)},q=s=>{P.value=!0,r.value=s,N(s.employer_id)},se=s=>{R.value=!0,r.value=s,N(s.employer_id)},J=s=>{$.value=!0,r.value=s,N(s.employer_id)};function oe(s){s.status={status:"aprobado",timestamp:M.value,responsable:Z()},s.history.push({...s.status}),fetch(`${S}/permission/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(t=>{t.json(),x.value=!1,P.value=!1,w(_.value,g.value).then(p=>v.value=p)}).then(t=>console.log("Permiso aprobado:",t)).catch(t=>console.error("Error:",t))}function ae(s){z.setLoading(!0,"eliminando permiso"),R.value=!1,fetch(`${S}/permission/${s.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(t=>{t.ok?(console.log(`Permiso con ID ${s} eliminado`),x.value=!1,w(_.value,g.value).then(p=>v.value=p)):console.error("Error al intentar eliminar el permiso")}).catch(t=>console.error("Error:",t))}function le(s){s.status={status:"rechazado",timestamp:M.value,razones:U.value,responsable:Z()},s.history.push({...s.status}),fetch(`${S}/permission/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(t=>{t.json(),$.value=!1,x.value=!1,w(_.value,g.value).then(p=>v.value=p)}).then(t=>console.log("Permiso rechazado:",t)).catch(t=>console.error("Error:",t))}const O=c([]);K(()=>{me().then(s=>O.value=s)});function ne(s){var t=new Date(s),p={day:"numeric",month:"long",year:"numeric"};return t.toLocaleDateString("es-ES",p)}const ie=async()=>{fetch(`${S}/server_time`).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>{console.log("Employer data:",s),M.value=s}).catch(s=>{console.error("There has been a problem with your fetch operation:",s),mensaje.value="error"})};function T(s){s||(s="2029-12-21 16:19");const t=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];let[p,f]=s.split(" "),[u,B,k]=p.split("-").map(Number),F=t[B-1];return`${k} de ${F} de ${u}`}const N=async s=>{fetch(`${S}/employer/${s}`).then(t=>{if(!t.ok)throw new Error("Network response was not ok");return t.json()}).then(t=>{console.log("Employer data:",t),y.value=t}).catch(t=>{console.error("There has been a problem with your fetch operation:",t)})};async function w(){z.setLoading(!0,"cargando permisos");const s=`${S}/permissions/  `;try{const t=await fetch(s);if(!t.ok)throw z.setLoading(!1,"cargando permisos"),new Error(`Error al obtener los permisos: ${t.status}`);return ee.value=!1,z.setLoading(!1,"cargando permisos"),await t.json()}catch(t){throw console.error("Error en getPermissions:",t),z.setLoading(!1,"cargando permisos"),t}}K(()=>{w(_.value,g.value).then(s=>v.value=s),ie()});const re=()=>{window.print()};return(s,t)=>{const p=C("InputText"),f=C("Column"),u=C("Button"),B=C("DataTable"),k=C("Dialog"),F=C("Textarea");return G(),Y("div",be,[ge,l(B,{ref_key:"dt",ref:Q,value:v.value,selection:H.value,"onUpdate:selection":t[1]||(t[1]=o=>H.value=o),dataKey:"id",paginator:!0,rows:10,filters:I.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25,100],currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} permisoes",responsiveLayout:"scroll",scrollable:""},{header:n(()=>[e("div",xe,[e("span",we,[ke,l(p,{class:"",modelValue:I.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=o=>I.value.global.value=o),placeholder:"Buscar..."},null,8,["modelValue"])])])]),default:n(()=>[l(f,{class:"p-2",selectionMode:"multiple",headerStyle:"width: 3rem; ",frozen:""}),l(f,{class:"p-2",field:"id",header:"Id",sortable:!0,headerStyle:"width:3rem; min-width:min-content; "},{body:n(o=>[Ce,d(" "+i(o.data.id),1)]),_:1}),l(f,{class:"p-2",field:"tipo",header:"Tipo",sortable:!0,headerStyle:"width:10rem; min-width:min-content; "},{body:n(o=>[Se,d(" "+i(o.data.tipo),1)]),_:1}),l(f,{class:"p-2",field:"fecha",header:"Fecha",sortable:!0,headerStyle:"width:10rem; min-width:10rem; "},{body:n(o=>{var m;return[Ee,d(" "+i((m=o.data.history)==null?void 0:m.filter(h=>h.status=="generado")[0].timestamp),1)]}),_:1}),l(f,{class:"p-2",field:"employer_id",header:" Empleado",sortable:!0,headerStyle:"width:20rem; min-width:15rem; "},{body:n(o=>{var m,h;return[ze,d(" "+i((h=(m=O.value.filter(A=>A.id==o.data.employer_id)[0])==null?void 0:m.name)==null?void 0:h.split(" ").slice(0,3).join(" ")),1)]}),_:1}),l(f,{class:"p-2",field:"start_date",header:"Inicio",sortable:!0,headerStyle:"width:10rem; min-width:10rem; "},{body:n(o=>[Pe,d(" "+i(o.data.start_date),1)]),_:1}),l(f,{class:"p-2",field:"end_date",header:"Fin",sortable:!0,headerStyle:"width:15rem; min-width:10rem; "},{body:n(o=>[$e,d(" "+i(o.data.end_date),1)]),_:1}),l(f,{class:"p-2",field:"observations",header:"Observaciones del empleado",sortable:!0,headerStyle:"width:30rem; min-width:30rem; "},{body:n(o=>[Re,d(" "+i(o.data.observations),1)]),_:1}),l(f,{class:"p-2",field:"status.status",header:"Estado",sortable:!0,headerStyle:"width:10rem; min-width:max-content; "},{body:n(o=>[je,e("div",{class:E(["p-2 text-center",o.data.status.status]),style:{"border-radius":"10rem"}},[e("span",Ie,i(o.data.status.status),1)],2)]),_:1}),l(f,{class:"p-2",field:"location",header:"Acciones",sortable:!0,frozen:"",alignFrozen:"right",headerStyle:"width:min-content; min-width:min-content; "},{body:n(o=>[e("div",Te,[l(u,{class:"p-0",outlined:"",severity:"info",label:"Small",onClick:m=>te(o.data),text:""},{default:n(()=>[e("i",{class:E(["text-xl",D(L).EYE]),style:{"font-weight":"bold"}},null,2)]),_:2},1032,["onClick"]),l(u,{class:"p-0",disabled:o.data.status.status=="aprobado",outlined:"",severity:"success",label:"Small",text:"",onClick:m=>q(o.data),style:{display:"flex","justify-content":"center"}},{default:n(()=>[e("i",{class:E(["text-xl",D(L).CHECK]),style:{"font-weight":"bold"}},null,2)]),_:2},1032,["disabled","onClick"]),l(u,{class:"p-0",disabled:o.data.status.status=="rechazado"&&o.data.status.status!="aprobado",outlined:"",severity:"danger",label:"Small",onClick:m=>J(o.data),style:{display:"flex","justify-content":"center"},text:""},{default:n(()=>[e("i",{class:E(["text-xl",D(L).TIMES]),style:{"font-weight":"bold"}},null,2)]),_:2},1032,["disabled","onClick"]),l(u,{class:"p-0",onClick:m=>se(o.data),severity:"danger",text:""},{default:n(()=>[e("i",{class:E(["text-xl",D(L).TRASH]),style:{"font-weight":"bold"}},null,2)]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["value","selection","filters"]),Ne,l(k,{style:he([{border:"none","box-shadow":"none",position:"relative"},{width:"700px"}]),visible:x.value,"onUpdate:visible":t[4]||(t[4]=o=>x.value=o),modal:!0,class:"p-fluid m-2 pt-8"},{default:n(()=>{var o,m;return[e("div",Ae,[De,e("h6",Le,i(T(r.value.history.filter(h=>h.status=="generado")[0].timestamp)),1),Ue,Me,e("h6",Oe,[d("FORMATO SOLICITUD DE PERMISO "+i(r.value.tipo)+" ",1),Be]),e("h5",Fe,[e("p",Ve,[He,d(),e("span",qe,i(T(r.value.history.filter(h=>h.status=="generado")[0].timestamp)),1)]),e("p",Je,[Ke,d(),e("span",Ge,i(y.value.name),1)]),e("p",Ye,[Ze,d(),e("span",Qe,i(y.value.position),1)]),e("p",We,[Xe,d(),e("span",et,i(y.value.dni),1)]),e("div",tt,[e("div",st,[ot,e("div",null,i(T(r.value.start_date)),1)]),e("div",at,[lt,e("div",null,i(T(r.value.end_date)),1)])]),e("div",nt,[e("div",it,[e("div",rt,[dt,e("div",null,i(r.value.observations),1)])])]),e("div",ct,[e("div",ut,[e("div",pt,[mt,e("div",ht,[ft,d(),e("span",{style:{"border-radius":"0 1rem 1rem 0"},class:E(["col-12 p-0",r.value.status.status])},i(r.value.status.status),3)]),e("div",_t,[vt,d(" "+i(ne(r.value.status.timestamp)),1)]),e("div",yt,[bt,d(" "+i((o=O.value.filter(h=>{var A;return h.id==((A=r.value.status)==null?void 0:A.responsable)})[0])==null?void 0:o.name),1)]),r.value.status.status=="rechazado"?(G(),Y("div",gt,[xt,d(" "+i((m=r.value.status)==null?void 0:m.razones),1)])):_e("",!0)])])])])]),e("div",wt,[l(u,{class:"text-center",onClick:t[2]||(t[2]=h=>q(r.value)),severity:"success",style:{border:"none",display:"flex","justify-content":"center"}},{default:n(()=>[d(" APROBAR ")]),_:1}),l(u,{onClick:t[3]||(t[3]=h=>J(r.value)),severity:"danger",style:{border:"none",display:"flex","justify-content":"center"}},{default:n(()=>[d(" RECHAZAR")]),_:1}),l(u,{onClick:re,severity:"warning",style:{border:"none",display:"flex","justify-content":"center"}},{default:n(()=>[d(" IMPRIMIR")]),_:1})])]}),_:1},8,["visible"]),l(k,{header:"Confirmacion",visible:R.value,"onUpdate:visible":t[7]||(t[7]=o=>R.value=o),style:{width:"350px"},modal:!0},{default:n(()=>[e("h5",null,"Seguro que desea eliminar el permiso de "+i(y.value.name),1),kt,l(u,{onClick:t[5]||(t[5]=o=>ae(r.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:n(()=>[Ct]),_:1}),l(u,{onClick:t[6]||(t[6]=o=>R.value=!1),style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:n(()=>[St]),_:1})]),_:1},8,["visible"]),l(k,{header:"Confirmacion",visible:P.value,"onUpdate:visible":t[10]||(t[10]=o=>P.value=o),style:{width:"350px"},modal:!0},{default:n(()=>[e("h5",null,"Seguro que desea aceptar el permiso de "+i(y.value.name),1),Et,l(u,{onClick:t[8]||(t[8]=o=>oe(r.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:n(()=>[zt]),_:1}),l(u,{onClick:t[9]||(t[9]=o=>P.value=!1),style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:n(()=>[Pt]),_:1})]),_:1},8,["visible"]),l(k,{header:"Confirmacion",visible:$.value,"onUpdate:visible":t[14]||(t[14]=o=>$.value=o),style:{width:"350px"},modal:!0},{default:n(()=>[e("h5",null,"Seguro que desea Rechazar el permiso de "+i(y.value.name)+"?",1),$t,l(F,{modelValue:U.value,"onUpdate:modelValue":t[11]||(t[11]=o=>U.value=o),style:{"max-width":"100%","min-width":"100%","min-height":"100px"},class:"col-12"},null,8,["modelValue"]),Rt,l(u,{onClick:t[12]||(t[12]=o=>le(r.value)),style:{margin:"auto","background-color":"rgb(105, 255, 157)",color:"black",border:"none"},class:"m-auto my-4 text-center"},{default:n(()=>[jt]),_:1}),l(u,{onClick:t[13]||(t[13]=o=>$.value=!1),style:{"background-color":"rgb(255, 156, 156)",color:"rgba(0, 0, 0, 0.864)",border:"none"},class:"m-auto my-4 ml-4 text-center"},{default:n(()=>[It]),_:1})]),_:1},8,["visible"])])}}},At=de(Tt,[["__scopeId","data-v-f53db35e"]]);export{At as default};
