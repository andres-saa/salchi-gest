import{_ as L,h as y,G as R,i as q,g as G,o as r,c as d,f as s,e as c,u as a,a as o,d as k,k as V,F as K,j as C,U as w,$ as h,a2 as E,ae as v,a5 as A,a1 as m,t as p,a0 as T,p as X,m as H,q as I}from"./index-ef821f84.js";import{f as $}from"./formatoPesos-2293ab52.js";const D=U=>(X("data-v-62e1556e"),U=U(),H(),U),Q={style:{display:"flex","justify-content":"center","align-items":"center","flex-direction":"column",width:"100%"}},Y=D(()=>o("h3",null,[o("b",null,"Melo")],-1)),Z=D(()=>o("i",{class:"pi pi-check text-7xl",style:{"font-weight":"bold",color:"green"}},null,-1)),P={class:"p-3"},ee={class:"field"},ae=D(()=>o("label",{for:"descuentoMayor"},[o("b",null,"Descuento para Precio Mayor (%)")],-1)),te={class:"field mt-3"},ie=D(()=>o("label",{for:"descuentoDistribuidor"},[o("b",null,"Descuento para Precio Distribuidor (%)")],-1)),se={class:"flex justify-content-end gap-2 mt-4"},oe={style:{"margin-top":"10rem","max-width":"1200px",margin:"10rem auto"},class:"px-3"},re={style:{width:"100%","justify-content":"center",display:"flex"},class:"my-4"},le=["src"],ne=D(()=>o("h5",null,[I(" ¿No ves algún producto? Prueba "),o("b",null,"Sincronizar la Districarta"),I(" (tardará un poco mientras obtenemos todos los datos de restaurant.PE) "),o("b",null,"2 minutos como máximo.")],-1)),de={style:{display:"flex","justify-content":"end",width:"100%"}},ue={class:"m-0 p-0"},ce={class:"m-0 p-0"},me={key:0},pe={key:1,class:"m-0 p-0"},_e={key:0},ye={key:1,class:"m-0 p-0"},he={key:0},ve={key:1,class:"m-0 p-0"},fe={key:0},be={key:1,class:"m-0 p-0"},ge={key:0},xe={key:1,class:"m-0 p-0"},ke={key:0},Ve={key:1,class:"m-0 p-0"},we={key:0},De={key:1,class:"m-0 p-0"},Ue={style:{display:"flex",gap:"1rem","justify-content":"end",margin:"1rem 0"}},Se={__name:"Distrimonster",setup(U){const f=y(!1),b=y(!1),g=y(0),x=y(0),_=y([]),F=y([]),n=y(!1),M=y({unit_measures:[],presentation_measures:[]}),N=u=>{u.value&&(_.value=u.value),_.value.forEach((t,i)=>{t.index=i})};R(()=>_.value.slice().sort((u,t)=>u.index-t.index));const j=R(()=>JSON.stringify(_.value)!==JSON.stringify(F.value)),S=async()=>{var u,t;try{const e=((t=(u=(await C.get(`${w}/get-product-integration-distrimonster`)).data)==null?void 0:u.data)==null?void 0:t.filter(l=>l.categoria_id==107))||[];_.value=e,F.value=JSON.parse(JSON.stringify(e))}catch(i){console.error("Error al actualizar los datos:",i)}try{const i=await C.get(`${w}/distrimonster-measures/`);M.value=i}catch(i){console.error("Error al actualizar los datos:",i)}},z=()=>{n.value=!1,S()};q(async()=>{S()});const W=async()=>{try{await C.post(`${w}/refresh-cache-distrimonster?quipupos=0`),S(),f.value=!0}catch(u){console.error("Error al refrescar la caché:",u)}},B=async()=>{var t;const u={prices:(t=_.value)==null?void 0:t.map(i=>({id:i.id,mayor:parseInt(i.mayor),distribuidor:parseInt(i.distribuidor),presentacion:i.presentacion,presentation_unit_measure_id:i.presentation_unit_measure_id,unit_measure_id:i.unit_measure_id,kilos_delivery:i.kilos_delivery,index:i.index}))};try{await C.put(`${w}/update-prices`,u),f.value=!0,n.value=!1,S()}catch(i){console.error("Error al actualizar precios:",i)}},J=()=>{const u=parseInt(g.value,10)||0,t=parseInt(x.value,10)||0;_.value=_.value.map(i=>{const e=i.minor*(1-u/100),l=i.minor*(1-t/100);return{...i,mayor:parseFloat(e.toFixed(0)),distribuidor:parseFloat(l.toFixed(0))}}),b.value=!1,g.value=0,x.value=0},O=()=>{b.value=!1,g.value=0,x.value=0};return(u,t)=>{const i=G("Dropdown");return r(),d(K,null,[s(a(E),{visible:f.value,"onUpdate:visible":t[1]||(t[1]=e=>f.value=e),modal:"",closable:!1,style:{display:"flex","justify-content":"center",width:"10rem"}},{default:c(()=>[o("div",Q,[Y,Z,s(a(h),{onClick:t[0]||(t[0]=e=>f.value=!1),icon:"pi pi-times",style:{position:"absolute","aspect-ratio":"1/1","border-radius":"50%",right:"-1.5rem",top:"-1.5rem"},severity:"danger"})])]),_:1},8,["visible"]),s(a(E),{visible:b.value,"onUpdate:visible":t[4]||(t[4]=e=>b.value=e),modal:"",header:"Modificar precios masivamente",closable:!0,style:{width:"20rem"}},{default:c(()=>[o("div",P,[o("div",ee,[ae,s(a(v),{inputStyle:{width:"100%",height:"2rem",borderRadius:"0"},id:"descuentoMayor",modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=e=>g.value=e),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),o("div",te,[ie,s(a(v),{inputStyle:{width:"100%",height:"2rem",borderRadius:"0"},id:"descuentoDistribuidor",modelValue:x.value,"onUpdate:modelValue":t[3]||(t[3]=e=>x.value=e),mode:"decimal",min:0,max:100,step:.1,class:"w-full"},null,8,["modelValue"])]),o("div",se,[s(a(h),{label:"Cancelar",severity:"danger",onClick:O}),s(a(h),{label:"Aplicar",severity:"success",onClick:J})])])]),_:1},8,["visible"]),o("div",oe,[o("div",re,[o("img",{src:`${a(w)}/read-photo-product/iX6UiE6e`,alt:"",style:{height:"5rem",width:"min-content",margin:"auto"}},null,8,le)]),s(a(A),{class:"p-4",severity:"success"},{default:c(()=>[ne]),_:1}),o("div",de,[s(a(h),{onClick:W,severity:"help",label:"Sincronizar Districarta",class:"my-4"})]),s(a(T),{onRowReorder:N,value:_.value,class:"shadow-1"},{default:c(()=>[n.value?(r(),k(a(m),{key:0,rowReorder:"",headerStyle:"width: 3rem",reorderableColumn:!1})):V("",!0),s(a(m),{header:"Producto",class:"m-0 py-0"},{body:c(e=>[o("h6",ue,p(e.data.productogeneral_descripcion),1)]),_:1}),s(a(m),{header:"Precio base",class:"m-0 py-0 py-2"},{body:c(e=>[o("h6",ce,p(a($)(e.data.minor)),1)]),_:1}),s(a(m),{header:"Precio Mayor",class:"m-0 py-0"},{body:c(e=>[n.value?(r(),d("div",me,[s(a(v),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.mayor,"onUpdate:modelValue":l=>e.data.mayor=l,mode:"currency",currency:"USD",locale:"en-US",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(r(),d("h6",pe,p(a($)(e.data.mayor)),1))]),_:1}),s(a(m),{header:"Precio Distribuidor",class:"m-0 py-0"},{body:c(e=>[n.value?(r(),d("div",_e,[s(a(v),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.distribuidor,"onUpdate:modelValue":l=>e.data.distribuidor=l,mode:"currency",currency:"USD",locale:"en-US",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(r(),d("h6",ye,p(a($)(e.data.distribuidor)),1))]),_:1}),s(a(m),{header:"Unidad de medida",class:"m-0 py-0"},{body:c(e=>[n.value?(r(),d("div",he,[s(i,{options:M.value.unit_measures,optionValue:"id",modelValue:e.data.unit_measure_id,"onUpdate:modelValue":l=>e.data.unit_measure_id=l,optionLabel:"name",style:{height:"2rem",width:"100%",display:"flex","align-items":"center"}},null,8,["options","modelValue","onUpdate:modelValue"])])):(r(),d("h6",ve,p(e.data.unit_measure),1))]),_:1}),s(a(m),{header:"Presentacion (kg)",class:"m-0 py-0"},{body:c(e=>[n.value?(r(),d("div",fe,[s(a(v),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.presentacion,"onUpdate:modelValue":l=>e.data.presentacion=l,suffix:` ${e.data.unit_measure}`,locale:"en-US",min:"0",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue","suffix"])])):(r(),d("h6",be,p(e.data.presentacion)+" "+p(e.data.unit_measure),1))]),_:1}),s(a(m),{header:"Unid. Med. Pres.",class:"m-0 py-0"},{body:c(e=>[n.value?(r(),d("div",ge,[s(i,{options:M.value.presentation_measures,optionValue:"id",modelValue:e.data.presentation_unit_measure_id,"onUpdate:modelValue":l=>e.data.presentation_unit_measure_id=l,optionLabel:"name",style:{height:"2rem",width:"100%",display:"flex","align-items":"center"}},null,8,["options","modelValue","onUpdate:modelValue"])])):(r(),d("h6",xe,p(e.data.presentation_unit_measure),1))]),_:1}),s(a(m),{header:"Kilos domi (kg)",class:"m-0 py-0"},{body:c(e=>[n.value?(r(),d("div",ke,[s(a(v),{inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},modelValue:e.data.kilos_delivery,"onUpdate:modelValue":l=>e.data.kilos_delivery=l,suffix:" kg",locale:"en-US",min:"0",minFractionDigits:0,maxFractionDigits:2},null,8,["modelValue","onUpdate:modelValue"])])):(r(),d("h6",Ve,p(e.data.kilos_delivery)+" Kg ",1))]),_:1}),s(a(m),{header:"Posicion",class:"m-0 py-0",style:{width:"min-content"}},{body:c(e=>[n.value?(r(),d("div",we,[s(a(v),{modelValue:e.data.index,"onUpdate:modelValue":l=>e.data.index=l,optionLabel:"name",inputStyle:{width:"100%",maxWidth:"10rem",height:"2rem",borderRadius:"0"},style:{height:"2rem",width:"3rem",display:"flex","align-items":"center"}},null,8,["modelValue","onUpdate:modelValue"])])):(r(),d("h6",De,p(e.data.index),1))]),_:1})]),_:1},8,["value"]),o("div",Ue,[n.value&&j.value?(r(),k(a(h),{key:0,onClick:B,severity:"success",label:"Guardar cambios"})):V("",!0),n.value?V("",!0):(r(),k(a(h),{key:1,onClick:t[5]||(t[5]=e=>n.value=!0),severity:"info",label:"Editar"})),n.value?(r(),k(a(h),{key:2,onClick:z,severity:"danger",label:"Descartar"})):V("",!0),n.value?(r(),k(a(h),{key:3,onClick:t[6]||(t[6]=e=>b.value=!0),severity:"warning",label:"Modificar Masiva"})):V("",!0)])])],64)}}},$e=L(Se,[["__scopeId","data-v-62e1556e"]]);export{$e as default};
