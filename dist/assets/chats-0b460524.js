import{H as xe,h,i as ee,I as te,j as N,J as M,D as ue,g as L,o as l,c as k,a as t,n,u as i,F as le,r as ce,d as D,e as u,t as v,f as d,k as B,b as pe,p as we,m as ke,_ as me,C as Te,l as Le,G as De,U as Ue,q as de,K as je,L as Re}from"./index-777afe56.js";import{c as fe,u as $e,P as Ne}from"./Messages.vue_vue_type_style_index_0_scoped_09e7a26a_lang-3cb2c7fd.js";/* empty css                                                             */import Oe from"./Messages-64bdaf3c.js";const Se=U=>(we("data-v-a255a83f"),U=U(),ke(),U),Ie={class:"sidebar-container",style:{position:"relative"}},Ae={class:"header"},ze=Se(()=>t("strong",null," Notificaciones ",-1)),Me=[ze],Ve=["onClick"],Pe={class:"avatar",style:{"grid-area":"imagen",height:"100%",width:"100%",display:"flex","align-items":"center"}},Fe={class:"flex align-items-center"},Be=["src"],We={class:"flex align-items-center"},Je=["src"],Ke={style:{display:"flex",gap:"1rem"}},qe={style:{position:"relative"}},Ge={style:{height:"1.5rem",width:"1.5rem","border-radius":"50%","background-color":"rgb(156,39,176)",position:"absolute",top:"-1rem",right:"-.7rem",display:"flex","align-items":"center","justify-content":"center","font-weight":"bold"}},He={style:{color:"white"}},Xe={class:"statuses"},Ye=["onClick"],Qe={class:"avatar",style:{"grid-area":"imagen",height:"100%",width:"100%",display:"flex","align-items":"center"}},Ze={style:{"grid-area":"check",display:"flex","justify-content":"end",gap:".5rem"}},et={key:0,style:{height:"1.5rem",width:"1.5rem","border-radius":"50%","background-color":"rgb(156,39,176)",display:"flex","align-items":"center","justify-content":"center","font-weight":"bold"}},tt={style:{color:"white"}},at=Se(()=>t("i",{style:{color:"greenyellow"},class:"fa-solid fa-check-double"},null,-1)),st={key:0,style:{bottom:"0","padding-bottom":"1rem",background:"linear-gradient(to bottom , transparent 3%, black)",display:"flex",position:"absolute","z-index":"100",width:"100%",color:"white"}},ot={key:1,style:{"text-align":"center",padding:".5rem",color:"#ffffff80"}},ye=1e3,it=xe({__name:"Sidebar",props:{restaurant:Object},setup(U){const p=h(!1),X=o=>{o.target.closest(".notifications")||(p.value=!1)};ee(()=>{document.addEventListener("click",X)}),te(()=>{document.removeEventListener("click",X)});const g=fe(),ne=U,x=$e(),Y=[{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"},{id:7,name:"Distrimoster",img:"https://backend.salchimonster.com/read-photo-product/iX6UiE6e"}],f=h(ne.restaurant||Y[0]);h([{label:"Todos",textColor:"#4CAF50"},{label:"Sin leer",textColor:"#2196F3"},{label:"Favoritos",textColor:"#FFC107"},{label:"Preocupantes",textColor:"#F44336"},{label:"Top",textColor:"#9C27B0"}]);const _=async o=>{x.current_user=o,p.value=!1;try{await N.post(`${M}/read-message/${o.user_id}/${f.value.id}`,!1)}catch(r){console.error("No se pudo marcar como leído",r)}o.unreaded=0},q=async o=>{x.current_user=o.user_info,p.value=!1;try{await N.post(`${M}/read-message/${o.user_info.user_id}/${f.value.id}`,!1),await N.post(`${M}/view_notification/${o.id}`,!1)}catch(r){console.error("No se pudo marcar como leído",r)}o.unreaded=0},W=h([{label:"TODO",bg:"#8e44ad",icon:"fa-star"},{label:"SIN DATOS",bg:"#7f8c8d",icon:"fa-circle-question"},{label:"PREOCUPANTE",bg:"#e74c3c",icon:"fa-triangle-exclamation"},{label:"CASUAL",bg:"#e67e22",icon:"fa-person-walking"},{label:"FRECUENTE",bg:"#27ae60",icon:"fa-repeat"},{label:"TOP",bg:"#2980b9",icon:"fa-ranking-star"},{label:"ESTRELLA",bg:"#8e44ad",icon:"fa-star"}]),$=h({label:"TODO",bg:"#8e44ad",icon:"fa-star"}),O=h(0);let w=0;const I=h(!1),P=h(!1),A=h(null),ae=o=>{var c;if(!o)return"";const r=o.split(" ");return(r[0][0]||"")+(((c=r[1])==null?void 0:c[0])||"")};ee(async()=>{x.notifications[f.value.id]=await N.get(`${M}/notifications/${f.value.id}`)});const G=o=>o==="9+"?10:Number(o??0),C=(o,r)=>{const c=x.sidebars[o]||[];r.forEach(S=>{const b=c.findIndex(R=>R.wa_id===S.wa_id);if(b===-1)c.push(S);else{const R=c[b],K=R.ultimo_mensaje_id!==S.ultimo_mensaje_id,a=G(S.unreaded)<G(R.unreaded);(K||a)&&(c[b]=S)}}),x.sidebars[o]=c,O.value=c.reduce((S,b)=>S+G(b.unreaded),0)},Q=async()=>{if(I.value||P.value)return;I.value=!0;const o=`${M}/last-contact-messages/${f.value.id}?limit=${ye}&offset=${w}`,r=await N.get(o,!1);r.length<ye&&(P.value=!0),w+=r.length,C(f.value.id,r),I.value=!1},Z=()=>{const o=A.value;if(!o||I.value||P.value)return;o.scrollTop+o.clientHeight>=o.scrollHeight-120&&Q()},z=o=>{const r=f.value.id,c=x.sidebars[r]||[],S=c.findIndex(b=>b.wa_id===o.wa_id);S!==-1?(c.splice(S,1),x.sidebars[r]=[o,...c]):x.sidebars[r]=[o,...c],O.value=x.sidebars[r].reduce((b,R)=>b+Number(R.unreaded||0),0)};let T=null;const j=()=>{const o=`wss://sockets-service.salchimonster.com/ws/salchimonster-${f.value.id}`;T=new WebSocket(o),T.onopen=()=>console.log("WebSocket conectado a",o),T.onerror=r=>console.error("WebSocket error",r),T.onclose=()=>setTimeout(j,5e3),T.onmessage=async r=>{const c=JSON.parse(r.data);c!=null&&c.user_id&&z(c)}};ue(f,async o=>{w=0,P.value=!1,x.sidebars[o.id]=[],T&&T.close(),j(),await Q(),J.value=!1,setTimeout(()=>{J.value=!0},0)}),ee(async()=>{var o;await Q(),(o=A.value)==null||o.addEventListener("scroll",Z),j()}),te(()=>{var o;(o=A.value)==null||o.removeEventListener("scroll",Z),T&&T.close()});const J=h(!0),se=o=>{$.value=o,J.value=!1,setTimeout(()=>{J.value=!0},0)};return(o,r)=>{var K,a,s;const c=L("RouterLink"),S=L("Dropdown"),b=L("Button"),R=L("ProgressSpinner");return l(),k("div",Ie,[t("div",Ae,[t("div",{class:"notifications",style:n([p.value?{height:"80vh",top:"4rem",boxShadow:"0 1rem 1rem #00000040"}:{height:0,overflow:"hidden",top:"-2rem"},{width:"100%","max-width":"20rem","background-color":"#ffffff90","max-height":"80vh",overflow:"auto",padding:"1rem",position:"absolute","z-index":"9",transition:"all linear .2s","border-radius":".5rem",right:"0","backdrop-filter":"blur(5px)"}])},[t("h4",{class:"my-3",style:n(i(g).current_chat_theme.text)},Me,4),(l(!0),k(le,null,ce((a=(K=i(x))==null?void 0:K.notifications)==null?void 0:a[f.value.id],(e,m)=>(l(),D(c,{"active-class":i(g).current_chat_theme.name=="dark"?"active":"active-light",key:m,to:`/chat/chats/messages/${f.value.id}/${e.user_info.wa_id}/${e.user_info.nombre}/${e.user_info.color}?expirado=${e.user_info.expirado}&?expira-en?=${e.user_info.tiempo_para_expirar}`},{default:u(()=>[t("div",{class:"chat2",onClick:()=>q(e),style:n(e.resolved?"background-color: #fff":"background-color: #b6f8ff59")},[t("div",Pe,[t("div",{style:n([{height:"3rem",width:"3rem","aspect-ratio":"1/1","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase","font-size":"1.3rem"},`background-color:${e.color||"black"}`])},v(ae(e.user_info.nombre)),5)]),t("div",{style:n([{"grid-area":"nombre","text-transform":"uppercase"},`${i(g).current_chat_theme.text} ; ${e.resolved?"":"font-weight: bold;"}`])},v(e.description),5),t("span",{style:n([{"grid-area":"mensaje",color:"#ffffff80",opacity:".5"},i(g).current_chat_theme.text])},v(e.user_info.nombre),5)],12,Ve)]),_:2},1032,["active-class","to"]))),128))],4),d(S,{modelValue:f.value,"onUpdate:modelValue":r[0]||(r[0]=e=>f.value=e),options:Y,optionLabel:"name",style:n([{"background-color":"#ffffff20",outline:"none","box-shadow":"none"},i(g).current_chat_theme.border])},{option:u(e=>[t("div",Fe,[t("img",{src:e.option.img,alt:"Logo",style:{width:"24px",height:"24px","margin-right":"8px","object-fit":"contain"}},null,8,Be),t("span",null,[t("b",null,v(e.option.name),1)])])]),value:u(e=>[t("div",We,[e.value?(l(),k("img",{key:0,src:e.value.img,alt:"Logo",style:{width:"24px",height:"24px","margin-right":"8px","object-fit":"contain"}},null,8,Je)):B("",!0),t("span",{style:n(i(g).current_chat_theme.text)},v(e.value?e.value.name:"Selecciona"),5)])]),_:1},8,["modelValue","style"]),t("div",Ke,[d(b,{class:"options",text:""},{default:u(()=>[t("i",{class:"pi pi-search text-2xl",style:n(i(g).current_chat_theme.text)},null,4)]),_:1}),t("div",qe,[d(b,{class:"options",text:"",style:{opacity:".5"}},{default:u(()=>[t("i",{class:"pi pi-bell text-2xl notifications",onClick:r[1]||(r[1]=e=>p.value=!p.value),style:n(i(g).current_chat_theme.text)},null,4)]),_:1}),t("div",Ge,[t("span",He,v(O.value),1)])]),d(b,{class:"options",text:""},{default:u(()=>[t("i",{class:"pi pi-bars text-2xl",style:n(i(g).current_chat_theme.text)},null,4)]),_:1})])]),t("div",Xe,[(l(!0),k(le,null,ce(W.value,(e,m)=>(l(),D(b,{style:n([{"border-radius":".3rem",padding:"0.3rem"},e.label===$.value.label?{backgroundColor:e.bg,color:"#fff"}:{backgroundColor:"#ffffff20",color:e.bg}]),text:"",key:m,onClick:()=>se(e),class:"status",label:e.label},null,8,["onClick","label","style"]))),128))]),t("div",{class:pe(["",J.value?"chats active-new":"chats"]),ref_key:"chatsContainer",ref:A,onScroll:Z},[(l(!0),k(le,null,ce(((s=i(x).sidebars[f.value.id])==null?void 0:s.filter(e=>e.clasification==$.value.label||$.value.label=="TODO"))||[],(e,m)=>(l(),D(c,{"active-class":i(g).current_chat_theme.name=="dark"?"active":"active-light",key:m,to:`/chat/chats/messages/${f.value.id}/${e.wa_id}/${e.nombre}/${e.color}?expirado=${e.expirado}&?expira-en?=${e.tiempo_para_expirar}`},{default:u(()=>[t("div",{class:"chat",onClick:()=>_(e)},[t("div",Qe,[t("div",{style:n([{height:"3rem",width:"3rem","aspect-ratio":"1/1","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase","font-size":"1.3rem"},`background-color:${e.color||"black"}`])},v(ae(e.nombre)),5)]),t("div",{style:n([{"grid-area":"nombre","text-transform":"capitalize"},i(g).current_chat_theme.text])},v(e.nombre),5),e.tiempo_para_expirar||!e.expirado?(l(),k("div",{key:0,style:n([{"grid-area":"expiration","text-align":"end","text-transform":"capitalize",opacity:".5"},i(g).current_chat_theme.text])}," Expira en "+v(e.tiempo_para_expirar),5)):(l(),k("div",{key:1,style:n([{"grid-area":"expiration","text-align":"end","text-transform":"capitalize",opacity:".5"},i(g).current_chat_theme.text])}," Expirado ",4)),t("span",{style:n([{"grid-area":"mensaje",color:"#ffffff80",opacity:".5"},i(g).current_chat_theme.text])},v(e.mensaje_truncado),5),t("span",{style:n([{"grid-area":"fecha","text-align":"end"},i(g).current_chat_theme.text])},v(e.abreviatura||e.fecha_ultimo_mensaje),5),t("div",Ze,[e.unreaded>0?(l(),k("div",et,[t("span",tt,v(e.unreaded),1)])):B("",!0),at])],8,Ye)]),_:2},1032,["active-class","to"]))),128)),I.value?(l(),k("div",st,[(l(),D(R,{key:0,style:{width:"50px",height:"50px"},strokeWidth:"8",fill:"transparent",animationDuration:".3s","aria-label":"Custom ProgressSpinner"}))])):B("",!0),P.value?(l(),k("div",ot,"No hay más chats.")):B("",!0)],34)])}}}),be=me(it,[["__scopeId","data-v-a255a83f"]]),Ee=U=>(we("data-v-5ca3d81f"),U=U(),ke(),U),nt={class:"top-bar-left"},rt={style:{height:"3rem",width:"3rem",display:"flex","align-items":"center"}},lt={class:"top-bar-info"},ct={style:{display:"flex","align-items":"center",gap:"1rem"}},dt={style:{height:"100%",overflow:"auto"}},ut={key:1,style:{display:"flex","justify-content":"center","align-items":"center",height:"100%"}},pt={class:"message-area"},mt=Ee(()=>t("i",{class:"fas fa-laugh-wink emoji-picker"},null,-1)),ft=["onKeydown"],_t=["src"],ht={style:{position:"relative",transition:".2s"}},gt=Ee(()=>t("i",{class:"pi pi-send text-2xl"},null,-1)),vt={style:{display:"flex",gap:"1rem"}},yt={class:"flex gap-2"},bt={style:{width:"100%",display:"flex","justify-content":"end"}},xt=xe({__name:"Main",setup(U){const p=fe();function X(a){return{APPROVED:"success",PENDING:"warning",REJECTED:"danger"}[a]||"info"}const g=a=>{ne(a),f.value=!1};async function ne(a){const s=a,e=new FormData;e.append("messaging_product","whatsapp"),e.append("employer_id",q.rawUserData.id.toString()),e.append("context_message_id",""),e.append("restaurant_id",_.params.restaurant_id),e.append("to",_.params.user_id),e.append("type","template"),e.append("template",JSON.stringify(s));try{C.sending=!0,await N.post(`${M}/webhook/send/template/`,e,!1),console.log(`✅ Template enviado a ${to}`)}catch(m){console.error(`✗ Error al enviar template a ${to}`,m)}finally{C.sending=!1}}const x=h([{}]),Y=a=>{a.target.closest(".emoji-picker")||(W.value=!1)};ee(()=>{document.addEventListener("click",Y),K()}),te(()=>{document.removeEventListener("click",Y)});const f=h(!1);h([]);const _=Te(),q=Le(),W=h(!1),$=h(""),O=h(!1),w=h(null),I=h(!1),P=h(!0),A=De(()=>{var a,s;return P.value&&(((a=_.query)==null?void 0:a.expirado)==="true"||((s=_.query)==null?void 0:s.expirado)===!0)}),ae=a=>{P.value=a};ue(()=>{var a;return(a=_.params)==null?void 0:a.restaurant_id},()=>{K()}),ue(A,a=>{$.value=a?"Conversación expirada":""},{immediate:!0});const G={"SIN DATOS":{bg:"#7f8c8d",icon:"fa-circle-question"},PREOCUPANTE:{bg:"#e74c3c",icon:"fa-triangle-exclamation"},CASUAL:{bg:"#e67e22",icon:"fa-person-walking"},FRECUENTE:{bg:"#27ae60",icon:"fa-repeat"},TOP:{bg:"#2980b9",icon:"fa-ranking-star"},ESTRELLA:{bg:"#8e44ad",icon:"fa-star"}},C=$e();h([{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"},{id:7,name:"Distrimoster",img:"https://backend.salchimonster.com/read-photo-product/iX6UiE6e"}]);const Q=(a="")=>{const s=a.trim().split(" ");return(Array.from(s[0]||"")[0]||"")+(s[1]?Array.from(s[1])[0]:"")},Z=a=>{$.value+=a.i,W.value=!1};let z=null,T=[],j=null;const J=async()=>{if(O.value&&z){z.stop();return}try{j=await navigator.mediaDevices.getUserMedia({audio:!0});const a=MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")?"audio/ogg;codecs=opus":"audio/webm;codecs=opus";z=new MediaRecorder(j,{mimeType:a}),z.ondataavailable=s=>s.data.size&&T.push(s.data),z.onstop=()=>{const s=new Blob(T,{type:a.split(";")[0]});T=[],j.getTracks().forEach(m=>m.stop());const e=a.startsWith("audio/ogg")?"ogg":"webm";w.value={file:new File([s],`audio_${Date.now()}.${e}`,{type:s.type}),url:URL.createObjectURL(s)},O.value=!1},z.start(),O.value=!0}catch(a){console.error("No se pudo abrir el micrófono:",a.name,a.message),O.value=!1,j&&j.getTracks().forEach(s=>s.stop())}},se=()=>{w.value&&URL.revokeObjectURL(w.value.url),w.value=null};te(()=>{z&&O.value&&z.stop(),j&&j.getTracks().forEach(a=>a.stop())});const o={messaging_product:"whatsapp",employer_id:q.rawUserData.id,context_message_id:null},r=async(a,s=null)=>{var m,V;if(A.value||!a.trim())return;const e=new FormData;e.append("messaging_product","whatsapp"),e.append("employer_id",q.rawUserData.id),e.append("context_message_id",((m=s==null?void 0:s.message_data)==null?void 0:m.wa_id)||null),e.append("restaurant_id",(V=_.params.restaurant_id)==null?void 0:V.toString()),e.append("to",_.params.user_id),e.append("type","text"),e.append("text",JSON.stringify({body:a})),$.value="";try{C.sending=!0,await N.post(`${M}/webhook/send/text/`,e,!1)}catch(E){console.error("Error al enviar texto",E)}C.sending=!1},c=async()=>{var m;if(A.value||!w.value||I.value)return;const a=w.value;se(),I.value=!0;const s=new FormData;s.append("files",a.file);const e={...o,restaurant_id:(m=_.params.restaurant_id)==null?void 0:m.toString(),to:_.params.user_id,type:"audio",text:{body:""},file_index:0};s.append("payloads",JSON.stringify(e));try{await N.post(`${M}/webhook/send`,s,!1)}catch(V){console.error("Error al enviar audio",V)}I.value=!1},S=async a=>{var V;if(A.value||!(a!=null&&a.length))return;const s=new FormData,e={restaurant_id:(V=_.params.restaurant_id)==null?void 0:V.toString(),to:_.params.user_id,messaging_product:"whatsapp",employer_id:q.rawUserData.id,context_message_id:null},m=E=>{var ie;const{type:F,name:re}=E;if(F.startsWith("image/"))return"image";if(F.startsWith("audio/"))return"audio";if(F.startsWith("video/"))return"video";if(F==="application/pdf")return"document";const oe=(ie=re.split(".").pop())==null?void 0:ie.toLowerCase();return["jpg","jpeg","png","webp"].includes(oe)?"image":["mp3","wav","ogg","opus"].includes(oe)?"audio":"document"};a.forEach((E,F)=>{s.append("files",E.file),s.append("payloads",JSON.stringify({...e,type:m(E.file),text:{body:E.caption||""},file_index:F}))}),C.sending=!0;try{await N.post(`${M}/webhook/send`,s,!1)}catch(E){console.error("Error al enviar archivos",E)}C.sending=!1},b=a=>{a.key==="Enter"&&(a.preventDefault(),$.value.trim()&&r($.value))},R=a=>{a.key==="Enter"&&w.value&&(a.preventDefault(),c())};ee(()=>window.addEventListener("keydown",R)),te(()=>window.removeEventListener("keydown",R));async function K(){if(_.params.restaurant_id){const s=(await N.get(`${Ue}/restaurants`)||[]).find(e=>{var m;return e.id==((m=_.params)==null?void 0:m.restaurant_id)})||null;s&&(x.value=await N.get(`${M}/wabas/${s.waba_id}/templates/`))}}return(a,s)=>{var _e,he,ge;const e=L("Button"),m=L("RouterView"),V=L("Textarea"),E=L("Column"),F=L("Tag"),re=L("DataTable"),oe=L("RouterLink"),ie=L("Dialog");return l(),k("div",{class:"main-container",style:n([i(p).current_chat_theme.bg_image,{}])},[t("div",{class:"top-bar",style:n([{"border-radius":".5rem",gap:"1rem"},i(p).current_chat_theme.bg_bars])},[t("div",nt,[t("div",rt,[t("div",{class:"cliente-img",style:n([`background-color:${i(_).params.color}`,{height:"100%",color:"white",width:"3rem","aspect-ratio":"1/1","border-radius":"50%",display:"flex","align-items":"center","justify-content":"center","text-transform":"uppercase","font-size":"1.3rem"}])},v(Q(i(_).params.user_name)),5)]),t("div",lt,[t("strong",null,[t("h5",{style:n([{"text-transform":"capitalize",margin:"0"},i(p).current_chat_theme.text])},v((_e=i(_).params.user_name)==null?void 0:_e.substring(0,20)),5)]),t("div",null,[i(C).current_user.clasification?(l(),D(e,{key:0,style:n({height:"2.3rem",display:"flex",alignItems:"center",textTransform:"capitalize",gap:"0.35rem",backgroundColor:((he=G[i(C).current_user.clasification])==null?void 0:he.bg)||"#7f8c8d",color:"#fff"})},{default:u(()=>{var y,H;return[t("i",{class:pe(["fa-solid",(y=G[i(C).current_user.clasification])==null?void 0:y.icon]),"aria-hidden":"true",style:{"font-size":"0.9rem"}},null,2),de(" "+v((H=i(C).current_user.clasification)==null?void 0:H.toLowerCase())+" "+v(i(C).current_user.times_purchased)+" compras ",1)]}),_:1},8,["style"])):B("",!0)])])]),t("div",ct,[d(e,{icon:"pi pi-shopping-cart",class:"p-2",style:{color:"white","min-width":"max-content"},severity:"warning",label:"Ing. Ped"}),d(e,{text:"",class:"p-2"},{default:u(()=>[t("i",{style:n(i(p).current_chat_theme.text),class:"pi pi-search text-2xl"},null,4)]),_:1}),d(e,{text:"",class:"p-2"},{default:u(()=>[t("i",{style:n(i(p).current_chat_theme.text),class:"pi pi-bars text-2xl"},null,4)]),_:1})])],4),t("div",dt,[d(m,null,{default:u(()=>[i(_).params.user_id?(l(),D(Oe,{key:0,send_function:S,send_text:r,change_expiration:ae,ref:"Messages_element"},null,512)):(l(),k("div",ut,[t("h2",{style:n([{color:"white","font-size":"3rem",opacity:".5"},i(p).current_chat_theme.text])},"Selecciona un chat...",4)]))]),_:1})]),(ge=i(_).params)!=null&&ge.user_id?(l(),k("div",{key:0,class:"chat-bar",tabindex:"0",style:n(i(p).current_chat_theme.bg_bars)},[W.value?(l(),D(i(Ne),{key:0,native:!0,style:{position:"absolute",bottom:"4rem","z-index":"1000"},onSelect:Z,class:"emoji-picker"})):B("",!0),t("div",pt,[d(e,{text:"",style:{"font-size":"2rem"},onClick:s[0]||(s[0]=y=>W.value=!W.value)},{default:u(()=>[mt]),_:1}),w.value?(l(),k("div",{key:1,class:"audio-chip",onKeydown:je(Re(c,["prevent"]),["enter"])},[t("audio",{style:{width:"100%","min-width":"28rem","max-width":"42rem"},src:w.value.url,controls:""},null,8,_t),d(e,{text:"",class:"btn-audio-trash p-2",onClick:se},{default:u(()=>[t("i",{style:n(i(p).current_chat_theme.text),class:"pi pi-trash text-2xl p-0"},null,4)]),_:1})],40,ft)):(l(),D(V,{key:0,modelValue:$.value,"onUpdate:modelValue":s[1]||(s[1]=y=>$.value=y),autoResize:"",class:"message",disabled:A.value,onKeydown:b,style:n(`${i(p).current_chat_theme.text} ; ${i(p).current_chat_theme.border} `)},null,8,["modelValue","disabled","style"]))]),t("div",ht,[!w.value&&$.value.trim()===""?(l(),D(e,{key:0,text:"",style:{height:"100%"},onClick:J},{default:u(()=>[t("i",{style:n(i(p).current_chat_theme.text),class:pe(O.value?"pi pi-stop text-2xl text-red-500":"pi pi-microphone text-2xl ")},null,6)]),_:1})):w.value?(l(),D(e,{key:1,disabled:I.value,text:"",onClick:c},{default:u(()=>[t("i",{style:n(i(p).current_chat_theme.text),class:"pi pi-send text-2xl"},null,4)]),_:1},8,["disabled"])):(l(),D(e,{key:2,style:n(i(p).current_chat_theme.text),text:"",onClick:s[2]||(s[2]=y=>r($.value))},{default:u(()=>[gt]),_:1},8,["style"]))]),t("div",vt,[d(e,{severity:"danger",style:{},icon:"pi pi-clock",class:"p-2",onClick:s[3]||(s[3]=()=>f.value=!0)}),i(_).query.expirado?(l(),D(e,{key:0,icon:"pi pi-bolt",severity:"warning",style:{},class:"p-2",onClick:s[4]||(s[4]=()=>f.value=!0)})):B("",!0)])],4)):B("",!0),d(ie,{visible:f.value,"onUpdate:visible":s[5]||(s[5]=y=>f.value=y),header:"Envio de plantilla",style:{width:"50rem"}},{default:u(()=>[d(re,{value:x.value,dataKey:"id",paginator:"",rows:10,responsiveLayout:"scroll",class:"shadow-md rounded-xl overflow-hidden"},{default:u(()=>[d(E,{class:"my-1 py-1",field:"name",header:"Nombre",bodyClass:"font-medium"}),d(E,{class:"my-1 py-1",header:"Estado"},{body:u(({data:y})=>[d(F,{severity:X(y.status)},{default:u(()=>[de(v(y.status),1)]),_:2},1032,["severity"])]),_:1}),d(E,{class:"my-1 py-1",header:"Estado"},{body:u(({data:y})=>{var H,ve;return[de(v((ve=(H=y==null?void 0:y.components)==null?void 0:H.find(Ce=>Ce.type=="BODY"))==null?void 0:ve.text),1)]}),_:1}),d(E,{class:"my-1 py-1",headerStyle:"width:8rem",header:"Acciones"},{body:u(({data:y})=>[t("div",yt,[d(e,{icon:"pi pi-send",label:"Enviar",severity:"help",onClick:H=>g(y)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"]),t("div",bt,[d(oe,{to:"/chat/templates"},{default:u(()=>[d(e,{severity:"help",icon:"pi pi-plus",label:"Agregar otro"})]),_:1})])]),_:1},8,["visible"])],4)}}}),wt=me(xt,[["__scopeId","data-v-5ca3d81f"]]);const kt={__name:"chats",setup(U){const p=fe();return(X,g)=>(l(),k("div",{class:"chat-container",style:n(i(p).current_chat_theme.bg)},[d(be,{style:{"box-shadow":".5rem 0 1rem #00000010"},class:"sidebar-left",restaurant:{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"}}),d(wt),d(be,{style:{"box-shadow":"-.5rem 0 1rem #00000010"},class:"sidebar-right",restaurant:{id:1,name:"Salchimonster",img:"https://backend.salchimonster.com/read-photo-product/xai0dVnL"}})],4))}},Tt=me(kt,[["__scopeId","data-v-5877f5bf"]]);export{Tt as default};
