import{_ as y,l,B as g,r as x,a as c,o as k,c as b,b as r,g as p,D as I,a7 as B,a6 as T,p as D,h as S,a1 as U,U as u,s as i,v as V}from"./index-e7a37f9b.js";const m=s=>(D("data-v-13fd55f5"),s=s(),S(),s),L={style:{display:"flex",position:"relative","background-size":"cover",height:"100vh",width:"100vw",overflow:"hidden"},class:"p-0 fondo"},z=m(()=>r("img",{src:U,alt:"",style:{width:"48px"},class:"m-3"},null,-1)),C=m(()=>r("p",{class:"text-2xl",style:{"font-weight":"bold"}},"Iniciar sesión",-1)),E={__name:"Login",setup(s){const h=l(),d=g(),_=o=>{const e=l();return V.get(`${u}/validate-token`,{headers:{Authorization:`Bearer ${o}`}}).then(a=>(a.data.access_token&&e.setUserData(a.data),a.data)).catch(a=>{throw console.error("Error durante la validación del token:",a),a})},v=()=>{const o=l();setInterval(async()=>{const e=o.userData.access_token;if(!e){i.push("/auth/login");return}try{await _(e)}catch(a){console.error("La sesión ha expirado o el token es inválido:",a),o.userData={},i.push("/auth/login")}},3e4)},t=x({username:"",password:""}),f=async()=>{const o=new URLSearchParams;o.append("username",t.value.username),o.append("password",t.value.password);try{const e=await fetch(`${u}/token-employer`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!e.ok)throw new Error("Network response was not ok");const a=await e.json();h.setUserData(a),v(),i.push("/"),d.add({severity:"success",summary:"Bienvenido",detail:"Hoy es un gran dia",life:3e3})}catch(e){d.add({severity:"error",summary:"Algo salio mal",detail:"Revisate los datos monstruo",life:3e3}),console.error(e)}};return(o,e)=>{const a=c("InputText"),w=c("Button");return k(),b("div",L,[r("form",{class:"col-12 m-auto",onSubmit:T(f,["prevent"]),style:{"max-width":"min-content",display:"flex","border-radius":"0.5rem","box-shadow":"0 0 10px rgba(0, 0, 0, 0.389)","flex-direction":"column","background-color":"rgb(255, 255, 255)","align-items":"center"}},[z,C,p(a,{class:"my-3 m-0",modelValue:t.value.username,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value.username=n),type:"text",autocomplete:"username",placeholder:"identificación",style:{width:"100%"}},null,8,["modelValue"]),I(r("input",{class:"p-inputtext p-component p-password-input",type:"password","onUpdate:modelValue":e[1]||(e[1]=n=>t.value.password=n),autocomplete:"current-password","aria-controls":"pv_id_3_panel","aria-expanded":"false","aria-haspopup":"true",placeholder:"Clave",value:""},null,512),[[B,t.value.password]]),p(w,{size:"samll",style:{width:"100%","background-color":"rgb(255, 98, 0)",border:"none",color:"#fff"},label:"Iniciar sesion",class:"my-3",type:"submit"})],32)])}}},R=y(E,[["__scopeId","data-v-13fd55f5"]]);export{R as default};
