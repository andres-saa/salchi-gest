import{_ as ye,x as _e,G as he,r as o,k as ge,m as S,i as we,U as O,H as xe,a as y,o as i,c as r,b as s,d as a,u as d,F as x,e as b,n as P,w as R,T as be,E as ke,s as N,t as De,D as C,p as Se,g as Ce,I as Te}from"./index-cc435204.js";const U=M=>(Se("data-v-e279a0ba"),M=M(),Ce(),M),Ve={class:"col-12 px-3 md:px-4 mx-auto",style:{position:"relative","max-width":"1366px","margin-top":"6rem"}},$e={class:"grid",style:{"background-color":"rgba(250, 250, 250, 0)"}},Re={class:"text-sm col-12 md:col-3 p-2 xl:col-2"},Me={class:"text-sm col-12 p-2 md:col-4 xl:col-6"},Ee={class:"text-center col-12 p-2 md:col-3"},Ue={class:"col-12 md:col-1 md:p-0",style:{display:"flex","align-items":"center","justify-content":"start"}},je=U(()=>s("p",{class:"text-3xl px-0 mx-0 my-6 pb-0",style:{"font-weight":"bold"}},[s("i",{class:"fa-solid fa-chart-simple"}),N(" Vision General")],-1)),Fe={class:"contenedor mt-5",style:{position:"sticky",top:"3rem","z-index":"99"}},He={class:"col-12 px-0 py-0 my-0 p-0",style:{"overflow-x":"auto","background-color":"#fafafa"}},Ie={class:"px-0 mx-0",style:{width:"max-content","background-color":"#fafafa",display:"flex",color:"","justify-content":"start",gap:"2rem","min-width":"max-content"}},Ne={style:{"background-color":""}},ze={class:"grid p-0 m-0"},Le={class:"grid"},Ae=U(()=>s("div",{class:"col-12 px-0 mx-0"},null,-1)),Be={class:"col-12",style:{display:"flex","flex-direction":"column",position:"relative"}},Oe=U(()=>s("span",{style:{"font-weight":"bold"},class:"text-l"},"Desde ",-1)),Pe={style:{position:"relative"}},Ye={class:"my-2"},Ge={key:0,style:{display:"flex","flex-wrap":"wrap",width:"100%",gap:".1rem"}},Je={key:1,style:{display:"flex","flex-wrap":"wrap",gap:".1rem",width:"100%"}},We={key:2,style:{display:"flex","flex-wrap":"wrap",gap:".5rem",width:"100%"}},qe={style:{display:"flex",width:"100%","justify-content":"end"}},Ke={class:"col-12",style:{display:"flex","flex-direction":"column",position:"relative"}},Qe=U(()=>s("span",{style:{"font-weight":"bold"},class:"text-l"},"Hasta ",-1)),Xe={style:{position:"relative"}},Ze={class:"my-2"},et={key:0,style:{display:"flex","flex-wrap":"wrap",width:"100%",gap:".1rem"}},tt={key:1,style:{display:"flex","flex-wrap":"wrap",gap:".1rem",width:"100%"}},lt={key:2,style:{display:"flex","flex-wrap":"wrap",gap:".5rem",width:"100%"}},ot={style:{display:"flex",width:"100%","justify-content":"end"}},st={class:"col-12 p-0",style:{display:"flex","justify-content":"center"}},at={class:"col-12",style:{display:"flex","justify-content":"center"}},nt={__name:"reporteVentas",setup(M){const u=_e(),{isDarkTheme:Y}=he(),_=o(new Date),m=o(new Date);o([]);const G=o(["enviada","cancelada","en preparacion"]),J=o("enviada"),W=ge(),q=o([]),K=o([]),E=o(!1),j=o(new Date(new Date().setDate(new Date().getDate()-7))),F=o(new Date),Q=o(Array.from({length:24},(e,l)=>l)),X=o([0,10,20,30,40,50]),Z=o([0,1,2,3,4,5,6,7,8,9]),h=o(null),f=o(null),g=o(null);function ee(e){h.value=e,f.value=null,g.value=null,H()}function te(e){f.value=e,g.value=null,H()}function le(e){g.value=f.value+e,H()}function H(){if(h.value!==null&&f.value!==null&&g.value!==null){const e=new Date(_.value);_.value=new Date(e.getFullYear(),e.getMonth(),e.getDate(),h.value,g.value)}}const oe=o(Array.from({length:24},(e,l)=>l)),se=o([10,20,30,40,50]),ae=o([0,1,2,3,4,5,6,7,8,9]),c=o(null),p=o(null),v=o(null);o(null),o(null);function ne(e){c.value=e,p.value=null,v.value=null,I(),z()}function ie(e){p.value=e,v.value=null,I(),z()}function re(e){v.value=p.value+e,I()}function I(){if(c.value!==null&&p.value!==null&&v.value!==null){const e=new Date(m.value);m.value=new Date(e.getFullYear(),e.getMonth(),e.getDate(),c.value,v.value)}}function z(){if(c.value!==null&&p.value!==null&&v.value!==null){const e=new Date;m.value=new Date(e.getFullYear(),e.getMonth(),e.getDate(),c.value,v.value)}}S(m,e=>{e&&e.getHours()===0&&(c.value=null,p.value=null,v.value=null)},{deep:!0}),o(""),we(()=>{de().then(e=>{q.value=e,u.fetchSalesReport()})});const ue=async()=>{const e=k(j.value),l=k(F.value),T=K.value.map(n=>n.site_id).join(","),V=new URLSearchParams({site_ids:T,status:J.value,start_date:e,end_date:l}),w=`${O}/sales_report?${V.toString()}`;try{const n=await fetch(w,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const D=await n.json();Te.value=D,console.log(D)}catch(n){console.error("Fetch error:",n)}};S([j,F],()=>{ue()},{deep:!0}),S(_,e=>{e&&e.getHours()===0&&(h.value=null,f.value=null,g.value=null)},{deep:!0}),S(()=>u.order_status,(e,l)=>{console.log(`El estado de orden ha cambiado de ${l} a ${e}`),u.fetchSalesReport()}),S(u.selectedSites,e=>{u.setSelectedSites(e)},{deep:!0});const de=async()=>{try{const e=await fetch(`${O}/sites`);if(!e.ok)throw"paila";return await e.json()}catch(e){console.log(e)}},ce=o([{name:"Valor ventas",to:"/reporte-ventas/valor-ventas",icon:"fa-solid fa-dollar-sign"},{name:"No. Ordenes",to:"/reporte-ventas/no-ordenes",icon:"fa-solid fa-sort"},{name:"Ticket promedio",to:"/reporte-ventas/ticket",icon:"fa-solid fa-money-bill"},{name:"Ordenes",to:"/reporte-ventas/ordenes",icon:"fa-solid fa-table"},{name:"Resumen",to:"/reporte-ventas/order-sumary",icon:"fa-solid fa-table"}]);o(null),xe({labels:["January","February","March","April","May","June","July"],datasets:[{label:"First Dataset",data:[65,59,80,81,56,55,40],fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4},{label:"Second Dataset",data:[28,48,40,19,86,27,90],fill:!1,backgroundColor:"#00bb7e",borderColor:"#00bb7e",tension:.4}]}),o([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const L=o(null),pe=()=>{L.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},ve=()=>{L.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}};S(Y,e=>{e?ve():pe()},{immediate:!0}),o(`${j.value} - ${F.value}`);const k=e=>{const l=new Date(e),T=l.getFullYear(),V=(l.getMonth()+1).toString().padStart(2,"0"),w=l.getDate().toString().padStart(2,"0"),n=l.getHours().toString().padStart(2,"0"),D=l.getMinutes().toString().padStart(2,"0");return`${T}-${V}-${w} ${n}:${D}`};return o({}),o(),(e,l)=>{var B;const T=y("Dropdown"),V=y("MultiSelect"),w=y("InputText"),n=y("Button"),D=y("RouterLink"),me=y("RouterView"),A=y("Calendar"),fe=y("Dialog");return i(),r("div",Ve,[s("div",$e,[s("div",Re,[a(T,{class:"text-sm col-12 p-0",modelValue:d(u).order_status,"onUpdate:modelValue":l[0]||(l[0]=t=>d(u).order_status=t),options:G.value,placeholder:"Estado"},null,8,["modelValue","options"])]),s("div",Me,[a(V,{style:{},display:"chip",multiple:"",modelValue:d(u).selectedSites,"onUpdate:modelValue":l[1]||(l[1]=t=>d(u).selectedSites=t),optionLabel:"site_name",options:(B=d(u).sites)==null?void 0:B.filter(t=>t.show_on_web),class:"text-sm col-12 p-0",placeholder:"Sedes"},null,8,["modelValue","options"])]),s("div",Ee,[a(w,{class:"col-12 p-3",onClick:l[2]||(l[2]=t=>E.value=!0),style:{height:"2.7rem"},value:d(u).dateRangeDifference.rangeName||`${k(d(u).dateRange.startDate)}  |  ${k(d(u).dateRange.endDate)}`,placeholder:"periodo"},null,8,["value"])]),s("div",Ue,[a(n,{icon:"pi pi-search",severity:"help",class:"text-center p-0 col-12 md:p-0",style:{height:"2.5rem",width:"min-content","aspect-ratio":"1 / 1","font-weight":"bold","border-radius":"50%",display:"flex","justify-content":"center"},onClick:d(u).fetchSalesReport},null,8,["onClick"])])]),je,s("div",Fe,[s("div",He,[s("div",Ie,[(i(!0),r(x,null,b(ce.value,t=>(i(),r("div",Ne,[a(D,{to:t.to},{default:R(()=>[a(n,{size:"medium",style:ke([d(W).fullPath==t.to?"box-shadow: 0 4px 0 #ff6200;color:#000;font-weight:bold;":"",{"border-radius":"0"}]),class:"text-md px-0 pt-2 pb-4 my-0 mx-0",text:"",severity:"secondary"},{default:R(()=>[s("i",{class:P(["mr-2",t.icon])},null,2),N(" "+De(t.name)+" ",1)]),_:2},1032,["style"])]),_:2},1032,["to"])]))),256))])])]),s("div",ze,[s("div",{class:P(["p-0",d(u).visibleNotifications?"col-9":"col-12"])},[a(be,{name:"fade"},{default:R(()=>[a(me)]),_:1})],2)]),a(fe,{visible:E.value,"onUpdate:visible":l[8]||(l[8]=t=>E.value=t),modal:"",header:"Periodo",style:{width:"25rem"}},{default:R(()=>[s("div",Le,[Ae,s("div",Be,[Oe,s("div",Pe,[a(w,{style:{position:"absolute","pointer-events":"none",width:"100%",top:"0",left:"0","z-index":"1000"},readOnly:"",value:k(_.value)},null,8,["value"]),a(A,{hourFormat:"12",style:{"min-width":"max-content",width:"100%"},modelValue:_.value,"onUpdate:modelValue":l[3]||(l[3]=t=>_.value=t),showWeek:""},null,8,["modelValue"])]),s("div",Ye,[h.value==null?(i(),r("div",Ge,[(i(!0),r(x,null,b(Q.value,t=>(i(),r("div",{key:"hour-"+t},[a(n,{outlined:"",style:{width:"3rem"},label:t,class:"py-1 px-2",onClick:$=>ee(t)},null,8,["label","onClick"])]))),128))])):C("",!0),h.value!==null&&f.value==null?(i(),r("div",Je,[(i(!0),r(x,null,b(X.value,t=>(i(),r("div",{key:"tens-"+t},[a(n,{outlined:"",class:"py-1 px-3",label:t,onClick:$=>te(t)},null,8,["label","onClick"])]))),128))])):C("",!0),f.value!==null&&g.value==null?(i(),r("div",We,[(i(!0),r(x,null,b(Z.value,t=>(i(),r("div",{key:"unit-"+t},[a(n,{outlined:"",label:t,class:"py-1 px-3",onClick:$=>le(t)},null,8,["label","onClick"])]))),128))])):C("",!0)]),s("div",qe,[a(n,{size:"small",rounded:"",severity:"help",class:"p-0",icon:"pi pi-clock",style:{width:"2rem",height:"2rem"},onClick:l[4]||(l[4]=()=>{h.value=null,f.value=null})})])]),s("div",Ke,[Qe,s("div",Xe,[a(w,{style:{position:"absolute","pointer-events":"none",width:"100%",top:"0",left:"0","z-index":"1000"},readOnly:"",value:k(m.value)},null,8,["value"]),a(A,{hourFormat:"12",style:{"min-width":"max-content",width:"100%"},modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=t=>m.value=t),showWeek:""},null,8,["modelValue"])]),s("div",Ze,[c.value==null?(i(),r("div",et,[(i(!0),r(x,null,b(oe.value,t=>(i(),r("div",{key:"hour-"+t},[a(n,{outlined:"",style:{width:"3rem"},label:t,class:"py-1 px-2",onClick:$=>ne(t)},null,8,["label","onClick"])]))),128))])):C("",!0),c.value!==null&&p.value==null?(i(),r("div",tt,[(i(!0),r(x,null,b(se.value,t=>(i(),r("div",{key:"tens-"+t},[a(n,{outlined:"",class:"py-1 px-3",label:t,onClick:$=>ie(t)},null,8,["label","onClick"])]))),128))])):C("",!0),p.value!==null&&v.value==null?(i(),r("div",lt,[(i(!0),r(x,null,b(ae.value,t=>(i(),r("div",{key:"unit-"+t},[a(n,{outlined:"",label:t,class:"py-1 px-3",onClick:$=>re(t)},null,8,["label","onClick"])]))),128))])):C("",!0)]),s("div",ot,[a(n,{size:"small",rounded:"",severity:"help",class:"p-0",icon:"pi pi-clock",style:{width:"2rem",height:"2rem"},onClick:l[6]||(l[6]=()=>{c.value=null,p.value=null})})])]),s("div",st,[s("div",at,[a(n,{onClick:l[7]||(l[7]=()=>{d(u).setDateRange(_.value,m.value),E.value=!1,d(u).fetchSalesReport()})},{default:R(()=>[N("Aplicar")]),_:1})])])])]),_:1},8,["visible"])])}}},rt=ye(nt,[["__scopeId","data-v-e279a0ba"]]);export{rt as default};
