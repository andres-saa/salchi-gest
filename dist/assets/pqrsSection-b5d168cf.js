import _e from"./pqrUser-fd21cec9.js";import{_ as ve,M as ye,r as d,A as he,l as fe,q as be,i as ge,D as Z,a as v,o as l,c as o,g as r,w as m,b as t,F as $,d as ee,s as Ve,j as L,U as E,t as a,k as f,m as c,f as n,u as z,N as O,n as xe,e as te,p as ke,h as we}from"./index-07588b22.js";import"./editor.esm-2b74ebab.js";/* empty css                                                             */const u=q=>(ke("data-v-22e8fa35"),q=q(),we(),q),Te={style:{display:"flex","flex-direction":"column"}},qe={style:{"min-width":"max-content",margin:"0",padding:"0"},class:"p-text-secondary m-0 p-0"},Ce={style:{"min-width":"max-content",margin:"0",padding:"0"},class:"p-text-secondary m-0 p-0"},Ne={class:"m-0"},Pe=u(()=>t("div",null,null,-1)),Se={key:0,class:"m-0",style:{"text-transform":"capitalize"}},Re=u(()=>t("b",null,"Responsable:",-1)),De={key:1,class:"p-0 m-0"},ze={key:2,class:"p-0 m-0"},Ie={key:3},Ue=u(()=>t("b",null,"Notas",-1)),$e=u(()=>t("br",null,null,-1)),Le=u(()=>t("div",{style:{display:"flex",gap:"1rem"}},null,-1)),Ee=u(()=>t("div",null,[t("h4",{class:"mt-0 py-0"})],-1)),Oe={style:{display:"flex","flex-direction":"column"}},je=u(()=>t("h6",{class:"m-0"},[t("b",null,"CONTEXTO")],-1)),Be={key:0,class:"m-0"},Fe=u(()=>t("b",null,"DATOS DEL CLIENTE",-1)),Me=[Fe],Ae={key:1},Ge=u(()=>t("b",null,"Nombre: ",-1)),He={key:2},Qe=u(()=>t("b",null,"Telefono: ",-1)),Xe={key:3},Je=u(()=>t("b",null,"Direccion: ",-1)),Ke={key:4},We=u(()=>t("b",null,"Orden: ",-1)),Ye=u(()=>t("h6",null,[t("b",null,"HISTORIAL")],-1)),Ze={style:{display:"flex","flex-direction":"column"}},et={style:{"min-width":"max-content",margin:"0",padding:"0"},class:"p-text-secondary m-0 p-0"},tt={style:{"min-width":"max-content",margin:"0",padding:"0"},class:"p-text-secondary m-0 p-0"},lt={class:"m-0"},st=u(()=>t("div",null,null,-1)),ot={key:0,class:"m-0",style:{"text-transform":"capitalize"}},at=u(()=>t("b",null,"Responsable:",-1)),nt={key:1,class:"p-0 m-0"},ut={key:2,class:"p-0 m-0"},it={key:3},rt=u(()=>t("b",null,"Notas",-1)),dt=u(()=>t("br",null,null,-1)),ct=u(()=>t("div",{style:{display:"flex",gap:"1rem"}},null,-1)),mt=u(()=>t("h6",null,[t("b",null,"Como desea proceder?")],-1)),pt={key:5},_t={key:0,style:{display:"flex","justify-content":"space-between",margin:"1rem 0"}},vt=u(()=>t("h6",{class:"m-0"},"Le dio una cortesia del 100% ?",-1)),yt={key:1,style:{display:"flex","justify-content":"space-between",margin:"1rem 0"}},ht=u(()=>t("h6",{class:"m-0"},"Le dio un bono de descuento?",-1)),ft={key:2},bt=u(()=>t("h6",{class:"m-0 my-3"},"porcentaje del descuento ",-1)),gt={key:3},Vt=u(()=>t("h6",{class:"m-0 my-3"},"Valor de la orden",-1)),xt={key:4},kt=u(()=>t("h6",{class:"m-0 my-3"},"Id de la orden",-1)),wt=u(()=>t("h6",{class:"m-0 my-3"},"Detalles",-1)),Tt={style:{"background-color":"#ff00002e"},class:"p-3"},qt=u(()=>t("b",null,"No preste sus credenciales de Salchigest, cada miembro de la empresa tiene los suyos, muchas gracias",-1)),Ct={style:{display:"flex","justify-content":"end","margin-top":"2rem"}},Nt={class:"nav_bar shadow-2 p-0 my-0 mx-2",style:{position:"sticky",top:"3rem","max-width":"900px","border-radius":"10rem","background-color":"white","z-index":"99"}},Pt={class:"nav_bar--buttons p-0 m-1",style:{}},St={key:"",class:"",style:{display:"flex","align-items":"center"}},Rt={class:"grid p-3",style:{"align-items":"center","justify-content":"space-between",display:"flex",gap:"1rem"}},Dt={class:"px-2"},zt=u(()=>t("i",{class:"fa-regular fa-bars-progress"},null,-1)),It={style:{"text-transform":"uppercase"}},Ut={style:{display:"flex",gap:"1rem"}},$t={key:0,style:{"min-width":"max-content"},class:"m-0 p-0"},Lt={key:2,class:"m-0 p-0"},Et={key:3,class:"m-0 p-0"},Ot={key:5,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},jt={key:6,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Bt={key:7,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Ft={key:8,class:"p-2",style:{display:"flex",gap:".1rem","flex-direction":"column","align-items":"start"}},Mt={style:{display:"flex",gap:".5rem","justify-content":"center"},class:"px-2"},At={__name:"pqrsSection",setup(q){const le=ye(),I=d(""),C=d(),j=he(),B=d([]),se=y=>y,U=d({id:2,name:"Generada",description:"Estado inicial de la pqr",exist:!0,color:"#3498DB"}),F=fe(),M=d([]),p=d(),oe=async y=>{N.value=!0,_.value=y},A=d([]),_=d([]),G=d(!1),N=d(!1),P=d(null),ae=()=>{P.value={global:{value:null,matchMode:Ve.CONTAINS}}};be(()=>{ae()});const ne=d([{columnName:"Id",columnValue:"pqr_request_id",columnType:"other",size:"1rem",vif:!0},{columnName:"Restaurante",columnValue:"restaurant",columnType:"restaurant",size:"1rem",vif:!0},{columnName:"Clasificacion",columnValue:"tag_name",columnType:"tag",size:"1rem",vif:!0},{columnName:"Id orden",columnValue:"order_id",columnType:"other",size:"1rem",vif:!0},{columnName:"Canal",columnValue:"channel",columnType:"tag",size:"4rem",vif:!0},{columnName:"Sede",columnValue:"site_name",columnType:"other",size:"4rem",vif:!0},{columnName:"Red",columnValue:"red",columnType:"other",size:"4rem",vif:!0},{columnName:"Calificacion",columnValue:"rating",columnType:"rating",size:"10rem",vif:!0},{columnName:"Tipo",columnValue:"request_type",columnType:"other",size:"15rem",vif:!0},{columnName:"Comentarios",columnValue:"request_content",columnType:"other",size:"20rem",vif:!0},{columnName:"Responsable",columnValue:"responsible_name",columnType:"other",size:"20rem",vif:!0},{columnName:"Estado",columnValue:"current_status",columnType:"status",size:"15rem",vif:!0}]);d({2:"#3498DB",4:"#2ECC71",5:"#16A085",6:"#E74C3C",7:"#F39C12"}),d({question:"",answer:""}),d({}),d({}),d(null);const H=d([{}]);d({}),d(!1),d({});const T=d(!1),b=d(),k=d(!1),S=async()=>{H.value=await L.get(`${E}/get-all-pqrs`);const y=await L.get(`${E}/get-all-pqrs-status`);M.value=y,B.value=y};ge(async()=>{S()}),Z(p,()=>{Q()});const Q=()=>{b.value=null,I.value="",C.value=null,T.value=!1,k.value=!1},w=d(),ue=async()=>{const y=w.value&&b.value?(b.value-b.value*(w.value/100)).toFixed(2):b.value,i={pqr_request_id:_.value.pqr_request_id,status_id:p.value,responsible_id:F.rawUserData.id,value:y||null,notes:w.value&&b.value?`Se le dio un descuento de ${w.value}% en una orden de ${O(b.value)}, quedando en un valor de ${O(y)}`:"",order_id:C.value||null};try{await L.post(`${E}/change-pqr-status`,i),S(),N.value=!1,Q()}catch(g){console.error("Error al enviar la actualizaciÃ³n de la PQR:",g)}};return Z(()=>j.params.section_id,()=>{S()},{deep:!0}),(y,i)=>{const g=v("Tag"),X=v("Timeline"),J=v("Dialog"),ie=v("Dropdown"),K=v("Checkbox"),W=v("InputNumber"),Y=v("InputText"),re=v("Textarea"),R=v("Button"),de=v("Rating"),ce=v("column"),me=v("Column"),pe=v("DataTable");return l(),o($,null,[r(J,{class:"mx-2",visible:G.value,"onUpdate:visible":i[0]||(i[0]=e=>G.value=e),modal:"",header:`Historial de la pqr  ID   ${A.value.pqr_request_id}`,style:{width:"40rem"}},{default:m(()=>[r(X,{value:A.value.status_history},{opposite:m(e=>{var s,h,V,x;return[t("div",Te,[t("p",qe,a((s=e.item.timestamp)==null?void 0:s.split(" ")[0]),1),t("p",Ce,a((x=(V=(h=e.item.timestamp)==null?void 0:h.split(" "))==null?void 0:V.slice(1,4))==null?void 0:x.join(" ")),1)])]}),content:m(e=>{var s;return[r(g,{style:f(`background-color:${e.item.color}`)},{default:m(()=>[t("p",Ne,[t("b",null,a(e.item.status),1)])]),_:2},1032,["style"]),Pe,e.item.responsible_name?(l(),o("p",Se,[Re,c(" "+a((s=e.item.responsible_name)==null?void 0:s.toLowerCase()),1)])):n("",!0),e.item.value?(l(),o("p",De,[c("Le costo a la empresa "),t("b",null,a(e.item),1)])):n("",!0),e.item.order_id?(l(),o("p",ze,[c("Orden entregada "),t("b",null,a(e.item.order_id),1)])):n("",!0),e.item.notes?(l(),o("p",Ie,[Ue,c(" "+a(e.item.notes),1)])):n("",!0),$e,Le]}),_:1},8,["value"])]),_:1},8,["visible","header"]),Ee,r(J,{class:"mx-2",visible:N.value,"onUpdate:visible":i[8]||(i[8]=e=>N.value=e),modal:"",header:`GESTION DE LA PQR  ID:    ${_.value.pqr_request_id}`,style:{width:"50rem"}},{footer:m(()=>[t("div",Ct,[r(R,{onClick:ue,label:"Enviar",severity:"help"})])]),default:m(()=>[t("div",Oe,[je,t("p",null,a(_.value.request_content),1),_.value.user_name||_.value.user_phone?(l(),o("h6",Be,Me)):n("",!0),_.value.user_name?(l(),o("span",Ae,[Ge,c(" "+a(_.value.user_name),1)])):n("",!0),_.value.user_phone?(l(),o("span",He,[Qe,c(" "+a(_.value.user_phone),1)])):n("",!0),_.value.user_address?(l(),o("span",Xe,[Je,c(" "+a(_.value.user_address),1)])):n("",!0),_.value.order_id?(l(),o("span",Ke,[We,c(" "+a(_.value.order_id),1)])):n("",!0),Ye,r(X,{value:_.value.status_history},{opposite:m(e=>{var s,h,V,x;return[t("div",Ze,[t("p",et,a((s=e.item.timestamp)==null?void 0:s.split(" ")[0]),1),t("p",tt,a((x=(V=(h=e.item.timestamp)==null?void 0:h.split(" "))==null?void 0:V.slice(1,4))==null?void 0:x.join(" ")),1)])]}),content:m(e=>{var s;return[r(g,{style:f(`background-color:${e.item.color}`)},{default:m(()=>[t("p",lt,[t("b",null,a(e.item.status),1)])]),_:2},1032,["style"]),st,e.item.responsible_name?(l(),o("p",ot,[at,c(" "+a((s=e.item.responsible_name)==null?void 0:s.toLowerCase()),1)])):n("",!0),e.item.value?(l(),o("p",nt,[c("Le costo a la empresa "),t("b",null,a(z(O)(e.item.value)),1)])):n("",!0),e.item.order_id?(l(),o("p",ut,[c("Orden entregada "),t("b",null,a(e.item.order_id),1)])):n("",!0),e.item.notes?(l(),o("p",it,[rt,c(" "+a(e.item.notes),1)])):n("",!0),dt,ct]}),_:1},8,["value"]),mt,r(ie,{modelValue:p.value,"onUpdate:modelValue":i[1]||(i[1]=e=>p.value=e),options:M.value.filter(e=>e.id!=2),optionLabel:"name",optionValue:"id"},null,8,["modelValue","options"]),p.value?(l(),o("div",pt,[p.value==4||p.value==7?(l(),o("div",_t,[vt,r(K,{binary:"",modelValue:T.value,"onUpdate:modelValue":i[2]||(i[2]=e=>T.value=e)},null,8,["modelValue"])])):n("",!0),p.value==4||p.value==7?(l(),o("div",yt,[ht,r(K,{modelValue:k.value,"onUpdate:modelValue":i[3]||(i[3]=e=>k.value=e),binary:""},null,8,["modelValue"])])):n("",!0),(p.value==4||p.value==7)&&k.value?(l(),o("div",ft,[bt,r(W,{modelValue:w.value,"onUpdate:modelValue":i[4]||(i[4]=e=>w.value=e),style:{width:"100%"}},null,8,["modelValue"])])):n("",!0),(p.value==4||p.value==7)&&T.value||k.value?(l(),o("div",gt,[Vt,r(W,{modelValue:b.value,"onUpdate:modelValue":i[5]||(i[5]=e=>b.value=e),style:{width:"100%"}},null,8,["modelValue"])])):n("",!0),(p.value==4||p.value==7)&&k.value||T.value?(l(),o("div",xt,[kt,r(Y,{modelValue:C.value,"onUpdate:modelValue":i[6]||(i[6]=e=>C.value=e),style:{width:"100%"}},null,8,["modelValue"])])):n("",!0),t("div",null,[wt,r(re,{modelValue:I.value,"onUpdate:modelValue":i[7]||(i[7]=e=>I.value=e),rows:"5",style:{resize:"none",width:"100%"}},null,8,["modelValue"])]),t("h6",Tt,[c("Recuerde que esta firmando como "),t("b",null,a(z(F).rawUserData.name),1),c(" y por ende se hace responsable, "),qt])])):n("",!0)])]),_:1},8,["visible","header"]),t("nav",Nt,[t("ul",Pt,[(l(!0),o($,null,ee(B.value,e=>(l(),o("li",St,[r(g,{style:f([`background-color:${e.color}`,{height:"1.3rem","aspect-ratio":"1 / 1","border-radius":"50%"}])},null,8,["style"]),c(),r(R,{onClick:()=>U.value=e,class:xe(["nav_bar--buttons-button p-2",e.id==U.value.id?"nav_bar--buttons-button-selected":""]),label:e.name},null,8,["onClick","class","label"])]))),128))])]),r(pe,{paginator:!0,rows:15,style:{width:"100%"},paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Mostrando {first} a {last} de {totalRecords} solicitudes",rowsPerPageOptions:[5,10,25,100],scrollable:"",showGridlines:"",scrollHeight:"65vh",stripedRows:"",class:"col-12 m-auto",value:H.value.filter(e=>{var s,h;return((s=e.current_status)==null?void 0:s.status)==((h=U.value)==null?void 0:h.name)}),tableStyle:"min-width: 50rem;",filters:P.value},{header:m(()=>[t("div",Rt,[t("h4",Dt,[zt,c(),t("b",It,[c("PQRS "),t("b",null,a(z(j).params.section),1)])]),t("div",Ut,[r(Y,{class:"",modelValue:P.value.global.value,"onUpdate:modelValue":i[9]||(i[9]=e=>P.value.global.value=e),placeholder:"Buscar Solicitud..."},null,8,["modelValue"]),r(R,{onClick:i[10]||(i[10]=e=>z(le).visible_add_pqr=!0),label:"Nueva PQR",severity:"help"})])])]),default:m(()=>[(l(!0),o($,null,ee(se(ne.value),e=>(l(),te(ce,{header:e.columnName,style:f(`min-width:${e.size}`),field:e.columnValue,class:"my-0 py-2"},{body:m(s=>{var h,V,x;return[e.columnType=="date"?(l(),o("h6",$t,a(((h=s.data[e.columnValue])==null?void 0:h.split("-").reverse().join("-"))||"---------"),1)):n("",!0),e.columnType=="max-content"?(l(),o("h6",{key:1,style:f(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},a(s.data[e.columnValue]||"---------"),5)):n("",!0),e.columnType=="other"?(l(),o("h6",Lt,a(s.data[e.columnValue]||"---------"),1)):n("",!0),e.columnType=="rating"?(l(),o("h6",Et,[s.data[e.columnValue]>0?(l(),te(de,{key:0,cancel:!1,readonly:"",modelValue:s.data[e.columnValue],"onUpdate:modelValue":D=>s.data[e.columnValue]=D},null,8,["modelValue","onUpdate:modelValue"])):n("",!0)])):n("",!0),e.columnType=="money"?(l(),o("h6",{key:4,style:f(e.columnType=="max-content"?"min-width: max-content":""),class:"m-0 p-0"},a(y.formatoPesosColombianos(s.data[e.columnValue])||"---------"),5)):n("",!0),e.columnValue=="current_status"?(l(),o("div",Ot,[r(g,{style:f([{color:"white"},`background-color:${(V=s.data[e.columnValue])==null?void 0:V.color}`])},{default:m(()=>{var D;return[c(a(((D=s.data[e.columnValue])==null?void 0:D.status)||"---------"),1)]}),_:2},1032,["style"]),t("b",null,a(((x=s.data[e.columnValue])==null?void 0:x.timestamp)||"---------"),1)])):n("",!0),e.columnValue=="channel"?(l(),o("div",jt,[r(g,{style:f([{color:"white"},`background-color:${s.data.channel_color}`])},{default:m(()=>[c(a(s.data[e.columnValue]||"---------"),1)]),_:2},1032,["style"])])):n("",!0),e.columnValue=="tag_name"?(l(),o("div",Bt,[r(g,{style:f([{color:"white"},`background-color:${s.data.tag_color}`])},{default:m(()=>[c(a(s.data[e.columnValue]),1)]),_:2},1032,["style"])])):n("",!0),e.columnValue=="restaurant"?(l(),o("div",Ft,[r(g,{style:f([{color:"white"},`background-color:${s.data.restaurant_color}`])},{default:m(()=>[c(a(s.data[e.columnValue]),1)]),_:2},1032,["style"])])):n("",!0)]}),_:2},1032,["header","style","field"]))),256)),r(me,{class:"my-0 py-0 px-0 mx-0",style:{},header:"Interactuar"},{body:m(e=>[t("div",Mt,[r(R,{onClick:s=>oe(e.data),label:"Gestionar",severity:"help",icon:"pi pi-check p-0",class:"my-0 py-2"},null,8,["onClick"])])]),_:1})]),_:1},8,["value","filters"]),r(_e,{onReload:i[11]||(i[11]=e=>S())})],64)}}},Jt=ve(At,[["__scopeId","data-v-22e8fa35"]]);export{Jt as default};
